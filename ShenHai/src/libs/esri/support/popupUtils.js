// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/assignHelper dojo/i18n!../widgets/Popup/nls/Popup ../PopupTemplate ../popup/content ../popup/FieldInfo ../popup/support/FieldInfoFormat".split(" "),function(A,m,p,q,r,h,t,f){function u(a,b){var c=a;b.ignoreFieldTypes&&(a=a.filter(function(a){return-1===b.ignoreFieldTypes.indexOf(a.type)}));if(0===a.length)return null;var d=b.maximumFields&&a.length>b.maximumFields;d&&(a=a.slice(0,b.maximumFields));a===c&&(a=a.slice());a.sort(v);return{fields:a,limitExceeded:d}}
function v(a,b){return"oid"===a.type?-1:"oid"===b.type?1:n(a)?-1:n(b)?1:(a.alias||a.name).toLocaleLowerCase().localeCompare((b.alias||b.name).toLocaleLowerCase())}function w(a){var b=a.visibleFieldNames,c=a.editFieldsInfo;return a.fields.map(function(a){var d=a.name,e;if(e=a.editable&&-1===x.indexOf(a.type)){if((e=a.name)&&c){var g=c.creationDateField,k=c.creatorField,h=c.editDateField,f=c.editorField;e=-1!==[g&&g.toLowerCase(),k&&k.toLowerCase(),h&&h.toLowerCase(),f&&f.toLowerCase()].indexOf(e.toLowerCase())}else e=
!1;e=!e}return new t({fieldName:d,isEditable:e,label:a.alias,format:y(a),visible:b?b.has(a.name):!0})})}function y(a){switch(a.type){case "small-integer":case "integer":case "single":return new f({digitSeparator:!0,places:0});case "double":return new f({digitSeparator:!0,places:2});case "date":return new f({dateFormat:"long-month-day-year"});default:return null}}function l(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d&&d.valueType&&d.valueType===b)return d.name}return null}function n(a){if("name"===
(a.name&&a.name.toLowerCase())||"name"===(a.alias&&a.alias.toLowerCase()))return!0}Object.defineProperty(m,"__esModule",{value:!0});var x=["oid","global-id","guid"];m.createPopupTemplate=function(a,b){var c=a.displayField,d=a.fields,f=a.title,e=a.visibleFieldNames;a=a.editFieldsInfo;if(!d)return null;b=p({},z,b);d=u(d,b);if(!d)return null;b=d.fields;if(!c){if(b&&b.length){if(!(c=l(b,"name-or-title")||l(b,"unique-identifier")||l(b,"type-or-category")))a:{for(c=0;c<b.length;c++){var g=b[c];if(g&&g.name){var k=
g.name.toLowerCase();if(-1<k.indexOf("name")||-1<k.indexOf("title")){c=g.name;break a}}}c=null}b=c}else b=null;c=b}f=(b=c)?f+": {"+b.trim()+"}":f;c=d.limitExceeded;b=[new h.FieldsContent,new h.AttachmentsContent];c&&b.push(new h.TextContent({text:"\x3csmall\x3e"+q.tooManyFields+"\x3c/small\x3e"}));e=w({fields:d.fields,visibleFieldNames:e,editFieldsInfo:a});return new r({title:f,content:b,fieldInfos:e})};var z={ignoreFieldTypes:["geometry","blob","raster","guid","xml"],maximumFields:75}});