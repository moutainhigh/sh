// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(h,k,v,m,w,n,p,q,e,x,y,z){Object.defineProperty(k,"__esModule",{value:!0});h=function(h){function f(A,b,g){var c=h.call(this,b)||this;c._cimLineLayer=b;var d=0;e.isFunction(b.width)||(d=.5*m.pt2px(b.width));c._dynamicPropertyMap.set("_halfWidth",
function(a,c,l){return e.isFunction(b.width)?.5*m.pt2px(b.width(a,c,l)):d});var a=w.CapType.ROUND;e.isFunction(b.cap)||(a=b.cap);c._dynamicPropertyMap.set("_capType",function(c,d,l){return e.isFunction(b.cap)?b.cap(c,d,l):a});var f;e.isFunction(b.join)||(f=b.join);c._dynamicPropertyMap.set("_joinType",function(a,c,d){return e.isFunction(b.join)?b.join(a,c,d):f});var r;if(!e.isFunction(b.color)){var t=b.color;r=t&&n.premultiplyAlphaRGBA(t)||0}c._dynamicPropertyMap.set("_fillColor",function(a,c,d){return e.isFunction(b.color)?
(a=b.color(a,c,d))&&n.premultiplyAlphaRGBA(a)||0:r});var u;e.isFunction(b.miterLimit)||(u=e.getLimitCosine(b.miterLimit));c._dynamicPropertyMap.set("_miterLimitCosine",function(a,c,d){return e.isFunction(b.miterLimit)?e.getLimitCosine(b.miterLimit(a,c,d)):u});var k=1;e.isFunction(g)||(k=g);c._dynamicPropertyMap.set("_scaleFactor",function(b,a,c){return e.isFunction(g)?g(b,a,c):k});c._isDashed=b.isDashed;c.tessellationProperties._bitset=b.colorLocked?1:0;c._materialKey=q.createMaterialKey(c.geometryType,
A,b.isOutline);c._initializeTessellator(!0);return c}v(f,h);f.fromCIMLine=function(e,b,g){return new f(e,b,g)};f.prototype.bindFeature=function(e,b,g){var c=this,d=this._dynamicPropertyMap;d&&d.forEach(function(a,d){c[d]=a(e,b,g)});this._halfWidth*=this._scaleFactor;var d=this._materialCache,a=this._cimLineLayer.materialHash,a=a(e,b,g),a=d.get(a),d=null;a&&z.ok(a.spriteMosaicItem)&&(d=a.spriteMosaicItem);if(d){this._hasPattern=!0;var a=d.rect,f=a.x+1+d.width,h=a.y+1+d.height;this.tessellationProperties._tl=
p.i1616to32(a.x+1,a.y+1);this.tessellationProperties._br=p.i1616to32(f,h)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;a=q.LineMaterialKey.load(this._materialKey);d&&(a.sdf=d.sdf,a.pattern=!0,a.textureBinding=d.textureBinding);this._materialKey=a.data};return f}(x.default(y.default));k.default=h});