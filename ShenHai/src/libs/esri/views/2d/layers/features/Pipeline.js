// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),function(c,a,
l,g,k,h,f,e,p,b,d,m,r,n,u){var y=new f.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",pbf:"pbf"});return function(a){function e(b){b=a.call(this,b)||this;b.dpi=96;b.format=null;b.origin=null;b.minScale=0;b.maxScale=0;b.size=null;b.spatialReference=null;return b}g(e,a);f=e;e.create=function(b){void 0===b&&(b={size:256,spatialReference:h.SpatialReference.WebMercator});
var a=b.resolutionFactor||1,d=b.scales,n=b.size||256;b=b.spatialReference||h.SpatialReference.WebMercator;if(!r.isValid(b)){a=[];if(d)for(var m=0;m<d.length;m++){var e=d[m];a.push({level:m,scale:e,resolution:e})}else for(var w=5E-4,m=23;0<=m;m--)a.unshift({level:m,scale:w,resolution:w}),w*=2;return new f({dpi:96,lods:a,origin:new h.Point(0,0,b),size:[n,n],spatialReference:b})}var v=(m=r.getInfo(b))?new h.Point(m.origin[0],m.origin[1],b):new h.Point(0,0,b),u=1/(39.37*p.getMetersPerUnitForSR(b)*96),
c=[];if(d)for(m=0;m<d.length;m++)e=d[m],w=e*u,c.push({level:m,scale:e,resolution:w});else for(e=r.isGeographic(b)?512/n*5.916575275917094E8:256/n*5.91657527591555E8,d=Math.ceil(24/a),c.push({level:0,scale:e,resolution:e*u}),m=1;m<d;m++)e/=Math.pow(2,a),w=e*u,c.push({level:m,scale:e,resolution:w});return new f({dpi:96,lods:c,origin:v,size:[n,n],spatialReference:b})};Object.defineProperty(e.prototype,"isWrappable",{get:function(){var b=this.spatialReference,a=this.origin;if(b&&a){var d=r.getInfo(b);
return b.isWrappable&&Math.abs(d.origin[0]-a.x)<=d.dx}return!1},enumerable:!0,configurable:!0});e.prototype.readOrigin=function(b,a){return h.Point.fromJSON(l({spatialReference:a.spatialReference},b))};Object.defineProperty(e.prototype,"lods",{set:function(b){var a=this,d=0,m=0,n=[];this._levelToLOD={};b&&(d=-Infinity,m=Infinity,b.forEach(function(b){n.push(b.scale);d=b.scale>d?b.scale:d;m=b.scale<m?b.scale:m;a._levelToLOD[b.level]=b}));this._set("scales",n);this._set("minScale",d);this._set("maxScale",
m);this._set("lods",b);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});e.prototype.readSize=function(b,a){return[a.cols,a.rows]};e.prototype.writeSize=function(b,a){a.cols=b[0];a.rows=b[0]};e.prototype.zoomToScale=function(b){var a=this.scales;if(0>=b)return a[0];if(b>=a.length)return a[a.length-1];var d=Math.round(b);return a[d]+(d-b)*(a[Math.round(b-.5)]-a[d])};e.prototype.scaleToZoom=function(b){for(var a=this.scales,d=a.length-1,m=0;m<d;m++){var n=a[m],e=a[m+1];if(n<=b)break;
if(e===b)return m+1;if(n>b&&e<b)return m+1-(b-e)/(n-e)}return m};e.prototype.snapScale=function(b,a){void 0===a&&(a=.95);b=this.scaleToZoom(b);return b%Math.floor(b)>=a?this.zoomToScale(Math.ceil(b)):this.zoomToScale(Math.floor(b))};e.prototype.tileAt=function(b,a,d,e){var h=this.lodAt(b);if(!h)return null;var f;if("number"===typeof a)f=a,a=d;else{if(r.equals(a.spatialReference,this.spatialReference))f=a.x,a=a.y;else{e=n.project(a,this.spatialReference);if(!e)return null;f=e.x;a=e.y}e=d}d=h.resolution*
this.size[0];h=h.resolution*this.size[1];e||(e={id:null,level:0,row:0,col:0,extent:m.create()});e.level=b;e.row=Math.floor((this.origin.y-a)/h+.001);e.col=Math.floor((f-this.origin.x)/d+.001);this.updateTileInfo(e);return e};e.prototype.updateTileInfo=function(b){var a=this.lodAt(b.level);if(a){var d=a.resolution*this.size[0],a=a.resolution*this.size[1];b.id=b.level+"/"+b.row+"/"+b.col;b.extent||(b.extent=m.create());b.extent[0]=this.origin.x+b.col*d;b.extent[1]=this.origin.y-(b.row+1)*a;b.extent[2]=
b.extent[0]+d;b.extent[3]=b.extent[1]+a}};e.prototype.upsampleTile=function(b){var a=this._upsampleLevels[b.level];if(!a||-1===a.parentLevel)return!1;b.level=a.parentLevel;b.row=Math.floor(b.row/a.factor+.001);b.col=Math.floor(b.col/a.factor+.001);this.updateTileInfo(b);return!0};e.prototype.getTileBounds=function(b,a){var d=this.lodAt(a.level).resolution,m=d*this.size[0],d=d*this.size[1];b[0]=this.origin.x+a.col*m;b[1]=this.origin.y-(a.row+1)*d;b[2]=b[0]+m;b[3]=b[1]+d;return b};e.prototype.lodAt=
function(b){return this._levelToLOD&&this._levelToLOD[b]||null};e.prototype.clone=function(){return f.fromJSON(this.write({}))};e.prototype._initializeUpsampleLevels=function(){var b=this.lods;this._upsampleLevels=[];for(var a=null,d=0;d<b.length;d++){var m=b[d];this._upsampleLevels[m.level]={parentLevel:a?a.level:-1,factor:a?a.resolution/m.resolution:0};a=m}};var f;k([b.property({type:Number,json:{write:!0}})],e.prototype,"compressionQuality",void 0);k([b.property({type:Number,json:{write:!0}})],
e.prototype,"dpi",void 0);k([b.property({type:String,json:{read:y.read,write:y.write,origins:{"web-scene":{read:!1,write:!1}}}})],e.prototype,"format",void 0);k([b.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],e.prototype,"isWrappable",null);k([b.property({type:h.Point,json:{write:!0}})],e.prototype,"origin",void 0);k([b.reader("origin")],e.prototype,"readOrigin",null);k([b.property({type:[u],value:null,json:{write:!0}})],e.prototype,"lods",null);k([b.property({readOnly:!0})],e.prototype,
"minScale",void 0);k([b.property({readOnly:!0})],e.prototype,"maxScale",void 0);k([b.property({readOnly:!0})],e.prototype,"scales",void 0);k([b.property({cast:function(b){return Array.isArray(b)?b:"number"===typeof b?[b,b]:[256,256]}})],e.prototype,"size",void 0);k([b.reader("size",["rows","cols"])],e.prototype,"readSize",null);k([b.writer("size",{cols:{type:d.Integer},rows:{type:d.Integer}})],e.prototype,"writeSize",null);k([b.property({type:h.SpatialReference,json:{write:!0}})],e.prototype,"spatialReference",
void 0);return e=f=k([b.subclass("esri.layers.support.TileInfo")],e)}(b.declared(e.JSONSupport))})},"esri/geometry":function(){define("require exports ./core/jsonMap ./core/accessorSupport/ensureType ./geometry/Extent ./geometry/Geometry ./geometry/Multipoint ./geometry/Point ./geometry/Polygon ./geometry/Polyline ./geometry/SpatialReference ./geometry/support/jsonUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m){Object.defineProperty(a,"__esModule",{value:!0});a.Extent=k;a.BaseGeometry=h;a.Multipoint=
f;a.Point=e;a.Polygon=p;a.Polyline=b;a.SpatialReference=d;a.isGeometry=function(b){return b instanceof a.BaseGeometry};a.fromJSON=m.fromJSON;a.typeKebabDictionary=l.strict()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});a.isFeatureGeometryType=function(b){return"point"===b||"multipoint"===b||"polyline"===b||"polygon"===b};a.featureGeometryTypeKebabDictionary=l.strict()({esriGeometryPoint:"point",
esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"});a.geometryTypes={base:a.BaseGeometry,key:"type",typeMap:{extent:a.Extent,multipoint:a.Multipoint,point:a.Point,polyline:a.Polyline,polygon:a.Polygon}};a.ensureType=g.ensureOneOfType(a.geometryTypes)})},"esri/geometry/Extent":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/string ../core/accessorSupport/decorators ./Geometry ./Point ./SpatialReference ./support/contains ./support/intersects ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){function u(b,a,d){return null==a?d:null==d?a:b(a,d)}c=function(a){function e(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.type="extent";b.xmin=0;b.ymin=0;b.mmin=void 0;b.zmin=void 0;b.xmax=0;b.ymax=0;b.mmax=void 0;b.zmax=void 0;return b}l(e,a);c=e;e.prototype.normalizeCtorArgs=function(a,d,m,n,e){return!a||"esri.geometry.SpatialReference"!==a.declaredClass&&null==a.wkid?"object"===typeof a?(a.spatialReference=null==a.spatialReference?
b.WGS84:a.spatialReference,a):{xmin:a,ymin:d,xmax:m,ymax:n,spatialReference:null==e?b.WGS84:e}:{spatialReference:a,xmin:0,ymin:0,xmax:0,ymax:0}};e.fromBounds=function(b,a){return new c({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:a})};Object.defineProperty(e.prototype,"center",{get:function(){var b=new p({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});this.hasZ&&(b.z=.5*(this.zmin+this.zmax));this.hasM&&(b.m=.5*(this.mmin+this.mmax));return b},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"extent",{get:function(){return this.clone()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hasM",{get:function(){return null!=this.mmin&&null!=this.mmax},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hasZ",{get:function(){return null!=this.zmin&&null!=this.zmax},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.ymax-this.ymin)},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.xmax-this.xmin)},enumerable:!0,configurable:!0});e.prototype.centerAt=function(b){var a=this.center;return null!=b.z&&this.hasZ?this.offset(b.x-a.x,b.y-a.y,b.z-a.z):this.offset(b.x-a.x,b.y-a.y)};e.prototype.clone=function(){var b=new c;b.xmin=this.xmin;b.ymin=this.ymin;b.xmax=this.xmax;b.ymax=this.ymax;b.spatialReference=this.spatialReference;null!=this.zmin&&(b.zmin=this.zmin,b.zmax=this.zmax);
null!=this.mmin&&(b.mmin=this.mmin,b.mmax=this.mmax);return b};e.prototype.contains=function(b){if(!b)return!1;var a=this.spatialReference,m=b.spatialReference;a&&m&&!a.equals(m)&&n.canProject(a,m)&&(b=a.isWebMercator?n.geographicToWebMercator(b):n.webMercatorToGeographic(b,!0));return"point"===b.type?d.extentContainsPoint(this,b):"extent"===b.type?d.extentContainsExtent(this,b):!1};e.prototype.equals=function(b){if(!b)return!1;var a=this.spatialReference,d=b.spatialReference;a&&d&&!a.equals(d)&&
n.canProject(a,d)&&(b=a.isWebMercator?n.geographicToWebMercator(b):n.webMercatorToGeographic(b,!0));return this.xmin===b.xmin&&this.ymin===b.ymin&&this.zmin===b.zmin&&this.mmin===b.mmin&&this.xmax===b.xmax&&this.ymax===b.ymax&&this.zmax===b.zmax&&this.mmax===b.mmax};e.prototype.expand=function(b){b=.5*(1-b);var a=this.width*b,d=this.height*b;this.xmin+=a;this.ymin+=d;this.xmax-=a;this.ymax-=d;this.hasZ&&(a=(this.zmax-this.zmin)*b,this.zmin+=a,this.zmax-=a);this.hasM&&(b*=this.mmax-this.mmin,this.mmin+=
b,this.mmax-=b);return this};e.prototype.intersects=function(b){if(k.isNone(b))return!1;var a=this.spatialReference,d=b.spatialReference;a&&d&&!a.equals(d)&&n.canProject(a,d)&&(b=a.isWebMercator?n.geographicToWebMercator(b):n.webMercatorToGeographic(b,!0));a=m.getExtentIntersector(b.type);return"mesh"!==b.type?a(this,b):a(this,b.extent)};e.prototype.normalize=function(){var b=this._normalize(!1,!0);return Array.isArray(b)?b:[b]};e.prototype.offset=function(b,a,d){this.xmin+=b;this.ymin+=a;this.xmax+=
b;this.ymax+=a;null!=d&&(this.zmin+=d,this.zmax+=d);return this};e.prototype.shiftCentralMeridian=function(){return this._normalize(!0)};e.prototype.union=function(b){this.xmin=Math.min(this.xmin,b.xmin);this.ymin=Math.min(this.ymin,b.ymin);this.xmax=Math.max(this.xmax,b.xmax);this.ymax=Math.max(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=u(Math.min,this.zmin,b.zmin),this.zmax=u(Math.max,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=u(Math.min,this.mmin,b.mmin),this.mmax=u(Math.max,this.mmax,
b.mmax);return this};e.prototype.intersection=function(b){if(!this.intersects(b))return null;this.xmin=Math.max(this.xmin,b.xmin);this.ymin=Math.max(this.ymin,b.ymin);this.xmax=Math.min(this.xmax,b.xmax);this.ymax=Math.min(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=u(Math.max,this.zmin,b.zmin),this.zmax=u(Math.min,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=u(Math.max,this.mmin,b.mmin),this.mmax=u(Math.min,this.mmax,b.mmax);return this};e.prototype.toJSON=function(b){return this.write(null,
b)};e.prototype._shiftCM=function(a){void 0===a&&(a=r.getInfo(this.spatialReference));if(!a||!this.spatialReference)return this;var d=this.spatialReference,m=this._getCM(a);if(m){var e=d.isWebMercator?n.webMercatorToGeographic(m):m;this.xmin-=m.x;this.xmax-=m.x;d.isWebMercator||(e.x=this._normalizeX(e.x,a).x);this.spatialReference=new b(h.replace(d.isWGS84?a.altTemplate:a.wkTemplate,{Central_Meridian:e.x}))}return this};e.prototype._getCM=function(b){var a=null,d=b.valid;b=d[0];var d=d[1],m=this.xmin,
n=this.xmax;m>=b&&m<=d&&n>=b&&n<=d||(a=this.center);return a};e.prototype._normalize=function(b,a,d){var m=this.spatialReference;if(!m)return this;d=d||r.getInfo(m);if(!d)return this;var n=this._getParts(d).map(function(b){return b.extent});if(2>n.length)return n[0]||this;if(2<n.length)return b?this._shiftCM(d):this.set({xmin:d.valid[0],xmax:d.valid[1]});if(b)return this._shiftCM(d);if(a)return n;var e=!0,h=!0;n.forEach(function(b){b.hasZ||(e=!1);b.hasM||(h=!1)});return{rings:n.map(function(b){var a=
[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(e)for(var d=(b.zmax-b.zmin)/2,m=0;m<a.length;m++)a[m].push(d);if(h)for(b=(b.mmax-b.mmin)/2,m=0;m<a.length;m++)a[m].push(b);return a}),hasZ:e,hasM:h,spatialReference:m}};e.prototype._getParts=function(b){var a=this.cache._parts;if(!a){var a=[],d=this.ymin,m=this.ymax,n=this.spatialReference,e=this.width,h=this.xmin,f=this.xmax,p=void 0;b=b||r.getInfo(n);var u=b.valid,w=u[0],g=u[1],p=this._normalizeX(this.xmin,b),t=
p.x,u=p.frameId,p=this._normalizeX(this.xmax,b),v=p.x;b=p.frameId;p=t===v&&0<e;if(e>2*g){e=new c(h<f?t:v,d,g,m,n);h=new c(w,d,h<f?v:t,m,n);f=new c(0,d,g,m,n);d=new c(w,d,0,m,n);m=[];n=[];e.contains(f)&&m.push(u);e.contains(d)&&n.push(u);h.contains(f)&&m.push(b);h.contains(d)&&n.push(b);for(w=u+1;w<b;w++)m.push(w),n.push(w);a.push({extent:e,frameIds:[u]},{extent:h,frameIds:[b]},{extent:f,frameIds:m},{extent:d,frameIds:n})}else t>v||p?a.push({extent:new c(t,d,g,m,n),frameIds:[u]},{extent:new c(w,d,
v,m,n),frameIds:[b]}):a.push({extent:new c(t,d,v,m,n),frameIds:[u]});this.cache._parts=a}b=this.hasZ;d=this.hasM;if(b||d)for(u={},b&&(u.zmin=this.zmin,u.zmax=this.zmax),d&&(u.mmin=this.mmin,u.mmax=this.mmax),b=0;b<a.length;b++)a[b].extent.set(u);return a};e.prototype._normalizeX=function(b,a){var d=a.valid;a=d[0];var m=d[1],d=2*m,n=0;b>m?(a=Math.ceil(Math.abs(b-m)/d),b-=a*d,n=a):b<a&&(a=Math.ceil(Math.abs(b-a)/d),b+=a*d,n=-a);return{x:b,frameId:n}};var c;g([f.property({dependsOn:"xmin ymin zmin mmin xmax ymax zmax mmax spatialReference".split(" ")})],
e.prototype,"cache",void 0);g([f.property({readOnly:!0,dependsOn:["cache"]})],e.prototype,"center",null);g([f.property({readOnly:!0,dependsOn:["cache"]})],e.prototype,"extent",null);g([f.property({readOnly:!0,dependsOn:["mmin","mmax"],json:{write:{enabled:!1,overridePolicy:null}}})],e.prototype,"hasM",null);g([f.property({readOnly:!0,dependsOn:["zmin","zmax"],json:{write:{enabled:!1,overridePolicy:null}}})],e.prototype,"hasZ",null);g([f.property({readOnly:!0,dependsOn:["ymin","ymax"]})],e.prototype,
"height",null);g([f.property({readOnly:!0,dependsOn:["xmin","xmax"]})],e.prototype,"width",null);g([f.property({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],e.prototype,"xmin",void 0);g([f.property({type:Number,json:{write:!0}})],e.prototype,"ymin",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],e.prototype,"mmin",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},
write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],e.prototype,"zmin",void 0);g([f.property({type:Number,json:{write:!0}})],e.prototype,"xmax",void 0);g([f.property({type:Number,json:{write:!0}})],e.prototype,"ymax",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],e.prototype,"mmax",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],
e.prototype,"zmax",void 0);return e=c=g([f.subclass("esri.geometry.Extent")],e)}(f.declared(e));c.prototype.toJSON.isDefaultToJSON=!0;return c})},"esri/geometry/Geometry":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./SpatialReference".split(" "),function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type=null;b.extent=null;b.hasM=!1;b.hasZ=!1;b.spatialReference=
f.WGS84;return b}l(e,a);Object.defineProperty(e.prototype,"cache",{get:function(){return{}},enumerable:!0,configurable:!0});e.prototype.readSpatialReference=function(b,a){if(b instanceof f)return b;if(null!=b){var d=new f;d.read(b,a);return d}return b};e.prototype.clone=function(){console.warn(".clone() is not implemented for "+this.declaredClass);return null};e.prototype.clearCache=function(){this.notifyChange("cache")};e.prototype.getCacheValue=function(b){return this.cache[b]};e.prototype.setCacheValue=
function(b,a){this.cache[b]=a};g([h.property()],e.prototype,"type",void 0);g([h.property({readOnly:!0,dependsOn:["spatialReference"]})],e.prototype,"cache",null);g([h.property({readOnly:!0,dependsOn:["spatialReference"]})],e.prototype,"extent",void 0);g([h.property({type:Boolean,json:{write:{overridePolicy:function(b){return{enabled:b}}}}})],e.prototype,"hasM",void 0);g([h.property({type:Boolean,json:{write:{overridePolicy:function(b){return{enabled:b}}}}})],e.prototype,"hasZ",void 0);g([h.property({type:f,
json:{write:!0}})],e.prototype,"spatialReference",void 0);g([h.reader("spatialReference")],e.prototype,"readSpatialReference",null);return e=g([h.subclass("esri.geometry.Geometry")],e)}(h.declared(k.JSONSupport))})},"esri/core/JSONSupport":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./declare ./accessorSupport/decorators ./accessorSupport/read ./accessorSupport/write".split(" "),function(c,a,l,g,k,h,f,e,p){function b(b,a){if(!b)return null;
if(b.declaredClass)throw Error("JSON object is already hydrated");var d=new this;d.read(b,a);return d}function d(b){return b&&"read"in b&&"write"in b&&"toJSON"in b}Object.defineProperty(a,"__esModule",{value:!0});a.JSONSupportMixin=function(a){a=function(a){function d(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];return a.apply(this,b)||this}l(d,a);d.prototype.read=function(b,a){e.default(this,b,a)};d.prototype.write=function(b,a){return p.default(this,b||{},a)};d.prototype.toJSON=function(b){return this.write(null,
b)};d.fromJSON=function(a,d){return b.call(this,a,d)};return d=g([f.subclass("esri.core.JSONSupport")],d)}(f.declared(a));a.prototype.toJSON.isDefaultToJSON=!0;return a};a.isJSONSupport=d;h.after(function(a){for(var m=a.prototype;;){if(d(m)){a.fromJSON=b.bind(a);break}m=Object.getPrototypeOf(m);if(!m)break}});c=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}l(a,b);return a=g([f.subclass("esri.core.JSONSupport")],a)}(f.declared(a.JSONSupportMixin(k)));a.JSONSupport=c})},"esri/core/accessorSupport/read":function(){define("require exports ../tsSupport/assignHelper ./get ./utils ./extensions/serializableProperty".split(" "),
function(c,a,l,g,k,h){function f(a,b,d){void 0===d&&(d=e);if(b&&"object"===typeof b){for(var m=k.getProperties(a),f=m.metadatas,n={},p=0,c=Object.getOwnPropertyNames(b);p<c.length;p++){var w=n,t=f,v=c[p],z=b,l=d,C=h.originSpecificReadPropertyDefinition(t[v],l);C&&(!C.read||!1!==C.read.enabled&&!C.read.source)&&(w[v]=!0);for(var D=0,B=Object.getOwnPropertyNames(t);D<B.length;D++){var E=B[D],C=h.originSpecificReadPropertyDefinition(t[E],l),F;a:{F=v;var H=z;if(C&&C.read&&!1!==C.read.enabled&&C.read.source)if(C=
C.read.source,"string"===typeof C){if(C===F||-1<C.indexOf(".")&&0===C.indexOf(F)&&g.exists(C,H)){F=!0;break a}}else for(var J=0;J<C.length;J++){var K=C[J];if(K===F||-1<K.indexOf(".")&&0===K.indexOf(F)&&g.exists(K,H)){F=!0;break a}}F=!1}F&&(w[E]=!0)}}m.setDefaultOrigin(d.origin);c=0;for(w=Object.getOwnPropertyNames(n);c<w.length;c++)p=w[c],v=(t=h.originSpecificReadPropertyDefinition(f[p],d).read)&&t.source,z=void 0,z=v&&"string"===typeof v?g.valueOf(b,v):b[p],t&&t.reader&&(z=t.reader.call(a,z,b,d)),
void 0!==z&&m.set(p,z);if(!d||!d.ignoreDefaults)for(b=0,f=Object.getOwnPropertyNames(f);b<f.length;b++)p=f[b],n[p]||(c=a,w=m,t=d,v=(v=h.originSpecificPropertyDefinition(w.metadatas[p],"any",t))&&v.default,void 0!==v&&(c="function"===typeof v?v.call(c,p,t):v,void 0!==c&&w.set(p,c)));m.setDefaultOrigin("user")}}Object.defineProperty(a,"__esModule",{value:!0});var e={origin:"service"};a.read=f;a.readLoadable=function(a,b,d,m){void 0===m&&(m=e);b=l({},m,{messages:[]});d(b);b.messages.forEach(function(b){"warning"!==
b.type||a.loaded?m&&m.messages.push(b):a.loadWarnings.push(b)})};a.default=f})},"esri/core/accessorSupport/write":function(){define("require exports ../arrayUtils ../Error ../Logger ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(c,a,l,g,k,h,f,e){function p(b,a,n,e,f,p){if(!e||!e.write)return!1;var m=b.get(n);if(!f&&e.write.overridePolicy){var r=e.write.overridePolicy.call(b,m,n,p);void 0!==r&&(f=r)}f||(f=e.write);if(!f||!1===f.enabled)return!1;if((null===m&&!f.allowNull||
void 0===m)&&f.isRequired)return(a=new g("web-document-write:property-required","Missing value for required property '"+n+"' on '"+b.declaredClass+"'",{propertyName:n,target:b}),p)&&p.messages?p.messages.push(a):a&&!p&&d.error(a.name,a.message),!1;if(void 0===m||null===m&&!f.allowNull)return!1;r=e.default;void 0===r?m=!1:"function"===typeof r?Array.isArray(m)?(b=r.call(b,n,p),m=l.equals(b,m)):m=!1:m=r===m;return m?!1:void 0!==e.default?!0:!f.ignoreOrigin&&p&&p.origin&&a.store.originOf(n)<h.nameToId(p.origin)?
!1:!0}function b(b,a,d){if(b&&"function"===typeof b.toJSON&&(!b.toJSON.isDefaultToJSON||!b.write))return f.merge(a,b.toJSON());var m=f.getProperties(b),n=m.metadatas,r;for(r in n){var c=e.originSpecificWritePropertyDefinition(n[r],d);if(p(b,m,r,c,null,d)){var g=b.get(r),k={};c.write.writer.call(b,g,k,"string"===typeof c.write.target?c.write.target:r,d);c=k;0<Object.keys(c).length&&(a=f.merge(a,c),d&&d.writtenProperties&&d.writtenProperties.push({target:b,propName:r,oldOrigin:h.idToReadableName(m.store.originOf(r)),
newOrigin:d.origin}))}}return a}Object.defineProperty(a,"__esModule",{value:!0});var d=k.getLogger("esri.core.accessorSupport.write");a.willPropertyWrite=function(b,a,d,h){var m=f.getProperties(b),n=e.originSpecificWritePropertyDefinition(m.metadatas[a],h);return n?p(b,m,a,n,d,h):!1};a.write=b;a.default=b})},"esri/geometry/SpatialReference":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/spatialReferenceUtils".split(" "),
function(c,a,l,g,k,h,f,e,p){c=function(b){function a(a){a=b.call(this,a)||this;a.latestWkid=null;a.wkid=null;a.wkt=null;a.imageCoordinateSystem=null;return a}g(a,b);m=a;a.fromJSON=function(b){if(!b)return null;if(b.wkid){if(102100===b.wkid)return m.WebMercator;if(4326===b.wkid)return m.WGS84}var a=new m;a.read(b);return a};a.prototype.normalizeCtorArgs=function(b){var a;return b&&"object"===typeof b?b:(a={},a["string"===typeof b?"wkt":"wkid"]=b,a)};Object.defineProperty(a.prototype,"isWGS84",{get:function(){return p.isWGS84(this)},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isWebMercator",{get:function(){return p.isWebMercator(this)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isGeographic",{get:function(){return p.isGeographic(this)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isWrappable",{get:function(){return p.isWrappable(this)},enumerable:!0,configurable:!0});a.prototype.writeWkt=function(b,a){this.wkid||(a.wkt=b)};a.prototype.clone=function(){if(this===
m.WGS84)return m.WGS84;if(this===m.WebMercator)return m.WebMercator;var b=new m;null!=this.wkid?(b.wkid=this.wkid,null!=this.latestWkid&&(b.latestWkid=this.latestWkid),null!=this.vcsWkid&&(b.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(b.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(b.wkt=this.wkt);this.imageCoordinateSystem&&(b.imageCoordinateSystem=f.clone(this.imageCoordinateSystem));return b};a.prototype.equals=function(b){if(null==b)return!1;if(this.imageCoordinateSystem||b.imageCoordinateSystem){if(null==
this.imageCoordinateSystem||null==b.imageCoordinateSystem)return!1;var a=b.imageCoordinateSystem,d=a.id,a=a.referenceServiceName,m=b.imageCoordinateSystem.geodataXform,e=this.imageCoordinateSystem;return null==d||m?JSON.stringify(e)===JSON.stringify(b.imageCoordinateSystem):a?e.id===d&&e.referenceServiceName===a:e.id===d}return p.equals(this,b)};a.prototype.toJSON=function(b){return this.write(null,b)};var m;a.GCS_NAD_1927=null;a.WGS84=null;a.WebMercator=null;k([e.property({dependsOn:["wkid"],readOnly:!0})],
a.prototype,"isWGS84",null);k([e.property({dependsOn:["wkid"],readOnly:!0})],a.prototype,"isWebMercator",null);k([e.property({dependsOn:["wkid","wkt"],readOnly:!0})],a.prototype,"isGeographic",null);k([e.property({dependsOn:["wkid"],readOnly:!0})],a.prototype,"isWrappable",null);k([e.property({type:Number,json:{write:!0}})],a.prototype,"latestWkid",void 0);k([e.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkt?!0:!1}}}}}}})],
a.prototype,"wkid",void 0);k([e.property({type:String,json:{origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkid?!0:!1}}}}}}})],a.prototype,"wkt",void 0);k([e.writer("wkt"),e.writer("web-scene","wkt")],a.prototype,"writeWkt",null);k([e.property({type:Number,json:{write:!0}})],a.prototype,"vcsWkid",void 0);k([e.property({type:Number,json:{write:!0}})],a.prototype,"latestVcsWkid",void 0);k([e.property()],a.prototype,"imageCoordinateSystem",void 0);return a=m=k([e.subclass("esri.geometry.SpatialReference")],
a)}(e.declared(h.JSONSupport));c.prototype.toJSON.isDefaultToJSON=!0;c.GCS_NAD_1927=new c({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'});c.WGS84=new c(p.WGS84);c.WebMercator=new c(p.WebMercator);Object.freeze&&(Object.freeze(c.GCS_NAD_1927),Object.freeze(c.WGS84),Object.freeze(c.WebMercator));return c})},"esri/geometry/support/spatialReferenceUtils":function(){define(["require",
"exports","../../core/string","./WKIDUnitConversion"],function(c,a,l,g){function k(b){return f(b)&&b.wkid?d[b.wkid]:null}function h(b){return f(b)&&!0===e[b.wkid]}function f(b){return null!=b&&(null!=b.wkid&&2E3<=b.wkid||null!=b.wkt)}Object.defineProperty(a,"__esModule",{value:!0});var e={102113:!0,102100:!0,3857:!0,3785:!0},p={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0};c=[-2.0037508342788905E7,2.0037508342788905E7];var b=[-2.0037508342787E7,2.0037508342787E7],d={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:c,origin:b,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:c,origin:b,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:c,origin:b,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:c,origin:b,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}};a.equals=function(b,a){return b&&a?b===a?!0:null!=b.wkid||null!=a.wkid?b.wkid===a.wkid||h(b)&&h(a)||null!=a.latestWkid&&b.wkid===a.latestWkid||null!=b.latestWkid&&a.wkid===b.latestWkid:b.wkt&&a.wkt?b.wkt.toUpperCase()===a.wkt.toUpperCase():!1:!1};a.getInfo=k;a.isGeographic=function(b){return f(b)?b.wkid?null==g[b.wkid]:b.wkt?!!/^\s*GEOGCS/i.test(b.wkt):!1:!1};a.isWGS84=function(b){return f(b)&&4326===b.wkid};a.isWebMercator=h;a.isWrappable=function(b){return f(b)&&
!0===p[b.wkid]};a.isValid=f;a.WGS84={wkid:4326,wkt:l.replace(k({wkid:4326}).wkTemplate,{Central_Meridian:"0.0"})};a.WebMercator={wkid:102100,latestWkid:3857}})},"esri/geometry/support/WKIDUnitConversion":function(){define([],function(){var c,a={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],units:"Meter Foot Foot_US Foot_Clarke Yard_Clarke Link_Clarke Yard_Sears Foot_Sears Chain_Sears Chain_Benoit_1895_B Yard_Indian Yard_Indian_1937 Foot_Gold_Coast Chain_Sears_1922_Truncated 50_Kilometers 150_Kilometers".split(" "),
2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,
3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,
3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,
3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,
5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,
6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,
6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,
6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,
6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,
7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,
7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,
8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,
8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,
8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,
24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,
32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,
103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,
103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,
103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,
103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(c=2E3;2045>=c;c++)a[c]=0;for(c=2056;2065>=c;c++)a[c]=0;for(c=2067;2135>=c;c++)a[c]=0;for(c=2137;2154>=c;c++)a[c]=0;for(c=2161;2170>=c;c++)a[c]=0;for(c=2172;2193>=c;c++)a[c]=
0;for(c=2195;2198>=c;c++)a[c]=0;for(c=2200;2203>=c;c++)a[c]=0;for(c=2205;2217>=c;c++)a[c]=0;for(c=2222;2224>=c;c++)a[c]=1;for(c=2225;2250>=c;c++)a[c]=2;for(c=2251;2253>=c;c++)a[c]=1;for(c=2257;2264>=c;c++)a[c]=2;for(c=2274;2279>=c;c++)a[c]=2;for(c=2280;2282>=c;c++)a[c]=1;for(c=2283;2289>=c;c++)a[c]=2;for(c=2290;2292>=c;c++)a[c]=0;for(c=2308;2313>=c;c++)a[c]=0;for(c=2315;2491>=c;c++)a[c]=0;for(c=2494;2866>=c;c++)a[c]=0;for(c=2867;2869>=c;c++)a[c]=1;for(c=2870;2888>=c;c++)a[c]=2;for(c=2891;2895>=c;c++)a[c]=
2;for(c=2896;2898>=c;c++)a[c]=1;for(c=2902;2908>=c;c++)a[c]=2;for(c=2915;2920>=c;c++)a[c]=2;for(c=2921;2923>=c;c++)a[c]=1;for(c=2924;2930>=c;c++)a[c]=2;for(c=2931;2962>=c;c++)a[c]=0;for(c=2964;2968>=c;c++)a[c]=2;for(c=2969;2973>=c;c++)a[c]=0;for(c=2975;2991>=c;c++)a[c]=0;for(c=2995;3051>=c;c++)a[c]=0;for(c=3054;3079>=c;c++)a[c]=0;for(c=3081;3088>=c;c++)a[c]=0;for(c=3092;3101>=c;c++)a[c]=0;for(c=3106;3138>=c;c++)a[c]=0;for(c=3146;3151>=c;c++)a[c]=0;for(c=3153;3166>=c;c++)a[c]=0;for(c=3168;3172>=c;c++)a[c]=
0;for(c=3174;3203>=c;c++)a[c]=0;for(c=3294;3358>=c;c++)a[c]=0;for(c=3367;3403>=c;c++)a[c]=0;for(c=3408;3416>=c;c++)a[c]=0;for(c=3417;3438>=c;c++)a[c]=2;for(c=3441;3446>=c;c++)a[c]=2;for(c=3447;3450>=c;c++)a[c]=0;for(c=3451;3459>=c;c++)a[c]=2;for(c=3460;3478>=c;c++)a[c]=0;for(c=3554;3559>=c;c++)a[c]=0;for(c=3560;3570>=c;c++)a[c]=2;for(c=3571;3581>=c;c++)a[c]=0;for(c=3594;3597>=c;c++)a[c]=0;for(c=3601;3604>=c;c++)a[c]=0;for(c=3637;3639>=c;c++)a[c]=0;for(c=3665;3667>=c;c++)a[c]=0;for(c=3693;3695>=c;c++)a[c]=
0;for(c=3701;3727>=c;c++)a[c]=0;for(c=3728;3739>=c;c++)a[c]=2;for(c=3740;3751>=c;c++)a[c]=0;for(c=3753;3760>=c;c++)a[c]=2;for(c=3761;3773>=c;c++)a[c]=0;for(c=3775;3777>=c;c++)a[c]=0;for(c=3779;3781>=c;c++)a[c]=0;for(c=3783;3785>=c;c++)a[c]=0;for(c=3788;3791>=c;c++)a[c]=0;for(c=3797;3802>=c;c++)a[c]=0;for(c=3814;3816>=c;c++)a[c]=0;for(c=3825;3829>=c;c++)a[c]=0;for(c=3832;3841>=c;c++)a[c]=0;for(c=3844;3852>=c;c++)a[c]=0;for(c=3873;3885>=c;c++)a[c]=0;for(c=3890;3893>=c;c++)a[c]=0;for(c=3907;3912>=c;c++)a[c]=
0;for(c=3942;3950>=c;c++)a[c]=0;for(c=3968;3970>=c;c++)a[c]=0;for(c=3973;3976>=c;c++)a[c]=0;for(c=3986;3989>=c;c++)a[c]=0;for(c=3994;3997>=c;c++)a[c]=0;for(c=4048;4051>=c;c++)a[c]=0;for(c=4056;4063>=c;c++)a[c]=0;for(c=4093;4096>=c;c++)a[c]=0;for(c=4390;4398>=c;c++)a[c]=0;for(c=4399;4413>=c;c++)a[c]=2;for(c=4418;4433>=c;c++)a[c]=2;for(c=4455;4457>=c;c++)a[c]=2;for(c=4484;4489>=c;c++)a[c]=0;for(c=4491;4554>=c;c++)a[c]=0;for(c=4568;4589>=c;c++)a[c]=0;for(c=4652;4656>=c;c++)a[c]=0;for(c=4766;4800>=c;c++)a[c]=
0;for(c=5014;5016>=c;c++)a[c]=0;for(c=5069;5072>=c;c++)a[c]=0;for(c=5105;5130>=c;c++)a[c]=0;for(c=5173;5188>=c;c++)a[c]=0;for(c=5253;5259>=c;c++)a[c]=0;for(c=5269;5275>=c;c++)a[c]=0;for(c=5292;5311>=c;c++)a[c]=0;for(c=5329;5331>=c;c++)a[c]=0;for(c=5343;5349>=c;c++)a[c]=0;for(c=5355;5357>=c;c++)a[c]=0;for(c=5387;5389>=c;c++)a[c]=0;for(c=5459;5463>=c;c++)a[c]=0;for(c=5479;5482>=c;c++)a[c]=0;for(c=5518;5520>=c;c++)a[c]=0;for(c=5530;5539>=c;c++)a[c]=0;for(c=5550;5552>=c;c++)a[c]=0;for(c=5562;5583>=c;c++)a[c]=
0;for(c=5623;5625>=c;c++)a[c]=2;for(c=5631;5639>=c;c++)a[c]=0;for(c=5649;5653>=c;c++)a[c]=0;for(c=5663;5680>=c;c++)a[c]=0;for(c=5682;5685>=c;c++)a[c]=0;for(c=5875;5877>=c;c++)a[c]=0;for(c=5896;5899>=c;c++)a[c]=0;for(c=5921;5940>=c;c++)a[c]=0;for(c=6050;6125>=c;c++)a[c]=0;for(c=6244;6275>=c;c++)a[c]=0;for(c=6328;6348>=c;c++)a[c]=0;for(c=6350;6356>=c;c++)a[c]=0;for(c=6366;6372>=c;c++)a[c]=0;for(c=6381;6387>=c;c++)a[c]=0;for(c=6393;6404>=c;c++)a[c]=0;for(c=6480;6483>=c;c++)a[c]=0;for(c=6511;6514>=c;c++)a[c]=
0;for(c=6579;6581>=c;c++)a[c]=0;for(c=6619;6624>=c;c++)a[c]=0;for(c=6625;6627>=c;c++)a[c]=2;for(c=6628;6632>=c;c++)a[c]=0;for(c=6634;6637>=c;c++)a[c]=0;for(c=6669;6692>=c;c++)a[c]=0;for(c=6707;6709>=c;c++)a[c]=0;for(c=6720;6723>=c;c++)a[c]=0;for(c=6732;6738>=c;c++)a[c]=0;for(c=6931;6933>=c;c++)a[c]=0;for(c=6956;6959>=c;c++)a[c]=0;for(c=7005;7007>=c;c++)a[c]=0;for(c=7057;7070>=c;c++)a[c]=2;for(c=7074;7082>=c;c++)a[c]=0;for(c=7109;7118>=c;c++)a[c]=0;for(c=7119;7127>=c;c++)a[c]=1;for(c=7374;7376>=c;c++)a[c]=
0;for(c=7528;7586>=c;c++)a[c]=0;for(c=7587;7645>=c;c++)a[c]=2;for(c=7692;7696>=c;c++)a[c]=0;for(c=7755;7787>=c;c++)a[c]=0;for(c=7791;7795>=c;c++)a[c]=0;for(c=7799;7801>=c;c++)a[c]=0;for(c=7803;7805>=c;c++)a[c]=0;for(c=7825;7831>=c;c++)a[c]=0;for(c=7845;7859>=c;c++)a[c]=0;for(c=8013;8032>=c;c++)a[c]=0;for(c=8065;8068>=c;c++)a[c]=1;for(c=8518;8529>=c;c++)a[c]=2;for(c=8533;8536>=c;c++)a[c]=2;for(c=8538;8540>=c;c++)a[c]=2;for(c=8677;8679>=c;c++)a[c]=0;for(c=8836;8840>=c;c++)a[c]=0;for(c=8857;8859>=c;c++)a[c]=
0;for(c=8908;8910>=c;c++)a[c]=0;for(c=9154;9159>=c;c++)a[c]=0;for(c=9205;9218>=c;c++)a[c]=0;for(c=20002;20032>=c;c++)a[c]=0;for(c=20062;20092>=c;c++)a[c]=0;for(c=20135;20138>=c;c++)a[c]=0;for(c=20248;20258>=c;c++)a[c]=0;for(c=20348;20358>=c;c++)a[c]=0;for(c=20436;20440>=c;c++)a[c]=0;for(c=20822;20824>=c;c++)a[c]=0;for(c=20934;20936>=c;c++)a[c]=0;for(c=21035;21037>=c;c++)a[c]=0;for(c=21095;21097>=c;c++)a[c]=0;for(c=21148;21150>=c;c++)a[c]=0;for(c=21413;21423>=c;c++)a[c]=0;for(c=21473;21483>=c;c++)a[c]=
0;for(c=21780;21782>=c;c++)a[c]=0;for(c=21891;21894>=c;c++)a[c]=0;for(c=21896;21899>=c;c++)a[c]=0;for(c=22171;22177>=c;c++)a[c]=0;for(c=22181;22187>=c;c++)a[c]=0;for(c=22191;22197>=c;c++)a[c]=0;for(c=22234;22236>=c;c++)a[c]=0;for(c=22521;22525>=c;c++)a[c]=0;for(c=22991;22994>=c;c++)a[c]=0;for(c=23028;23038>=c;c++)a[c]=0;for(c=23830;23853>=c;c++)a[c]=0;for(c=23866;23872>=c;c++)a[c]=0;for(c=23877;23884>=c;c++)a[c]=0;for(c=23886;23894>=c;c++)a[c]=0;for(c=23946;23948>=c;c++)a[c]=0;for(c=24311;24313>=
c;c++)a[c]=0;for(c=24342;24347>=c;c++)a[c]=0;for(c=24370;24374>=c;c++)a[c]=10;for(c=24375;24381>=c;c++)a[c]=0;for(c=24718;24721>=c;c++)a[c]=0;for(c=24817;24821>=c;c++)a[c]=0;for(c=24877;24882>=c;c++)a[c]=0;for(c=24891;24893>=c;c++)a[c]=0;for(c=25391;25395>=c;c++)a[c]=0;for(c=25828;25838>=c;c++)a[c]=0;for(c=26191;26195>=c;c++)a[c]=0;for(c=26391;26393>=c;c++)a[c]=0;for(c=26701;26722>=c;c++)a[c]=0;for(c=26729;26799>=c;c++)a[c]=2;for(c=26801;26803>=c;c++)a[c]=2;for(c=26811;26813>=c;c++)a[c]=2;for(c=26847;26870>=
c;c++)a[c]=2;for(c=26891;26899>=c;c++)a[c]=0;for(c=26901;26923>=c;c++)a[c]=0;for(c=26929;26946>=c;c++)a[c]=0;for(c=26948;26998>=c;c++)a[c]=0;for(c=27037;27040>=c;c++)a[c]=0;for(c=27205;27232>=c;c++)a[c]=0;for(c=27258;27260>=c;c++)a[c]=0;for(c=27391;27398>=c;c++)a[c]=0;for(c=27561;27564>=c;c++)a[c]=0;for(c=27571;27574>=c;c++)a[c]=0;for(c=27581;27584>=c;c++)a[c]=0;for(c=27591;27594>=c;c++)a[c]=0;for(c=28191;28193>=c;c++)a[c]=0;for(c=28348;28358>=c;c++)a[c]=0;for(c=28402;28432>=c;c++)a[c]=0;for(c=28462;28492>=
c;c++)a[c]=0;for(c=29118;29122>=c;c++)a[c]=0;for(c=29168;29172>=c;c++)a[c]=0;for(c=29177;29185>=c;c++)a[c]=0;for(c=29187;29195>=c;c++)a[c]=0;for(c=29900;29903>=c;c++)a[c]=0;for(c=30161;30179>=c;c++)a[c]=0;for(c=30491;30494>=c;c++)a[c]=0;for(c=30729;30732>=c;c++)a[c]=0;for(c=31251;31259>=c;c++)a[c]=0;for(c=31265;31268>=c;c++)a[c]=0;for(c=31275;31279>=c;c++)a[c]=0;for(c=31281;31297>=c;c++)a[c]=0;for(c=31461;31469>=c;c++)a[c]=0;for(c=31491;31495>=c;c++)a[c]=0;for(c=31917;31922>=c;c++)a[c]=0;for(c=31965;32E3>=
c;c++)a[c]=0;for(c=32001;32003>=c;c++)a[c]=2;for(c=32005;32031>=c;c++)a[c]=2;for(c=32033;32060>=c;c++)a[c]=2;for(c=32064;32067>=c;c++)a[c]=2;for(c=32074;32077>=c;c++)a[c]=2;for(c=32081;32086>=c;c++)a[c]=0;for(c=32107;32130>=c;c++)a[c]=0;for(c=32133;32158>=c;c++)a[c]=0;for(c=32164;32167>=c;c++)a[c]=2;for(c=32180;32199>=c;c++)a[c]=0;for(c=32201;32260>=c;c++)a[c]=0;for(c=32301;32360>=c;c++)a[c]=0;for(c=32601;32662>=c;c++)a[c]=0;for(c=32664;32667>=c;c++)a[c]=2;for(c=32701;32761>=c;c++)a[c]=0;for(c=53001;53004>=
c;c++)a[c]=0;for(c=53008;53019>=c;c++)a[c]=0;for(c=53021;53032>=c;c++)a[c]=0;for(c=53034;53037>=c;c++)a[c]=0;for(c=53042;53046>=c;c++)a[c]=0;for(c=53074;53080>=c;c++)a[c]=0;for(c=54001;54004>=c;c++)a[c]=0;for(c=54008;54019>=c;c++)a[c]=0;for(c=54021;54032>=c;c++)a[c]=0;for(c=54034;54037>=c;c++)a[c]=0;for(c=54042;54046>=c;c++)a[c]=0;for(c=54048;54053>=c;c++)a[c]=0;for(c=54074;54080>=c;c++)a[c]=0;for(c=54098;54101>=c;c++)a[c]=0;for(c=102001;102040>=c;c++)a[c]=0;for(c=102042;102063>=c;c++)a[c]=0;for(c=
102065;102067>=c;c++)a[c]=0;for(c=102070;102117>=c;c++)a[c]=0;for(c=102122;102216>=c;c++)a[c]=0;for(c=102221;102377>=c;c++)a[c]=0;for(c=102382;102388>=c;c++)a[c]=0;for(c=102389;102398>=c;c++)a[c]=2;for(c=102399;102444>=c;c++)a[c]=0;for(c=102445;102447>=c;c++)a[c]=2;for(c=102448;102458>=c;c++)a[c]=0;for(c=102459;102468>=c;c++)a[c]=2;for(c=102469;102499>=c;c++)a[c]=0;for(c=102500;102519>=c;c++)a[c]=1;for(c=102520;102524>=c;c++)a[c]=0;for(c=102525;102529>=c;c++)a[c]=2;for(c=102530;102588>=c;c++)a[c]=
0;for(c=102590;102598>=c;c++)a[c]=0;for(c=102601;102603>=c;c++)a[c]=0;for(c=102605;102628>=c;c++)a[c]=0;for(c=102629;102646>=c;c++)a[c]=2;for(c=102648;102700>=c;c++)a[c]=2;for(c=102701;102703>=c;c++)a[c]=0;for(c=102707;102730>=c;c++)a[c]=2;for(c=102733;102758>=c;c++)a[c]=2;for(c=102767;102900>=c;c++)a[c]=0;for(c=102965;102969>=c;c++)a[c]=0;for(c=102971;102973>=c;c++)a[c]=0;for(c=102975;102989>=c;c++)a[c]=0;for(c=102990;102992>=c;c++)a[c]=1;for(c=102997;103002>=c;c++)a[c]=0;for(c=103003;103008>=c;c++)a[c]=
2;for(c=103009;103011>=c;c++)a[c]=0;for(c=103012;103014>=c;c++)a[c]=2;for(c=103019;103021>=c;c++)a[c]=0;for(c=103022;103024>=c;c++)a[c]=2;for(c=103029;103031>=c;c++)a[c]=0;for(c=103032;103034>=c;c++)a[c]=2;for(c=103065;103068>=c;c++)a[c]=0;for(c=103074;103076>=c;c++)a[c]=0;for(c=103077;103079>=c;c++)a[c]=1;for(c=103080;103082>=c;c++)a[c]=0;for(c=103083;103085>=c;c++)a[c]=2;for(c=103090;103093>=c;c++)a[c]=0;for(c=103097;103099>=c;c++)a[c]=0;for(c=103100;103102>=c;c++)a[c]=2;for(c=103107;103109>=c;c++)a[c]=
0;for(c=103110;103112>=c;c++)a[c]=2;for(c=103113;103116>=c;c++)a[c]=0;for(c=103117;103120>=c;c++)a[c]=2;for(c=103153;103157>=c;c++)a[c]=0;for(c=103158;103162>=c;c++)a[c]=2;for(c=103163;103165>=c;c++)a[c]=0;for(c=103166;103168>=c;c++)a[c]=1;for(c=103169;103171>=c;c++)a[c]=2;for(c=103186;103188>=c;c++)a[c]=0;for(c=103189;103191>=c;c++)a[c]=2;for(c=103192;103195>=c;c++)a[c]=0;for(c=103196;103199>=c;c++)a[c]=2;for(c=103200;103224>=c;c++)a[c]=0;for(c=103225;103227>=c;c++)a[c]=1;for(c=103232;103237>=c;c++)a[c]=
0;for(c=103238;103243>=c;c++)a[c]=2;for(c=103244;103246>=c;c++)a[c]=0;for(c=103247;103249>=c;c++)a[c]=2;for(c=103254;103256>=c;c++)a[c]=0;for(c=103257;103259>=c;c++)a[c]=2;for(c=103264;103266>=c;c++)a[c]=0;for(c=103267;103269>=c;c++)a[c]=2;for(c=103300;103375>=c;c++)a[c]=0;for(c=103381;103383>=c;c++)a[c]=0;for(c=103384;103386>=c;c++)a[c]=1;for(c=103387;103389>=c;c++)a[c]=0;for(c=103390;103392>=c;c++)a[c]=2;for(c=103397;103399>=c;c++)a[c]=0;for(c=103400;103471>=c;c++)a[c]=2;for(c=103476;103478>=c;c++)a[c]=
0;for(c=103479;103481>=c;c++)a[c]=2;for(c=103486;103488>=c;c++)a[c]=0;for(c=103489;103491>=c;c++)a[c]=2;for(c=103492;103495>=c;c++)a[c]=0;for(c=103496;103499>=c;c++)a[c]=2;for(c=103528;103543>=c;c++)a[c]=0;for(c=103544;103548>=c;c++)a[c]=2;for(c=103549;103551>=c;c++)a[c]=0;for(c=103552;103554>=c;c++)a[c]=1;for(c=103555;103557>=c;c++)a[c]=2;for(c=103558;103560>=c;c++)a[c]=0;for(c=103571;103573>=c;c++)a[c]=0;for(c=103574;103576>=c;c++)a[c]=2;for(c=103577;103580>=c;c++)a[c]=0;for(c=103581;103583>=c;c++)a[c]=
2;for(c=103595;103597>=c;c++)a[c]=0;for(c=103600;103694>=c;c++)a[c]=0;for(c=103696;103698>=c;c++)a[c]=0;for(c=103700;103793>=c;c++)a[c]=2;for(c=103794;103871>=c;c++)a[c]=0;for(c=103900;103971>=c;c++)a[c]=2;return a})},"esri/geometry/Point":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Logger ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Geometry ./SpatialReference ./support/offset ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){function r(b){return b&&("esri.geometry.SpatialReference"===b.declaredClass||null!=b.wkid)}var n=[0,0],u=k.getLogger("esri.geometry.Point");c=function(a){function e(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.x=0;b.y=0;b.z=void 0;b.m=void 0;b.type="point";return b}l(e,a);c=e;e.copy=function(b,a){a._set("x",b._get("x"));a._set("y",b._get("y"));a._set("z",b._get("z"));a._set("m",b._get("m"));b=b._get("spatialReference");a._set("spatialReference",
Object.isFrozen(b)?b:b.clone())};e.distance=function(b,a){var d=b.x-a.x,m=b.y-a.y;b=b.hasZ&&a.hasZ?b.z-a.z:0;return Math.sqrt(d*d+m*m+b*b)};e.prototype.normalizeCtorArgs=function(b,a,d,e,h){var f;if(Array.isArray(b))f=b,h=a,b=f[0],a=f[1],d=f[2],e=f[3];else if(b&&"object"===typeof b){if(f=b,b=null!=f.x?f.x:f.longitude,a=null!=f.y?f.y:f.latitude,d=null!=f.z?f.z:f.altitude,e=f.m,(h=f.spatialReference)&&"esri.geometry.SpatialReference"!==h.declaredClass&&(h=new p(h)),null!=f.longitude||null!=f.latitude)null==
f.longitude?u.warn(".longitude\x3d","Latitude was defined without longitude"):null==f.latitude?u.warn(".latitude\x3d","Longitude was defined without latitude"):!f.declaredClass&&h&&h.isWebMercator&&(a=m.lngLatToXY(f.longitude,f.latitude,n),b=a[0],a=a[1])}else r(d)?(h=d,d=null):r(e)&&(h=e,e=null);b={x:b,y:a};null==b.x&&null!=b.y?u.warn(".y\x3d","Y coordinate was defined without an X coordinate"):null==b.y&&null!=b.x&&u.warn(".x\x3d","X coordinate was defined without a Y coordinate");null!=h&&(b.spatialReference=
h);null!=d&&(b.z=d);null!=e&&(b.m=e);return b};Object.defineProperty(e.prototype,"hasM",{get:function(){return void 0!==this.m},set:function(b){b!==this.hasM&&(this._set("m",b?0:void 0),this._set("hasM",b))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hasZ",{get:function(){return void 0!==this.z},set:function(b){b!==this.hasZ&&(this._set("z",b?0:void 0),this._set("hasZ",b))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"latitude",{get:function(){var b=this._get("spatialReference");
if(b){if(b.isWebMercator)return m.xyToLngLat(this.x,this.y,n)[1];if(b.isGeographic)return this._get("y")}return null},set:function(b){var a=this._get("spatialReference");a&&(a.isWebMercator?this._set("y",m.lngLatToXY(this.x,b,n)[1]):a.isGeographic&&this._set("y",b),this._set("latitude",b))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"longitude",{get:function(){var b=this._get("spatialReference");if(b){if(b.isWebMercator)return m.xyToLngLat(this._get("x"),this._get("y"),n)[0];
if(b.isGeographic)return this._get("x")}return null},set:function(b){var a=this._get("spatialReference");a&&(a.isWebMercator?this._set("x",m.lngLatToXY(b,this._get("y"),n)[0]):a.isGeographic&&this._set("x",b),this._set("longitude",b))},enumerable:!0,configurable:!0});e.prototype.writeX=function(b,a,d){a[d]=isNaN(b)?"NaN":b};e.prototype.readX=function(b){return"string"===typeof b?NaN:b};e.prototype.clone=function(){var b=new c;b.x=this.x;b.y=this.y;b.z=this.z;b.m=this.m;b.spatialReference=this.spatialReference;
return b};e.prototype.copy=function(b){c.copy(b,this);return this};e.prototype.equals=function(b){var a;if(!b)return!1;var d=this.x,e=this.y,n=this.z,f=this.m,h=this.spatialReference,r=b.z,p=b.m,c=b.x;a=b.y;b=b.spatialReference;if(!h.equals(b))if(h.isWebMercator&&b.isWGS84)a=m.lngLatToXY(c,a),c=a[0],a=a[1],b=h;else if(h.isWGS84&&b.isWebMercator)a=m.xyToLngLat(c,a),c=a[0],a=a[1],b=h;else return!1;return d===c&&e===a&&n===r&&f===p&&h.wkid===b.wkid};e.prototype.offset=function(a,d,m){return b.offsetPoint(this,
a,d,m)};e.prototype.normalize=function(){if(!this.spatialReference)return this;var b=d.getInfo(this.spatialReference);if(!b)return this;var a=this.x,m=b.valid,b=m[0],e=m[1],m=2*e;a>e?(b=Math.ceil(Math.abs(a-e)/m),a-=b*m):a<b&&(b=Math.ceil(Math.abs(a-b)/m),a+=b*m);this._set("x",a);return this};e.prototype.distance=function(b){return c.distance(this,b)};e.prototype.toArray=function(){var b=this.hasZ,a=this.hasM;return b&&a?[this.x,this.y,this.z,this.m]:b?[this.x,this.y,this.z]:a?[this.x,this.y,this.m]:
[this.x,this.y]};e.prototype.toJSON=function(b){return this.write(null,b)};var c;g([h.property({dependsOn:["x","y","z","m","spatialReference"]})],e.prototype,"cache",void 0);g([h.property({type:Boolean,dependsOn:["m"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],e.prototype,"hasM",null);g([h.property({type:Boolean,dependsOn:["z"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],e.prototype,"hasZ",null);g([h.property({type:Number,dependsOn:["y"]})],e.prototype,"latitude",null);
g([h.property({type:Number,dependsOn:["x"]})],e.prototype,"longitude",null);g([h.property({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),h.cast(function(b){return isNaN(b)?b:f.ensureNumber(b)})],e.prototype,"x",void 0);g([h.writer("x")],e.prototype,"writeX",null);g([h.reader("x")],e.prototype,"readX",null);g([h.property({type:Number,json:{write:!0}})],e.prototype,"y",void 0);g([h.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],
e.prototype,"z",void 0);g([h.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],e.prototype,"m",void 0);return e=c=g([h.subclass("esri.geometry.Point")],e)}(h.declared(e));c.prototype.toJSON.isDefaultToJSON=!0;return c})},"esri/geometry/support/offset":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.offsetPoint=function(a,c,k,h){a.x+=c;a.y+=k;null!=h&&null!=a.z&&(a.z+=h);return a};a.offsetCoordsX=function(a,
c){a[0]+=c;return a}})},"esri/geometry/support/webMercatorUtils":function(){define("require exports ../../core/lang ../../core/wgs84Constants ../SpatialReference ./spatialReferenceUtils".split(" "),function(c,a,l,g,k,h){function f(b,a,d,m,e){var n;if("x"in b&&"x"in e)a=a(b.x,b.y,r,m),e.x=a[0],e.y=a[1];else if("xmin"in b&&"xmin"in e)n=a(b.xmin,b.ymin,r,m),e.xmin=n[0],e.ymin=n[1],a=a(b.xmax,b.ymax,r,m),e.xmax=a[0],e.ymax=a[1];else if("paths"in b&&"paths"in e||"rings"in b&&"rings"in e){n="paths"in b?
b.paths:b.rings;var f=[],h=void 0;for(b=0;b<n.length;b++){var p=n[b],h=[];f.push(h);for(var c=0;c<p.length;c++)h.push(a(p[c][0],p[c][1],[0,0],m)),2<p[c].length&&h[c].push(p[c][2]),3<p[c].length&&h[c].push(p[c][3])}"paths"in e?e.paths=f:e.rings=f}else if("points"in b&&"points"in e){n=b.points;f=[];for(b=0;b<n.length;b++)f[b]=a(n[b][0],n[b][1],[0,0],m),2<n[b].length&&f[b].push(n[b][2]),3<n[b].length&&f[b].push(n[b][3]);e.points=f}else if("type"in b&&"mesh"===b.type&&"type"in e&&"mesh"===e.type&&(n=
b.vertexAttributes&&b.vertexAttributes.position,f=e.vertexAttributes&&e.vertexAttributes.position,n))for(h=[0,0],b=0;b<n.length;b+=3)a(n[b],n[b+1],h,m),f[b]=h[0],f[b+1]=h[1];e.spatialReference=d;return e}function e(b,a){b=b&&(null!=b.wkid||null!=b.wkt?b:b.spatialReference);a=a&&(null!=a.wkid||null!=a.wkt?a:a.spatialReference);return b&&a?h.equals(a,b)?!0:h.isWebMercator(a)&&h.isWGS84(b)||h.isWebMercator(b)&&h.isWGS84(a):!1}function p(b,a,e){void 0===e&&(e=[0,0]);89.99999<a?a=89.99999:-89.99999>a&&
(a=-89.99999);a*=.017453292519943;e[0]=.017453292519943*b*d;e[1]=m*Math.log((1+Math.sin(a))/(1-Math.sin(a)));return e}function b(b,a,e,m){void 0===e&&(e=[0,0]);void 0===m&&(m=!1);b=b/d*57.29577951308232;e[0]=m?b:b-360*Math.floor((b+180)/360);e[1]=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*a/d)));return e}Object.defineProperty(a,"__esModule",{value:!0});var d=g.wgs84Radius,m=d/2,r=[0,0];a.canProject=e;a.project=function(a,d){var m=a&&a.spatialReference;d=d&&(null!=d.wkid||null!=d.wkt?d:d.spatialReference);
return e(m,d)?h.equals(m,d)?l.clone(a):h.isWebMercator(d)?f(a,p,k.WebMercator,!1,l.clone(a)):h.isWGS84(d)?f(a,b,k.WGS84,!1,l.clone(a)):null:null};a.lngLatToXY=p;a.xyToLngLat=b;a.geographicToWebMercator=function(b,a,d){void 0===a&&(a=!1);void 0===d&&(d=l.clone(b));return f(b,p,k.WebMercator,a,d)};a.webMercatorToGeographic=function(a,d,e){void 0===d&&(d=!1);void 0===e&&(e=l.clone(a));return f(a,b,k.WGS84,d,e)}})},"esri/core/wgs84Constants":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,
"__esModule",{value:!0});a.wgs84Radius=6378137;a.wgs84InverseFlattening=298.257223563;a.wgs84Flattening=1/a.wgs84InverseFlattening;a.wgs84PolarRadius=a.wgs84Radius*(1-a.wgs84Flattening);a.wgs84Eccentricity=.0818191908426215})},"esri/geometry/support/contains":function(){define(["require","exports"],function(c,a){function l(a,f){return g(a,f[0],f[1])}function g(a,f,b,d){return f>=a.xmin&&f<=a.xmax&&b>=a.ymin&&b<=a.ymax?null!=d&&a.hasZ?d>=a.zmin&&d<=a.zmax:!0:!1}function k(a,f){if(a=a.rings)if(Array.isArray(a[0][0])){for(var b=
!1,d=0,m=a.length;d<m;d++)b=h(b,a[d],f);f=b}else f=h(!1,a,f);else f=!1;return f}function h(a,f,b){var d=b[0];b=b[1];for(var m=0,e=0,n=f.length;e<n;e++){m++;m===n&&(m=0);var h=f[e],p=h[0],h=h[1],c=f[m],g=c[0],c=c[1];(h<b&&c>=b||c<b&&h>=b)&&p+(b-h)/(c-h)*(g-p)<d&&(a=!a)}return a}Object.defineProperty(a,"__esModule",{value:!0});var f=[0,0];a.extentContainsPoint=function(a,f){return g(a,f.x,f.y,f.z)};a.extentContainsMultipoint=function(a,f){if(!f.points||f.points.length)return!1;var b=0;for(f=f.points;b<
f.length;b++)if(!l(a,f[b]))return!1;return!0};a.extentContainsExtent=function(a,f){var b=f.xmin,d=f.ymin,m=f.zmin,e=f.xmax,n=f.ymax,h=f.zmax;return a.hasZ&&f.hasZ?g(a,b,d,m)&&g(a,b,n,m)&&g(a,e,n,m)&&g(a,e,d,m)&&g(a,b,d,h)&&g(a,b,n,h)&&g(a,e,n,h)&&g(a,e,d,h):g(a,b,d)&&g(a,b,n)&&g(a,e,n)&&g(a,e,d)};a.extentContainsCoords2D=l;a.extentContainsCoords3D=function(a,f){return g(a,f[0],f[1],f[2])};a.polygonContainsPoint=function(a,h){f[1]=h.y;f[0]=h.x;return k(a,f)};a.polygonContainsCoords=k})},"esri/geometry/support/intersects":function(){define(["require",
"exports","./contains"],function(c,a,l){function g(b,a){return l.extentContainsPoint(b,a)}function k(b,a){var d=b.hasZ&&a.hasZ,m;if(b.xmin<=a.xmin){if(m=a.xmin,b.xmax<m)return!1}else if(m=b.xmin,a.xmax<m)return!1;if(b.ymin<=a.ymin){if(m=a.ymin,b.ymax<m)return!1}else if(m=b.ymin,a.ymax<m)return!1;if(d&&a.hasZ)if(b.zmin<=a.zmin){if(d=a.zmin,b.zmax<d)return!1}else if(d=b.zmin,a.zmax<d)return!1;return!0}function h(b,a){var d=a.hasZ?l.extentContainsCoords3D:l.extentContainsCoords2D,m=0;for(a=a.points;m<
a.length;m++)if(d(b,a[m]))return!0;return!1}function f(b,a){d[0]=b.xmin;d[1]=b.ymax;m[0]=b.xmax;m[1]=b.ymax;r[0]=b.xmin;r[1]=b.ymin;n[0]=b.xmax;n[1]=b.ymin;for(var e=0,f=u;e<f.length;e++)if(l.polygonContainsCoords(a,f[e]))return!0;e=0;for(a=a.rings;e<a.length;e++)if(f=a[e],f.length){var h=f[0];if(l.extentContainsCoords2D(b,h))return!0;for(var c=1;c<f.length;c++){var g=f[c];if(l.extentContainsCoords2D(b,g)||p(h,g,y))return!0;h=g}}return!1}function e(b,a){d[0]=b.xmin;d[1]=b.ymax;m[0]=b.xmax;m[1]=b.ymax;
r[0]=b.xmin;r[1]=b.ymin;n[0]=b.xmax;n[1]=b.ymin;a=a.paths;for(var e=0;e<a.length;e++){var f=a[e];if(a.length){var h=f[0];if(l.extentContainsCoords2D(b,h))return!0;for(var c=1;c<f.length;c++){var g=f[c];if(l.extentContainsCoords2D(b,g)||p(h,g,y))return!0;h=g}}}return!1}function p(a,d,m){for(var e=0;e<m.length;e++)if(b(a,d,m[e][0],m[e][1]))return!0;return!1}function b(b,a,d,m,e){var n=b[0];b=b[1];var f=a[0];a=a[1];var h=d[0],r=d[1];d=m[0]-h;var h=n-h,p=f-n;m=m[1]-r;var r=b-r,c=a-b,g=m*p-d*c;if(0===
g)return!1;d=(d*r-m*h)/g;h=(p*r-c*h)/g;return 0<=d&&1>=d&&0<=h&&1>=h?(e&&(e[0]=n+d*(f-n),e[1]=b+d*(a-b)),!0):!1}Object.defineProperty(a,"__esModule",{value:!0});a.extentIntersectsPoint=g;a.extentIntersectsExtent=k;a.extentIntersectsMultipoint=h;var d=[0,0],m=[0,0],r=[0,0],n=[0,0],u=[d,m,r,n],y=[[r,d],[d,m],[m,n],[n,r]];a.extentIntersectsPolygon=f;a.extentIntersectsPolyline=e;var w=[0,0];a.isSelfIntersecting=function(a){for(var d=0;d<a.length;d++){for(var m=a[d],e=0;e<m.length-1;e++)for(var n=m[e],
f=m[e+1],h=d+1;h<a.length;h++)for(var r=0;r<a[h].length-1;r++){var p=a[h][r],c=a[h][r+1],g=b(n,f,p,c,w);if(g&&!(w[0]===n[0]&&w[1]===n[1]||w[0]===p[0]&&w[1]===p[1]||w[0]===f[0]&&w[1]===f[1]||w[0]===c[0]&&w[1]===c[1]))return!0}r=m.length;if(!(4>=r))for(e=0;e<r-3;e++){var u=r-1;0===e&&(u=r-2);n=m[e];f=m[e+1];for(h=e+2;h<u;h++)if(p=m[h],c=m[h+1],(g=b(n,f,p,c,w))&&!(w[0]===n[0]&&w[1]===n[1]||w[0]===p[0]&&w[1]===p[1]||w[0]===f[0]&&w[1]===f[1]||w[0]===c[0]&&w[1]===c[1]))return!0}}return!1};a.segmentIntersects=
b;a.getExtentIntersector=function(b){switch(b){case "esriGeometryEnvelope":case "extent":return k;case "esriGeometryMultipoint":case "multipoint":return h;case "esriGeometryPoint":case "point":return g;case "esriGeometryPolygon":case "polygon":return f;case "esriGeometryPolyline":case "polyline":return e;case "mesh":return k}}})},"esri/geometry/Multipoint":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./support/zmUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b){function d(b){return function(a,d){return null==a?d:null==d?a:b(a,d)}}c=function(a){function m(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.points=[];b.type="multipoint";return b}l(m,a);e=m;m.prototype.normalizeCtorArgs=function(b,a){if(!b&&!a)return null;var d={};Array.isArray(b)?(d.points=b,d.spatialReference=a):!b||"esri.geometry.SpatialReference"!==b.declaredClass&&null==b.wkid?(b.points&&(d.points=b.points),b.spatialReference&&
(d.spatialReference=b.spatialReference),b.hasZ&&(d.hasZ=b.hasZ),b.hasM&&(d.hasM=b.hasM)):d.spatialReference=b;if(b=d.points&&d.points[0])void 0===d.hasZ&&void 0===d.hasM?(d.hasZ=2<b.length,d.hasM=!1):void 0===d.hasZ?d.hasZ=3<b.length:void 0===d.hasM&&(d.hasM=3<b.length);return d};Object.defineProperty(m.prototype,"extent",{get:function(){var b=this.points;if(!b.length)return null;for(var a=new f,m=this.hasZ,e=this.hasM,n=m?3:2,h=b[0],r=d(Math.min),p=d(Math.max),c=h[0],g=h[1],k=h[0],h=h[1],l,H,J,K,
G=0,I=b.length;G<I;G++){var L=b[G],R=L[0],M=L[1],c=r(c,R),g=r(g,M),k=p(k,R),h=p(h,M);m&&2<L.length&&(R=L[2],l=r(l,R),J=p(J,R));e&&L.length>n&&(L=L[n],H=r(H,L),K=p(K,L))}a.xmin=c;a.ymin=g;a.xmax=k;a.ymax=h;a.spatialReference=this.spatialReference;m?(a.zmin=l,a.zmax=J):(a.zmin=null,a.zmax=null);e?(a.mmin=H,a.mmax=K):(a.mmin=null,a.mmax=null);return a},enumerable:!0,configurable:!0});m.prototype.writePoints=function(b,a){a.points=k.clone(this.points)};m.prototype.addPoint=function(a){this.clearCache();
b.updateSupportFromPoint(this,a);Array.isArray(a)?this.points.push(a):this.points.push(a.toArray());return this};m.prototype.clone=function(){var b={points:k.clone(this.points),spatialReference:this.spatialReference};this.hasZ&&(b.hasZ=!0);this.hasM&&(b.hasM=!0);return new e(b)};m.prototype.getPoint=function(b){if(!this._validateInputs(b))return null;b=this.points[b];var a={x:b[0],y:b[1],spatialReference:this.spatialReference},d=2;this.hasZ&&(a.z=b[2],d=3);this.hasM&&(a.m=b[d]);return new p(a)};m.prototype.removePoint=
function(b){if(!this._validateInputs(b))return null;this.clearCache();return new p(this.points.splice(b,1)[0],this.spatialReference)};m.prototype.setPoint=function(a,d){if(!this._validateInputs(a))return this;this.clearCache();b.updateSupportFromPoint(d);this.points[a]=d.toArray();return this};m.prototype.toJSON=function(b){return this.write(null,b)};m.prototype._validateInputs=function(b){return null!=b&&0<=b&&b<this.points.length};var e;g([h.property({dependsOn:["points","hasZ","hasM","spatialReference"]})],
m.prototype,"cache",void 0);g([h.property({dependsOn:["cache"]})],m.prototype,"extent",null);g([h.property({type:[[Number]],json:{write:{isRequired:!0}}})],m.prototype,"points",void 0);g([h.writer("points")],m.prototype,"writePoints",null);return m=e=g([h.subclass("esri.geometry.Multipoint")],m)}(h.declared(e));c.prototype.toJSON.isDefaultToJSON=!0;return c})},"esri/geometry/support/zmUtils":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.updateSupportFromPoint=
function(a,c,k){void 0===k&&(k=!1);var h=a.hasM,f=a.hasZ;Array.isArray(c)?4!==c.length||h||f?3===c.length&&k&&!h?(f=!0,h=!1):3===c.length&&h&&f&&(f=h=!1):f=h=!0:(f=!f&&c.hasZ&&(!h||c.hasM),h=!h&&c.hasM&&(!f||c.hasZ));a.hasZ=f;a.hasM=h}})},"esri/geometry/Polygon":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/centroid ./support/contains ./support/coordsUtils ./support/extentUtils ./support/intersects ./support/webMercatorUtils ./support/zmUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){c=function(a){function e(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.rings=[];b.type="polygon";return b}l(e,a);c=e;e.fromExtent=function(b){var a=b.clone().normalize();b=b.spatialReference;var d=!1,e=!1;a.map(function(b){b.hasZ&&(d=!0);b.hasM&&(e=!0)});a={rings:a.map(function(b){var a=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(d&&b.hasZ)for(var m=b.zmin+.5*(b.zmax-b.zmin),
n=0;n<a.length;n++)a[n].push(m);if(e&&b.hasM)for(b=b.mmin+.5*(b.mmax-b.mmin),n=0;n<a.length;n++)a[n].push(b);return a}),spatialReference:b};d&&(a.hasZ=!0);e&&(a.hasM=!0);return new c(a)};e.prototype.normalizeCtorArgs=function(a,d){var e=null,m,n,f=null;a&&!Array.isArray(a)?(e=a.rings?a.rings:null,d||(a.spatialReference?d=a.spatialReference:a.rings||(d=a)),m=a.hasZ,n=a.hasM):e=a;e=e||[];d=d||b.WGS84;e.length&&e[0]&&null!=e[0][0]&&"number"===typeof e[0][0]&&(e=[e]);if(f=e[0]&&e[0][0])void 0===m&&void 0===
n?(m=2<f.length,n=!1):void 0===m?m=!n&&3<f.length:void 0===n&&(n=!m&&3<f.length);return{rings:e,spatialReference:d,hasZ:m,hasM:n}};Object.defineProperty(e.prototype,"centroid",{get:function(){var b=d.polygonCentroid(this);if(!b||isNaN(b[0])||isNaN(b[1])||this.hasZ&&isNaN(b[2]))return null;var a=new p;a.x=b[0];a.y=b[1];a.spatialReference=this.spatialReference;this.hasZ&&(a.z=b[2]);return a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"extent",{get:function(){var b=this.spatialReference,
a=n.getPolygonExtent(this);if(!a)return null;a=new f(a);a.spatialReference=b;return a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isSelfIntersecting",{get:function(){return u.isSelfIntersecting(this.rings)},enumerable:!0,configurable:!0});e.prototype.writePaths=function(b,a){a.rings=k.clone(this.rings)};e.prototype.addRing=function(b){if(b){this.clearCache();var a=this.rings,d=a.length;if(Array.isArray(b[0]))a[d]=b.concat();else{for(var e=[],m=0,n=b.length;m<n;m++)e[m]=b[m].toArray();
a[d]=e}return this}};e.prototype.clone=function(){var b=new c;b.spatialReference=this.spatialReference;b.rings=k.clone(this.rings);b.hasZ=this.hasZ;b.hasM=this.hasM;return b};e.prototype.contains=function(b){if(!b)return!1;y.canProject(b,this.spatialReference)&&(b=y.project(b,this.spatialReference));return m.polygonContainsPoint(this,b)};e.prototype.isClockwise=function(b){var a=this;b=Array.isArray(b[0])?b:b.map(function(b){return a.hasZ?a.hasM?[b.x,b.y,b.z,b.m]:[b.x,b.y,b.z]:[b.x,b.y]});return r.isClockwise(b,
this.hasM,this.hasZ)};e.prototype.getPoint=function(b,a){if(!this._validateInputs(b,a))return null;b=this.rings[b][a];a=this.hasZ;var d=this.hasM;return a&&!d?new p(b[0],b[1],b[2],void 0,this.spatialReference):d&&!a?new p(b[0],b[1],void 0,b[2],this.spatialReference):a&&d?new p(b[0],b[1],b[2],b[3],this.spatialReference):new p(b[0],b[1],this.spatialReference)};e.prototype.insertPoint=function(b,a,d){if(!this._validateInputs(b,a,!0))return this;this.clearCache();w.updateSupportFromPoint(this,d);Array.isArray(d)||
(d=d.toArray());this.rings[b].splice(a,0,d);return this};e.prototype.removePoint=function(b,a){if(!this._validateInputs(b,a))return null;this.clearCache();return new p(this.rings[b].splice(a,1)[0],this.spatialReference)};e.prototype.removeRing=function(b){if(!this._validateInputs(b,null))return null;this.clearCache();b=this.rings.splice(b,1)[0];var a=this.spatialReference;return b.map(function(b){return new p(b,a)})};e.prototype.setPoint=function(b,a,d){if(!this._validateInputs(b,a))return this;this.clearCache();
w.updateSupportFromPoint(this,d);Array.isArray(d)||(d=d.toArray());this.rings[b][a]=d;return this};e.prototype._validateInputs=function(b,a,d){void 0===d&&(d=!1);return null==b||0>b||b>=this.rings.length||null!=a&&(b=this.rings[b],d&&(0>a||a>b.length)||!d&&(0>a||a>=b.length))?!1:!0};e.prototype.toJSON=function(b){return this.write(null,b)};var c;g([h.property({dependsOn:["hasM","hasZ","rings"]})],e.prototype,"cache",void 0);g([h.property({readOnly:!0,dependsOn:["cache"]})],e.prototype,"centroid",
null);g([h.property({dependsOn:["cache"],readOnly:!0})],e.prototype,"extent",null);g([h.property({dependsOn:["cache"],readOnly:!0})],e.prototype,"isSelfIntersecting",null);g([h.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],e.prototype,"rings",void 0);g([h.writer("rings")],e.prototype,"writePaths",null);return e=c=g([h.subclass("esri.geometry.Polygon")],e)}(h.declared(e));c.prototype.toJSON.isDefaultToJSON=!0;return c})},"esri/geometry/support/centroid":function(){define(["require","exports",
"./coordsUtils"],function(c,a,l){function g(a,e){if(!a||!a.length)return null;for(var f=[],b=[],d=e?[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity]:[Infinity,-Infinity,Infinity,-Infinity],m=0,r=a.length;m<r;m++){var n=k(a[m],e,d);n&&b.push(n)}b.sort(function(b,a){var d=b[2]-a[2];0===d&&e&&(d=b[4]-a[4]);return d});b.length&&(m=6*b[0][2],f[0]=b[0][0]/m,f[1]=b[0][1]/m,e&&(m=6*b[0][4],f[2]=0!==m?b[0][3]/m:0),f[0]<d[0]||f[0]>d[1]||f[1]<d[2]||f[1]>d[3]||e&&(f[2]<d[4]||f[2]>d[5]))&&(f.length=
0);if(!f.length)if(a=a[0]&&a[0].length?h(a[0],e):null)f[0]=a[0],f[1]=a[1],e&&2<a.length&&(f[2]=a[2]);else return null;return f}function k(a,e,h){for(var b=0,d=0,m=0,f=0,n=0,p=0;p<a.length;p++){var c=a[p],g=c[0],t=c[1],k=c[2],l=a[(p+1)%a.length],A=l[0],C=l[1],D=l[2],B=g*C-A*t,f=f+B,b=b+(g+A)*B,d=d+(t+C)*B;e&&2<c.length&&2<l.length&&(B=g*D-A*k,m+=(k+D)*B,n+=B);g<h[0]&&(h[0]=g);g>h[1]&&(h[1]=g);t<h[2]&&(h[2]=t);t>h[3]&&(h[3]=t);e&&(k<h[4]&&(h[4]=k),k>h[5]&&(h[5]=k))}0<f&&(f*=-1);0<n&&(n*=-1);if(!f)return null;
a=[b,d,.5*f];e&&(a[3]=m,a[4]=.5*n);return a}function h(a,e){for(var f=e?[0,0,0]:[0,0],b=e?[0,0,0]:[0,0],d=0,m=0,h=0,n=0,c=0,g=a.length;c<g-1;c++){var w=a[c],t=a[c+1];if(w&&t){f[0]=w[0];f[1]=w[1];b[0]=t[0];b[1]=t[1];e&&2<w.length&&2<t.length&&(f[2]=w[2],b[2]=t[2]);var k=l.getLength(f,b);k&&(d+=k,w=l.getMidpoint(w,t),m+=k*w[0],h+=k*w[1],e&&2<w.length&&(n+=k*w[2]))}}return 0<d?e?[m/d,h/d,n/d]:[m/d,h/d]:a.length?a[0]:null}Object.defineProperty(a,"__esModule",{value:!0});a.extentCentroid=function(a){return a?
a.hasZ?[a.xmax-a.xmin/2,a.ymax-a.ymin/2,a.zmax-a.zmin/2]:[a.xmax-a.xmin/2,a.ymax-a.ymin/2]:null};a.polygonCentroid=function(a){return a?g(a.rings,a.hasZ):null};a.ringsCentroid=g;a.lineCentroid=h})},"esri/geometry/support/coordsUtils":function(){define(["require","exports","./spatialReferenceUtils"],function(c,a,l){function g(a,h){var b=h[0]-a[0],d=h[1]-a[1];return 2<a.length&&2<h.length?(a=a[2]-h[2],Math.sqrt(b*b+d*d+a*a)):Math.sqrt(b*b+d*d)}function k(a,h,b){var d=a[0]+b*(h[0]-a[0]),m=a[1]+b*(h[1]-
a[1]);return 2<a.length&&2<h.length?[d,m,a[2]+b*(h[2]-a[2])]:[d,m]}function h(a,h,b){for(var d=a.length,m=0,e=0,n=0,f=0;f<d;f++){var c=a[f],p=a[(f+1)%d],g=2,m=m+(c[0]*p[1]-p[0]*c[1]);2<c.length&&2<p.length&&b&&(e+=c[0]*p[2]-p[0]*c[2],g=3);c.length>g&&p.length>g&&h&&(n+=c[0]*p[g]-p[0]*c[g])}return 0>=m&&0>=e&&0>=n}function f(a,h){if(h=l.getInfo(h)){var b=h.valid[0],d=h.valid[1],m=d-b;h=function(a){var e=Infinity,n=-Infinity;a.forEach(function(a){for(var h=a[0];h<b;)h+=m;for(;h>d;)h-=m;e=Math.min(e,
h);n=Math.max(n,h);a[0]=h});var h=n-e;m-h<h&&a.forEach(function(b){0>b[0]&&(b[0]+=m)})};for(var e=0;e<a.length;e++)h(a[e])}}Object.defineProperty(a,"__esModule",{value:!0});a.geometryToCoordinates=function(a){if(!a)return null;if(Array.isArray(a))return a;var e=a.hasZ,b=a.hasM;if("point"===a.type)return b&&e?[a.x,a.y,a.z,a.m]:e?[a.x,a.y,a.z]:b?[a.x,a.y,a.m]:[a.x,a.y];if("polygon"===a.type)return a.rings.slice(0);if("polyline"===a.type)return a.paths.slice(0);if("multipoint"===a.type)return a.points.slice(0);
if("extent"===a.type){a=a.clone().normalize();if(!a)return null;var d=!1,m=!1;a.forEach(function(b){b.hasZ&&(d=!0);b.hasM&&(m=!0)});return a.map(function(b){var a=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(d&&b.hasZ)for(var e=.5*(b.zmax-b.zmin),h=0;h<a.length;h++)a[h].push(e);if(m&&b.hasM)for(b=.5*(b.mmax-b.mmin),h=0;h<a.length;h++)a[h].push(b);return a})}return null};a.getLength=g;a.getMidpoint=function(a,h){return k(a,h,.5)};a.getPathLength=function(a){for(var e=
a.length,b=0,d=0;d<e-1;++d)b+=g(a[d],a[d+1]);return b};a.getPointOnPath=function(a,h){if(0>=h)return a[0];for(var b=a.length,d=0,m=0;m<b-1;++m){var e=g(a[m],a[m+1]);if(h-d<e)return k(a[m],a[m+1],(h-d)/e);d+=e}return a[b-1]};a.isClockwise=h;a.closeRingsAndFixWinding=function(a){if("rings"in a){for(var e=0,b=a.rings;e<b.length;e++){var d=b[e];3>d.length||d[0][0]===d[d.length-1][0]&&d[0][1]===d[d.length-1][1]||d.push([d[0][0],d[0][1]])}if(0<a.rings.length&&!h(a.rings[0],a.hasM,a.hasZ))for(e=0;e<a.rings.length;++e)a.rings[e]=
a.rings[e].reverse()}};a.closeRings=function(a){if("rings"in a){var e=0;for(a=a.rings;e<a.length;e++){var b=a[e];3>b.length||b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]||b.push([b[0][0],b[0][1]])}}};a.getRingArea=function(a){for(var e=a.length,b=0,d=0;d<e;d++)var m=a[d],h=a[(d+1)%e],b=b+(m[0]*h[1]-h[0]*m[1]);return b};a.unnormalizeGeometryOnDatelineCrossing=function(a){if("polygon"!==a.type&&"polyline"!==a.type)return a;f("polygon"===a.type?a.rings:a.paths,a.spatialReference);return a};
a.unnormalizeVerticesOnDatelineCrossing=f;a.computeUnnormalizedVertexPositionsOnDateLineCrossing=function(a,h,b,d){var m=Infinity,e=-Infinity;a.forEach(function(a){for(var n=a.pos[0];n<h;)n+=d;for(;n>b;)n-=d;m=Math.min(m,n);e=Math.max(e,n);a.unnormalizedPos[0]=n;a.unnormalizedPos[1]=a.pos[1];2<a.pos.length&&(a.unnormalizedPos[2]=a.pos[2]);3<a.pos.length&&(a.unnormalizedPos[3]=a.pos[3])});var n=e-m;d-n<n&&a.forEach(function(b){0>b.unnormalizedPos[0]&&(b.unnormalizedPos[0]+=d)})}})},"esri/geometry/support/extentUtils":function(){define(["require",
"exports","./boundsUtils"],function(c,a,l){function g(b,a,m){void 0===a&&(a=!1);void 0===m&&(m=!1);return a?m?{xmin:b[0],ymin:b[1],zmin:b[2],mmin:b[3],xmax:b[4],ymax:b[5],zmax:b[6],mmax:b[7]}:{xmin:b[0],ymin:b[1],zmin:b[2],xmax:b[3],ymax:b[4],zmax:b[5]}:m?{xmin:b[0],ymin:b[1],mmin:b[2],xmax:b[3],ymax:b[4],mmax:b[5]}:{xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3]}}function k(b){var a=b.hasZ,m=b.hasM;return g(l.getPointsBounds(p,b.points,a,m),a,m)}function h(b){var a=b.x,m=b.y,e=b.z;b=b.m;var n=null!=b;return null!=
e?n?{xmin:a,ymin:m,zmin:e,mmin:b,xmax:a,ymax:m,zmax:e,mmax:b}:{xmin:a,ymin:m,zmin:e,xmax:a,ymax:m,zmax:e}:n?{xmin:a,ymin:m,mmin:b,xmax:a,ymax:m,mmax:b}:{xmin:a,ymin:m,xmax:a,ymax:m}}function f(b){var a=b.hasZ,m=b.hasM;return(b=l.getRingsOrPathsBounds(p,b.rings,a,m))?g(b,a,m):null}function e(b){var a=b.hasZ,m=b.hasM;return(b=l.getRingsOrPathsBounds(p,b.paths,a,m))?g(b,a,m):null}Object.defineProperty(a,"__esModule",{value:!0});var p=[];a.getGeometryExtent=function(b){return b?void 0!==b.xmin&&void 0!==
b.ymin&&void 0!==b.xmax&&void 0!==b.ymax?b:void 0!==b.x&&void 0!==b.y?h(b):void 0!==b.rings?f(b):void 0!==b.paths?e(b):void 0!==b.points?k(b):null:null};a.getMultipointExtent=k;a.getPointExtent=h;a.getPolygonExtent=f;a.getPolylineExtent=e})},"esri/geometry/support/boundsUtils":function(){define(["require","exports"],function(c,a){function l(b){return void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax}function g(b){return function(a,m){return null==a?m:null==m?a:b(a,m)}}function k(b,
a,m,h){var d=m?3:2;if(!a.length||!a[0].length)return null;for(var f=a[0][0],r=f[0],f=f[1],c=a[0][0],g=c[0],c=c[1],k=void 0,l=void 0,A=void 0,C=void 0,D=0;D<a.length;D++)for(var B=a[D],E=0;E<B.length;E++){var F=B[E],H=F[0],J=F[1],r=e(r,H),f=e(f,J),g=p(g,H),c=p(c,J);m&&2<F.length&&(H=F[2],k=e(k,H),l=p(l,H));h&&F.length>d&&(C=F[d],A=e(k,C),C=p(l,C))}if(m){if(h)return b[0]=r,b[1]=f,b[2]=k,b[3]=A,b[4]=g,b[5]=c,b[6]=l,b[7]=C,b.length=8,b;b[0]=r;b[1]=f;b[2]=k;b[3]=g;b[4]=c;b[5]=l;b.length=6;return b}if(h)return b[0]=
r,b[1]=f,b[2]=A,b[3]=g,b[4]=c,b[5]=C,b.length=6,b;b[0]=r;b[1]=f;b[2]=g;b[3]=c;b.length=4;return b}function h(b,a,m,e,n,h){m=a.xmin;e=a.xmax;var d=a.ymin,f=a.ymax,r=a.zmin,c=a.zmax,p=a.mmin;a=a.mmax;if(n){r=r||0;c=c||0;if(h)return b[0]=m,b[1]=d,b[2]=r,b[3]=p||0,b[4]=e,b[5]=f,b[6]=c,b[7]=a||0,b;b[0]=m;b[1]=d;b[2]=r;b[3]=e;b[4]=f;b[5]=c;return b}if(h)return b[0]=m,b[1]=d,b[2]=p||0,b[3]=e,b[4]=f,b[5]=a||0,b;b[0]=m;b[1]=d;b[2]=e;b[3]=f;return b}function f(b,a,m,h,n,f){var d=m?3:2;h=h&&f;m=m&&n;if(!a.length||
!a[0].length)return null;for(var r=a[0],c=r[0],r=r[1],g=a[0],u=g[0],g=g[1],k=void 0,l=void 0,D=void 0,B=void 0,E=0;E<a.length;E++){var F=a[E],H=F[0],J=F[1],c=e(c,H),r=e(r,J),u=p(u,H),g=p(g,J);m&&2<F.length&&(H=F[2],k=e(k,H),l=p(l,H));h&&F.length>d&&(B=F[d],D=e(k,B),B=p(l,B))}if(n){k=k||0;l=l||0;if(f)return b[0]=c,b[1]=r,b[2]=k,b[3]=D||0,b[4]=u,b[5]=g,b[6]=l,b[7]=B||0,b;b[0]=c;b[1]=r;b[2]=k;b[3]=u;b[4]=g;b[5]=l;return b}if(f)return b[0]=c,b[1]=r,b[2]=D||0,b[3]=u,b[4]=g,b[5]=B||0,b;b[0]=c;b[1]=r;b[2]=
u;b[3]=g;return b}Object.defineProperty(a,"__esModule",{value:!0});var e=g(Math.min),p=g(Math.max);a.getBoundsXY=function(b,a){if(void 0!==a.paths)return k(b,a.paths,!1,!1);if(void 0!==a.rings)return k(b,a.rings,!1,!1);if(void 0!==a.points)return f(b,a.points,!1,!1,!1,!1);if(l(a))return h(b,a);void 0!==a.x&&void 0!==a.y&&(b[0]=a.x,b[1]=a.y,b[2]=a.x,b[3]=a.y);return b};a.getBoundsXYZ=function(b,a){if(void 0!==a.paths)return k(b,a.paths,!0,!1);if(void 0!==a.rings)return k(b,a.rings,!0,!1);if(void 0!==
a.points)return f(b,a.points,!0,!1,!0,!1);if(l(a))return h(b,a,!0,!1,!0,!1);void 0!==a.x&&void 0!==a.y&&(b[0]=a.x,b[1]=a.y,b[2]=a.z,b[3]=a.x,b[4]=a.y,b[5]=a.z);return b};a.getRingsOrPathsBounds=k;a.getExtentBounds=h;a.getPointsBounds=f;a.getPointsBoundsWidth=function(b){if(!b.length||!b[0].length)return null;for(var a=b[0][0],m=b[0][0],h=0;h<b.length;h++)var n=b[h][0],a=e(a,n),m=p(m,n);return m-a};a.getPointsBoundsCenterX=function(b){if(!b.length||!b[0].length)return null;for(var a=b[0][0],m=b[0][0],
h=0;h<b.length;h++)var n=b[h][0],a=e(a,n),m=p(m,n);return a+.5*(m-a)}})},"esri/geometry/Polyline":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/extentUtils ./support/zmUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m){c=function(a){function e(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.paths=
[];b.type="polyline";return b}l(e,a);r=e;e.prototype.normalizeCtorArgs=function(a,d){var m=null,e,h,n=null;a&&!Array.isArray(a)?(m=a.paths?a.paths:null,d||(a.spatialReference?d=a.spatialReference:a.paths||(d=a)),e=a.hasZ,h=a.hasM):m=a;m=m||[];d=d||b.WGS84;m.length&&m[0]&&null!=m[0][0]&&"number"===typeof m[0][0]&&(m=[m]);if(n=m[0]&&m[0][0])void 0===e&&void 0===h?(e=2<n.length,h=!1):void 0===e?e=!h&&3<n.length:void 0===h&&(h=!e&&3<n.length);return{paths:m,spatialReference:d,hasZ:e,hasM:h}};Object.defineProperty(e.prototype,
"extent",{get:function(){var b=this.spatialReference,a=d.getPolylineExtent(this);if(!a)return null;a=new f(a);a.spatialReference=b;return a},enumerable:!0,configurable:!0});e.prototype.writePaths=function(b,a){a.paths=k.clone(this.paths)};e.prototype.addPath=function(b){if(b){this.clearCache();var a=this.paths,d=a.length;if(Array.isArray(b[0]))a[d]=b.concat();else{for(var m=[],e=0,h=b.length;e<h;e++)m[e]=b[e].toArray();a[d]=m}return this}};e.prototype.clone=function(){var b=new r;b.spatialReference=
this.spatialReference;b.paths=k.clone(this.paths);b.hasZ=this.hasZ;b.hasM=this.hasM;return b};e.prototype.getPoint=function(b,a){if(!this._validateInputs(b,a))return null;b=this.paths[b][a];a=this.hasZ;var d=this.hasM;return a&&!d?new p(b[0],b[1],b[2],void 0,this.spatialReference):d&&!a?new p(b[0],b[1],void 0,b[2],this.spatialReference):a&&d?new p(b[0],b[1],b[2],b[3],this.spatialReference):new p(b[0],b[1],this.spatialReference)};e.prototype.insertPoint=function(b,a,d){if(!this._validateInputs(b,a,
!0))return this;this.clearCache();m.updateSupportFromPoint(this,d);Array.isArray(d)||(d=d.toArray());this.paths[b].splice(a,0,d);return this};e.prototype.removePath=function(b){if(!this._validateInputs(b,null))return null;this.clearCache();b=this.paths.splice(b,1)[0];var a=this.spatialReference;return b.map(function(b){return new p(b,a)})};e.prototype.removePoint=function(b,a){if(!this._validateInputs(b,a))return null;this.clearCache();return new p(this.paths[b].splice(a,1)[0],this.spatialReference)};
e.prototype.setPoint=function(b,a,d){if(!this._validateInputs(b,a))return this;this.clearCache();m.updateSupportFromPoint(this,d);Array.isArray(d)||(d=d.toArray());this.paths[b][a]=d;return this};e.prototype._validateInputs=function(b,a,d){void 0===d&&(d=!1);return null==b||0>b||b>=this.paths.length||null!=a&&(b=this.paths[b],d&&(0>a||a>b.length)||!d&&(0>a||a>=b.length))?!1:!0};e.prototype.toJSON=function(b){return this.write(null,b)};var r;g([h.property({dependsOn:["hasM","hasZ","paths"]})],e.prototype,
"cache",void 0);g([h.property({dependsOn:["cache"],readOnly:!0})],e.prototype,"extent",null);g([h.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],e.prototype,"paths",void 0);g([h.writer("paths")],e.prototype,"writePaths",null);return e=r=g([h.subclass("esri.geometry.Polyline")],e)}(h.declared(e));c.prototype.toJSON.isDefaultToJSON=!0;return c})},"esri/geometry/support/jsonUtils":function(){define("require exports ../Extent ../Geometry ../Multipoint ../Point ../Polygon ../Polyline".split(" "),
function(c,a,l,g,k,h,f,e){function p(b){return void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax}function b(b){return void 0!==b.points}function d(b){return void 0!==b.x&&void 0!==b.y}function m(b){return void 0!==b.paths}function r(b){return void 0!==b.rings}function n(a){return a?a instanceof g?a:d(a)?h.fromJSON(a):m(a)?e.fromJSON(a):r(a)?f.fromJSON(a):b(a)?k.fromJSON(a):p(a)?l.fromJSON(a):null:null}Object.defineProperty(a,"__esModule",{value:!0});a.fromJson=function(b){try{throw Error("fromJson is deprecated, use fromJSON instead");
}catch(w){console.warn(w.stack)}return n(b)};a.isExtent=p;a.isMultipoint=b;a.isPoint=d;a.isPolyline=m;a.isPolygon=r;a.isMesh=function(b){return void 0!==b.vertexAttributes};a.fromJSON=n;a.getJsonType=function(a){return a?d(a)?"esriGeometryPoint":m(a)?"esriGeometryPolyline":r(a)?"esriGeometryPolygon":p(a)?"esriGeometryEnvelope":b(a)?"esriGeometryMultipoint":null:null};var u={esriGeometryPoint:h,esriGeometryPolyline:e,esriGeometryPolygon:f,esriGeometryEnvelope:l,esriGeometryMultipoint:k};a.getGeometryType=
function(b){return b&&u[b]||null}})},"esri/core/unitUtils":function(){define("require exports ./compilerUtils ./iteratorUtils ./jsonMap ./wgs84Constants ../geometry/support/WKIDUnitConversion".split(" "),function(c,a,l,g,k,h,f){function e(b){if(b=D[b])return b;throw Error("unknown measure");}function p(b){return C[b].baseUnit}function b(b,a){void 0===a&&(a=null);a=a||e(b);return C[a].baseUnit===b}function d(a,d,m){if(d===m)return a;var h=e(d);if(h!==e(m))throw Error("incompatible units");a=b(d,h)?
a:a*C[h].units[d].inBaseUnits;return b(m,h)?a:a/C[h].units[m].inBaseUnits}function m(b){return A.fromJSON(b.toLowerCase())||null}function r(b,a){void 0===a&&(a=y);return n(b,!0)||a}function n(b,a){void 0===a&&(a=!1);var d,m,e;null!=b&&("object"===typeof b?(d=b.wkid,m=b.wkt):"number"===typeof b?d=b:"string"===typeof b&&(m=b));d?(e=v.values[v[d]],!e&&a&&z.has(d)&&(e=w)):m&&-1!==m.search(/^PROJCS/i)&&(b=t.exec(m))&&b[1]&&(e=parseFloat(b[1].split(",")[1]));return e}function u(b){var a,d,e;null!=b&&("object"===
typeof b?(a=b.wkid,d=b.wkt):"number"===typeof b?a=b:"string"===typeof b&&(d=b));a?e=v.units[v[a]]:d&&-1!==d.search(/^PROJCS/i)&&(b=t.exec(d))&&b[1]&&(e=(b=/[\\"\\']{1}([^\\"\\']+)/.exec(b[1]))&&b[1]);return e?m(e):null}Object.defineProperty(a,"__esModule",{value:!0});a.inchesPerMeter=39.37;var y=h.wgs84Radius*Math.PI/180,w=h.wgs84Radius*Math.PI/200,t=/UNIT\[([^\]]+)\]\]$/i,v=f,z=g.createSetFromValues([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),A=k.strict()({meter:"meters",
foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});c={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},
decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};g={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},
"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:function(b){return b*b}(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};var C={length:{baseUnit:"meters",units:c},area:{baseUnit:"square-meters",units:g},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},
"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},D=function(){var b={},a;for(a in C)for(var d in C[a].units)b[d]=a;return b}();a.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");
a.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");a.measureForUnit=e;a.baseUnitForMeasure=p;a.baseUnitForUnit=function(b){return p(e(b))};a.isBaseUnit=b;a.convertUnit=d;a.preferredMetricLengthUnit=function(b,a){return 3E3>d(b,a,"meters")?"meters":"kilometers"};a.preferredMetricVerticalLengthUnit=function(b,a){return 1E5>d(b,a,"meters")?"meters":"kilometers"};a.preferredImperialLengthUnit=function(b,a){return 1E3>d(b,a,"feet")?"feet":
"miles"};a.preferredImperialVerticalLengthUnit=function(b,a){return 1E5>d(b,a,"feet")?"feet":"miles"};a.preferredMetricAreaUnit=function(b,a){return 3E6>d(b,a,"square-meters")?"square-meters":"square-kilometers"};a.preferredImperialAreaUnit=function(b,a){return 1E6>d(b,a,"square-feet")?"square-feet":"square-miles"};a.lengthToDegrees=function(b,a,m){void 0===m&&(m=h.wgs84Radius);return d(b,a,"meters")/(m*Math.PI/180)};a.unitFromRESTJSON=m;a.unitToRESTJSON=function(b){return A.toJSON(b)||null};a.getMetersPerVerticalUnitForSR=
function(b){b=r(b);return 1E5<b?1:b};a.getVerticalUnitStringForSR=function(b){return 1E5<r(b)?"meters":u(b)};a.getMetersPerUnitForSR=r;a.getMetersPerUnit=n;a.getUnitString=u;a.getDefaultUnitSystem=function(b){if(!b)return null;b=u(b);switch(b){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric";case null:case void 0:break;default:l.neverReached(b)}return null}})},"esri/core/iteratorUtils":function(){define(["require","exports","@dojo/framework/shim/array"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.someMap=Map.prototype.entries?function(a,c){a=a.entries();for(var h=a.next();!h.done;h=a.next())if(c(h.value[1],h.value[0]))return!0;return!1}:function(a,c){var h=!0;a.forEach(function(a,e){h&&(h=!c(a,
e))});return!h};c=!!Map.prototype.values;a.pairsOfMap=function(a){var c=[];a.forEach(function(a,f){return c.push([f,a])});return c};a.valuesOfMap=c?function(a){return l.from(a.values())}:function(a){var c=Array(a.size),h=0;a.forEach(function(a){return c[h++]=a});return c};a.keysOfMap=function(a){var c=Array(a.size),h=0;a.forEach(function(a,e){return c[h++]=e});return c};a.MapFromValues=c?function(a){return new Map(a)}:function(a){for(var c=new Map,h=0;h<a.length;h++){var f=a[h];c.set(f[0],f[1])}return c};
a.someSet=Set.prototype.entries?function(a,c){a=a.entries();for(var h=a.next();!h.done;h=a.next())if(c(h.value[0]))return!0;return!1}:function(a,c){var h=!0;a.forEach(function(a){h&&(h=!c(a))});return!h};c=!!Set.prototype.values;a.valuesOfSet=c?function(a){return l.from(a.values())}:function(a){var c=Array(a.size),h=0;a.forEach(function(a){return c[h++]=a});return c};a.createSetFromValues=c?function(a){return new Set(a)}:function(a){for(var c=new Set,h=0;h<a.length;h++)c.add(a[h]);return c}})},"esri/geometry/support/aaBoundingRect":function(){define(["require",
"exports","../../core/compilerUtils","../Extent"],function(c,a,l,g){function k(b){void 0===b&&(b=a.ZERO);return[b[0],b[1],b[2],b[3]]}function h(b){return b[0]>=b[2]?0:b[2]-b[0]}function f(b){return b[1]>=b[3]?0:b[3]-b[1]}function e(b,a,d){return a>=b[0]&&d>=b[1]&&a<=b[2]&&d<=b[3]}function p(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b}function b(b){return 4===b.length}function d(b,a,d){return b<a?a:b>d?d:b}Object.defineProperty(a,"__esModule",{value:!0});a.create=k;a.clone=function(b){return[b[0],
b[1],b[2],b[3]]};a.fromValues=function(b,a,d,e,h){void 0===h&&(h=k());h[0]=b;h[1]=a;h[2]=d;h[3]=e;return h};a.fromExtent=function(b,a){void 0===a&&(a=k());a[0]=b.xmin;a[1]=b.ymin;a[2]=b.xmax;a[3]=b.ymax;return a};a.toExtent=function(b,a){return new g({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:a})};a.expandPointInPlace=function(b,a){a[0]<b[0]&&(b[0]=a[0]);a[0]>b[2]&&(b[2]=a[0]);a[1]<b[1]&&(b[1]=a[1]);a[1]>b[3]&&(b[3]=a[1])};a.expand=function(a,d,e){void 0===e&&(e=a);if("length"in d)if(b(d))e[0]=
Math.min(a[0],d[0]),e[1]=Math.min(a[1],d[1]),e[2]=Math.max(a[2],d[2]),e[3]=Math.max(a[3],d[3]);else{if(2===d.length||3===d.length)e[0]=Math.min(a[0],d[0]),e[1]=Math.min(a[1],d[1]),e[2]=Math.max(a[2],d[0]),e[3]=Math.max(a[3],d[1])}else switch(d.type){case "extent":e[0]=Math.min(a[0],d.xmin);e[1]=Math.min(a[1],d.ymin);e[2]=Math.max(a[2],d.xmax);e[3]=Math.max(a[3],d.ymax);break;case "point":e[0]=Math.min(a[0],d.x);e[1]=Math.min(a[1],d.y);e[2]=Math.max(a[2],d.x);e[3]=Math.max(a[3],d.y);break;default:l.neverReached(d)}return e};
a.expandWithNestedArray=function(b,a,d){void 0===d&&(d=b);var e=a.length,m=b[0],h=b[1],n=b[2];b=b[3];for(var f=0;f<e;f++){var c=a[f],m=Math.min(m,c[0]),h=Math.min(h,c[1]),n=Math.max(n,c[0]);b=Math.max(b,c[1])}d[0]=m;d[1]=h;d[2]=n;d[3]=b;return d};a.allFinite=function(b){for(var a=0;4>a;a++)if(!isFinite(b[a]))return!1;return!0};a.width=h;a.height=f;a.diameter=function(b){var a=h(b);b=f(b);return Math.sqrt(a*a+b*b)};a.area=function(b){return h(b)*f(b)};a.center=function(b,a){void 0===a&&(a=[0,0]);a[0]=
b[0]+h(b)/2;a[1]=b[1]+f(b)/2;return a};a.containsPoint=function(b,a){return e(b,a[0],a[1])};a.containsPointObject=function(b,a){return e(b,a.x,a.y)};a.containsPointWithMargin=function(b,a,d){return a[0]>=b[0]-d&&a[1]>=b[1]-d&&a[0]<=b[2]+d&&a[1]<=b[3]+d};a.intersects=function(b,a){return Math.max(a[0],b[0])<=Math.min(a[2],b[2])&&Math.max(a[1],b[1])<=Math.min(a[3],b[3])};a.contains=function(b,a){return a[0]>=b[0]&&a[2]<=b[2]&&a[1]>=b[1]&&a[3]<=b[3]};a.intersection=function(b,a,e){void 0===e&&(e=b);
var m=a[0],h=a[1],n=a[2];a=a[3];e[0]=d(b[0],m,n);e[1]=d(b[1],h,a);e[2]=d(b[2],m,n);e[3]=d(b[3],h,a);return e};a.distance=function(b,a){var d=(b[1]+b[3])/2,e=Math.max(Math.abs(a[0]-(b[0]+b[2])/2)-h(b)/2,0);b=Math.max(Math.abs(a[1]-d)-f(b)/2,0);return Math.sqrt(e*e+b*b)};a.size=function(b,a){a[0]=b[2]-b[0];a[1]=b[3]-b[1]};a.offset=function(b,a,d,e){void 0===e&&(e=b);e[0]=b[0]+a;e[1]=b[1]+d;e[2]=b[2]+a;e[3]=b[3]+d;return e};a.pad=function(b,a,d){void 0===d&&(d=b);d[0]=b[0]-a;d[1]=b[1]-a;d[2]=b[2]+a;
d[3]=b[3]+a;return d};a.setMin=function(b,a,d){void 0===d&&(d=b);d[0]=a[0];d[1]=a[1];d!==b&&(d[2]=b[2],d[3]=b[3]);return d};a.setMax=function(b,a,d){void 0===d&&(d=b);d[2]=a[0];d[3]=a[1];d!==b&&(d[0]=b[0],d[1]=b[1]);return b};a.set=p;a.empty=function(b){return b?p(b,a.NEGATIVE_INFINITY):k(a.NEGATIVE_INFINITY)};a.is=b;a.isPoint=function(b){return(0===h(b)||!isFinite(b[0]))&&(0===f(b)||!isFinite(b[1]))};a.equals=function(a,d,e){if(null==a||null==d)return a===d;if(!b(a)||!b(d))return!1;if(e)for(var h=
0;h<a.length;h++){if(!e(a[h],d[h]))return!1}else for(h=0;h<a.length;h++)if(a[h]!==d[h])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0];a.UNIT=[0,0,1,1]})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.level=0;b.levelValue=null;b.resolution=0;b.scale=0;return b}l(e,a);b=e;e.prototype.clone=function(){return new b({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var b;g([h.property({type:f.Integer,json:{write:!0}})],e.prototype,"level",void 0);g([h.property({type:String,json:{write:!0}})],e.prototype,"levelValue",void 0);g([h.property({type:Number,json:{write:!0}})],e.prototype,
"resolution",void 0);g([h.property({type:Number,json:{write:!0}})],e.prototype,"scale",void 0);return e=b=g([h.subclass("esri.layers.support.LOD")],e)}(h.declared(k.JSONSupport))})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f32 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec2f64 ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v){var z=[0,0];return function(a){function f(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];b=a.apply(this,b)||this;b._viewpoint2D={center:w.vec2f64.create(),rotation:0,scale:0,spatialReference:null};b.center=[0,0];b.extent=new k.Extent;b.id=0;b.inverseTransform=m.mat2df64.create();b.resolution=0;b.rotation=0;b.scale=0;b.transform=m.mat2df64.create();b.transformNoRotation=m.mat2df64.create();b.displayMat3=n.mat3f32.create();b.displayViewMat3=
n.mat3f32.create();b.viewMat3=n.mat3f32.create();b.viewMat2d=d.mat2df32.create();b.worldScreenWidth=0;b.size=[0,0];return b}l(f,a);c=f;Object.defineProperty(f.prototype,"pixelRatio",{set:function(b){this._set("pixelRatio",b);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"size",{set:function(b){this._set("size",b);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewpoint",{set:function(b){if(b){var a=this._viewpoint2D,d=b.targetGeometry;
a.center[0]=d.x;a.center[1]=d.y;a.rotation=b.rotation;a.scale=b.scale;a.spatialReference=d.spatialReference}this._update()},enumerable:!0,configurable:!0});f.prototype.copy=function(b){var a=this.size,d=this.viewpoint;d&&a?(this.viewpoint=v.copy(d,b.viewpoint),this._set("size",u.vec2.copy(a,b.size))):(this.viewpoint=b.viewpoint.clone(),this._set("size",[b.size[0],b.size[1]]));this._set("pixelRatio",b.pixelRatio);return this};f.prototype.clone=function(){return new c({size:this.size,viewpoint:this.viewpoint.clone(),
pixelRatio:this.pixelRatio})};f.prototype.toMap=function(b,a,d){if(t.isVec2(a))return u.vec2.transformMat2d(b,a,this.inverseTransform);z[0]=a;z[1]=d;return u.vec2.transformMat2d(b,z,this.inverseTransform)};f.prototype.toScreen=function(b,a,d){if(t.isVec2(a))return u.vec2.transformMat2d(b,a,this.transform);z[0]=a;z[1]=d;return u.vec2.transformMat2d(b,z,this.transform)};f.prototype.toScreenNoRotation=function(b,a,d){if(t.isVec2(a))return u.vec2.transformMat2d(b,a,this.transformNoRotation);z[0]=a;z[1]=
d;return u.vec2.transformMat2d(b,z,this.transformNoRotation)};f.prototype.pixelSizeAt=function(b){return v.pixelSizeAt(b,this.viewpoint)};f.prototype.getScreenTransform=function(b,a){var d=this._viewpoint2D.center,e=this._get("pixelRatio")||1,h=this._get("size");v.getMatrix(b,d,h,a,0,e);return b};f.prototype._update=function(){var a=this._viewpoint2D,d=a.center,e=a.spatialReference,m=a.scale,f=a.rotation,a=this._get("pixelRatio")||1,n=this._get("size");this._set("id",this.id+1);var c=new h({targetGeometry:new k.Point(d[0],
d[1],e),scale:m,rotation:f});this._set("viewpoint",c);if(n&&e&&m)return this.resolution=v.getResolution(c),this.rotation=f,this.scale=m,this.spatialReference=e,u.vec2.copy(this.center,d),r.mat3.set(this.displayMat3,0!==n[0]?2/n[0]:0,0,0,0,0!==n[1]?-2/n[1]:0,0,-1,1,1),m=r.mat3.identity(this.viewMat3),d=y.vec2f32.fromValues(n[0]/2,n[1]/2),e=y.vec2f32.fromValues(-n[0]/2,-n[1]/2),f=p.common.toRadian(f),r.mat3.translate(m,m,d),r.mat3.rotate(m,m,f),r.mat3.translate(m,m,e),r.mat3.multiply(this.displayViewMat3,
this.displayMat3,m),m=b.mat2d.identity(this.viewMat2d),b.mat2d.translate(m,m,d),b.mat2d.rotate(m,m,f),b.mat2d.translate(m,m,e),v.getExtent(this.extent,c,n),v.getTransform(this.transform,c,n,a),b.mat2d.invert(this.inverseTransform,this.transform),v.getTransformNoRotation(this.transformNoRotation,c,n,a),this.worldScreenWidth=v.getWorldScreenWidth(this.spatialReference,this.resolution),this};var c;g([e.property({readOnly:!0})],f.prototype,"id",void 0);g([e.property({value:1,json:{write:!0}})],f.prototype,
"pixelRatio",null);g([e.property({json:{write:!0}})],f.prototype,"size",null);g([e.property({type:h,json:{write:!0}})],f.prototype,"viewpoint",null);return f=c=g([e.subclass("esri.views.2d.ViewState")],f)}(e.declared(f.JSONSupport))})},"esri/Viewpoint":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./Camera ./geometry ./core/JSONSupport ./core/accessorSupport/decorators ./geometry/support/jsonUtils".split(" "),function(c,a,l,g,k,h,f,e,p){function b(){return{enabled:!this.camera}}
return function(a){function d(b){b=a.call(this,b)||this;b.rotation=0;b.scale=0;b.targetGeometry=null;b.camera=null;return b}l(d,a);f=d;d.prototype.castRotation=function(b){b%=360;0>b&&(b+=360);return b};d.prototype.clone=function(){return new f({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry?this.targetGeometry.clone():null,camera:this.camera?this.camera.clone():null})};var f;g([e.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:b}}}}})],
d.prototype,"rotation",void 0);g([e.cast("rotation")],d.prototype,"castRotation",null);g([e.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:b}}}}})],d.prototype,"scale",void 0);g([e.property({types:h.geometryTypes,json:{read:p.fromJSON,write:!0,origins:{"web-scene":{read:p.fromJSON,write:{overridePolicy:b}}}}})],d.prototype,"targetGeometry",void 0);g([e.property({type:k,json:{write:!0}})],d.prototype,"camera",void 0);return d=f=g([e.subclass("esri.Viewpoint")],d)}(e.declared(f.JSONSupport))})},
"esri/Camera":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/JSONSupport ./core/mathUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./geometry/Point ./views/3d/support/mathUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b){return function(a){function d(b,d,e,h){b=a.call(this,b)||this;b.position=new p([0,0,0]);b.heading=0;b.tilt=0;b.fov=55;return b}l(d,a);c=d;d.prototype.normalizeCtorArgs=function(b,a,d,e){b&&"object"===
typeof b&&("x"in b||Array.isArray(b))&&(b={position:b},null!=a&&(b.heading=a),null!=d&&(b.tilt=d),null!=e&&(b.fov=e));return b};d.prototype.writePosition=function(b,a,d,h){var m=b.clone();m.x=e.ensureNumber(b.x||0);m.y=e.ensureNumber(b.y||0);m.z=b.hasZ?e.ensureNumber(b.z||0):b.z;a[d]=m.write(null,h)};d.prototype.readPosition=function(b,a){var d=new p;d.read(b,a);d.x=e.ensureNumber(d.x||0);d.y=e.ensureNumber(d.y||0);d.z=d.hasZ?e.ensureNumber(d.z||0):d.z;return d};d.prototype.equals=function(b){return b?
this.tilt===b.tilt&&this.heading===b.heading&&this.fov===b.fov&&this.position.equals(b.position):!1};d.prototype.clone=function(){return new c({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})};var c;g([f.property({type:p,json:{write:{isRequired:!0}}})],d.prototype,"position",void 0);g([f.writer("position")],d.prototype,"writePosition",null);g([f.reader("position")],d.prototype,"readPosition",null);g([f.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),
f.cast(function(a){return b.cyclicalDeg.normalize(e.ensureNumber(a))})],d.prototype,"heading",void 0);g([f.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),f.cast(function(b){return h.clamp(e.ensureNumber(b),-180,180)})],d.prototype,"tilt",void 0);g([f.property({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],d.prototype,"fov",void 0);return d=c=g([f.subclass("esri.Camera")],d)}(f.declared(k.JSONSupport))})},"esri/views/3d/support/mathUtils":function(){define(["require","exports",
"../../../core/mathUtils","../../../core/libs/gl-matrix-2/vec3","../../../core/libs/gl-matrix-2/vec3f64"],function(c,a,l,g,k){function h(b){for(var a in b){var d=b[a];d instanceof Function&&(b[a]=d.bind(b))}return b}Object.defineProperty(a,"__esModule",{value:!0});a.cosCapped=function(b,a){return b>a?Math.cos(a):Math.cos(b)};a.fovx2fovy=function(b,a,d){return 2*Math.atan(d*Math.tan(.5*b)/a)};a.fovy2fovx=function(b,a,d){return 2*Math.atan(a*Math.tan(.5*b)/d)};a.maxScale=function(b){return Math.sqrt(Math.max(Math.max(b[0]*
b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10]))};a.scaleFromMatrix=function(b,a){g.vec3.set(b,Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9]),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]));return b};a.makeOrthonormal=function(b,a,d){d=d||b;var e=g.vec3.dot(b,a);g.vec3.set(d,b[0]-e*a[0],b[1]-e*a[1],b[2]-e*a[2]);g.vec3.normalize(d,d)};a.tangentFrame=function(b,a,d){Math.abs(b[0])>Math.abs(b[1])?g.vec3.set(a,0,1,0):g.vec3.set(a,
1,0,0);g.vec3.cross(d,b,a);g.vec3.normalize(a,a);g.vec3.cross(a,d,b);g.vec3.normalize(d,d)};a.moduloPositive=function(b,a){return(b%a+a)%a};a.cartesianToSpherical=function(b,a){var d=g.vec3.length(b),e=l.asinClamped(b[2]/d);g.vec3.set(a,d,e,Math.atan2(b[1]/d,b[0]/d));return a};a.sphericalToCartesian=function(b,a){var d=b[0],e=b[1];b=b[2];var h=Math.cos(e);g.vec3.set(a,d*h*Math.cos(b),d*h*Math.sin(b),d*Math.sin(e))};a.directionFromTo=function(b,a,d){var e=d[0]-a[0],h=d[1]-a[1];a=d[2]-a[2];d=e*e+h*
h+a*a;if(!d)return b[0]=0,b[1]=0,b[2]=0,b;d=1/Math.sqrt(d);b[0]=e*d;b[1]=h*d;b[2]=a*d;return b};a.bilerp=function(b,a,d,e,h,f){b+=(a-b)*h;return b+(d+(e-d)*h-b)*f};a.slerp=function(a,e,h,f){void 0===f&&(f=k.vec3f64.create());var m=g.vec3.length(a),n=g.vec3.length(e),c=g.vec3.dot(a,e)/(m*n);if(.9999999999999999>c){var c=Math.acos(c),p=((1-h)*m+h*n)/Math.sin(c),n=p/n*Math.sin(h*c);g.vec3.scale(b,a,p/m*Math.sin((1-h)*c));g.vec3.scale(d,e,n);return g.vec3.add(f,b,d)}return g.vec3.lerp(f,a,e,h)};a.angle=
function(a,e,h){a=g.vec3.normalize(b,a);e=g.vec3.normalize(d,e);var f=l.acosClamped(g.vec3.dot(a,e));return h&&(a=g.vec3.cross(p,a,e),0>g.vec3.dot(a,h))?-f:f};a.makePiecewiseLinearFunction=function(b){var a=b.length;return function(d){if(d<=b[0][0])return b[0][1];if(d>=b[a-1][0])return b[a-1][1];for(var e=1;d>b[e][0];)e++;var h=b[e][0];d=(h-d)/(h-b[e-1][0]);return d*b[e-1][1]+(1-d)*b[e][1]}};a.vectorEquals=function(b,a){if(null==b||null==a)return b!==a;if(b.length!==a.length)return!1;for(var d=0;d<
b.length;d++)if(b[d]!==a[d])return!1;return!0};c=function(){function b(b,a){this.min=b;this.max=a;this.range=a-b}b.prototype.ndiff=function(b,a){void 0===a&&(a=0);return Math.ceil((b-a)/this.range)*this.range+a};b.prototype._normalize=function(b,a,d,e){void 0===e&&(e=0);d-=e;d<b?d+=this.ndiff(b-d):d>a&&(d-=this.ndiff(d-a));return d+e};b.prototype.normalize=function(b,a){return this._normalize(this.min,this.max,b,a)};b.prototype.clamp=function(b,a){void 0===a&&(a=0);return l.clamp(b-a,this.min,this.max)+
a};b.prototype.monotonic=function(b,a,d){return b<a?a:a+this.ndiff(b-a,d)};b.prototype.minimalMonotonic=function(b,a,d){return this._normalize(b,b+this.range,a,d)};b.prototype.center=function(b,a,d){a=this.monotonic(b,a,d);return this.normalize((b+a)/2,d)};b.prototype.diff=function(b,a,d){return this.monotonic(b,a,d)-b};b.prototype.shortestSignedDiff=function(b,a){b=this.normalize(b);a=this.normalize(a);var d=a-b;b=a<b?this.minimalMonotonic(b,a)-b:a-this.minimalMonotonic(a,b);return Math.abs(d)<Math.abs(b)?
d:b};b.prototype.contains=function(b,a,d){a=this.minimalMonotonic(b,a);d=this.minimalMonotonic(b,d);return d>b&&d<a};return b}();a.Cyclical=c;a.planeFromPoints=function(b,a,d,h){g.vec3.subtract(f,a,b);g.vec3.subtract(e,d,b);g.vec3.cross(h,f,e);g.vec3.normalize(h,h);h[3]=-g.vec3.dot(b,h)};var f=k.vec3f64.create(),e=k.vec3f64.create();a.cyclical2PI=h(new c(0,2*Math.PI));a.cyclicalPI=h(new c(-Math.PI,Math.PI));a.cyclicalDeg=h(new c(0,360));var p=k.vec3f64.create(),b=k.vec3f64.create(),d=k.vec3f64.create()})},
"esri/core/libs/gl-matrix-2/vec3":function(){define(["require","exports","./math/vec3"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.vec3=l})},"esri/core/libs/gl-matrix-2/math/vec3":function(){define(["require","exports","../factories/vec3f64","./common"],function(c,a,l,g){function k(b){var a=b[0],d=b[1];b=b[2];return Math.sqrt(a*a+d*d+b*b)}function h(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b}function f(b,a,d){b[0]=a[0]-d[0];b[1]=a[1]-d[1];b[2]=a[2]-d[2];return b}function e(b,
a,d){b[0]=a[0]*d[0];b[1]=a[1]*d[1];b[2]=a[2]*d[2];return b}function p(b,a,d){b[0]=a[0]/d[0];b[1]=a[1]/d[1];b[2]=a[2]/d[2];return b}function b(b,a){var d=a[0]-b[0],e=a[1]-b[1];b=a[2]-b[2];return Math.sqrt(d*d+e*e+b*b)}function d(b,a){var d=a[0]-b[0],e=a[1]-b[1];b=a[2]-b[2];return d*d+e*e+b*b}function m(b){var a=b[0],d=b[1];b=b[2];return a*a+d*d+b*b}function r(b,a){var d=a[0],e=a[1],h=a[2],d=d*d+e*e+h*h;0<d&&(d=1/Math.sqrt(d),b[0]=a[0]*d,b[1]=a[1]*d,b[2]=a[2]*d);return b}function n(b,a){return b[0]*
a[0]+b[1]*a[1]+b[2]*a[2]}Object.defineProperty(a,"__esModule",{value:!0});a.length=k;a.copy=h;a.set=function(b,a,d,e){b[0]=a;b[1]=d;b[2]=e;return b};a.add=function(b,a,d){b[0]=a[0]+d[0];b[1]=a[1]+d[1];b[2]=a[2]+d[2];return b};a.subtract=f;a.multiply=e;a.divide=p;a.ceil=function(b,a){b[0]=Math.ceil(a[0]);b[1]=Math.ceil(a[1]);b[2]=Math.ceil(a[2]);return b};a.floor=function(b,a){b[0]=Math.floor(a[0]);b[1]=Math.floor(a[1]);b[2]=Math.floor(a[2]);return b};a.min=function(b,a,d){b[0]=Math.min(a[0],d[0]);
b[1]=Math.min(a[1],d[1]);b[2]=Math.min(a[2],d[2]);return b};a.max=function(b,a,d){b[0]=Math.max(a[0],d[0]);b[1]=Math.max(a[1],d[1]);b[2]=Math.max(a[2],d[2]);return b};a.round=function(b,a){b[0]=Math.round(a[0]);b[1]=Math.round(a[1]);b[2]=Math.round(a[2]);return b};a.scale=function(b,a,d){b[0]=a[0]*d;b[1]=a[1]*d;b[2]=a[2]*d;return b};a.scaleAndAdd=function(b,a,d,e){b[0]=a[0]+d[0]*e;b[1]=a[1]+d[1]*e;b[2]=a[2]+d[2]*e;return b};a.distance=b;a.squaredDistance=d;a.squaredLength=m;a.negate=function(b,a){b[0]=
-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(b,a){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=r;a.dot=n;a.cross=function(b,a,d){var e=a[0],h=a[1];a=a[2];var f=d[0],m=d[1];d=d[2];b[0]=h*d-a*m;b[1]=a*f-e*d;b[2]=e*m-h*f;return b};a.lerp=function(b,a,d,e){var h=a[0],f=a[1];a=a[2];b[0]=h+e*(d[0]-h);b[1]=f+e*(d[1]-f);b[2]=a+e*(d[2]-a);return b};a.hermite=function(b,a,d,e,h,f){var m=f*f,n=m*(2*f-3)+1,c=m*(f-2)+f,p=m*(f-1);f=m*(3-2*f);b[0]=a[0]*n+d[0]*c+e[0]*p+h[0]*f;b[1]=a[1]*n+
d[1]*c+e[1]*p+h[1]*f;b[2]=a[2]*n+d[2]*c+e[2]*p+h[2]*f;return b};a.bezier=function(b,a,d,e,h,f){var m=1-f,n=m*m,c=f*f,p=n*m,n=3*f*n,m=3*c*m;f*=c;b[0]=a[0]*p+d[0]*n+e[0]*m+h[0]*f;b[1]=a[1]*p+d[1]*n+e[1]*m+h[1]*f;b[2]=a[2]*p+d[2]*n+e[2]*m+h[2]*f;return b};a.random=function(b,a){a=a||1;var d=2*g.RANDOM()*Math.PI,e=2*g.RANDOM()-1,h=Math.sqrt(1-e*e)*a;b[0]=Math.cos(d)*h;b[1]=Math.sin(d)*h;b[2]=e*a;return b};a.transformMat4=function(b,a,d){var e=a[0],h=a[1];a=a[2];b[0]=d[0]*e+d[4]*h+d[8]*a+d[12];b[1]=d[1]*
e+d[5]*h+d[9]*a+d[13];b[2]=d[2]*e+d[6]*h+d[10]*a+d[14];return b};a.transformMat3=function(b,a,d){var e=a[0],h=a[1];a=a[2];b[0]=e*d[0]+h*d[3]+a*d[6];b[1]=e*d[1]+h*d[4]+a*d[7];b[2]=e*d[2]+h*d[5]+a*d[8];return b};a.transformQuat=function(b,a,d){var e=d[0],h=d[1],f=d[2],m=a[0],n=a[1];a=a[2];var c=h*a-f*n,p=f*m-e*a,g=e*n-h*m;d=2*d[3];b[0]=m+c*d+2*(h*g-f*p);b[1]=n+p*d+2*(f*c-e*g);b[2]=a+g*d+2*(e*p-h*c);return b};a.rotateX=function(b,a,d,e){var h=[],f=[];h[0]=a[0]-d[0];h[1]=a[1]-d[1];h[2]=a[2]-d[2];f[0]=
h[0];f[1]=h[1]*Math.cos(e)-h[2]*Math.sin(e);f[2]=h[1]*Math.sin(e)+h[2]*Math.cos(e);b[0]=f[0]+d[0];b[1]=f[1]+d[1];b[2]=f[2]+d[2];return b};a.rotateY=function(b,a,d,e){var h=[],f=[];h[0]=a[0]-d[0];h[1]=a[1]-d[1];h[2]=a[2]-d[2];f[0]=h[2]*Math.sin(e)+h[0]*Math.cos(e);f[1]=h[1];f[2]=h[2]*Math.cos(e)-h[0]*Math.sin(e);b[0]=f[0]+d[0];b[1]=f[1]+d[1];b[2]=f[2]+d[2];return b};a.rotateZ=function(b,a,d,e){var h=[],f=[];h[0]=a[0]-d[0];h[1]=a[1]-d[1];h[2]=a[2]-d[2];f[0]=h[0]*Math.cos(e)-h[1]*Math.sin(e);f[1]=h[0]*
Math.sin(e)+h[1]*Math.cos(e);f[2]=h[2];b[0]=f[0]+d[0];b[1]=f[1]+d[1];b[2]=f[2]+d[2];return b};a.angle=function(b,a){h(u,b);h(y,a);r(u,u);r(y,y);b=n(u,y);return 1<b?0:-1>b?Math.PI:Math.acos(b)};var u=l.create(),y=l.create();a.str=function(b){return"vec3("+b[0]+", "+b[1]+", "+b[2]+")"};a.exactEquals=function(b,a){return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]};a.equals=function(b,a){var d=b[0],e=b[1];b=b[2];var h=a[0],f=a[1];a=a[2];return Math.abs(d-h)<=g.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))&&
Math.abs(e-f)<=g.EPSILON*Math.max(1,Math.abs(e),Math.abs(f))&&Math.abs(b-a)<=g.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))};a.sub=f;a.mul=e;a.div=p;a.dist=b;a.sqrDist=d;a.len=k;a.sqrLen=m})},"esri/core/libs/gl-matrix-2/factories/vec3f64":function(){define(["require","exports"],function(c,a){function l(){return[0,0,0]}function g(){return[1,1,1]}function k(){return[1,0,0]}function h(){return[0,1,0]}function f(){return[0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=l;a.clone=function(a){return[a[0],
a[1],a[2]]};a.fromValues=function(a,h,b){return[a,h,b]};a.fromArray=function(a){for(var e=l(),b=Math.min(3,a.length),d=0;d<b;++d)e[d]=a[d];return e};a.createView=function(a,h){return new Float64Array(a,h,3)};a.zeros=function(){return l()};a.ones=g;a.unitX=k;a.unitY=h;a.unitZ=f;a.ZEROS=l();a.ONES=g();a.UNIT_X=k();a.UNIT_Y=h();a.UNIT_Z=f()})},"esri/core/libs/gl-matrix-2/math/common":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.EPSILON=1E-6;
a.RANDOM=Math.random;var l=Math.PI/180,g=180/Math.PI;a.toRadian=function(a){return a*l};a.toDegree=function(a){return a*g};a.equals=function(c,h){return Math.abs(c-h)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(h))}})},"esri/core/libs/gl-matrix-2/vec3f64":function(){define(["require","exports","./factories/vec3f64"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.vec3f64=l})},"esri/core/libs/gl-matrix-2/common":function(){define(["require","exports","./math/common"],function(c,a,
l){Object.defineProperty(a,"__esModule",{value:!0});a.common=l})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports","./math/mat2d"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat2d=l})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(c,a,l){function g(a,f,e){var h=f[0],b=f[1],d=f[2],m=f[3],c=f[4];f=f[5];var n=e[0],g=e[1],k=e[2],w=e[3],t=e[4];e=e[5];a[0]=h*n+d*g;a[1]=b*n+m*g;a[2]=h*k+d*w;a[3]=b*k+m*
w;a[4]=h*t+d*e+c;a[5]=b*t+m*e+f;return a}function k(a,f,e){a[0]=f[0]-e[0];a[1]=f[1]-e[1];a[2]=f[2]-e[2];a[3]=f[3]-e[3];a[4]=f[4]-e[4];a[5]=f[5]-e[5];return a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[3];a[4]=f[4];a[5]=f[5];return a};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a};a.set=function(a,f,e,c,b,d,m){a[0]=f;a[1]=e;a[2]=c;a[3]=b;a[4]=d;a[5]=m;return a};a.invert=function(a,f){var e=f[0],h=f[1],b=f[2],
d=f[3],m=f[4];f=f[5];var c=e*d-h*b;if(!c)return null;c=1/c;a[0]=d*c;a[1]=-h*c;a[2]=-b*c;a[3]=e*c;a[4]=(b*f-d*m)*c;a[5]=(h*m-e*f)*c;return a};a.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};a.multiply=g;a.rotate=function(a,f,e){var h=f[0],b=f[1],d=f[2],m=f[3],c=f[4];f=f[5];var n=Math.sin(e);e=Math.cos(e);a[0]=h*e+d*n;a[1]=b*e+m*n;a[2]=h*-n+d*e;a[3]=b*-n+m*e;a[4]=c;a[5]=f;return a};a.scale=function(a,f,e){var h=f[1],b=f[2],d=f[3],m=f[4],c=f[5],n=e[0];e=e[1];a[0]=f[0]*n;a[1]=h*n;a[2]=b*e;a[3]=
d*e;a[4]=m;a[5]=c;return a};a.translate=function(a,f,e){var h=f[0],b=f[1],d=f[2],m=f[3],c=f[4];f=f[5];var n=e[0];e=e[1];a[0]=h;a[1]=b;a[2]=d;a[3]=m;a[4]=h*n+d*e+c;a[5]=b*n+m*e+f;return a};a.fromRotation=function(a,f){var e=Math.sin(f);f=Math.cos(f);a[0]=f;a[1]=e;a[2]=-e;a[3]=f;a[4]=0;a[5]=0;return a};a.fromScaling=function(a,f){a[0]=f[0];a[1]=0;a[2]=0;a[3]=f[1];a[4]=0;a[5]=0;return a};a.fromTranslation=function(a,f){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=f[0];a[5]=f[1];return a};a.str=function(a){return"mat2d("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};a.add=function(a,f,e){a[0]=f[0]+e[0];a[1]=f[1]+e[1];a[2]=f[2]+e[2];a[3]=f[3]+e[3];a[4]=f[4]+e[4];a[5]=f[5]+e[5];return a};a.subtract=k;a.multiplyScalar=function(a,f,e){a[0]=f[0]*e;a[1]=f[1]*e;a[2]=f[2]*e;a[3]=f[3]*e;a[4]=f[4]*e;a[5]=f[5]*e;return a};a.multiplyScalarAndAdd=function(a,f,e,c){a[0]=f[0]+
e[0]*c;a[1]=f[1]+e[1]*c;a[2]=f[2]+e[2]*c;a[3]=f[3]+e[3]*c;a[4]=f[4]+e[4]*c;a[5]=f[5]+e[5]*c;return a};a.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]&&a[3]===f[3]&&a[4]===f[4]&&a[5]===f[5]};a.equals=function(a,f){var e=a[0],h=a[1],b=a[2],d=a[3],m=a[4];a=a[5];var c=f[0],n=f[1],g=f[2],k=f[3],w=f[4];f=f[5];return Math.abs(e-c)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(c))&&Math.abs(h-n)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(n))&&Math.abs(b-g)<=l.EPSILON*Math.max(1,Math.abs(b),
Math.abs(g))&&Math.abs(d-k)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(m-w)<=l.EPSILON*Math.max(1,Math.abs(m),Math.abs(w))&&Math.abs(a-f)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};a.mul=g;a.sub=k})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require","exports","./factories/mat2df32"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat2df32=l})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,
"__esModule",{value:!0});a.create=function(){var a=new Float32Array(6);a[0]=1;a[3]=1;return a};a.clone=function(a){var c=new Float32Array(6);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];return c};a.fromValues=function(a,c,k,h,f,e){var p=new Float32Array(6);p[0]=a;p[1]=c;p[2]=k;p[3]=h;p[4]=f;p[5]=e;return p};a.createView=function(a,c){return new Float32Array(a,c,6)}})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require","exports","./factories/mat2df64"],function(c,a,l){Object.defineProperty(a,
"__esModule",{value:!0});a.mat2df64=l})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,1,0,0]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5]]};a.fromValues=function(a,c,k,h,f,e){return[a,c,k,h,f,e]};a.createView=function(a,c){return new Float64Array(a,c,6)}})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(c,
a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat3=l})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(c,a,l){function g(a,f,e){var h=f[0],b=f[1],d=f[2],m=f[3],c=f[4],n=f[5],g=f[6],k=f[7];f=f[8];var w=e[0],t=e[1],v=e[2],l=e[3],A=e[4],C=e[5],D=e[6],B=e[7];e=e[8];a[0]=w*h+t*m+v*g;a[1]=w*b+t*c+v*k;a[2]=w*d+t*n+v*f;a[3]=l*h+A*m+C*g;a[4]=l*b+A*c+C*k;a[5]=l*d+A*n+C*f;a[6]=D*h+B*m+e*g;a[7]=D*b+B*c+e*k;a[8]=D*d+B*n+e*f;return a}function k(a,f,
e){a[0]=f[0]-e[0];a[1]=f[1]-e[1];a[2]=f[2]-e[2];a[3]=f[3]-e[3];a[4]=f[4]-e[4];a[5]=f[5]-e[5];a[6]=f[6]-e[6];a[7]=f[7]-e[7];a[8]=f[8]-e[8];return a}Object.defineProperty(a,"__esModule",{value:!0});a.fromMat4=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[4];a[4]=f[5];a[5]=f[6];a[6]=f[8];a[7]=f[9];a[8]=f[10];return a};a.copy=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[3];a[4]=f[4];a[5]=f[5];a[6]=f[6];a[7]=f[7];a[8]=f[8];return a};a.set=function(a,f,e,c,b,d,m,g,n,u){a[0]=f;a[1]=e;a[2]=c;a[3]=
b;a[4]=d;a[5]=m;a[6]=g;a[7]=n;a[8]=u;return a};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,f){if(a===f){var e=f[1],h=f[2],b=f[5];a[1]=f[3];a[2]=f[6];a[3]=e;a[5]=f[7];a[6]=h;a[7]=b}else a[0]=f[0],a[1]=f[3],a[2]=f[6],a[3]=f[1],a[4]=f[4],a[5]=f[7],a[6]=f[2],a[7]=f[5],a[8]=f[8];return a};a.invert=function(a,f){var e=f[0],h=f[1],b=f[2],d=f[3],m=f[4],c=f[5],n=f[6],g=f[7];f=f[8];var k=f*m-c*g,w=-f*d+c*n,t=g*d-m*n,v=e*k+h*w+b*t;if(!v)return null;
v=1/v;a[0]=k*v;a[1]=(-f*h+b*g)*v;a[2]=(c*h-b*m)*v;a[3]=w*v;a[4]=(f*e-b*n)*v;a[5]=(-c*e+b*d)*v;a[6]=t*v;a[7]=(-g*e+h*n)*v;a[8]=(m*e-h*d)*v;return a};a.adjoint=function(a,f){var e=f[0],h=f[1],b=f[2],d=f[3],m=f[4],c=f[5],n=f[6],g=f[7];f=f[8];a[0]=m*f-c*g;a[1]=b*g-h*f;a[2]=h*c-b*m;a[3]=c*n-d*f;a[4]=e*f-b*n;a[5]=b*d-e*c;a[6]=d*g-m*n;a[7]=h*n-e*g;a[8]=e*m-h*d;return a};a.determinant=function(a){var f=a[3],e=a[4],h=a[5],b=a[6],d=a[7],m=a[8];return a[0]*(m*e-h*d)+a[1]*(-m*f+h*b)+a[2]*(d*f-e*b)};a.multiply=
g;a.translate=function(a,f,e){var h=f[0],b=f[1],d=f[2],m=f[3],c=f[4],n=f[5],g=f[6],k=f[7];f=f[8];var w=e[0];e=e[1];a[0]=h;a[1]=b;a[2]=d;a[3]=m;a[4]=c;a[5]=n;a[6]=w*h+e*m+g;a[7]=w*b+e*c+k;a[8]=w*d+e*n+f;return a};a.rotate=function(a,f,e){var h=f[0],b=f[1],d=f[2],m=f[3],c=f[4],n=f[5],g=f[6],k=f[7];f=f[8];var w=Math.sin(e);e=Math.cos(e);a[0]=e*h+w*m;a[1]=e*b+w*c;a[2]=e*d+w*n;a[3]=e*m-w*h;a[4]=e*c-w*b;a[5]=e*n-w*d;a[6]=g;a[7]=k;a[8]=f;return a};a.scale=function(a,f,e){var h=e[0],b=e[1];e=e[2];a[0]=h*
f[0];a[1]=h*f[1];a[2]=h*f[2];a[3]=b*f[3];a[4]=b*f[4];a[5]=b*f[5];a[6]=e*f[6];a[7]=e*f[7];a[8]=e*f[8];return a};a.scaleByVec2=function(a,f,e){var h=e[0];e=e[1];a[0]=h*f[0];a[1]=h*f[1];a[2]=h*f[2];a[3]=e*f[3];a[4]=e*f[4];a[5]=e*f[5];return a};a.fromTranslation=function(a,f){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=f[0];a[7]=f[1];a[8]=1;return a};a.fromRotation=function(a,f){var e=Math.sin(f);f=Math.cos(f);a[0]=f;a[1]=e;a[2]=0;a[3]=-e;a[4]=f;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromScaling=
function(a,f){a[0]=f[0];a[1]=0;a[2]=0;a[3]=0;a[4]=f[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat2d=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=0;a[3]=f[2];a[4]=f[3];a[5]=0;a[6]=f[4];a[7]=f[5];a[8]=1;return a};a.fromQuat=function(a,f){var e=f[0],h=f[1],b=f[2];f=f[3];var d=e+e,m=h+h,c=b+b,e=e*d,n=h*d,h=h*m,g=b*d,k=b*m,b=b*c,d=f*d,m=f*m;f*=c;a[0]=1-h-b;a[3]=n-f;a[6]=g+m;a[1]=n+f;a[4]=1-e-b;a[7]=k-d;a[2]=g-m;a[5]=k+d;a[8]=1-e-h;return a};a.normalFromMat4Legacy=function(a,f){var e=f[0],h=f[1],b=f[2],
d=f[4],m=f[5],c=f[6],n=f[8],g=f[9];f=f[10];var k=f*m-c*g,w=-f*d+c*n,t=g*d-m*n,v=e*k+h*w+b*t;if(!v)return null;v=1/v;a[0]=k*v;a[1]=(-f*h+b*g)*v;a[2]=(c*h-b*m)*v;a[3]=w*v;a[4]=(f*e-b*n)*v;a[5]=(-c*e+b*d)*v;a[6]=t*v;a[7]=(-g*e+h*n)*v;a[8]=(m*e-h*d)*v;return a};a.normalFromMat4=function(a,f){var e=f[0],h=f[1],b=f[2],d=f[3],m=f[4],c=f[5],n=f[6],g=f[7],k=f[8],w=f[9],t=f[10],v=f[11],l=f[12],A=f[13],C=f[14];f=f[15];var D=e*c-h*m,B=e*n-b*m,E=e*g-d*m,F=h*n-b*c,H=h*g-d*c,J=b*g-d*n,K=k*A-w*l,G=k*C-t*l,k=k*f-
v*l,I=w*C-t*A,w=w*f-v*A,t=t*f-v*C,v=D*t-B*w+E*I+F*k-H*G+J*K;if(!v)return null;v=1/v;a[0]=(c*t-n*w+g*I)*v;a[1]=(n*k-m*t-g*G)*v;a[2]=(m*w-c*k+g*K)*v;a[3]=(b*w-h*t-d*I)*v;a[4]=(e*t-b*k+d*G)*v;a[5]=(h*k-e*w-d*K)*v;a[6]=(A*J-C*H+f*F)*v;a[7]=(C*E-l*J-f*B)*v;a[8]=(l*H-A*E+f*D)*v;return a};a.projection=function(a,f,e){a[0]=2/f;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/e;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+
a[8]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};a.add=function(a,f,e){a[0]=f[0]+e[0];a[1]=f[1]+e[1];a[2]=f[2]+e[2];a[3]=f[3]+e[3];a[4]=f[4]+e[4];a[5]=f[5]+e[5];a[6]=f[6]+e[6];a[7]=f[7]+e[7];a[8]=f[8]+e[8];return a};a.subtract=k;a.multiplyScalar=function(a,f,e){a[0]=f[0]*e;a[1]=f[1]*e;a[2]=f[2]*e;a[3]=f[3]*e;a[4]=f[4]*e;a[5]=f[5]*e;a[6]=f[6]*e;a[7]=
f[7]*e;a[8]=f[8]*e;return a};a.multiplyScalarAndAdd=function(a,f,e,c){a[0]=f[0]+e[0]*c;a[1]=f[1]+e[1]*c;a[2]=f[2]+e[2]*c;a[3]=f[3]+e[3]*c;a[4]=f[4]+e[4]*c;a[5]=f[5]+e[5]*c;a[6]=f[6]+e[6]*c;a[7]=f[7]+e[7]*c;a[8]=f[8]+e[8]*c;return a};a.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]&&a[3]===f[3]&&a[4]===f[4]&&a[5]===f[5]&&a[6]===f[6]&&a[7]===f[7]&&a[8]===f[8]};a.equals=function(a,f){var e=a[0],c=a[1],b=a[2],d=a[3],m=a[4],h=a[5],n=a[6],g=a[7];a=a[8];var k=f[0],w=f[1],t=f[2],v=
f[3],z=f[4],A=f[5],C=f[6],D=f[7];f=f[8];return Math.abs(e-k)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(k))&&Math.abs(c-w)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(b-t)<=l.EPSILON*Math.max(1,Math.abs(b),Math.abs(t))&&Math.abs(d-v)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(m-z)<=l.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(h-A)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(n-C)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(g-D)<=l.EPSILON*
Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(a-f)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};a.mul=g;a.sub=k})},"esri/core/libs/gl-matrix-2/mat3f32":function(){define(["require","exports","./factories/mat3f32"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f32=l})},"esri/core/libs/gl-matrix-2/factories/mat3f32":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){var a=new Float32Array(9);a[0]=1;a[4]=
1;a[8]=1;return a};a.clone=function(a){var c=new Float32Array(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.fromValues=function(a,c,k,h,f,e,p,b,d){var m=new Float32Array(9);m[0]=a;m[1]=c;m[2]=k;m[3]=h;m[4]=f;m[5]=e;m[6]=p;m[7]=b;m[8]=d;return m};a.createView=function(a,c){return new Float32Array(a,c,9)}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require","exports","./math/vec2"],function(c,a,l){Object.defineProperty(a,"__esModule",
{value:!0});a.vec2=l})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(c,a,l){function g(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];return a}function k(a,b,e){a[0]=b[0]*e[0];a[1]=b[1]*e[1];return a}function h(a,b,e){a[0]=b[0]/e[0];a[1]=b[1]/e[1];return a}function f(a,b){var d=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(d*d+a*a)}function e(a,b){var d=b[0]-a[0];a=b[1]-a[1];return d*d+a*a}function p(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)}function b(a){var b=
a[0];a=a[1];return b*b+a*a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};a.set=function(a,b,e){a[0]=b;a[1]=e;return a};a.add=function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];return a};a.subtract=g;a.multiply=k;a.divide=h;a.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};a.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};a.min=function(a,b,e){a[0]=Math.min(b[0],e[0]);a[1]=Math.min(b[1],e[1]);return a};
a.max=function(a,b,e){a[0]=Math.max(b[0],e[0]);a[1]=Math.max(b[1],e[1]);return a};a.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};a.scale=function(a,b,e){a[0]=b[0]*e;a[1]=b[1]*e;return a};a.scaleAndAdd=function(a,b,e,f){a[0]=b[0]+e[0]*f;a[1]=b[1]+e[1]*f;return a};a.distance=f;a.squaredDistance=e;a.length=p;a.squaredLength=b;a.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};a.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};a.normalize=function(a,b){var d=b[0],
e=b[1],d=d*d+e*e;0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d);return a};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};a.cross=function(a,b,e){b=b[0]*e[1]-b[1]*e[0];a[0]=a[1]=0;a[2]=b;return a};a.lerp=function(a,b,e,f){var d=b[0];b=b[1];a[0]=d+f*(e[0]-d);a[1]=b+f*(e[1]-b);return a};a.random=function(a,b){b=b||1;var d=2*l.RANDOM()*Math.PI;a[0]=Math.cos(d)*b;a[1]=Math.sin(d)*b;return a};a.transformMat2=function(a,b,e){var d=b[0];b=b[1];a[0]=e[0]*d+e[2]*b;a[1]=e[1]*d+e[3]*b;return a};a.transformMat2d=
function(a,b,e){var d=b[0];b=b[1];a[0]=e[0]*d+e[2]*b+e[4];a[1]=e[1]*d+e[3]*b+e[5];return a};a.transformMat3=function(a,b,e){var d=b[0];b=b[1];a[0]=e[0]*d+e[3]*b+e[6];a[1]=e[1]*d+e[4]*b+e[7];return a};a.transformMat4=function(a,b,e){var d=b[0];b=b[1];a[0]=e[0]*d+e[4]*b+e[12];a[1]=e[1]*d+e[5]*b+e[13];return a};a.rotate=function(a,b,e,f){var d=b[0]-e[0];b=b[1]-e[1];var c=Math.sin(f);f=Math.cos(f);a[0]=d*f-b*c+e[0];a[1]=d*c+b*f+e[1];return a};a.angle=function(a,b){var d=a[0];a=a[1];var e=b[0];b=b[1];
var f=d*d+a*a;0<f&&(f=1/Math.sqrt(f));var c=e*e+b*b;0<c&&(c=1/Math.sqrt(c));d=(d*e+a*b)*f*c;return 1<d?0:-1>d?Math.PI:Math.acos(d)};a.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};a.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};a.equals=function(a,b){var d=a[0];a=a[1];var e=b[0];b=b[1];return Math.abs(d-e)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(e))&&Math.abs(a-b)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};a.len=p;a.sub=g;a.mul=k;a.div=h;a.dist=f;a.sqrDist=e;a.sqrLen=b})},
"esri/core/libs/gl-matrix-2/vec2f32":function(){define(["require","exports","./factories/vec2f32"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f32=l})},"esri/core/libs/gl-matrix-2/factories/vec2f32":function(){define(["require","exports"],function(c,a){function l(){return new Float32Array(2)}function g(a,f){var b=new Float32Array(2);b[0]=a;b[1]=f;return b}function k(){return g(1,1)}function h(){return g(1,0)}function f(){return g(0,1)}Object.defineProperty(a,"__esModule",
{value:!0});a.create=l;a.clone=function(a){var e=new Float32Array(2);e[0]=a[0];e[1]=a[1];return e};a.fromValues=g;a.createView=function(a,f){return new Float32Array(a,f,2)};a.zeros=function(){return l()};a.ones=k;a.unitX=h;a.unitY=f;a.ZEROS=l();a.ONES=k();a.UNIT_X=h();a.UNIT_Y=f()})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f64=l})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require",
"exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[0,0]};a.clone=function(a){return[a[0],a[1]]};a.fromValues=function(a,c){return[a,c]};a.fromArray=function(a){for(var c=[0,0],k=Math.min(2,a.length),h=0;h<k;++h)c[h]=a[h];return c};a.createView=function(a,c){return new Float64Array(a,c,2)};a.zeros=function(){return[0,0]};a.ones=function(){return[1,1]};a.unitX=function(){return[1,0]};a.unitY=function(){return[0,1]};a.ZEROS=[0,0];a.ONES=[1,1];a.UNIT_X=
[1,0];a.UNIT_Y=[0,1]})},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["require","exports"],function(c,a){function l(a){return a instanceof Float32Array&&2<=a.length}function g(a){return Array.isArray(a)&&2<=a.length}Object.defineProperty(a,"__esModule",{value:!0});a.isVec2f32=l;a.isVec2f64=g;a.isVec2=function(a){return l(a)||g(a)}})},"esri/views/2d/viewpointUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Viewpoint ../../core/Collection ../../core/maybe ../../core/promiseUtils ../../core/unitUtils ../../core/wgs84Constants ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C){function D(a,b,e,f){return f&&e&&!f.equals(e)&&A.canProject(f,e)&&f.isWebMercator?(f.isWebMercator?(e=b[1],89.99999<e?e=89.99999:-89.99999>e&&(e=-89.99999),e=Math.sin(d.common.toRadian(e)),a=n.vec2.set(a,d.common.toRadian(b[0])*V,.5*V*Math.log((1+e)/(1-e)))):(e=d.common.toDegree(b[0]/V),a=n.vec2.set(a,e-360*Math.floor((e+180)/360),d.common.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*b[1]/V))))),a):n.vec2.copy(a,b)}function B(a){return a.wkid?a:
a.spatialReference||v.WGS84}function E(a,b){return b.type?n.vec2.set(a,b.x,b.y):n.vec2.copy(a,b)}function F(a,b){return Math.max(a.width/b[0],a.height/b[1])*N(a.spatialReference)}function H(a,b,d,c){return g(this,void 0,void 0,function(){var m,n,p,g,r,k,u,v,z,G,I,J,C,K,D,E,F,L,B,R,Q,N,M,X,W,q,V,Y;return l(this,function(l){switch(l.label){case 0:if(!a||Array.isArray(a)&&!a.length)return[2,null];h.isCollection(a)&&(a=a.toArray());if(!Array.isArray(a)||!a.length||"object"!==typeof a[0])return[3,7];n=
a.every(function(a){return"attributes"in a});p=a.some(function(a){return!a.geometry});g=a;if(!(n&&p&&b&&b.allLayerViews))return[3,2];r=new Map;k=0;for(u=a;k<u.length;k++)v=u[k],z=v.layer,G=r.get(z)||[],I=v.attributes[z.objectIdField],null!=I&&G.push(I),r.set(z,G);J=[];r.forEach(function(a,d){var e=b.allLayerViews.find(function(a){return a.layer.id===d.id});if("queryFeatures"in e){var f=d.createQuery();f.objectIds=a;f.returnGeometry=!0;J.push(e.queryFeatures(f))}});return[4,e.all(J)];case 1:C=l.sent();
K=[];D=0;for(E=C;D<E.length;D++)if((F=E[D])&&F.features&&F.features.length)for(L=0,B=F.features;L<B.length;L++)v=B[L],f.isSome(v.geometry)&&K.push(v.geometry);g=K;l.label=2;case 2:R=0,Q=g,l.label=3;case 3:if(!(R<Q.length))return[3,6];N=Q[R];return[4,H(N,b,d,c)];case 4:c=l.sent(),l.label=5;case 5:return R++,[3,3];case 6:return[2,c];case 7:if(!Array.isArray(a)||2!==a.length||"number"!==typeof a[0]||"number"!==typeof a[1])return[3,8];m=new t(a);return[3,12];case 8:if(!(a instanceof w))return[3,9];m=
a;return[3,12];case 9:if(!("geometry"in a))return[3,12];if(!a.geometry)return[3,10];m=a.geometry;return[3,12];case 10:if(!a.layer)return[3,12];M=a.layer;X=b.allLayerViews.find(function(a){return a.layer.id===M.id});if(!("queryFeatures"in X))return[3,12];W=M.createQuery();W.objectIds=[a.attributes[M.objectIdField]];W.returnGeometry=!0;return[4,X.queryFeatures(W)];case 11:q=l.sent(),m=f.get(q,"features",0,"geometry"),l.label=12;case 12:if(f.isNone(m))return[2,null];V="point"===m.type?new y({xmin:m.x,
ymin:m.y,xmax:m.x,ymax:m.y,spatialReference:m.spatialReference}):m.extent;if(!V)return[2,null];Y=A.canProject(V,d);if(!V.spatialReference.equals(d)&&Y)V=A.project(V,d);else if(!Y)return[2,null];c=c?c.union(V):V.clone();return[2,c]}})})}function J(a){if(a&&(!Array.isArray(a)||"number"!==typeof a[0])&&("object"===typeof a||Array.isArray(a)&&"object"===typeof a[0])){if("layer"in a&&a.layer&&a.layer.minScale&&a.layer.maxScale){var b=a.layer;return{min:b.minScale,max:b.maxScale}}if(Array.isArray(a)&&a.length&&
a.every(function(a){return"layer"in a})){for(var d=0,e=0,f=0;f<a.length;f++)(b=a[f].layer)&&b.minScale&&b.maxScale&&(d=b.minScale<d?b.minScale:d,e=b.maxScale>e?b.maxScale:e);return d&&e?{min:d,max:e}:null}}}function K(a,b){return g(this,void 0,void 0,function(){var d,e,f,c,m,n,h,p,g,r,w,v,z,G,I,K;return l(this,function(l){switch(l.label){case 0:if(!a||!b)return[2,new k({targetGeometry:new t,scale:0,rotation:0})];d=b.spatialReference;e=b.size;f=b.viewpoint;c=b.constraints;m=null;a instanceof k?m=a:
a.viewpoint?m=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(m=a.target);n=null;if(!m||!m.targetGeometry)return[3,1];n=m.targetGeometry;return[3,10];case 1:if(!(a instanceof y))return[3,2];n=a;return[3,10];case 2:return a||a&&("center"in a||"extent"in a||"target"in a)?[4,H(a.center,b,d)]:[3,10];case 3:return(g=l.sent())?[3,5]:[4,H(a.extent,b,d)];case 4:g=l.sent(),l.label=5;case 5:return(p=g)?[3,7]:[4,H(a.target,b,d)];case 6:p=l.sent(),l.label=7;case 7:return(h=p)?[3,9]:[4,H(a,b,
d)];case 8:h=l.sent(),l.label=9;case 9:n=h,l.label=10;case 10:!n&&f&&f.targetGeometry?n=f.targetGeometry:!n&&b.extent&&(n=b.extent);r=B(n);d||(d=B(b.spatialReference||b.extent||n));if(!C.canProject(n,d)&&r&&!r.equals(d))return[2,null];w=E(u.vec2f64.create(),n.center?n.center:n);v=new t(D(w,w,r,d),d);z=null;z=m&&m.targetGeometry&&"point"===m.targetGeometry.type?m.scale:a.hasOwnProperty("scale")&&a.scale?a.scale:a.hasOwnProperty("zoom")&&-1!==a.zoom&&c&&c.effectiveLODs?c.zoomToScale(a.zoom):Array.isArray(n)||
"point"===n.type||"extent"===n.type&&0===n.width&&0===n.height?b.extent&&A.canProject(b.extent,d)?F(A.project(b.extent,d),e):b.extent?F(b.extent,e):f.scale:A.canProject(n.extent,d)?F(A.project(n.extent,d),e):F(n.extent,e);if(G=J(a))G.min&&G.min>z?z=G.min:G.max&&G.max<z&&(z=G.max);I=0;m?I=m.rotation:a.hasOwnProperty("rotation")?I=a.rotation:f&&(I=f.rotation);K=new k({targetGeometry:v,scale:z,rotation:I});c&&(K=c.fit(K),c.rotationEnabled||(K.rotation=I));return[2,K]}})})}function G(a,b){var d=a.targetGeometry,
e=b.targetGeometry;d.x=e.x;d.y=e.y;d.spatialReference=e.spatialReference;a.scale=b.scale;a.rotation=b.rotation;return a}function I(a,b,d){return d?n.vec2.set(a,.5*(b[0]-d.right+d.left),.5*(b[1]-d.bottom+d.top)):n.vec2.scale(a,b,.5)}function L(b,d,e,f){a.getTransform(b,d,e,f);return m.mat2d.invert(b,b)}function R(a,b,d){var e=Q(b);b=Math.abs(Math.cos(e));e=Math.abs(Math.sin(e));return n.vec2.set(a,Math.round(d[1]*e+d[0]*b),Math.round(d[1]*b+d[0]*e))}function M(a){var b=a.scale;a=a.targetGeometry.spatialReference;
a=z.isValid(a)?1/(39.37*p.getMetersPerUnitForSR(a)*96):1;return b*a}function Q(a){return d.common.toRadian(a.rotation)||0}function N(a){return z.isValid(a)?39.37*p.getMetersPerUnitForSR(a)*96:1}function U(a){return a.isWrappable?(a=z.getInfo(a),a.valid[1]-a.valid[0]):0}Object.defineProperty(a,"__esModule",{value:!0});var V=b.wgs84Radius,S=180/Math.PI;a.extentToScale=F;a.create=K;a.copy=G;a.getAnchor=I;a.getExtent=function(){var a=u.vec2f64.create();return function(b,d,e){var f=d.targetGeometry;E(a,
f);d=.5*M(d);b.xmin=a[0]-d*e[0];b.ymin=a[1]-d*e[1];b.xmax=a[0]+d*e[0];b.ymax=a[1]+d*e[1];b.spatialReference=f.spatialReference;return b}}();a.setExtent=function(b,d,e,f,c){a.centerAt(b,d,e.center);b.scale=F(e,f);c&&c.constraints&&c.constraints.constrain(b);return b};a.getOuterExtent=function(){var a=u.vec2f64.create(),b=u.vec2f64.create();return function(d,e,f){E(a,e.targetGeometry);R(b,e,f);f=.5*M(e);d.set({xmin:a[0]-f*b[0],ymin:a[1]-f*b[1],xmax:a[0]+f*b[0],ymax:a[1]+f*b[1],spatialReference:e.targetGeometry.spatialReference});
return d}}();a.getOuterSize=R;a.getPaddingScreenTranslation=function(){var a=u.vec2f64.create();return function(b,d,e){return n.vec2.sub(b,n.vec2.scale(b,d,.5),I(a,d,e))}}();a.getPaddingMapTranslation=function(){var b=r.mat2df64.create(),d=u.vec2f64.create();return function(e,f,c,h){var p=M(f);f=Q(f);n.vec2.set(d,p,p);m.mat2d.fromScaling(b,d);m.mat2d.rotate(b,b,f);m.mat2d.translate(b,b,a.getPaddingScreenTranslation(d,c,h));m.mat2d.translate(b,b,[0,h.top-h.bottom]);return n.vec2.set(e,b[4],b[5])}}();
a.getResolution=M;a.getResolutionToScaleFactor=N;a.getMatrix=function(){var a=u.vec2f64.create(),b=u.vec2f64.create(),d=u.vec2f64.create();return function(e,f,c,h,p,g){n.vec2.negate(a,f);n.vec2.scale(b,c,.5*g);n.vec2.set(d,1/h*g,-1/h*g);m.mat2d.identity(e);m.mat2d.translate(e,e,b);p&&m.mat2d.rotate(e,e,p);m.mat2d.scale(e,e,d);m.mat2d.translate(e,e,a);return e}}();a.getTransform=function(){var b=u.vec2f64.create();return function(d,e,f,c){var m=M(e),n=Q(e);E(b,e.targetGeometry);return a.getMatrix(d,
b,f,m,n,c)}}();a.getTransformNoRotation=function(){var b=u.vec2f64.create();return function(d,e,f,c){var m=M(e);E(b,e.targetGeometry);return a.getMatrix(d,b,f,m,0,c)}}();a.getWorldWidth=U;a.getWorldScreenWidth=function(a,b){return Math.round(U(a)/b)};a.createAsync=function(a,b){return K(a,b)};a.angleBetween=function(){var a=u.vec2f64.create(),b=u.vec2f64.create(),d=[0,0,0];return function(e,f,c){n.vec2.subtract(a,e,f);n.vec2.normalize(a,a);n.vec2.subtract(b,e,c);n.vec2.normalize(b,b);n.vec2.cross(d,
a,b);e=Math.acos(n.vec2.dot(a,b)/(n.vec2.length(a)*n.vec2.length(b)))*S;0>d[2]&&(e=-e);isNaN(e)&&(e=0);return e}}();a.addPadding=function(){var b=u.vec2f64.create();return function(d,e,f,c){var m=d.targetGeometry;G(d,e);a.getPaddingMapTranslation(b,e,f,c);m.x+=b[0];m.y+=b[1];return d}}();a.removePadding=function(){var b=u.vec2f64.create();return function(d,e,f,c){var m=d.targetGeometry;G(d,e);a.getPaddingMapTranslation(b,e,f,c);m.x-=b[0];m.y-=b[1];return d}}();a.centerAt=function(){var a=u.vec2f64.create();
return function(b,d,e){G(b,d);d=b.targetGeometry;var f=B(e),c=B(d);E(a,e);D(a,a,f,c);d.x=a[0];d.y=a[1];return b}}();a.pixelSizeAt=function(a,b){return M(b)};a.resize=function(){var b=u.vec2f64.create();return function(d,e,f,c,m){m||(m="center");n.vec2.sub(b,f,c);n.vec2.scale(b,b,.5);f=b[0];c=b[1];switch(m){case "center":n.vec2.set(b,0,0);break;case "left":n.vec2.set(b,-f,0);break;case "top":n.vec2.set(b,0,c);break;case "right":n.vec2.set(b,f,0);break;case "bottom":n.vec2.set(b,0,-c);break;case "top-left":n.vec2.set(b,
-f,c);break;case "bottom-left":n.vec2.set(b,-f,-c);break;case "top-right":n.vec2.set(b,f,c);break;case "bottom-right":n.vec2.set(b,f,-c)}a.translateBy(d,e,b);return d}}();a.rotateBy=function(a,b,d){G(a,b);a.rotation+=d;return a};a.rotateTo=function(a,b,d){G(a,b);a.rotation=d;return a};a.scaleBy=function(){var b=u.vec2f64.create();return function(d,e,f,c,m){G(d,e);isNaN(f)||0===f||(a.toMap(b,c,e,m),d.scale=e.scale*f,a.toScreen(b,b,d,m),a.translateBy(d,d,n.vec2.set(b,b[0]-c[0],c[1]-b[1])));return d}}();
a.scaleTo=function(a,b,d){G(a,b);a.scale=d;return a};a.scaleAndRotateBy=function(){var b=u.vec2f64.create();return function(d,e,f,c,m,h){G(d,e);isNaN(f)||0===f||(a.toMap(b,m,e,h),d.scale=e.scale*f,d.rotation+=c,a.toScreen(b,b,d,h),a.translateBy(d,d,n.vec2.set(b,b[0]-m[0],m[1]-b[1])));return d}}();a.padAndScaleAndRotateBy=function(){var b=u.vec2f64.create(),d=u.vec2f64.create();return function(e,f,c,m,h,p,g){a.getPaddingScreenTranslation(d,p,g);n.vec2.add(b,h,d);return m?a.scaleAndRotateBy(e,f,c,m,
b,p):a.scaleBy(e,f,c,b,p)}}();a.toMap=function(){var a=r.mat2df64.create();return function(b,d,e,f){return n.vec2.transformMat2d(b,d,L(a,e,f,1))}}();a.toScreen=function(){var b=r.mat2df64.create();return function(d,e,f,c){return n.vec2.transformMat2d(d,e,a.getTransform(b,f,c,1))}}();a.translateBy=function(){var a=u.vec2f64.create(),b=r.mat2df64.create();return function(d,e,f){G(d,e);var c=M(e),h=d.targetGeometry;m.mat2d.fromRotation(b,Q(e));m.mat2d.scale(b,b,u.vec2f64.fromValues(c,c));n.vec2.transformMat2d(a,
f,b);h.x+=a[0];h.y+=a[1];return d}}()})},"esri/core/Collection":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./ArrayPool ./arrayUtils ./Evented ./lang ./ObjectPool ./scheduling ./accessorSupport/decorators ./accessorSupport/ensureType".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m){function r(a){return a?a instanceof D?a.toArray():a.length?Array.prototype.slice.apply(a):[]:[]}function n(a){if(a&&a.length)return a[0]}function u(a,b,d,e){b&&b.forEach(function(b,
f,c){a.push(b);u(a,d.call(e,b,f,c),d,e)})}c=function(){function a(){this.target=null;this.defaultPrevented=this.cancellable=!1}a.prototype.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};a.prototype.reset=function(a){this.defaultPrevented=!1;this.item=a};return a}();var y=function(){},w=new p(c,!0,function(a){a.item=null;a.target=null}),t=new Set,v=new Set,z=new Set,A=new Map,C=0,D=function(a){function f(b){b=a.call(this,b)||this;b._chgListeners=[];b._notifications=null;b._timer=
null;b.length=0;b._items=[];Object.defineProperty(b,"uid",{value:C++});return b}l(f,a);c=f;f.isCollection=function(a){return null!=a&&a instanceof c};f.prototype.normalizeCtorArgs=function(a){return a?Array.isArray(a)||a instanceof c?{items:a}:a:{}};Object.defineProperty(f.prototype,"items",{get:function(){return this._items},set:function(a){this._emitBeforeChanges(1)||(this._splice.apply(this,[0,this.length].concat(r(a))),this._emitAfterChanges(1))},enumerable:!0,configurable:!0});f.prototype.hasEventListener=
function(a){return"change"===a?0<this._chgListeners.length:this._emitter.hasEventListener(a)};f.prototype.on=function(a,b){if("change"===a){var d=this._chgListeners,e={removed:!1,callback:b};d.push(e);this._notifications&&this._notifications.push({listeners:d.slice(),items:this._items.slice(),changes:[]});return{remove:function(){this.remove=y;e.removed=!0;d.splice(d.indexOf(e),1)}}}return this._emitter.on(a,b)};f.prototype.once=function(a,b){var d=this.on(a,b);return{remove:function(){d.remove()}}};
f.prototype.add=function(a,b){if(this._emitBeforeChanges(1))return this;b=this.getNextIndex(b);this._splice(b,0,a);this._emitAfterChanges(1);return this};f.prototype.addMany=function(a,b){void 0===b&&(b=this._items.length);if(!a||!a.length||this._emitBeforeChanges(1))return this;b=this.getNextIndex(b);this._splice.apply(this,[b,0].concat(r(a)));this._emitAfterChanges(1);return this};f.prototype.removeAll=function(){if(!this.length||this._emitBeforeChanges(2))return[];var a=this._splice(0,this.length)||
[];this._emitAfterChanges(2);return a};f.prototype.clone=function(){return this._createNewInstance({items:this._items.map(e.clone)})};f.prototype.concat=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var d,a=a.map(r);return this._createNewInstance({items:(d=this._items).concat.apply(d,a)})};f.prototype.drain=function(a,b){if(this.length&&!this._emitBeforeChanges(2)){for(var d=this._splice(0,this.length),e=d.length,f=0;f<e;f++)a.call(b,d[f],f,d);this._emitAfterChanges(2)}};f.prototype.every=
function(a,b){return this._items.every(a,b)};f.prototype.filter=function(a,b){var d;d=2===arguments.length?this._items.filter(a,b):this._items.filter(a);return this._createNewInstance({items:d})};f.prototype.find=function(a,b){return h.find(this._items,a,b)};f.prototype.findIndex=function(a,b){return h.findIndex(this._items,a,b)};f.prototype.flatten=function(a,b){var d=[];u(d,this,a,b);return new c(d)};f.prototype.forEach=function(a,b){return this._items.forEach(a,b)};f.prototype.getItemAt=function(a){return this._items[a]};
f.prototype.getNextIndex=function(a){var b=this.length;a=null==a?b:a;0>a?a=0:a>b&&(a=b);return a};f.prototype.includes=function(a,b){void 0===b&&(b=0);return arguments.length?-1!==this._items.indexOf(a,b):!1};f.prototype.indexOf=function(a,b){void 0===b&&(b=0);return this._items.indexOf(a,b)};f.prototype.join=function(a){void 0===a&&(a=",");return this._items.join(a)};f.prototype.lastIndexOf=function(a,b){void 0===b&&(b=this.length-1);return this._items.lastIndexOf(a,b)};f.prototype.map=function(a,
b){a=this._items.map(a,b);return new c({items:a})};f.prototype.reorder=function(a,b){void 0===b&&(b=this.length-1);var d=this.indexOf(a);if(-1!==d){0>b?b=0:b>=this.length&&(b=this.length-1);if(d!==b){if(this._emitBeforeChanges(4))return a;this._splice(d,1);this._splice(b,0,a);this._emitAfterChanges(4)}return a}};f.prototype.pop=function(){if(this.length&&!this._emitBeforeChanges(2)){var a=n(this._splice(this.length-1,1));this._emitAfterChanges(2);return a}};f.prototype.push=function(){for(var a=[],
b=0;b<arguments.length;b++)a[b]=arguments[b];if(this._emitBeforeChanges(1))return this.length;this._splice.apply(this,[this.length,0].concat(a));this._emitAfterChanges(1);return this.length};f.prototype.reduce=function(a,b){var d=this._items;return 2===arguments.length?d.reduce(a,b):d.reduce(a)};f.prototype.reduceRight=function(a,b){var d=this._items;return 2===arguments.length?d.reduceRight(a,b):d.reduceRight(a)};f.prototype.remove=function(a){return this.removeAt(this.indexOf(a))};f.prototype.removeAt=
function(a){if(!(0>a||a>=this.length||this._emitBeforeChanges(2)))return a=n(this._splice(a,1)),this._emitAfterChanges(2),a};f.prototype.removeMany=function(a){if(!a||!a.length||this._emitBeforeChanges(2))return[];a=a instanceof c?a.toArray():a;for(var b=this._items,d=[],e=a.length,f=0;f<e;f++){var m=b.indexOf(a[f]);if(-1<m){for(var n=f+1,h=m+1,p=Math.min(a.length-n,b.length-h),g=0;g<p&&a[n+g]===b[h+g];)g++;n=1+g;(m=this._splice(m,n))&&0<m.length&&d.push.apply(d,m);f+=n-1}}this._emitAfterChanges(2);
return d};f.prototype.reverse=function(){if(this._emitBeforeChanges(4))return this;var a=this._splice(0,this.length);a&&(a.reverse(),this._splice.apply(this,[0,0].concat(a)));this._emitAfterChanges(4);return this};f.prototype.shift=function(){if(this.length&&!this._emitBeforeChanges(2)){var a=n(this._splice(0,1));this._emitAfterChanges(2);return a}};f.prototype.slice=function(a,b){void 0===a&&(a=0);void 0===b&&(b=this.length);return this._createNewInstance({items:this._items.slice(a,b)})};f.prototype.some=
function(a,b){return this._items.some(a,b)};f.prototype.sort=function(a){if(!this.length||this._emitBeforeChanges(4))return this;var b=this._splice(0,this.length);arguments.length?b.sort(a):b.sort();this._splice.apply(this,[0,0].concat(b));this._emitAfterChanges(4);return this};f.prototype.splice=function(a,b){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];e=(b?2:0)|(d.length?1:0);if(this._emitBeforeChanges(e))return[];d=this._splice.apply(this,[a,b].concat(d))||[];this._emitAfterChanges(e);
return d};f.prototype.toArray=function(){return this._items.slice()};f.prototype.toJSON=function(){return this.toArray()};f.prototype.toLocaleString=function(){return this._items.toLocaleString()};f.prototype.toString=function(){return this._items.toString()};f.prototype.unshift=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(!a.length||this._emitBeforeChanges(1))return this.length;this._splice.apply(this,[0,0].concat(a));this._emitAfterChanges(1);return this.length};f.prototype._createNewInstance=
function(a){return new this.constructor(a)};f.prototype._splice=function(a,d){for(var e=this,f=[],c=2;c<arguments.length;c++)f[c-2]=arguments[c];var c=this._items,m=this.constructor.prototype.itemType,n,h;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=b.schedule(function(){return e._dispatchChange()}));if(d){h=c.splice(a,d);if(this.hasEventListener("before-remove")){var p=
w.acquire();p.target=this;p.cancellable=!0;for(var g=0,r=h.length;g<r;g++)n=h[g],p.reset(n),this.emit("before-remove",p),p.defaultPrevented&&(h.splice(g,1),c.splice(a,0,n),a+=1,--g,--r);w.release(p)}this.length=this._items.length;if(this.hasEventListener("after-remove")){n=w.acquire();n.target=this;n.cancellable=!1;r=h.length;for(g=0;g<r;g++)n.reset(h[g]),this.emit("after-remove",n);w.release(n)}}if(f&&f.length){if(m){g=[];for(r=0;r<f.length;r++)n=f[r],p=m.ensureType(n),null==p&&null!=n||g.push(p);
f=g}m=this.hasEventListener("before-add");g=this.hasEventListener("after-add");r=a===this.length;if(m||g){n=w.acquire();n.target=this;n.cancellable=!0;p=w.acquire();p.target=this;p.cancellable=!1;for(var k=0,u=f;k<u.length;k++){var t=u[k];m?(n.reset(t),this.emit("before-add",n),n.defaultPrevented||(r?c.push(t):c.splice(a++,0,t),this._set("length",c.length),g&&(p.reset(t),this.emit("after-add",p)))):(r?c.push(t):c.splice(a++,0,t),this._set("length",c.length),p.reset(t),this.emit("after-add",p))}w.release(p);
w.release(n)}else r?c.push.apply(c,f):c.splice.apply(c,[a,0].concat(f)),this._set("length",c.length)}(f&&f.length||h&&h.length)&&this._notifyChangeEvent(f,h);return h};f.prototype._emitBeforeChanges=function(a){var b=!1;if(this.hasEventListener("before-changes")){var d=w.acquire();d.target=this;d.cancellable=!0;d.type=a;this.emit("before-changes",d);b=d.defaultPrevented;w.release(d)}return b};f.prototype._emitAfterChanges=function(a){if(this.hasEventListener("after-changes")){var b=w.acquire();b.target=
this;b.cancellable=!1;b.type=a;this.emit("after-changes",b);w.release(b)}};f.prototype._notifyChangeEvent=function(a,b){this.hasEventListener("change")&&this._notifications[this._notifications.length-1].changes.push({added:a,removed:b})};f.prototype._dispatchChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var a=this._notifications;this._notifications=null;for(var b=function(a){var b=a.changes;t.clear();v.clear();z.clear();for(var e=0;e<b.length;e++){var f=
b[e],c=f.added,f=f.removed;if(c)if(0===z.size&&0===v.size)for(var m=0,n=c;m<n.length;m++)c=n[m],t.add(c);else for(m=0,n=c;m<n.length;m++)c=n[m],v.has(c)?(z.add(c),v.delete(c)):z.has(c)||t.add(c);if(f)if(0===z.size&&0===t.size)for(m=0;m<f.length;m++)c=f[m],v.add(c);else for(m=0;m<f.length;m++)c=f[m],t.has(c)?t.delete(c):(z.delete(c),v.add(c))}var h=k.acquire();t.forEach(function(a){h.push(a)});var p=k.acquire();v.forEach(function(a){p.push(a)});var g=d._items,r=a.items,u=k.acquire();z.forEach(function(a){r.indexOf(a)!==
g.indexOf(a)&&u.push(a)});if(a.listeners&&(h.length||p.length||u.length))for(b={target:d,added:h,removed:p,moved:u},e=a.listeners.length,c=0;c<e;c++)f=a.listeners[c],f.removed||f.callback.call(d,b);k.release(h);k.release(p);k.release(u)},d=this,e=0;e<a.length;e++)b(a[e]);t.clear();v.clear();z.clear()}};var c;f.ofType=function(a){if(!a)return c;if(A.has(a))return A.get(a);var b;if("function"===typeof a)b=a.prototype.declaredClass;else if(a.base)b=a.base.prototype.declaredClass;else for(var e in a.typeMap){var f=
a.typeMap[e].prototype.declaredClass;b=b?b+(" | "+f):f}e=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}l(e,a);return e=g([d.subclass("esri.core.Collection\x3c"+b+"\x3e")],e)}(d.declared(c));f={Type:a,ensureType:"function"===typeof a?m.ensureType(a):m.ensureOneOfType(a)};Object.defineProperty(e.prototype,"itemType",{value:f});A.set(a,e);return e};g([d.property()],f.prototype,"length",void 0);g([d.property()],f.prototype,"items",null);return f=c=g([d.subclass("esri.core.Collection")],
f)}(d.declared(f.EventedAccessor));return D})},"esri/core/Evented":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./accessorSupport/decorators ./accessorSupport/utils".split(" "),function(c,a,l,g,k,h,f){var e=function(){function a(b){this._emitter=new a.EventEmitter(this);this._emitter=new a.EventEmitter(b&&void 0!==b.target?b.target:this)}a.prototype.emit=function(a,d){return this._emitter.emit(a,d)};a.prototype.on=function(a,d){return this._emitter.on(a,
d)};a.prototype.once=function(a,d){return this._emitter.once(a,d)};a.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};return a}();(function(a){var b=function(){function a(a){this.target=a}a.prototype.clear=function(){this._listenersMap&&this._listenersMap.clear()};a.prototype.emit=function(a,b){var d=this;a=this._listenersMap&&this._listenersMap.get(a);if(!a)return!1;b=b||{};if(!b.target&&this.target||b.target&&!this.target)b.target=this.target;a.slice().forEach(function(a){a.call(d.target,
b)});return 0<a.length};a.prototype.on=function(a,b){var d=this;if(Array.isArray(a)){var e=a.map(function(a){return d.on(a,b)});return f.handlesGroup(e)}if(-1<a.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);e=this._listenersMap.get(a)||[];e.push(b);this._listenersMap.set(a,e);return{remove:function(){var e=d._listenersMap&&d._listenersMap.get(a)||[];0<=e.indexOf(b)&&e.splice(e.indexOf(b),
1)}}};a.prototype.once=function(a,b){var d=this,e;return e=this.on(a,function(a){e.remove();b.call(d.target,a)})};a.prototype.hasEventListener=function(a){a=this._listenersMap&&this._listenersMap.get(a);return null!=a&&0<a.length};return a}();a.EventEmitter=b;a.EventedMixin=function(a){return function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._emitter=new b(d);return d}l(d,a);d.prototype.emit=function(a,b){return this._emitter.emit(a,b)};d.prototype.on=function(a,b){return this._emitter.on(a,
b)};d.prototype.once=function(a,b){return this._emitter.once(a,b)};d.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};return d=g([h.subclass("esri.core.Evented")],d)}(h.declared(a))};var d=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._emitter=new e.EventEmitter(b);return b}l(b,a);b.prototype.emit=function(a,b){return this._emitter.emit(a,b)};b.prototype.on=function(a,b){return this._emitter.on(a,b)};b.prototype.once=function(a,b){return this._emitter.once(a,
b)};b.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};return b=g([h.subclass("esri.core.Evented")],b)}(h.declared(k));a.EventedAccessor=d})(e||(e={}));return e})},"esri/views/2d/layers/features/controllers":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/promiseUtils".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,
"__esModule",{value:!0});a.loadControllerModule=function(a){switch(a){case "on-demand":return f.create(function(a){return c(["./controllers/OnDemandController"],a)});case "stream":return f.create(function(a){return c(["./controllers/StreamController"],a)});default:return f.reject(new h("mapview-controller:bad-type","Unable to create controller for unknown type: "+a))}}})},"esri/views/2d/layers/features/processors":function(){define(["require","exports","../../../../core/tsSupport/assignHelper","../../../../core/promiseUtils"],
function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.loadProcessorModule=function(a){return"heatmap"===a?g.create(function(a){return c(["./processors/HeatmapProcessor"],a)}):g.create(function(a){return c(["./processors/SymbolProcessor"],a)})}})},"esri/views/2d/layers/features/support/TileStore":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Evented ../../../../../core/has ../../../../../core/libs/rbush/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});var d={added:[],removed:[]},m=new Set,r=new b(0,0,0,0);c=function(a){function b(b){var d=a.call(this)||this;d._tiles=new Map;d._index=f(9,h("csp-restrictions")?function(a){return{minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);d.tiles=[];d.tileScheme=b;return d}l(b,a);b.prototype.destroy=function(){this._tiles.clear()};b.prototype.has=function(a){return this._tiles.has(a)};
b.prototype.get=function(a){return this._tiles.get(a)};b.prototype.findByKey=function(a){return this._tiles.get(a.id)};b.prototype.intersections=function(a,b){var d="string"===typeof a?this.get(a):a;if(!d)return[];var e=b*d.resolution;b=d.bounds[0]-e;a=d.bounds[1]-e;for(var f=d.bounds[2]+e,d=d.bounds[3]+e,e=[],c=0,m=this._index.search({minX:b,minY:a,maxX:f,maxY:d});c<m.length;c++){var n=m[c],h=n.bounds.slice();h[0]=Math.max(h[0],b);h[1]=Math.max(h[1],a);h[2]=Math.min(h[2],f);h[3]=Math.min(h[3],d);
0<h[2]-h[0]&&0<h[3]-h[1]&&e.push({bounds:h,tile:n})}return e};b.prototype.boundsIntersections=function(a){return this._index.search({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]})};b.prototype.setViewState=function(a){if(a=this.tileScheme.getTileCoverage(a,0)){var b=a.spans,f=a.lodInfo,c=f.level;if(0<b.length)for(var h=0;h<b.length;h++)for(var n=b[h],g=n.row,k=n.colTo,u=n.colFrom;u<=k;u++){var y=r.set(c,g,f.normalizeCol(u),f.getWorldForColumn(u)).id;m.add(y);this.has(y)||(n=new e.default(this.tileScheme,
y),this._tiles.set(y,n),this._index.insert(n),this.tiles.push(n),d.added.push(n))}for(b=this.tiles.length-1;0<=b;b--)n=this.tiles[b],m.has(n.id)||(this._tiles.delete(n.id),this.tiles.splice(b,1),this._index.remove(n),d.removed.push(n));(d.added.length||d.removed.length)&&this.emit("update",d);p.pool.release(a);m.clear();d.added.length=0;d.removed.length=0}};return b}(k);a.default=c})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(c){function a(b,d){if(!(this instanceof
a))return new a(b,d);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));d&&("function"===typeof d?this.toBBox=d:this._initFormat(d));this.clear()}function l(a,b){g(a,0,a.children.length,b,a)}function g(a,b,d,e,f){f||(f=m(null));f.minX=Infinity;f.minY=Infinity;f.maxX=-Infinity;f.maxY=-Infinity;for(var c;b<d;b++)c=a.children[b],k(f,a.leaf?e(c):c);return f}function k(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);
a.maxY=Math.max(a.maxY,b.maxY);return a}function h(a,b){return a.minX-b.minX}function f(a,b){return a.minY-b.minY}function e(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function p(a){return a.maxX-a.minX+(a.maxY-a.minY)}function b(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function d(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function m(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function r(a,
b,d,e,f){for(var m=[b,d],h;m.length;)d=m.pop(),b=m.pop(),d-b<=e||(h=b+Math.ceil((d-b)/e/2)*e,c(a,h,b,d,f),m.push(b,h,h,d))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var e=this.data,f=[],c=this.toBBox;if(!d(a,e))return f;for(var m=[],h,n,g,p;e;){h=0;for(n=e.children.length;h<n;h++)g=e.children[h],p=e.leaf?c(g):g,d(a,p)&&(e.leaf?f.push(g):b(a,p)?this._all(g,f):m.push(g));e=m.pop()}return f},collides:function(a){var e=this.data,f=this.toBBox;if(!d(a,e))return!1;for(var c=
[],m,h,n,g;e;){m=0;for(h=e.children.length;m<h;m++)if(n=e.children[m],g=e.leaf?f(n):n,d(a,g)){if(e.leaf||b(a,g))return!0;c.push(n)}e=c.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,d=a.length;b<d;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-
a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=m([]);return this},remove:function(a,d){if(!a)return this;for(var e=this.data,f=this.toBBox(a),c=[],m=[],h,n,g,p;e||c.length;){e||(e=c.pop(),n=c[c.length-1],h=m.pop(),p=!0);if(e.leaf){a:{g=a;var r=e.children,k=d;if(k){for(var u=0;u<r.length;u++)if(k(g,r[u])){g=u;break a}g=-1}else g=r.indexOf(g)}if(-1!==g){e.children.splice(g,1);c.push(e);this._condense(c);break}}p||
e.leaf||!b(e,f)?n?(h++,e=n.children[h],p=!1):e=null:(c.push(e),m.push(h),h=0,n=e,e=e.children[0])}return this},toBBox:function(a){return a},compareMinX:h,compareMinY:f,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var d=[];a;)a.leaf?b.push.apply(b,a.children):d.push.apply(d,a.children),a=d.pop();return b},_build:function(a,b,d,e){var f=d-b+1,c=this._maxEntries,h;if(f<=c)return h=m(a.slice(b,d+1)),l(h,this.toBBox),h;e||(e=Math.ceil(Math.log(f)/
Math.log(c)),c=Math.ceil(f/Math.pow(c,e-1)));h=m([]);h.leaf=!1;h.height=e;var f=Math.ceil(f/c),c=f*Math.ceil(Math.sqrt(c)),n,g,p;for(r(a,b,d,c,this.compareMinX);b<=d;b+=c)for(g=Math.min(b+c-1,d),r(a,b,g,f,this.compareMinY),n=b;n<=g;n+=f)p=Math.min(n+f-1,g),h.children.push(this._build(a,n,p,e-1));l(h,this.toBBox);return h},_chooseSubtree:function(a,b,d,f){for(var c,m,h,n,g,p,r,k;;){f.push(b);if(b.leaf||f.length-1===d)break;r=k=Infinity;c=0;for(m=b.children.length;c<m;c++)h=b.children[c],g=e(h),p=(Math.max(h.maxX,
a.maxX)-Math.min(h.minX,a.minX))*(Math.max(h.maxY,a.maxY)-Math.min(h.minY,a.minY))-g,p<k?(k=p,r=g<r?g:r,n=h):p===k&&g<r&&(r=g,n=h);b=n||b.children[0]}return b},_insert:function(a,b,d){var e=this.toBBox;d=d?a:e(a);var e=[],f=this._chooseSubtree(d,this.data,b,e);f.children.push(a);for(k(f,d);0<=b;)if(e[b].children.length>this._maxEntries)this._split(e,b),b--;else break;this._adjustParentBBoxes(d,e,b)},_split:function(a,b){var d=a[b],e=d.children.length,f=this._minEntries;this._chooseSplitAxis(d,f,e);
e=this._chooseSplitIndex(d,f,e);e=m(d.children.splice(e,d.children.length-e));e.height=d.height;e.leaf=d.leaf;l(d,this.toBBox);l(e,this.toBBox);b?a[b-1].children.push(e):this._splitRoot(d,e)},_splitRoot:function(a,b){this.data=m([a,b]);this.data.height=a.height+1;this.data.leaf=!1;l(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,d){var f,c,m,h,n,p,r;n=p=Infinity;for(f=b;f<=d-b;f++)c=g(a,0,f,this.toBBox),m=g(a,f,d,this.toBBox),h=Math.max(0,Math.min(c.maxX,m.maxX)-Math.max(c.minX,m.minX))*Math.max(0,
Math.min(c.maxY,m.maxY)-Math.max(c.minY,m.minY)),c=e(c)+e(m),h<n?(n=h,r=f,p=c<p?c:p):h===n&&c<p&&(p=c,r=f);return r},_chooseSplitAxis:function(a,b,d){var e=a.leaf?this.compareMinX:h,c=a.leaf?this.compareMinY:f,m=this._allDistMargin(a,b,d,e);b=this._allDistMargin(a,b,d,c);m<b&&a.children.sort(e)},_allDistMargin:function(a,b,d,e){a.children.sort(e);e=this.toBBox;var f=g(a,0,b,e),c=g(a,d-b,d,e),m=p(f)+p(c),h,n;for(h=b;h<d-b;h++)n=a.children[h],k(f,a.leaf?e(n):n),m+=p(f);for(h=d-b-1;h>=b;h--)n=a.children[h],
k(c,a.leaf?e(n):n),m+=p(c);return m},_adjustParentBBoxes:function(a,b,d){for(;0<=d;d--)k(b[d],a)},_condense:function(a){for(var b=a.length-1,d;0<=b;b--)0===a[b].children.length?0<b?(d=a[b-1].children,d.splice(d.indexOf(a[b]),1)):this.clear():l(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+
a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function c(g,k,h,f,e){for(;f>h;){if(600<f-h){var p=f-h+1,b=k-h+1,d=Math.log(p),m=.5*Math.exp(2*d/3),d=.5*Math.sqrt(d*m*(p-m)/p)*(0>b-p/2?-1:1);c(g,k,Math.max(h,Math.floor(k-b*m/p+d)),Math.min(f,Math.floor(k+(p-b)*m/p+d)),e)}p=g[k];b=h;m=f;a(g,h,k);for(0<e(g[f],p)&&a(g,h,f);b<m;){a(g,b,m);b++;for(m--;0>e(g[b],p);)b++;for(;0<e(g[m],p);)m--}0===e(g[h],p)?a(g,h,m):(m++,a(g,m,f));m<=k&&(h=
m+1);k<=m&&(f=m-1)}}function a(a,c,h){var f=a[c];a[c]=a[h];a[h]=f}function l(a,c){return a<c?-1:a>c?1:0}return function(a,k,h,f,e){c(a,k,h||0,f||a.length-1,e||l)}})},"esri/views/2d/layers/features/support/Tile":function(){define("require exports ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),function(c,a,l,g,k,h,f){function e(a,b){var d=a.bounds,e=b.bounds;
return a.key.id!==b.key.id&&a.key.world===b.key.world&&d[0]<=e[0]&&d[1]<=e[1]&&d[2]>=e[2]&&d[3]>=e[3]}Object.defineProperty(a,"__esModule",{value:!0});a.isParentOf=e;a.isChildOf=function(a,b){return e(b,a)};c=function(){function a(a,d){this.bounds=k.create();this.key=new f(0,0,0,0);this.objectIds=new Set;this.key.set(d);d=a.getLODInfoAt(this.key);this.tileInfoView=a;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=d.resolution;this.scale=d.scale;this.level=d.level;this.needsClear=
!0}Object.defineProperty(a.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"extent",{get:function(){return g.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0});a.prototype.clone=
function(){return new a(this.tileInfoView,this.id)};a.prototype.createChildTiles=function(){for(var b=this.key.getChildKeys(),d=l.acquire(),e=0;e<b.length;e++)d[e]=new a(this.tileInfoView,b[e]);return d};a.prototype.getQuantizationParameters=function(){return h.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};return a}();
a.Tile=c;a.default=c})},"esri/tasks/support/QuantizationParameters":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});var b=new h.default({upperLeft:"upper-left",lowerLeft:"lower-left"});c=function(a){function d(b){b=a.call(this,b)||this;
b.extent=null;b.mode="view";b.originPosition="upper-left";b.tolerance=1;return b}l(d,a);f=d;d.prototype.clone=function(){return new f(e.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};var f;g([p.property({type:k.Extent,json:{write:!0}})],d.prototype,"extent",void 0);g([p.property({type:["view","edit"],json:{write:!0}})],d.prototype,"mode",void 0);g([p.property({type:String,json:{read:b.read,write:b.write}})],d.prototype,"originPosition",void 0);
g([p.property({type:Number,json:{write:!0}})],d.prototype,"tolerance",void 0);return d=f=g([p.subclass("esri.tasks.support.QuantizationParameters")],d)}(p.declared(f.JSONSupport));a.default=c})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(c,a,l){return function(){function a(a,c,f,e){this.set(a,c,f,e)}a.getId=function(a,c,f,e){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+c+"/"+f+"/"+e};Object.defineProperty(a.prototype,
"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});a.prototype.equals=function(a){return this.level===a.level&&this.row===a.row&&this.col===a.col&&this.world===a.world};a.prototype.release=function(){this.world=this.col=this.row=this.level=0};a.prototype.set=function(a,c,f,e){null==a?this.world=this.col=this.row=this.level=0:"object"===typeof a?(this.level=a.level||0,this.row=
a.row||0,this.col=a.col||0,this.world=a.world||0):"string"===typeof a?(a=a.split("/"),c=a[1],f=a[2],e=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(c),this.col=parseFloat(f),this.world=parseFloat(e)):(this.level=+a,this.row=+c,this.col=+f,this.world=+e||0);return this};a.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};a.prototype.getChildKeys=function(){var c=this.level+1,h=this.row<<1,f=this.col<<1,e=this.world;return[new a(c,h,f,e),new a(c,h,f+1,
e),new a(c,h+1,f,e),new a(c,h+1,f+1,e)]};a.prototype.compareRowMajor=function(a){return this.row<a.row?-1:this.row>a.row?1:this.col<a.col?-1:this.col>a.col?1:0};a.pool=new l(a,!0,null,25,50);return a}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ObjectPool"],function(c,a,l){return function(){function a(a){this.lodInfo=a;this.spans=[]}a.prototype.release=function(){};a.prototype.forEach=function(a,c){var f=this.spans,e=this.lodInfo,h=e.level;if(0!==
f.length)for(var b=0;b<f.length;b++)for(var d=f[b],m=d.row,g=d.colTo,d=d.colFrom;d<=g;d++)a.call(c,h,m,e.normalizeCol(d),e.getWorldForColumn(d))};a.pool=new l(a,!0);return a}()})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(c,a,l,g,k,h,f){var e=new h("0/0/0/0"),p=function(){function a(a,b,d,e,f,c,h,g){this.x=a;this.ymin=b;this.ymax=d;this.invM=e;this.leftAdjust=
f;this.rightAdjust=c;this.leftBound=h;this.rightBound=g}a.create=function(b,d){var e;b[1]>d[1]&&(e=[d,b],b=e[0],d=e[1]);e=b[0];b=b[1];var f=d[0];d=d[1];var c=f-e,h=d-b,h=0!==h?c/h:0,m=(Math.ceil(b)-b)*h,g=(Math.floor(b)-b)*h;return new a(e,Math.floor(b),Math.ceil(d),h,0>c?m:g,0>c?g:m,0>c?f:e,0>c?e:f)};a.prototype.incrRow=function(){this.x+=this.invM};a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+
this.rightAdjust,this.rightBound)};return a}(),b=[[0,0],[0,0],[0,0],[0,0]];return function(){function a(a,b){var d=this;this.tileInfo=a;this.fullExtent=b;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=a.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var f=this._lodInfos=e.map(function(d){return g.create(a,d,b)});e.forEach(function(a,b){d._infoByLevel[a.level]=f[b];d._infoByScale[a.scale]=f[b];d.scales[b]=a.scale},this);this._wrap=a.isWrappable}Object.defineProperty(a.prototype,
"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!0,configurable:!0});a.prototype.getLODInfoAt=function(a){return this._infoByLevel["number"===typeof a?a:a.level]};a.prototype.getTileBounds=function(a,b,d){void 0===d&&(d=!1);e.set(b);return(b=this._infoByLevel[e.level])?b.getTileBounds(a,e,d):a};a.prototype.getTileCoords=function(a,b,d){void 0===d&&(d=!1);e.set(b);return(b=this._infoByLevel[e.level])?b.getTileCoords(a,e,d):a};a.prototype.getTileCoverage=function(a,
d,e){void 0===d&&(d=192);void 0===e&&(e="closest");e="closest"===e?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);var c=k.pool.acquire(e),h=this._wrap,m;m=Infinity;var n=-Infinity,g,r,l=c.spans;b[0][0]=b[0][1]=b[1][1]=b[3][0]=-d;b[1][0]=b[2][0]=a.size[0]+d;b[2][1]=b[3][1]=a.size[1]+d;for(d=0;d<b.length;d++){var C=b[d];a.toMap(C,C);C[0]=e.getColumnForX(C[0]);C[1]=e.getRowForY(C[1])}a=[];C=3;for(d=0;4>d;d++){if(b[d][1]!==b[C][1]){var D=p.create(b[d],b[C]);m=Math.min(D.ymin,
m);n=Math.max(D.ymax,n);void 0===a[D.ymin]&&(a[D.ymin]=[]);a[D.ymin].push(D)}C=d}if(null==m||null==n||100<n-m)return null;for(C=[];m<n;){null!=a[m]&&(C=C.concat(a[m]));g=Infinity;r=-Infinity;for(d=C.length-1;0<=d;d--)D=C[d],g=Math.min(g,D.getLeftCol()),r=Math.max(r,D.getRightCol());g=Math.floor(g);r=Math.floor(r);if(m>=e.first[1]&&m<=e.last[1])if(h)if(e.size[0]<e.worldSize[0])for(D=Math.floor(r/e.worldSize[0]),d=Math.floor(g/e.worldSize[0]);d<=D;d++)l.push(new f(m,Math.max(e.getFirstColumnForWorld(d),
g),Math.min(e.getLastColumnForWorld(d),r)));else l.push(new f(m,g,r));else g>e.last[0]||r<e.first[0]||(g=Math.max(g,e.first[0]),r=Math.min(r,e.last[0]),l.push(new f(m,g,r)));m+=1;for(d=C.length-1;0<=d;d--)D=C[d],D.ymax>=m?D.incrRow():C.splice(d,1)}return c};a.prototype.getTileParentId=function(a){e.set(a);a=this._lodInfos.indexOf(this._infoByLevel[e.level])-1;if(0>a)return null;this._getTileIdAtLOD(e,this._lodInfos[a],e);return e.id};a.prototype.getTileResolution=function(a){return(a=this._infoByLevel["object"===
typeof a?a.level:a])?a.resolution:-1};a.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};a.prototype.intersects=function(a,b){e.set(b);b=this._infoByLevel[e.level];var d=a.lodInfo;if(d.resolution>b.resolution){this._getTileIdAtLOD(e,d,e);for(var f=d.denormalizeCol(e.col,e.world),c=0,h=a.spans;c<h.length;c++){var m=h[c];if(m.row===e.row&&m.colFrom<=f&&m.colTo>=f)return!0}}if(d.resolution<b.resolution){h=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],b.row);a[1]=
Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]);a=h[0];var f=h[1],c=h[2],h=h[3],g=b.denormalizeCol(e.col,e.world),m=d.getColumnForX(b.getXForColumn(g)),p=d.getRowForY(b.getYForRow(e.row)),g=d.getColumnForX(b.getXForColumn(g+1))-1;b=d.getRowForY(b.getYForRow(e.row+1))-1;return!(m>h||g<c||p>f||b<a)}var r=d.denormalizeCol(e.col,e.world);return a.spans.some(function(a){return a.row===e.row&&a.colFrom<=r&&a.colTo>=r})};a.prototype.normalizeBounds=
function(a,b,d){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];this._wrap&&(b=l.getInfo(this.tileInfo.spatialReference),d=-d*(b.valid[1]-b.valid[0]),a[0]+=d,a[2]+=d);return a};a.prototype.getSmallestInfoForScale=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a];if(a>b[0])return this._infoByScale[b[0]];for(var d=1;d<b.length-1;d++)if(a>b[d]+1E-6)return this._infoByScale[b[d-1]];return this._infoByScale[b[b.length-1]]};a.prototype.getClosestInfoForScale=function(a){var b=this.scales;
if(this._infoByScale[a])return this._infoByScale[a];a=b.reduce(function(b,d){return Math.abs(d-a)<Math.abs(b-a)?d:b},b[0]);return this._infoByScale[a]};a.prototype.scaleToLevel=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a].level;for(var d=b.length-1;0<=d;d--)if(a<b[d])return d===b.length-1?this._infoByScale[b[b.length-1]].level:this._infoByScale[b[d]].level+(b[d]-a)/(b[d]-b[d+1]);return this._infoByScale[b[0]].level};a.prototype.scaleToZoom=function(a){return this.tileInfo.scaleToZoom(a)};
a.prototype._getTileIdAtLOD=function(a,b,d){var e=this._infoByLevel[d.level];a.set(d);if(b.resolution<e.resolution)return null;if(b.resolution===e.resolution)return a;a.level=b.level;a.col=Math.floor(d.col*e.resolution/b.resolution+.01);a.row=Math.floor(d.row*e.resolution/b.resolution+.01);return a};return a}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(c,a,l,g){function k(a,e,c){a[0]=e;a[1]=c;return a}
var h=new g("0/0/0/0");return function(){function a(a,f,b,d,c,h,n,g,k,w,t,v){this.level=a;this.resolution=f;this.scale=b;this.origin=d;this.first=c;this.last=h;this.size=n;this.norm=g;this.worldStart=k;this.worldEnd=w;this.worldSize=t;this.wrap=v}a.create=function(e,f,b){var d=l.getInfo(e.spatialReference),c=[e.origin.x,e.origin.y],h=[e.size[0]*f.resolution,e.size[1]*f.resolution],n=[-Infinity,-Infinity],g=[Infinity,Infinity],p=[Infinity,Infinity];b&&(k(n,Math.max(0,Math.floor((b.xmin-c[0])/h[0])),
Math.max(0,Math.floor((c[1]-b.ymax)/h[1]))),k(g,Math.max(0,Math.floor((b.xmax-c[0])/h[0])),Math.max(0,Math.floor((c[1]-b.ymin)/h[1]))),k(p,g[0]-n[0]+1,g[1]-n[1]+1));var w;e.isWrappable?(e=[Math.ceil(Math.round(2*d.origin[1]/f.resolution)/e.size[0]),p[1]],d=[Math.floor((d.origin[0]-c[0])/h[0]),n[1]],b=[e[0]+d[0]-1,g[1]],w=!0):(d=n,b=g,e=p,w=!1);return new a(f.level,f.resolution,f.scale,c,n,g,p,h,d,b,e,w)};a.prototype.normalizeCol=function(a){if(!this.wrap)return a;var e=this.worldSize[0];return 0>
a?e-1-Math.abs((a+1)%e):a%e};a.prototype.denormalizeCol=function(a,f){return this.wrap?this.worldSize[0]*f+a:a};a.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};a.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};a.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};a.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};a.prototype.getXForColumn=
function(a){return this.origin[0]+a*this.norm[0]};a.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};a.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};a.prototype.getTileBounds=function(a,f,b){void 0===b&&(b=!1);h.set(f);var d=b?h.col:this.denormalizeCol(h.col,h.world),e=h.row;f=this.getXForColumn(d);b=this.getYForRow(e+1);d=this.getXForColumn(d+1);e=this.getYForRow(e);a[0]=f;a[1]=b;a[2]=d;a[3]=e;return a};a.prototype.getTileCoords=function(a,f,b){void 0===
b&&(b=!1);h.set(f);f=b?h.col:this.denormalizeCol(h.col,h.world);Array.isArray(a)?k(a,this.getXForColumn(f),this.getYForRow(h.row)):(a.x=this.getXForColumn(f),a.y=this.getYForRow(h.row));return a};return a}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(c,a,l){return function(){function a(a,c,f){this.row=a;this.colFrom=c;this.colTo=f}a.pool=new l(a,!0);return a}()})},"esri/views/2d/layers/features/controllers/OnDemandController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/ArrayPool ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/now ../../../../../core/promiseUtils ../../../../../core/watchUtils ../../../../../core/workers ../../../../../core/accessorSupport/decorators ../../../../../geometry/Extent ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../tasks/operations/query ../../../engine ./BaseController ./EditsQueue ../support/DataTile ../support/DataTileFeaturesIndex ../support/Tile ../support/TileUpdateQueue ../../../tiling/TileQueue".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B,E,F,H,J){Object.defineProperty(a,"__esModule",{value:!0});var K=d.getLogger("esri.views.2d.layers.features.controllers.OnDemandController");c=b("esri-featurelayer-webgl");b=b("esri-mobile");var G=c&&"object"===typeof c&&null!=c.maxDrillLevel?c.maxDrillLevel:b?1:4,I=c&&"object"===typeof c&&null!=c.maxRecordCountFactor?c.maxRecordCountFactor:b?1:3,L=c&&"object"===typeof c&&null!=c.enablePBFQuery?c.enablePBFQuery:!0,R=new Set,M=[],Q=function(){function a(a,
b){this.objectIdField=b;this.client=u.openWithPorts(a)}a.prototype.destroy=function(){this.client.close();this.client=null};a.prototype.executeQuery=function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){switch(e.label){case 0:return[4,this.client.invoke("queryFeatures",a.toJSON(),b)];case 1:return d=e.sent(),[2,v.convertFromFeatureSet(d,this.objectIdField)]}})})};return a}(),N=function(){function a(a){this.source=a}a.prototype.destroy=function(){};a.prototype.executeQuery=
function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){switch(e.label){case 0:return[4,z.executeQueryPBF(this.source,a,{type:"optimized"},b)];case 1:return d=e.sent().data,[2,d]}})})};return a}(),U=function(){function a(a,b){this.source=a;this.objectIdField=b}a.prototype.destroy=function(){};a.prototype.executeQuery=function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){switch(e.label){case 0:return[4,z.executeQuery(this.source,a,b)];case 1:return d=
e.sent().data,[2,v.convertFromFeatureSet(d,this.objectIdField)]}})})};return a}();C=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.type="on-demand";b._queryInfoHash=null;b._dataTileIndex=new E.default;b._editsQueue=new D.EditsQueue({processEdits:b._processEdits.bind(b)});b._featuresInFlight=new Map;return b}l(b,a);b.prototype.initialize=function(){var a=this,b=this._createFeatureStore();b.onFeatureAdd=this.onFeatureAdd.bind(this);b.onFeatureRemove=this.onFeatureRemove.bind(this);
this._set("featureStore",b);this._dataTileIndex.featureStore=this.featureStore;this._dataTileIndex.forEach(function(a){return a.done=!1});this._fetchQueue=new J({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(b,d){return a._fetchTile(b,a.queryInfo,d)}});this._patchQueue=new J({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(b,d){return a._fetchTile(b.dataTile,b.queryInfo,d)}});this._updateQueue=new H.default({tileInfoView:this.tileStore.tileScheme,
process:function(b,d,e){return a._updateTile(b,d,e)}});var d=this.service,b=d.capabilities,e=d.source,d=d.objectIdField;Array.isArray(e)?this.sourceAdapter=new Q(e,d):this.sourceAdapter=L&&b.query.supportsFormatPBF?new N(e):new U(e,d);this.handles.add([this.watch("updating",function(b){return!b&&a.onIdle()})]);this.featureStore.events.on("valueRangesChanged",function(b){a.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:b.valueRanges}})})};b.prototype.destroy=function(){this._fetchQueue.clear();
this._patchQueue.clear();this._updateQueue.clear();this._editsQueue.destroy();this.queryEngine.destroy();this.sourceAdapter.destroy()};Object.defineProperty(b.prototype,"queryEngine",{get:function(){return this._createQueryEngine(this.featureStore)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"updating",{get:function(){return!this.viewState||this._fetchQueue.updating||this._patchQueue.updating||this._updateQueue.updating||this._editsQueue.updating},enumerable:!0,configurable:!0});
b.prototype.update=function(a,b){return f(this,void 0,void 0,function(){var d,e,f,c,m,n,g=this;return h(this,function(h){switch(h.label){case 0:return this.validateConfig(a),d=JSON.stringify(this.config.filters),e=this.renderer.getAttributeHash(),f=a.availableFields.filter(function(a){return-1===g.availableFields.indexOf(a)}),c=this.config.definitionExpression,this._set("config",a),c!==this.config.definitionExpression&&this._set("queryEngine",this._createQueryEngine(this.featureStore)),[4,this.updatePixelBuffer()];
case 1:return h.sent(),m=d!==JSON.stringify(a.filters),n=e!==this.renderer.getAttributeHash(),b?n?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,3]:[3,6];case 2:h.sent(),h.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return h.sent(),[4,this.featureStore.update(m,a)];case 5:return h.sent(),this.refresh(),[2];case 6:return f.length?[4,this._handleAttributeChange(f)]:[3,8];case 7:h.sent(),h.label=8;case 8:return"heatmap"===this.renderer.type?
[2]:n?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,10];case 9:h.sent(),this.featureStore.forEach(function(a){return g.attributeStore.setAttributeData(a.localId,a,g.geometryInfo,g.viewParams)}),h.label=10;case 10:return[4,this.attributeStore.updateFilters(this)];case 11:return h.sent(),[4,this.featureStore.update(m,a)];case 12:return h.sent(),[4,this.attributeStore.sendUpdates()];case 13:return h.sent(),[2]}})})};b.prototype.invalidate=function(){return f(this,void 0,
void 0,function(){var a,b,d;return h(this,function(e){a=0;for(b=this.tileStore.tiles;a<b.length;a++)d=b[a],this._updateQueue.push(d.id,Date.now());return[2]})})};b.prototype.onIdle=function(){this.featureStore.sweepClusters()};b.prototype.onEdits=function(a){var b=this;this._fetchQueue.pause();this._fetchQueue.reset();return this._editsQueue.push(a).then(function(){b._editsQueue.updating||b._fetchQueue.resume()})};b.prototype.queryFeatures=function(a){return this.queryEngine.executeQuery(a)};b.prototype.queryFeatureCount=
function(a){return this.queryEngine.executeQueryForCount(a)};b.prototype.queryObjectIds=function(a){return this.queryEngine.executeQueryForIds(a)};b.prototype.queryExtent=function(a){return this.queryEngine.executeQueryForExtent(a)};b.prototype.queryStatistics=function(a){return f(this,void 0,void 0,function(){var a,b,d,e=this;return h(this,function(c){switch(c.label){case 0:return d=b=a=0,[4,r.all(this.tileStore.tiles.map(function(c){return f(e,void 0,void 0,function(){var e,f,n,g,p,k,r,u,w,v,y;
return h(this,function(h){switch(h.label){case 0:return e=this.queryInfo,f=e.returnCentroid,n=e.returnGeometry,g=this._pixelBuffer,p={pixelBuffer:g,returnGeometry:n,returnCentroid:f,returnOutline:this.returnOutline},k=m(),[4,this.featureStore.executeTileQuery(c,this.spatialReference,p)];case 1:r=h.sent().features;u=m();d+=u-k;a+=r.length;w=0;for(v=r;w<v.length;w++)y=v[w],y.geometry&&(t.isPolygon(y.geometry)?b+=y.geometry.rings.reduce(function(a,b){return a+b.length},0):t.isPolyline(y.geometry)&&(b+=
y.geometry.paths.reduce(function(a,b){return a+b.length},0)));return[2]}})})}))];case 1:return c.sent(),[2,k({},this.featureStore.storeStatistics,{displayedFeatureCount:a,displayedVertexCount:b,displayPreProcessTime:d})]}})})};b.prototype.refresh=function(){return f(this,void 0,void 0,function(){var a=this;return h(this,function(b){switch(b.label){case 0:return this._queryInfoHash=Math.random().toString(),this._dataTileIndex.clear(),this._fetchQueue.pause(),this._updateQueue.pause(),this._editsQueue.clear(),
this._fetchQueue.clear(),this._updateQueue.clear(),this.featureStore.startMarkingUsedFeatures(),this._manageTiles(this.tileStore.tiles),this._fetchQueue.resume(),[4,n.whenFalseOnce(this._fetchQueue,"updating")];case 1:return b.sent(),this.featureStore.sweep(),this.featureStore.forEach(function(b){return a.attributeStore.setAttributeData(b.localId,b,a.geometryInfo,a.viewParams)}),this.attributeStore.sendUpdates(),this._updateQueue.resume(),[2]}})})};b.prototype.setViewState=function(a){var b=this,
d=this.viewState&&this.viewState.scale;this.inherited(arguments);this._fetchQueue.state=a;this._updateQueue.state=a;d!==this.viewState.scale&&this.attributeStore.hasScaleExpr&&(this.featureStore.forEach(function(a){return b.attributeStore.setAttributeData(a.localId,a,b.geometryInfo,b.viewParams)}),this.attributeStore.sendUpdates())};b.prototype.getAggregate=function(a){return this.featureStore.getAggregate(a)};b.prototype.getAggregateValueRanges=function(){return this.featureStore.getAggregateValueRanges()};
b.prototype.onTileUpdate=function(a){this._manageTiles(a.added,a.removed);this.featureStore.onTileUpdate(a)};b.prototype.onFeatureAdd=function(a){if(this._featuresInFlight.has(a.objectId)){var b=this._featuresInFlight.get(a.objectId).attributes;a.attributes=k({},b,a.attributes);this._featuresInFlight.delete(a.objectId)}a.localId=this.attributeStore.createLocalId(a.objectId);this.attributeStore.setAttributeData(a.localId,a,this.geometryInfo,this.viewParams)};b.prototype._handleAttributeChange=function(a){return f(this,
void 0,void 0,function(){return h(this,function(b){switch(b.label){case 0:return[4,this._fetchChangedFields(a)];case 1:return b.sent(),[2]}})})};b.prototype._fetchChangedTileFields=function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){return(d=this._dataTileIndex.get(a.id))?[2,this._fetchChangedTileFieldsDrill(d,b)]:[2]})})};b.prototype._fetchChangedTileFieldsDrill=function(a,b,d){void 0===d&&(d=0);return f(this,void 0,void 0,function(){var e,f,c,m,n,g,p,u,w,t,v=this;
return h(this,function(h){switch(h.label){case 0:return e=k({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:b.concat([this.service.objectIdField])}),a.returnExceeded=a.returnExceeded||d>=G,f=a.key,c={key:f,dataTile:a,queryInfo:e},[4,this._patchQueue.push(c)];case 1:m=h.sent();if(!(m.exceededTransferLimit&&d<G))return[3,3];n=a.tile.createChildTiles();g=n.map(function(b){var d=new B.default;d.tile=b;d.displayTile=a.displayTile;return d});return[4,r.all(g.map(function(a){return v._fetchChangedTileFieldsDrill(a,
b,d+1)}))];case 2:return h.sent(),[2];case 3:p=0;for(u=m.features;p<u.length;p++)w=u[p],this.featureStore.has(w.objectId)?(t=this.featureStore.getFeature(w.objectId),t.attributes=k({},t.attributes,w.attributes)):this._featuresInFlight.set(w.objectId,w);return[2]}})})};b.prototype._fetchChangedTileFieldsPaged=function(a,b,d){void 0===d&&(d=0);return f(this,void 0,void 0,function(){var e,f,c,m,n,g,p,r,u,w,t;return h(this,function(h){switch(h.label){case 0:return e=this.service.capabilities.query.supportsMaxRecordCountFactor,
f=this.service.tileMaxRecordCount,c=f*(e?1:I),m=k({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:b.concat([this.service.objectIdField]),resultOffset:d*c,num:c}),a.returnExceeded=!0,n=a.key,g={key:n,dataTile:a,queryInfo:m},[4,this._patchQueue.push(g)];case 1:p=h.sent();r=0;for(u=p.features;r<u.length;r++)w=u[r],this.featureStore.has(w.objectId)?(t=this.featureStore.getFeature(w.objectId),t.attributes=k({},t.attributes,w.attributes)):this._featuresInFlight.set(w.objectId,w);return p.exceededTransferLimit?
[2,this._fetchChangedTileFieldsPaged(a,b,d+1)]:[2]}})})};b.prototype._fetchChangedFields=function(a){return f(this,void 0,void 0,function(){var b,d,e=this;return h(this,function(f){switch(f.label){case 0:return b=this.tileStore.tiles,d=b.map(function(b){return e._fetchChangedTileFields(b,a)}),[4,r.all(d)];case 1:return f.sent(),[2]}})})};b.prototype._manageTiles=function(a,b){void 0===b&&(b=null);for(var d=this._dataTileIndex,e=this._fetchQueue,f=this._updateQueue,c="esriGeometryPoint"===this.service.geometryType,
h=function(a){var b=d.get(a.id);b?(b.displayTile=a,c?d.forEach(function(d){F.isChildOf(d,b)&&(d.displayTile=a)}):b.done=!1):(b=new B.default,b.tile=a.clone(),b.displayTile=a,d.add(b));m._processDataTile(b)},m=this,n=0;n<a.length;n++){var g=a[n];h(g)}if(b)for(a=0;a<b.length;a++)g=b[a],R.add(g),f.abort(g.id);d.forEach(function(a){R.has(a.displayTile)&&M.push(a)});for(f=0;f<M.length;f++)g=M[f],e.abort(g.id),d.delete(g);M.length=0;R.clear()};b.prototype._processDataTile=function(a){var b=this,d=a.key,
e=this._fetchQueue,f=d.id,c=this._queryInfoHash,d=d.level-a.displayTile.key.level>=G;this._dataTileIndex.add(a);if(a.done||e.has(f)){if(a.queryInfoHash!==c||a.returnExceeded!==d)if(a.done)a.done=!1;else if(e.isOngoing(f))e.abort(f);else{a.queryInfoHash=c;a.returnExceeded=d;return}}else a.queryInfoHash=c,a.returnExceeded=d;a.done?this._invalidateTile(a.displayTile):e.has(f)||e.push(a).then(function(d){return b._handleResponse(a,d)}).catch(function(d){r.isAbortError(d)||K.error(new p("featurelayer-controller:tile-error",
"Encountered an error when handling tile response",d));a.done=!0;b._invalidateTile(a.displayTile)})};b.prototype._handleResponse=function(a,b){a.done=!0;v.hydrateOptimizedFeatureSet(b);if(b.exceededTransferLimit)if(a.returnExceeded)this._dataTileIndex.setTileFeatures(a,b.features),this._deleteChildrenDataTiles(a);else{b=a.tile.createChildTiles();for(var d=0;d<b.length;d++){var f=b[d],c=new B.default;c.tile=f;c.displayTile=a.displayTile;this._processDataTile(c)}e.release(b)}else this._dataTileIndex.setTileFeatures(a,
b.features),this._deleteChildrenDataTiles(a);this._invalidateTile(a.tile)};b.prototype._deleteChildrenDataTiles=function(a){this._dataTileIndex.forEach(function(b){F.isChildOf(b,a)&&M.push(b)});for(var b=0;b<M.length;b++){var d=M[b];this._fetchQueue.abort(d.id);this._dataTileIndex.delete(d)}M.length=0};b.prototype._fetchTile=function(a,b,d){return f(this,void 0,void 0,function(){var e,f,c,m,n,g,p,k,r,u,t;return h(this,function(h){switch(h.label){case 0:return e=new w({xmin:a.bounds[0],ymin:a.bounds[1],
xmax:a.bounds[2],ymax:a.bounds[3],spatialReference:this.spatialReference}),f=this.service.geometryType,c="esriGeometryPoint"===f?a.tile:a.displayTile,m=c.extent,n=c.resolution,g=a.returnExceeded,p=this._createQuery(e,m,n,b,I,g),[4,this.sourceAdapter.executeQuery(p,d)];case 1:k=h.sent();if("esriGeometryPolygon"===f)for(r=0,u=k.features;r<u.length;r++)t=u[r],t.geometry=v.removeCollinearVectices(t.geometry,t.geometry,f,!1,!1);return[2,k]}})})};b.prototype._invalidateTile=function(a){var b=this._updateQueue,
d=0;for(a=this.tileStore.intersections(a,this._pixelBuffer);d<a.length;d++){var e=a[d].tile;b.push(e.id,e.updateTimestamp)}};b.prototype._updateTile=function(a,b,d){return f(this,void 0,void 0,function(){var e,f,c,m,n,g,p,k,u,w,t,v,y=this;return h(this,function(h){switch(h.label){case 0:return e=this.tileStore.get(a),f=this.queryInfo,c=f.returnCentroid,m=f.returnGeometry,n=this._pixelBuffer,g={pixelBuffer:n,returnGeometry:m,returnCentroid:c,returnOutline:this.returnOutline},[4,this.featureStore.executeTileQuery(e,
this.spatialReference,g)];case 1:return p=h.sent(),k=p.features,u=p.objectIds,[4,this.attributeStore.sendUpdates()];case 2:return h.sent(),w={geometryType:this.service.geometryType,features:k,fields:this.service.fields,objectIdFieldName:this.service.objectIdField,transform:e.transform},t=[],v=!0,this._dataTileIndex.forEach(function(a){e.id!==a.id&&F.isChildOf(a,e)&&v&&!a.done&&(v=!1)}),v&&e&&e.objectIds.forEach(function(a){u.has(a)||(a=y.attributeStore.getLocalId(a),t.push(a))}),u.forEach(function(a){e.objectIds.add(a)}),
e.updateTimestamp=b,[2,this.processor.onTileData(e,{clear:!0,addOrUpdate:w.features,remove:t,transformParams:A.Utils.getTransformParams(w)},d).catch(function(a){r.isAbortError(a)||K.error("update-tile",a)})]}})})};b.prototype._processEdits=function(a,b,d){return f(this,void 0,void 0,function(){var e,c,m,n,g,p=this;return h(this,function(u){switch(u.label){case 0:return e=this._createTempQueryEngine(),c=this._createObjectIdsQuery(a),a.length?[4,this.sourceAdapter.executeQuery(c)]:[3,2];case 1:m=u.sent(),
v.hydrateOptimizedFeatureSet(m),this._dataTileIndex.addOrUpdateFeatures(m.features),e.featureStore.addMany(m.features),u.label=2;case 2:return n=b.concat(a).map(function(a){return p.attributeStore.getLocalId(a)}),this._dataTileIndex.deleteFeaturesById(b),this.attributeStore.sendUpdates(),g=k({},this.queryInfo,{pixelBuffer:this._pixelBuffer,returnOutline:this.returnOutline}),this.tileStore.tiles.map(function(a){return f(p,void 0,void 0,function(){var b,f;return h(this,function(c){switch(c.label){case 0:return[4,
e.featureStore.executeTileQuery(a,this.spatialReference,g)];case 1:return b=c.sent().features,f={transform:a.transform,hasZ:!1,hasM:!1},[2,this.processor.onTileData(a,{addOrUpdate:b,remove:n,transformParams:f},d).catch(function(a){r.isAbortError(a)||K.error("update-tile",a)})]}})})}),e.destroy(),[2]}})})};b.prototype._createObjectIdsQuery=function(a){var b=this._createDefaultQuery(this.queryInfo);b.objectIds=a;return b};g([y.property()],b.prototype,"_fetchQueue",void 0);g([y.property()],b.prototype,
"_patchQueue",void 0);g([y.property()],b.prototype,"_updateQueue",void 0);g([y.property()],b.prototype,"_editsQueue",void 0);g([y.property({readOnly:!0})],b.prototype,"featureStore",void 0);g([y.property()],b.prototype,"sourceAdapter",void 0);g([y.property({readOnly:!0,dependsOn:["featureStore","service"]})],b.prototype,"queryEngine",null);g([y.property({dependsOn:["viewState","_fetchQueue.updating","_updateQueue.updating","_patchQueue.updating","_editsQueue.updating"]})],b.prototype,"updating",null);
return b=g([y.subclass("esri.views.2d.layers.features.controllers.OnDemandController")],b)}(y.declared(C.default));a.default=C})},"esri/core/workers":function(){define(["require","exports","./workers/workers"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});for(var g in l)a.hasOwnProperty(g)||(a[g]=l[g])})},"esri/core/workers/workers":function(){define("require exports ../tsSupport/generatorHelper ../tsSupport/awaiterHelper ../Error ../has ../promiseUtils ./Connection ./RemoteClient ./WorkerOwner".split(" "),
function(c,a,l,g,k,h,f,e,p,b){function d(){return g(this,void 0,void 0,function(){var a,d,e;return l(this,function(c){if(u)return[2,u];y=f.createAbortController();a=[];d=function(d){var e=b.create(d).then(function(a){return n[d]=a});a.push(e)};for(e=0;e<m;e++)d(e);u=f.all(a);return[2,u]})})}Object.defineProperty(a,"__esModule",{value:!0});a.Connection=e;a.RemoteClient=p;var m=h("esri-workers-debug")?1:h("host-browser")?navigator.hardwareConcurrency-1:0;m||(m=h("safari")&&h("mac")||h("trident")?7:
2);var r=0,n=[];a.initialize=function(){d()};a.openWithPorts=function(b,d){return new a.Connection(b.map(function(b){return new a.RemoteClient(b,d,{})}))};a.open=function(b,e){void 0===e&&(e={});return g(this,void 0,void 0,function(){var g,p,u,w,t,y,E;return l(this,function(v){switch(v.label){case 0:if("string"!==typeof b)throw new k("workers:undefined-module","modulePath is missing");g=e.signal;p=e.strategy||"distributed";h("host-webworker")&&!h("esri-workers")&&(p="local");return"local"!==p?[3,
2]:[4,f.create(function(a){return c([b],a)})];case 1:return u=v.sent(),f.throwIfAborted(g),w=e.client||u,t=a.RemoteClient.connect(u),[2,new a.Connection([new a.RemoteClient(t,w,e)])];case 2:return[4,d()];case 3:v.sent();f.throwIfAborted(g);if("dedicated"!==p)return[3,5];y=r++;r%=m;return[4,n[y].open(b,e)];case 4:return t=v.sent(),[2,new a.Connection([new a.RemoteClient(t,e.client,e)])];case 5:return[4,f.all(n.map(function(a){return a.open(b,e)}))];case 6:return E=v.sent(),[2,new a.Connection(E.map(function(b){return new a.RemoteClient(b,
e.client,e)}))]}})})};a.terminate=function(){u&&(y.abort(),u=null);for(var a=0;a<n.length;a++)n[a]&&n[a].terminate();n.length=0};var u=null,y})},"esri/core/workers/Connection":function(){define(["require","exports","../Logger","../promiseUtils","../accessorSupport/utils"],function(c,a,l,g,k){var h=l.getLogger("esri.core.workers.Connection");return function(){function a(a){this._clientIdx=0;this._clients=a}a.prototype.broadcast=function(a,f,b){for(var d=[],e=0,c=this._clients;e<c.length;e++)d.push(c[e].invoke(a,
f,b));return d};a.prototype.close=function(){for(var a=0,f=this._clients;a<f.length;a++)f[a].close();this._clients=[]};a.prototype.getAvailableClient=function(){var a;this._clients.some(function(e){return e.isBusy()?!1:(a=e,!0)})||(this._clientIdx=(this._clientIdx+1)%this._clients.length,a=this._clients[this._clientIdx]);return a};a.prototype.invoke=function(a,f,b){var d=null;Array.isArray(b)?(h.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),d={transferList:b}):
d=b;return this._clients&&this._clients.length?this.getAvailableClient().invoke(a,f,d):g.reject(Error("Connection closed"))};a.prototype.on=function(a,f){var b=this._clients.map(function(b){return b.on(a,f)});return k.handlesGroup(b)};a.prototype.openPorts=function(){return this._clients.map(function(a){return a.openPort()})};return a}()})},"esri/core/workers/WorkerOwner":function(){define("require exports ../tsSupport/generatorHelper ../tsSupport/awaiterHelper ../../kernel ../Error ../Logger ../promiseUtils ./utils ./workerFactory".split(" "),
function(c,a,l,g,k,h,f,e,p,b){function d(a,b){a["delete"](b)}var m=f.getLogger("esri.core.workers"),r=p.MessageType.ABORT,n=p.MessageType.INVOKE,u=p.MessageType.OPEN,y=p.MessageType.OPENED,w=p.MessageType.RESPONSE;return function(){function a(a,b){this._outJobs=new Map;this._inJobs=new Map;this.worker=a;this.id=b;a.addEventListener("message",this._onMessage.bind(this));a.addEventListener("error",function(a){a.preventDefault();m.error(a)})}a.create=function(d){return g(this,void 0,void 0,function(){var e;
return l(this,function(f){switch(f.label){case 0:return[4,b.createWorker()];case 1:return e=f.sent(),[2,new a(e,d)]}})})};a.prototype.terminate=function(){this.worker.terminate()};a.prototype.open=function(a,b){void 0===b&&(b={});return g(this,void 0,void 0,function(){var f,c,h=this;return l(this,function(m){f=b.signal;c=p.newJobId();return[2,e.create(function(b,m){b={resolve:b,reject:m};e.onAbortOrThrow(f,function(){d(h._outJobs,c);h._post({type:r,jobId:c})});h._outJobs.set(c,b);h._post({type:u,
jobId:c,modulePath:a})})]})})};a.prototype._onMessage=function(a){if(a=p.receiveMessage(a))switch(a.type){case y:this._onOpenedMessage(a);break;case w:this._onResponseMessage(a);break;case r:this._onAbortMessage(a);break;case n:this._onInvokeMessage(a)}};a.prototype._onAbortMessage=function(a){var b=this._inJobs;a=a.jobId;var e=b.get(a);e&&(e.controller&&e.controller.abort(),d(b,a))};a.prototype._onInvokeMessage=function(a){var b=this,f=a.methodName,c=a.jobId,h=a.data;a=a.abortable?e.createAbortController():
null;var m=this._inJobs,n=k.workerMessages[f],g;try{if("function"!==typeof n)throw new TypeError(f+" is not a function");g=n.call(null,h,{signal:a?a.signal:null})}catch(H){this._post({type:w,jobId:c,error:p.toInvokeError(H)});return}if(e.isPromiseLike(g)){m.set(c,{controller:a,promise:g});if(a&&"cancel"in g)e.onAbort(a.signal,function(){return g.cancel()});g.then(function(a){m.has(c)&&(d(m,c),b._post({type:w,jobId:c},a))},function(a){m.has(c)&&(d(m,c),a||(a={message:"Error encountered at method"+
f}),e.isAbortError(a)||b._post({type:w,jobId:c,error:p.toInvokeError(a||{message:"Error encountered at method "+f})}))})}else this._post({type:w,jobId:c},g)};a.prototype._onOpenedMessage=function(a){var b=a.jobId;a=a.data;var e=this._outJobs.get(b);e&&(d(this._outJobs,b),e.resolve(a))};a.prototype._onResponseMessage=function(a){var b=a.jobId,e=a.error;a=a.data;var f=this._outJobs.get(b);f&&(d(this._outJobs,b),e?f.reject(h.fromJSON(JSON.parse(e))):f.resolve(a))};a.prototype._post=function(a,b,d){return p.postMessage(this.worker,
a,b,d)};return a}()})},"esri/core/workers/workerFactory":function(){define("require exports ../tsSupport/assignHelper ../tsSupport/generatorHelper ../tsSupport/awaiterHelper dojo/_base/kernel ../../config ../has ../Logger ../promiseUtils ./loaderConfig ./utils ./WorkerFallback".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m,r){function n(a){return k(this,void 0,void 0,function(){return g(this,function(c){return[2,b.create(function(b){function c(g){if(g=m.receiveMessage(g))switch(g.type){case t:g=a;var p=
f.workers.loaderUrl||d.DEFAULT_LOADER_URL,k;null!=f["default"]?(k=l({},f),delete k["default"],k=JSON.parse(JSON.stringify(k))):k=JSON.parse(JSON.stringify(f));var r=f.workers.loaderConfig,r=d.default({baseUrl:r.baseUrl,locale:h.locale,has:l({"config-deferredInstrumentation":0,"csp-restrictions":e("csp-restrictions"),"dojo-test-sniff":0,"esri-native-promise":e("esri-native-promise"),"esri-secure-context":e("esri-secure-context"),"esri-workers-arraybuffer-transfer":e("esri-workers-arraybuffer-transfer"),
"events-keypress-typed":0,"host-webworker":1,"esri-webgl-texture-float":e("esri-webgl-texture-float"),"esri-shared-array-buffer":e("esri-shared-array-buffer"),"esri-atomics":e("esri-atomics"),"esri-2d-debug":0,"esri-webgl-max-texture-size":e("esri-webgl-max-texture-size")},r.has),map:l({},r.map),paths:l({},r.paths),packages:r.packages||[]});g.postMessage({type:w,configure:{esriConfig:k,loaderUrl:p,loaderConfig:r}});break;case y:a.removeEventListener("message",c),a.removeEventListener("error",n),b(a)}}
function n(b){b.preventDefault();a.removeEventListener("message",c);a.removeEventListener("error",n);u.warn("Failed to create Worker. Fallback to execute module in main thread",b);a=new r;a.addEventListener("message",c);a.addEventListener("error",n)}a.addEventListener("message",c);a.addEventListener("error",n)})]})})}Object.defineProperty(a,"__esModule",{value:!0});var u=p.getLogger("esri.core.workers");e.add("esri-workers-arraybuffer-transfer",!e("safari")||12<=e("safari"));var y=m.MessageType.CONFIGURED,
w=m.MessageType.CONFIGURE,t=m.MessageType.HANDSHAKE,v;try{v=URL.createObjectURL(new Blob(['var globalId\x3d0;var outgoing\x3dnew Map;var configured\x3dfalse;var HANDSHAKE\x3d0;var CONFIGURE\x3d1;var CONFIGURED\x3d2;var OPEN\x3d3;var OPENED\x3d4;var RESPONSE\x3d5;var INVOKE\x3d6;var ABORT\x3d7;function mapDelete(map,key){map["delete"](key)}function createAbortError(){var error\x3dnew Error("AbortError");error.dojoType\x3d"cancel";return error}function receiveMessage(event){if(!event||!event.data){return null}if(typeof event.data\x3d\x3d\x3d"string"){return JSON.parse(event.data)}return event.data}function invokeStaticMessage(methodName,data,options){var signal\x3doptions\x26\x26options.signal;var Deferred\x3drequire("dojo/Deferred");var jobId\x3dglobalId++;var abort\x3dfunction(){var outJob\x3doutgoing.get(jobId);if(!outJob){return}mapDelete(outgoing,jobId);self.postMessage({type:ABORT,jobId:jobId});outJob.reject(createAbortError())};var deferred\x3dnew Deferred(abort);if(signal){if(signal.aborted){return deferred.reject(createAbortError())}signal.addEventListener("abort",function(){abort();deferred.reject(createAbortError())})}outgoing.set(jobId,deferred);self.postMessage({type:INVOKE,jobId:jobId,methodName:methodName,abortable:true,data:data});return deferred.promise}function messageHandler(event){var message\x3dreceiveMessage(event);if(!message){return}var jobId\x3dmessage.jobId;switch(message.type){case CONFIGURE:var configuration\x3dmessage.configure;if(configured){return}self.dojoConfig\x3dconfiguration.loaderConfig;self.importScripts(configuration.loaderUrl);if(typeof require.config\x3d\x3d\x3d"function"){require.config(configuration.loaderConfig)}require(["esri/config"],function(esriConfig){for(var name in configuration.esriConfig){if(Object.prototype.hasOwnProperty.call(configuration.esriConfig,name)){esriConfig[name]\x3dconfiguration.esriConfig[name]}}self.postMessage({type:CONFIGURED})});break;case OPEN:var modulePath\x3dmessage.modulePath;require(["esri/core/workers/RemoteClient",modulePath],function(RemoteClient,Module){var port\x3dRemoteClient.connect(Module);self.postMessage({type:OPENED,jobId:jobId,data:port},[port])});break;case RESPONSE:if(outgoing.has(jobId)){var deferred\x3doutgoing.get(jobId);mapDelete(outgoing,jobId);if(message.error){deferred.reject(JSON.parse(message.error))}else{deferred.resolve(message.data)}}break}}self.addEventListener("message",messageHandler);self.postMessage({type:HANDSHAKE});'],
{type:"text/javascript"}))}catch(z){}a.createWorker=function(){return k(this,void 0,void 0,function(){var a;return g(this,function(b){if(!e("esri-workers"))return[2,n(new r)];if(v)try{a=new Worker(v)}catch(C){u.warn("Failed to create Worker. Fallback to execute module in main thread",event),a=new r}else u.warn("Failed to create Worker. Fallback to execute module in main thread",event),a=new r;return[2,n(a)]})})}})},"esri/core/workers/loaderConfig":function(){define(["require","exports","../tsSupport/assignHelper",
"../has","../urlUtils"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});g=g("esri-built")?"dojo/dojo-lite.js":"dojo/dojo.js";a.DEFAULT_LOADER_URL=k.makeAbsolute(k.removeQueryParameters(c.toUrl(g)));a.DEFAULT_CONFIG={baseUrl:function(){var a=k.removeQueryParameters(c.toUrl("dojo/x.js"));return k.makeAbsolute(a.slice(0,a.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",main:"dist/cldr"},
{name:"globalize",main:"dist/globalize"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental","cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}};a.default=function(h){var f={async:h.async,isDebug:h.isDebug,locale:h.locale,baseUrl:h.baseUrl,has:l({},h.has),map:l({},h.map),
packages:h.packages&&h.packages.concat()||[],paths:l({},h.paths)};h.hasOwnProperty("async")||(f.async=!0);h.hasOwnProperty("isDebug")||(f.isDebug=!1);h.baseUrl||(f.baseUrl=a.DEFAULT_CONFIG.baseUrl);a.DEFAULT_CONFIG.packages.forEach(function(a){a:{for(var b=f.packages,d=0;d<b.length;d++)if(b[d].name===a.name)break a;a=l({},a);d=k.removeQueryParameters(c.toUrl(a.name+"/x.js"));d=d.slice(0,d.length-5);a.location=k.makeAbsolute(d);b.push(a)}});h=f.map=f.map||{};for(var e=0,g=Object.keys(a.DEFAULT_CONFIG.map);e<
g.length;e++){var b=g[e];h[b]||(h[b]=a.DEFAULT_CONFIG.map[b])}return f}})},"esri/core/urlUtils":function(){define("require exports ./tsSupport/assignHelper ../config ../kernel ./Error ./global ./Logger ./string".split(" "),function(c,a,l,g,k,h,f,e,p){function b(a){var b={path:null,query:null},e=new ma(a),f=a.indexOf("?");null===e.query?b.path=a:(b.path=a.substring(0,f),b.query=d(e.query));e.fragment&&(b.hash=e.fragment,null===e.query&&(b.path=b.path.substring(0,b.path.length-(e.fragment.length+1))));
return b}function d(a){var b={},d=0;for(a=a.split("\x26");d<a.length;d++){var e=a[d];if(e){var f=e.indexOf("\x3d"),c=void 0,h=void 0;0>f?(c=decodeURIComponent(e),h=""):(c=decodeURIComponent(e.slice(0,f)),h=decodeURIComponent(e.slice(f+1)));e=b[c];"string"===typeof e&&(e=b[c]=[e]);Array.isArray(e)?e.push(h):b[c]=h}}return b}function m(a){return a&&"object"===typeof a&&"toJSON"in a&&"function"===typeof a.toJSON}function r(a,b){return a?b&&"function"===typeof b?Object.keys(a).map(function(d){return encodeURIComponent(d)+
"\x3d"+encodeURIComponent(b(d,a[d]))}).join("\x26"):Object.keys(a).map(function(d){var e=a[d];if(null==e)return"";var f=encodeURIComponent(d)+"\x3d";return(d=b&&b[d])?f+encodeURIComponent(d(e)):Array.isArray(e)?e.map(function(a){return m(a)?f+encodeURIComponent(JSON.stringify(a)):f+encodeURIComponent(a)}).join("\x26"):m(e)?f+encodeURIComponent(JSON.stringify(e)):f+encodeURIComponent(e)}).filter(function(a){return a}).join("\x26"):""}function n(a){var b=a.indexOf("?");-1!==b?(oa.path=a.slice(0,b),
oa.query=a.slice(b+1)):(oa.path=a,oa.query=null);return oa}function u(a){a=n(a).path;a&&"/"===a[a.length-1]||(a+="/");a=Q(a,!0);return a=a.toLowerCase()}function y(a){var b=T.proxyRules;a=u(a);for(var d=0;d<b.length;d++)if(0===a.indexOf(b[d].urlPrefix))return b[d]}function w(a){a=A(a);var b=a.indexOf("/sharing");return 0<b?a.substring(0,b):a.replace(/\/+$/,"")}function t(a,b,d){void 0===d&&(d=!1);a=V(a);b=V(b);return d||a.scheme===b.scheme?a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port:
!1}function v(b,d,e){void 0===d&&(d=a.appBaseUrl);if(G(b))return e&&e.preserveProtocolRelative?b:"http"===a.appUrl.scheme&&a.appUrl.authority===D(b).slice(2)?"http:"+b:"https:"+b;if(!I(b)){e=C;if("/"===b[0]){var f=d.indexOf("//"),f=d.indexOf("/",f+2);d=-1===f?d:d.slice(0,f)}return e(d,b)}return b}function z(b,d,e){void 0===d&&(d=a.appBaseUrl);if(!B(b))return b;var f=A(b),c=f.toLowerCase();d=A(d).toLowerCase().replace(/\/+$/,"");if((e=e?A(e).toLowerCase().replace(/\/+$/,""):null)&&0!==d.indexOf(e))return b;
for(var h=function(a,b,d){d=a.indexOf(b,d);return-1===d?a.length:d},m=h(c,"/",c.indexOf("//")+2),n=-1;c.slice(0,m+1)===d.slice(0,m)+"/";){n=m+1;if(m===c.length)break;m=h(c,"/",m+1)}if(-1===n||e&&n<e.length)return b;b=f.slice(n);f=d.slice(n-1).replace(/[^/]+/g,"").length;if(0<f)for(c=0;c<f;c++)b="../"+b;else b="./"+b;return b}function A(a){a=a.trim();a=v(a);if(/^https?:\/\//i.test(a)){var b=n(a);a=b.path.replace(/\/{2,}/g,"/");a=a.replace("/","//");b.query&&(a+="?"+b.query)}a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,
"$1www.$2");return a=N(a)}function C(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(a&&a.length){b=[];if(B(a[0])){var d=a[0],e=d.indexOf("//");-1!==e&&(b.push(d.slice(0,e+1)),da.test(a[0])&&(b[0]+="/"),a[0]=d.slice(e+2))}else"/"===a[0][0]&&b.push("");a=a.reduce(function(a,b){return b?a.concat(b.split("/")):a},[]);for(d=0;d<a.length;d++)e=a[d],".."===e&&0<b.length&&".."!==b[b.length-1]?b.pop():(!e&&d===a.length-1||e&&("."!==e||0===b.length))&&b.push(e);return b.join("/")}}function D(a,
b){void 0===b&&(b=!1);if(E(a)||F(a))return null;var d=a.indexOf("://");if(-1===d&&G(a))d=2;else if(-1!==d)d+=3;else return null;d=a.indexOf("/",d);-1!==d&&(a=a.slice(0,d));b&&(a=Q(a,!0));return a}function B(a){return G(a)||I(a)}function E(a){return"blob:"===a.slice(0,5)}function F(a){return"data:"===a.slice(0,5)}function H(a){a=J(a);if(!a||!a.isBase64)return null;a=atob(a.data);for(var b=new Uint8Array(a.length),d=0;d<a.length;d++)b[d]=a.charCodeAt(d);return b.buffer}function J(a){return(a=a.match(Ba))?
{mediaType:a[1],isBase64:!!a[2],data:a[3]}:null}function K(a){var b=H(a);if(!b)return null;a=J(a);return new Blob([b],{type:a.mediaType})}function G(a){return a&&"/"===a[0]&&"/"===a[1]}function I(a){return ja.test(a)}function L(b){return aa.test(b)||"http"===a.appUrl.scheme&&G(b)}function R(a){return G(a)?"https:"+a:a.replace(aa,"https:")}function M(){return"https"===a.appUrl.scheme}function Q(a,b){void 0===b&&(b=!1);if(G(a))return a.slice(2);a=a.replace(ja,"");b&&1<a.length&&"/"===a[0]&&"/"===a[1]&&
(a=a.slice(2));return a}function N(b){var d=T.httpsDomains;if(!L(b))return b;var e=b.indexOf("/",7),f;f=-1===e?b:b.slice(0,e);f=f.toLowerCase().slice(7);if(pa.test(f))if(p.endsWith(f,":80"))f=f.slice(0,-3),b=b.replace(":80","");else return b;if("http"===a.appUrl.scheme&&f===a.appUrl.authority&&!ea.test(b))return b;if(M()&&f===a.appUrl.authority||d&&d.some(function(a){return f===a||p.endsWith(f,"."+a)})||M()&&!y(b))b=R(b);return b}function U(a,b,d){if(!(b&&d&&a&&B(a)))return a;var e=a.indexOf("//"),
f=a.indexOf("/",e+2),c=a.indexOf(":",e+2),f=Math.min(0>f?a.length:f,0>c?a.length:c);if(a.slice(e+2,f).toLowerCase()!==b.toLowerCase())return a;b=a.slice(0,e+2);a=a.slice(f);return""+b+d+a}function V(b){if("string"===typeof b)return new ma(v(b));b.scheme||(b.scheme=a.appUrl.scheme);return b}function S(b,d){var e=d&&d.url&&d.url.path;b&&e&&(b=v(b,e,{preserveProtocolRelative:!0}));(d=d&&d.portal)&&!d.isPortal&&d.urlKey&&d.customBaseUrl?(e=d.urlKey+"."+d.customBaseUrl,d=t(a.appUrl,a.appUrl.scheme+"://"+
e)?U(b,d.portalHostname,e):U(b,e,d.portalHostname)):d=b;return d}function X(a,b){if(!a)return a;!B(a)&&b&&b.blockedRelativeUrls&&b.blockedRelativeUrls.push(a);var d=v(a);if(b){var e=b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.rootPath||b.url&&b.url.path;e&&(d=z(d,e,e),d!==a&&b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.writtenUrls.push(d))}a=d;d=(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?U(a,b.urlKey+"."+b.customBaseUrl,b.portalHostname):a;B(d)&&(d=A(d));return d}function W(a,
d,e){a=b(a);var f=a.query||{};f[d]=String(e);return a.path+"?"+r(f)}Object.defineProperty(a,"__esModule",{value:!0});var Y=e.getLogger("esri.core.urlUtils"),T=g.request,ja=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,aa=/^\s*http:/i,ba=/^\s*https:/i,da=/^\s*file:/i,pa=/:\d+$/,ea=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,ta=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,qa=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,ma=function(){function a(a){void 0===a&&(a="");this.uri=
a;this.port=this.host=this.password=this.user=this.fragment=this.query=this.path=this.authority=this.scheme=null;a=this.uri.match(ta);this.scheme=a[2]||(a[1]?"":null);this.authority=a[4]||(a[3]?"":null);this.path=a[5];this.query=a[7]||(a[6]?"":null);this.fragment=a[9]||(a[8]?"":null);null!=this.authority&&(a=this.authority.match(qa),this.user=a[3]||null,this.password=a[4]||null,this.host=a[6]||a[7],this.port=a[9]||null)}a.prototype.toString=function(){return this.uri};return a}();a.Url=ma;a.appUrl=
new ma(g.applicationUrl);a.trustedServersUrlCache={};a.appBaseUrl=function(){var b=a.appUrl.path,b=b.substring(0,b.lastIndexOf(b.split("/")[b.split("/").length-1]));return""+(a.appUrl.scheme+"://"+a.appUrl.host+(null!=a.appUrl.port?":"+a.appUrl.port:""))+b}();a.urlToObject=b;a.queryToObject=d;a.objectToQuery=r;a.getProxyUrl=function(d){void 0===d&&(d=!1);var e,f=T.proxyUrl;if("string"===typeof d){if(e=d,e=ba.test(e)||"https"===a.appUrl.scheme&&G(e),d=y(d))f=d.proxyUrl}else e=!!d;if(!f)throw Y.warn("esri/config: esriConfig.request.proxyUrl is not set."),
new h("urlutils:proxy-not-set","esri/config: esriConfig.request.proxyUrl is not set.");e&&M()&&(f=R(f));return b(f)};a.addProxy=function(a){var e=y(a),f,c;e&&(c=n(e.proxyUrl),f=c.path,c=c.query?d(c.query):null);f&&(e=b(a),a=f+"?"+e.path,(f=r(l({},c,e.query)))&&(a=a+"?"+f));return a};var oa={path:"",query:""};a.addProxyRule=function(a){a={proxyUrl:a.proxyUrl,urlPrefix:u(a.urlPrefix)};for(var b=T.proxyRules,d=a.urlPrefix,e=b.length,f=0;f<b.length;f++){var c=b[f].urlPrefix;if(0===d.indexOf(c)){if(d.length===
c.length)return-1;e=f;break}0===c.indexOf(d)&&(e=f+1)}b.splice(e,0,a);return e};a.getProxyRule=y;a.hasSamePortal=function(a,b){a=w(a);b=w(b);return Q(a)===Q(b)};a.getInterceptor=function(a){var b=function(b){return null==b||b instanceof RegExp&&b.test(a)||"string"===typeof b&&p.startsWith(a,b)},d=T.interceptors;if(d)for(var e=0;e<d.length;e++){var f=d[e];if(Array.isArray(f.urls)){if(f.urls.some(b))return f}else if(b(f.urls))return f}return null};a.hasSameOrigin=t;a.isTrustedServer=function(b){if("string"===
typeof b)if(B(b))b=V(b);else return!0;if(t(b,a.appUrl))return!0;for(var d=T.trustedServers||[],e=0;e<d.length;e++){var f;f=d[e];a.trustedServersUrlCache[f]||(I(f)||G(f)?a.trustedServersUrlCache[f]=[new ma(v(f))]:a.trustedServersUrlCache[f]=[new ma("http://"+f),new ma("https://"+f)]);f=a.trustedServersUrlCache[f];for(var c=0;c<f.length;c++)if(t(b,f[c]))return!0}return!1};a.makeAbsolute=v;a.makeRelative=z;a.normalize=A;a.join=C;a.getOrigin=D;a.isAbsolute=B;a.isBlobProtocol=E;a.isDataProtocol=F;a.dataToArrayBuffer=
H;var Ba=/^data:(.*?)(;base64)?,(.*)$/;a.dataComponents=J;a.makeData=function(a){return a.isBase64?"data:"+a.mediaType+";base64,"+a.data:"data:"+a.mediaType+","+a.data};a.dataToBlob=K;a.downloadDataAsFile=function(a,b){var d;a:if(d=document.createElement("a"),"download"in d){var e=null;if(f.URL&&f.URL.createObjectURL){e=K(a);if(!e){d=!1;break a}e=f.URL.createObjectURL(e)}d.download=b;d.href=e||a;d.style.display="none";document.body.appendChild(d);d.click();document.body.removeChild(d);e&&f.URL.revokeObjectURL(e);
d=void 0}else d=!1;d||window.navigator.msSaveOrOpenBlob&&window.navigator.msSaveOrOpenBlob(K(a),b)};a.isProtocolRelative=G;a.hasProtocol=I;a.toHTTP=function(a){return G(a)?"http:"+a:a.replace(ba,"http:")};a.toHTTPS=R;a.isAppHTTPS=M;a.removeFile=function(a){var b=0;if(B(a)){var d=a.indexOf("//");-1!==d&&(b=d+2)}d=a.lastIndexOf("/");return d<b?a:a.slice(0,d+1)};a.removeTrailingSlash=function(a){return a.replace(/\/+$/,"")};a.changeDomain=U;a.fromJSON=S;a.read=function(a,b,d){return S(a,d)};a.toJSON=
X;a.write=function(a,b,d,e){(a=X(a,e))&&(b[d]=a)};a.isSVG=function(a){return ua.test(a)};a.removeQueryParameters=function(a,d){a=b(a);var e=Object.keys(a.query||{});0<e.length&&d&&d.warn("removeQueryParameters()","Url query parameters are not supported, the following parameters have been removed: "+e.join(", ")+".");return a.path};a.addQueryParameter=W;a.addQueryParameters=function(a,d){a=b(a);var e=a.query||{},f;for(f in d)e[f]=d[f];return(d=r(e))?a.path+"?"+d:a.path};a.removeQueryParameter=function(a,
d){var e=b(a),f=e.path,e=e.query;if(!e)return a;delete e[d];return(a=r(e))?f+"?"+a:f};a.addTokenParameter=function(a){var b=k.id&&k.id.findCredential(a);return b&&b.token?W(a,"token",b.token):a};var ua=/(^data:image\/svg|\.svg$)/i})},"esri/core/workers/WorkerFallback":function(){define("require exports ../tsSupport/generatorHelper ../tsSupport/awaiterHelper ../global ../has ../promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(c,a,l,g,k,h,f,e){var p=function(){return function(){var a=
this,b=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(d){a[d]=function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];return b[d].apply(b,a)}})}}(),b=k.MutationObserver||k.WebKitMutationObserver,d=function(){var a;if(k.process&&k.process.nextTick)a=function(a){k.process.nextTick(a)};else if(k.Promise)a=function(a){k.Promise.resolve().then(a)};else if(b){var d=[],e=document.createElement("div");(new b(function(){for(;0<d.length;)d.shift()()})).observe(e,
{attributes:!0});a=function(a){d.push(a);e.setAttribute("queueStatus","1")}}return a}(),m=function(){var a=k.MessageEvent;try{new a("message",{data:null})}catch(n){return function(a,b){void 0===b&&(b={});var d=b.data,e=b.bubbles,e=void 0===e?!1:e;b=b.cancelable;b=void 0===b?!1:b;var f=document.createEvent("Event");f.initEvent(a,e,b);f.data=d;return f}}return function(b,d){return new a(b,d)}}();return function(){function a(){this._dispatcher=new p;this._isInitialized=!1;this._workerPostMessage({type:e.MessageType.HANDSHAKE})}
a.prototype.terminate=function(){};Object.defineProperty(a.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(a){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=a)&&this.addEventListener("message",a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(a){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);
(this._onerrorHandler=a)&&this.addEventListener("error",a)},enumerable:!0,configurable:!0});a.prototype.postMessage=function(a){var b=this;d(function(){b._workerMessageHandler(m("message",{data:a}))})};a.prototype.dispatchEvent=function(a){return this._dispatcher.dispatchEvent(a)};a.prototype.addEventListener=function(a,b,d){this._dispatcher.addEventListener(a,b,d)};a.prototype.removeEventListener=function(a,b,d){this._dispatcher.removeEventListener(a,b,d)};a.prototype._workerPostMessage=function(a){var b=
this;d(function(){b.dispatchEvent(m("message",{data:a}))})};a.prototype._workerMessageHandler=function(a){return g(this,void 0,void 0,function(){var b,d,h,m,n,g,p,k,r=this;return l(this,function(u){switch(u.label){case 0:b=e.receiveMessage(a);if(!b)return[2];d=b.type;switch(d){case e.MessageType.CONFIGURE:return[3,1];case e.MessageType.OPEN:return[3,2]}return[3,27];case 1:return this._isInitialized||this._workerPostMessage({type:e.MessageType.CONFIGURED}),[3,27];case 2:return h=b.modulePath,m=b.jobId,
[3,25];case 3:g=u.sent();p=h;switch(p){case "esri/tasks/operations/PBFWorker":return[3,4];case "esri/views/2d/engine/vectorTiles/WorkerTileHandler":return[3,6];case "esri/views/2d/layers/features/Pipeline":return[3,8];case "esri/views/3d/layers/PointCloudWorker":return[3,10];case "esri/views/3d/layers/SceneLayerWorker":return[3,12];case "esri/layers/graphics/sources/support/CSVSourceWorker":return[3,14];case "esri/layers/support/LercWorker":return[3,16];case "esri/views/3d/webgl-engine/lib/edgeRendering/EdgeProcessingWorker":return[3,
18];case "esri/geometry/support/meshUtils/ElevationSamplerWorker":return[3,20]}return[3,22];case 4:return[4,new Promise(function(a,b){c(["esri/tasks/operations/PBFWorker"],a,b)})];case 5:return n=u.sent(),[3,24];case 6:return[4,new Promise(function(a,b){c(["esri/views/2d/engine/vectorTiles/WorkerTileHandler"],a,b)})];case 7:return n=u.sent(),[3,24];case 8:return[4,new Promise(function(a,b){c(["esri/views/2d/layers/features/Pipeline"],a,b)})];case 9:return n=u.sent(),[3,24];case 10:return[4,new Promise(function(a,
b){c(["esri/views/3d/layers/PointCloudWorker"],a,b)})];case 11:return n=u.sent(),[3,24];case 12:return[4,new Promise(function(a,b){c(["esri/views/3d/layers/SceneLayerWorker"],a,b)})];case 13:return n=u.sent(),[3,24];case 14:return[4,new Promise(function(a,b){c(["esri/layers/graphics/sources/support/CSVSourceWorker"],a,b)})];case 15:return n=u.sent(),[3,24];case 16:return[4,new Promise(function(a,b){c(["esri/layers/support/LercWorker"],a,b)})];case 17:return n=u.sent(),[3,24];case 18:return[4,new Promise(function(a,
b){c(["esri/views/3d/webgl-engine/lib/edgeRendering/EdgeProcessingWorker"],a,b)})];case 19:return n=u.sent(),[3,24];case 20:return[4,new Promise(function(a,b){c(["esri/geometry/support/meshUtils/ElevationSamplerWorker"],a,b)})];case 21:return n=u.sent(),[3,24];case 22:return[4,f.create(function(a){return c([h],a)})];case 23:n=u.sent(),u.label=24;case 24:return k=g.connect(n),this._workerPostMessage({type:e.MessageType.OPENED,jobId:m,data:k}),[3,26];case 25:c(["esri/core/workers/RemoteClient",h],function(a,
b){a=a.connect(b);r._workerPostMessage({type:e.MessageType.OPENED,jobId:m,data:a})}),u.label=26;case 26:return[3,27];case 27:return[2]}})})};return a}()})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(c,a,l,g,k,h,f,e){function p(a,b){return a?b?4:3:b?3:2}function b(a,b,d,e){if(a){if(d)return b&&e?W:S;if(b&&e)return X}else if(b&&
e)return S;return V}function d(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function m(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function r(a,b){return b*a.scale[0]+a.translate[0]}function n(a,b){return a.translate[1]-b*a.scale[1]}function u(a){a=a.coords;return{x:a[0],y:a[1]}}function y(a,b){a.coords[0]=b.x;a.coords[1]=b.y;return a}function w(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function t(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;return a}function v(a){a=a.coords;
return{x:a[0],y:a[1],m:a[2]}}function z(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.m;return a}function A(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function C(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;a.coords[3]=b.m;return a}function D(a,b){return a&&b?C:a?t:b?z:y}function B(a,b,d){if(!a)return null;for(var e=p(b,d),f=[],c=0;c<a.coords.length;c+=e){for(var h=[],m=0;m<e;m++)h.push(a.coords[c+m]);f.push(h)}return b?d?{points:f,hasZ:b,hasM:d}:{points:f,hasZ:b}:d?{points:f,
hasM:d}:{points:f}}function E(a,b,d){void 0===d&&(d=p(b.hasZ,b.hasM));a.lengths[0]=b.points.length;var e=a.coords,f=0,c=0;for(b=b.points;c<b.length;c++)for(var h=b[c],m=0;m<d;m++)e[f++]=h[m];return a}function F(a,b,d){if(!a)return null;var e=p(b,d),f=a.coords,c=[],h=0,m=0;for(a=a.lengths;m<a.length;m++){for(var n=a[m],g=[],k=0;k<n;k++){for(var r=[],u=0;u<e;u++)r.push(f[h++]);g.push(r)}c.push(g)}return b?d?{paths:c,hasZ:b,hasM:d}:{paths:c,hasZ:b}:d?{paths:c,hasM:d}:{paths:c}}function H(a,b,d){void 0===
d&&(d=p(b.hasZ,b.hasM));var e=a.lengths,f=a.coords,c=0,h=0;for(b=b.paths;h<b.length;h++){for(var m=b[h],n=0,g=m;n<g.length;n++)for(var k=g[n],r=0;r<d;r++)f[c++]=k[r];e.push(m.length)}return a}function J(a,b,d){if(!a)return null;var e=p(b,d),f=a.coords,c=[],h=0,m=0;for(a=a.lengths;m<a.length;m++){for(var n=a[m],g=[],k=0;k<n;k++){for(var r=[],u=0;u<e;u++)r.push(f[h++]);g.push(r)}c.push(g)}return b?d?{rings:c,hasZ:b,hasM:d}:{rings:c,hasZ:b}:d?{rings:c,hasM:d}:{rings:c}}function K(a,b,d,e){void 0===d&&
(d=b.hasZ);void 0===e&&(e=b.hasM);G(a,b.rings,d,e);return a}function G(a,b,d,e){d=p(d,e);e=a.lengths;for(var f=a.coords,c=0,h=e.length=f.length=0;h<b.length;h++){for(var m=b[h],n=0,g=m;n<g.length;n++)for(var k=g[n],r=0;r<d;r++)f[c++]=k[r];e.push(m.length)}return a}function I(a,b,d,f,c,m){a.length=0;if(!d){for(f=0;f<b.length;f++)c=b[f],a.push(new h.default(null,c.attributes,null,c.attributes[m]));return a}switch(d){case "esriGeometryPoint":f=D(f,c);for(c=0;c<b.length;c++){var n=b[c];d=n.geometry;var n=
n.attributes,g=void 0;d&&(g=f(new e.default,d));a.push(new h.default(g,n,null,n[m]))}break;case "esriGeometryMultipoint":f=p(f,c);for(c=0;c<b.length;c++)n=b[c],d=n.geometry,n=n.attributes,g=void 0,d&&(g=E(new e.default,d,f)),a.push(new h.default(g,n,null,n[m]));break;case "esriGeometryPolyline":f=p(f,c);for(c=0;c<b.length;c++)n=b[c],d=n.geometry,n=n.attributes,g=void 0,d&&(g=H(new e.default,d,f)),a.push(new h.default(g,n,null,n[m]));break;case "esriGeometryPolygon":for(d=0;d<b.length;d++){var k=b[d],
n=k.geometry,g=k.centroid,k=k.attributes,r=void 0;n&&(r=K(new e.default,n,f,c));g?a.push(new h.default(r,k,y(new e.default,g),k[m])):a.push(new h.default(r,k,null,k[m]))}break;default:N.error("convertToFeatureSet:unknown-geometry",new l("Unable to parse unknown geometry type '"+d+"'")),a.length=0}return a}function L(a,b,d,e,f){a.length=0;switch(d){case "esriGeometryPoint":d=u;e&&f?d=A:e?d=w:f&&(d=v);for(e=0;e<b.length;e++){var c=b[e];f=c.geometry;c=c.attributes;f=f?d(f):null;a.push({attributes:c,
geometry:f})}break;case "esriGeometryMultipoint":for(d=0;d<b.length;d++){var h=b[d],c=h.geometry,h=h.attributes,m=void 0;c&&(m=B(c,e,f));a.push({attributes:h,geometry:m})}break;case "esriGeometryPolyline":for(d=0;d<b.length;d++)h=b[d],c=h.geometry,h=h.attributes,m=void 0,c&&(m=F(c,e,f)),a.push({attributes:h,geometry:m});break;case "esriGeometryPolygon":for(d=0;d<b.length;d++){var m=b[d],h=m.geometry,c=m.attributes,n=m.centroid,m=void 0;h&&(m=J(h,e,f));n?(h=u(n),a.push({attributes:c,centroid:h,geometry:m})):
a.push({attributes:c,geometry:m})}break;default:N.error("convertToFeatureSet:unknown-geometry",new l("Unable to parse unknown geometry type '"+d+"'"))}return a}function R(a,e,f,c,h,n,g,k){void 0===g&&(g=f);void 0===k&&(k=c);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!e||!e.coords.length)return null;h=U[h];var r=e.coords;e=e.lengths;var u=p(f,c),w=p(f&&g,c&&k);f=b(f,c,g,k);if(!e.length)return f(a.coords,r,0,0,d(n,r[0]),m(n,r[1])),a.lengths.length&&(a.lengths.length=
0),a.coords.length=u,a;for(var t,v=0,y,l=0,z=0;z<e.length;z++){var G=e[z];if(!(G<h)){var I=0;y=l;k=c=d(n,r[v]);t=g=m(n,r[v+1]);f(a.coords,r,y,v,k,t);I++;v+=u;y+=w;for(var A=1;A<G;A++,v+=u)if(k=d(n,r[v]),t=m(n,r[v+1]),k!==c||t!==g)f(a.coords,r,y,v,k-c,t-g),y+=w,I++,c=k,g=t;I>=h&&(a.lengths.push(I),l=y)}}a.coords.length=l;return a.coords.length?a:null}function M(a,b,d,e,f,c,h){for(var m=e,n=0,g,p=c+d;p<h;p+=d){g=b[p];var k=b[p+1],r=b[h],u=b[h+1],w=b[c],t=b[c+1],v=r-w,y=u-t;if(0!==v||0!==y){var l=((g-
w)*v+(k-t)*y)/(v*v+y*y);1<l?(w=r,t=u):0<l&&(w+=v*l,t+=y*l)}v=g-w;y=k-t;g=v*v+y*y;g>m&&(n=p,m=g)}m>e&&(n-c>d&&M(a,b,d,e,f,c,n),f(a,b,a.length,n,b[n],b[n+1]),h-n>d&&M(a,b,d,e,f,n,h))}function Q(a,b,d,e,f){var c=b.coords,h=b.lengths,m=d?e?W:S:e?S:V;d=p(d,e);if(!c.length)return a!==b&&(a.lengths.length=0,a.coords.length=0),a;if(!h.length)return m(a.coords,c,0,0,r(f,c[0]),n(f,c[1])),a!==b&&(a.lengths.length=0,a.coords.length=d),a;var g=f.scale;e=g[0];for(var g=g[1],k=0,u=0;u<h.length;u++){var w=h[u];a.lengths[u]=
w;var t=r(f,c[k]),v=n(f,c[k+1]);m(a.coords,c,k,k,t,v);for(var k=k+d,y=1;y<w;y++,k+=d)t+=c[k]*e,v-=c[k+1]*g,m(a.coords,c,k,k,t,v)}a!==b&&(a.lengths.length=h.length,a.coords.length=c.length);return a}Object.defineProperty(a,"__esModule",{value:!0});var N=g.getLogger("esri.tasks.support.optimizedFeatureSet"),U={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},V=function(a,b,d,e,f,c){a[d]=f;a[d+1]=c},S=function(a,b,d,e,f,c){a[d]=f;a[d+1]=c;a[d+2]=b[e+2]},X=function(a,
b,d,e,f,c){a[d]=f;a[d+1]=c;a[d+2]=b[e+3]},W=function(a,b,d,e,f,c){a[d]=f;a[d+1]=c;a[d+2]=b[e+2];a[d+3]=b[e+3]};a.quantizeX=d;a.quantizeY=m;a.hydrateX=r;a.hydrateY=n;a.convertToPoint=function(a,b,d){return a?b?d?A(a):w(a):d?v(a):u(a):null};a.convertFromPoint=function(a,b,d){void 0===d&&(d=D(null!=b.z,null!=b.m));return d(a,b)};a.convertToMultipoint=B;a.convertFromMultipoint=E;a.convertToPolyline=F;a.convertFromPolyline=H;a.convertToPolygon=J;a.convertFromPolygon=K;a.convertFromNestedArray=G;var Y=
[],T=[];a.convertFromFeature=function(a,b,d,e,f){Y[0]=a;a=I(T,Y,b,d,e,f)[0];Y.length=T.length=0;return a};a.convertFromFeatures=I;a.convertToFeature=function(a,b,d,e){T[0]=a;L(Y,T,b,d,e);a=Y[0];Y.length=T.length=0;return a};a.convertFromGeometry=function(a,b,d){if(!a)return null;var f=new e.default;"hasZ"in a&&null==b&&(b=a.hasZ);"hasM"in a&&null==d&&(d=a.hasM);if(k.isPoint(a))return D(null!=b?b:null!=a.z,null!=d?d:null!=a.m)(f,a);if(k.isPolygon(a))return K(f,a,b,d);if(k.isPolyline(a))return H(f,
a,p(b,d));if(k.isMultipoint(a))return E(f,a,p(b,d));N.error("convertFromGeometry:unknown-geometry",new l("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=function(a,b,d,e){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(b){case "esriGeometryPoint":return b=u,d&&e?b=A:d?b=w:e&&(b=v),b(a);case "esriGeometryMultipoint":return B(a,d,e);case "esriGeometryPolyline":return F(a,d,e);case "esriGeometryPolygon":return J(a,d,e);default:N.error("convertToGeometry:unknown-geometry",
new l("Unable to parse unknown geometry type '"+b+"'"))}};a.convertToFeatures=L;a.convertToFeatureSet=function(a){var b=a.objectIdFieldName,d=a.spatialReference,e=a.transform,f=a.fields,c=a.hasM,h=a.hasZ,m=a.geometryType,n=a.exceededTransferLimit;a={features:L([],a.features,m,h,c),fields:f,geometryType:m,objectIdFieldName:b,spatialReference:d};e&&(a.transform=e);n&&(a.exceededTransferLimit=n);c&&(a.hasM=c);h&&(a.hasZ=h);return a};a.convertFromFeatureSet=function(a,b){var d=new f.default,e=a.hasM,
c=a.hasZ,h=a.features,m=a.objectIdFieldName,n=a.spatialReference,g=a.geometryType,p=a.exceededTransferLimit,k=a.transform;d.fields=a.fields;d.geometryType=g;d.objectIdFieldName=m||b;d.spatialReference=n;if(!d.objectIdFieldName)return N.error(new l("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),d;h&&I(d.features,h,g,c,e,d.objectIdFieldName);p&&(d.exceededTransferLimit=p);e&&(d.hasM=e);c&&(d.hasZ=c);k&&(d.transform=k);return d};a.hydrateOptimizedFeatureSet=function(a){var b=
a.transform,d=a.hasM,e=a.hasZ;if(!b)return a;for(var f=0,c=a.features;f<c.length;f++){var h=c[f];h.geometry&&Q(h.geometry,h.geometry,d,e,b);h.centroid&&Q(h.centroid,h.centroid,d,e,b)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,b){var d=b.geometryType,f=b.features,c=b.hasM,m=b.hasZ;if(!a)return b;for(var n=0;n<f.length;n++){var g=f[n],p=new h.default(new e.default,g.attributes);R(p.geometry,g.geometry,c,m,d,a);g.centroid&&(p.centroid=new e.default,R(p.centroid,g.centroid,c,
m,"esriGeometryPoint",a));f[n]=p}b.transform=a;return b};a.quantizeOptimizedGeometry=R;a.generalizeOptimizedGeometry=function(a,d,e,f,c,h,m,n){void 0===m&&(m=e);void 0===n&&(n=f);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!d||!d.coords.length)return null;c=U[c];var g=d.coords;d=d.lengths;var k=p(e,f),r=p(e&&m,f&&n);e=b(e,f,m,n);if(!d.length)return e(a.coords,g,0,0,g[0],g[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=k,a;f=0;h*=h;for(m=0;m<d.length;m++){n=
d[m];if(!(n<c)){var u=a.coords.length/r,w=f,t=f+(n-1)*k;e(a.coords,g,a.coords.length,w,g[w],g[w+1]);M(a.coords,g,k,h,e,w,t);e(a.coords,g,a.coords.length,t,g[t],g[t+1]);w=a.coords.length/r-u;w>=c?a.lengths.push(w):a.coords.length=u*r}f+=n*k}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,b,d,e){d=p(d,e);var f=e=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;if(b&&b.coords){b=b.coords;for(var m=0;m<b.length;m+=d){var n=b[m],g=b[m+1];e=Math.min(e,
n);c=Math.max(c,n);f=Math.min(f,g);h=Math.max(h,g)}}a[0]=e;a[1]=f;a[2]=c;a[3]=h;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,b,d,e){d=p(d,e);e=b.coords;var f=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,m=Number.NEGATIVE_INFINITY,n=0,g=0;for(b=b.lengths;g<b.length;g++)for(var k=b[g],r=e[n],u=e[n+1],f=Math.min(r,f),c=Math.min(u,c),h=Math.max(r,h),m=Math.max(u,m),n=n+d,w=1;w<k;w++,n+=d){var t=e[n],v=e[n+1],r=r+t,u=u+v;0>t&&(f=Math.min(f,r));0<t&&(h=Math.max(h,
r));0>v?c=Math.min(c,u):0<v&&(m=Math.max(m,u))}a[0]=f;a[1]=c;a[2]=h;a[3]=m;return a};a.hydrateOptimizedGeometry=Q;a.removeZMValues=function(a,d,e,f,c,h){var m,n=p(e,f);e=b(e,f,c,h);f=d.coords;a.coords.length=0;a.lengths.length=0;(m=a.lengths).push.apply(m,d.lengths);for(d=0;d<f.length;d+=n)e(a.coords,f,a.coords.length,d,f[d],f[d+1]);return a};a.removeCollinearVectices=function(a,d,e,f,c){if(!d||!d.coords||!d.coords.length)return null;e=U[e];var h=d.coords;d=d.lengths;var m=b(f,c,f,c);f=p(f,c);for(var n=
c=0,g=0,k=0,r=0;r<d.length;r++){var u=d[r],n=k;m(a.coords,h,n,c,h[c],h[c+1]);c+=f;var w=h[c],t=h[c+1],v=w,y=t,l=t/w,n=n+f;m(a.coords,h,n,c,v,y);c+=f;for(var z=2;z<u;z++){var w=h[c],t=h[c+1],G=t/w,I=l===G||!isFinite(l)&&!isFinite(G),l=I&&isFinite(G)?0<=l&&0<=G||0>=l&&0>=G:0<=y&&0<=t||0>=y&&0>=t;I&&l?(v+=w,y+=t):(v=w,y=t,n+=f);m(a.coords,h,n,c,v,y);c+=f;l=G}n+=f;u=(n-k)/f;u>=e&&(a.lengths[g]=u,k=n,g++)}a.coords.length>n&&(a.coords.length=n);a.lengths.length>g&&(a.lengths.length=g);return a.coords.length?
a:null}})},"esri/layers/graphics/OptimizedFeature":function(){define(["require","exports","../../core/tsSupport/extendsHelper"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){return function(a,c,h,f){void 0===a&&(a=null);void 0===c&&(c={});this.localId=0;this.geohashIndexed=!1;this.geohashY=this.geohashX=0;this.geometry=a;c&&(this.attributes=c);h&&(this.centroid=h);null!=f&&(this.objectId=f)}}();a.default=c})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["require",
"exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){return function(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1}}();a.default=c})},"esri/layers/graphics/OptimizedGeometry":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});
c=function(){return function(a,c){void 0===a&&(a=[]);void 0===c&&(c=[]);this.lengths=a;this.coords=c}}();a.default=c})},"esri/tasks/operations/query":function(){define("require exports ../../core/tsSupport/assignHelper ../../request ../../core/maybe ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/normalizeUtils ./pbfQueryUtils ./PBFWorker ./urlUtils @dojo/framework/shim/Promise".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){function m(a,b){var d=a.geometry;a=a.toJSON();d&&
(a.geometry=JSON.stringify(d),a.geometryType=f.getJsonType(d),a.inSR=d.spatialReference.wkid||JSON.stringify(d.spatialReference));a.groupByFieldsForStatistics&&(a.groupByFieldsForStatistics=a.groupByFieldsForStatistics.join(","));a.objectIds&&(a.objectIds=a.objectIds.join(","));a.orderByFields&&(a.orderByFields=a.orderByFields.join(","));!a.outFields||b&&(b.returnCountOnly||b.returnExtentOnly||b.returnIdsOnly)?delete a.outFields:-1!==a.outFields.indexOf("*")?a.outFields="*":a.outFields=a.outFields.join(",");
a.outSR?a.outSR=a.outSR.wkid||JSON.stringify(a.outSR):d&&(a.returnGeometry||a.returnCentroid)&&(a.outSR=a.inSR);a.returnGeometry&&delete a.returnGeometry;a.outStatistics&&(a.outStatistics=JSON.stringify(a.outStatistics));a.pixelSize&&(a.pixelSize=JSON.stringify(a.pixelSize));a.quantizationParameters&&(a.quantizationParameters=JSON.stringify(a.quantizationParameters));a.source&&(a.layer=JSON.stringify({source:a.source}),delete a.source);if(a.timeExtent){d=a.timeExtent;b=d.start;d=d.end;if(null!=b||
null!=d)a.time=b===d?b:(null==b?"null":b)+","+(null==d?"null":d);delete a.timeExtent}return a}function r(a,b,f,c,n){void 0===c&&(c={});var p="string"===typeof a?h.urlToObject(a):a;a=b.geometry?[b.geometry]:[];c.responseType="pbf"===f?"array-buffer":"json";return e.normalizeCentralMeridian(a,null,c).then(function(a){a=a&&a[0];k.isSome(a)&&(b=b.clone(),b.geometry=a);a=d.mapParameters(l({},p.query,{f:f},n,m(b,n)));return g(p.path+"/query",l({},c,{query:a}))})}Object.defineProperty(a,"__esModule",{value:!0});
a.queryToQueryStringParameters=m;a.executeQuery=function(a,b,d){return r(a,b,"json",d)};a.executeQueryPBF=function(a,d,e,f){var c;e.useWorker?(null==n&&(n=new b.PBFWorker),c=n):c=null;var h=c;return r(a,d,"pbf",f).then(function(a){var b=function(b){a.data=b;return a};return e.useWorker?h.parseFeatureQuery(a.data,e).then(function(a){return b(a)}):b(p.parsePBFFeatureQuery(a.data,e))})};a.executeQueryForIds=function(a,b,d){return r(a,b,"json",d,{returnIdsOnly:!0})};a.executeQueryForCount=function(a,
b,d){return r(a,b,"json",d,{returnIdsOnly:!0,returnCountOnly:!0})};a.executeQueryForExtent=function(a,b,d){return r(a,b,"json",d,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(a){var b=a.data;if(b.hasOwnProperty("extent"))return a;if(b.features)throw Error("Layer does not support extent calculation.");if(b.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return a})};var n})},"esri/request":function(){define("require exports ./core/tsSupport/assignHelper ./core/tsSupport/awaiterHelper ./core/tsSupport/generatorHelper ./config ./kernel ./core/Error ./core/global ./core/has ./core/lang ./core/promiseUtils ./core/string ./core/urlUtils @dojo/framework/shim/Promise".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){function u(a,b){var d=m.createAbortController();return m.create(function(e,f){y(d.signal,a,b).then(e).catch(f)},function(){d.abort()})}function y(a,d,e){return g(this,void 0,void 0,function(){var f,c,g,p,r,u,w,t;return k(this,function(k){switch(k.label){case 0:return f=n.isDataProtocol(d),(c=n.isBlobProtocol(d))||f||(d=n.normalize(d)),g={url:d,requestOptions:l({},e)},(p=n.getInterceptor(d))?[4,F(p,g)]:[3,2];case 1:r=k.sent();if(null!=r)return[2,{data:r,getHeader:U,
requestOptions:g.requestOptions,url:g.url}];p.after||p.error||(p=null);k.label=2;case 2:d=g.url;e=g.requestOptions;if("image"===e.responseType){if(b("host-webworker"))throw z("request:invalid-parameters",Error("responseType 'image' is not supported in Web Workers or Node environment"),g);}else if(f)throw z("request:invalid-parameters",Error("Data URLs are not supported for responseType \x3d "+e.responseType),g);if("head"===e.method){if(e.body)throw z("request:invalid-parameters",Error("body parameter cannot be set when method is 'head'"),
g);if(f||c)throw z("request:invalid-parameters",Error("data and blob URLs are not supported for method 'head'"),g);}return[4,A()];case 3:k.sent();if(L)return[2,L.execute(d,e)];u=m.createAbortController();m.onAbort(a,function(){return u.abort()});m.onAbort(e,function(){return u.abort()});w={controller:u,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:p,params:g,redoRequest:!1,useIdentity:h.request.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1};return[4,K(w)];case 4:return t=
k.sent(),p&&p.after&&p.after(t),[2,t]}})})}function w(a){n.isBlobProtocol(a)||n.isDataProtocol(a)||(a=n.getOrigin(a))&&-1===u._corsServers.indexOf(a)&&u._corsServers.push(a)}function t(a){a=n.getOrigin(a);return!a||r.endsWith(a,".arcgis.com")||-1!==u._corsServers.indexOf(a)||n.isTrustedServer(a)}function v(){var a;try{a=new DOMException("Aborted","AbortError")}catch(S){a=Error("Aborted"),a.name="AbortError"}return a}function z(a,b,f,c){var h="Error",m={url:f.url,requestOptions:f.requestOptions,getHeader:U,
ssl:!1};if(b instanceof e)return b.details?(b.details=d.clone(b.details),b.details.url=f.url,b.details.requestOptions=f.requestOptions):b.details=m,b;if(b){f=c&&function(a){return c.headers.get(a)};var n=c&&c.status,g=b.message;g&&(h=g);f&&(m.getHeader=f);m.httpStatus=(null!=b.httpCode?b.httpCode:b.code)||n||0;m.subCode=b.subcode;m.messageCode=b.messageCode;m.messages="string"===typeof b.details?[b.details]:b.details}a=new e(a,h,m);b&&"cancel"===b.dojoType&&(a.dojoType="cancel");return a}function A(){return g(this,
void 0,void 0,function(){var a;return k(this,function(d){switch(d.label){case 0:return b("host-webworker")?L?[3,2]:[4,new Promise(function(a,b){c(["./core/workers/request"],a,b)})]:[3,3];case 1:L=d.sent(),d.label=2;case 2:return[3,6];case 3:if(u._abortableFetch)return[3,6];if(!b("esri-abortable-fetch")||!b("esri-native-promise")&&(13>b("safari")||13>b("ios")))return[3,4];u._abortableFetch=p.fetch.bind(p);return[3,6];case 4:return a=u,[4,new Promise(function(a,b){c(["whatwg-fetch"],a,b)})];case 5:a._abortableFetch=
d.sent().fetch,d.label=6;case 6:return[2]}})})}function C(){return g(this,void 0,void 0,function(){return k(this,function(a){switch(a.label){case 0:return f.id?[3,2]:[4,new Promise(function(a,b){c(["./identity/IdentityManager"],a,b)})];case 1:a.sent(),a.label=2;case 2:return[2]}})})}function D(a){return g(this,void 0,void 0,function(){var b,d,e,c,h,n,g,r;return k(this,function(k){switch(k.label){case 0:b=a.params.url;d=a.params.requestOptions;e=a.controller.signal;c=d.body;g=n=h=null;R&&"HTMLFormElement"in
p&&(c instanceof FormData?h=c:c instanceof HTMLFormElement&&(n=c,h=new FormData(n)));"string"===typeof c&&(g=c);a.fetchOptions={cache:d.cacheBust&&!u._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:d.headers||{},method:"head"===d.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:e};if(h||g)a.fetchOptions.body=h||g;"anonymous"===d.authMode&&(a.useIdentity=!1);a.hasToken=!!(/token=/i.test(b)||d.query&&d.query.token||h&&h.get&&h.get("token")||n&&n.elements.token);
if(!a.useIdentity||a.hasToken||a.credentialToken||B(b)||m.isAborted(e))return[3,11];r=void 0;return"immediate"!==d.authMode?[3,3]:[4,C()];case 1:return k.sent(),[4,f.id.getCredential(b,{signal:e})];case 2:return r=k.sent(),a.credential=r,[3,10];case 3:return"no-prompt"!==d.authMode?[3,9]:[4,C()];case 4:k.sent(),k.label=5;case 5:return k.trys.push([5,7,,8]),[4,f.id.getCredential(b,{prompt:!1,signal:e})];case 6:return r=k.sent(),a.credential=r,[3,8];case 7:return k.sent(),[3,8];case 8:return[3,10];
case 9:f.id&&(r=f.id.findCredential(b)),k.label=10;case 10:r&&(a.credentialToken=r.token,a.useSSL=!!r.ssl),k.label=11;case 11:return[2]}})})}function B(a){return N.some(function(b){return b.test(a)})}function E(a){return g(this,void 0,void 0,function(){var d,e,c,g,p,r,v,y,G,A,K,C,D,L,F,E,B,Q,M,N,V,U,fa;return k(this,function(k){switch(k.label){case 0:d=a.params.url;e=a.params.requestOptions;c=a.fetchOptions;g=n.isBlobProtocol(d)||n.isDataProtocol(d);p=e.responseType||"json";r=g?0:null!=e.timeout?
e.timeout:h.request.timeout;v=!1;if(!g){a.useSSL&&(d=n.toHTTPS(d));e.cacheBust&&"default"===c.cache&&(d=n.addQueryParameter(d,"request.preventCache",Date.now()));y=l({},e.query);a.credentialToken&&(y.token=a.credentialToken);G=n.objectToQuery(y);b("esri-url-encodes-apostrophe")&&(G=G.replace(/'/g,"%27"));A=d.length+1+G.length;K=void 0;v="post"===e.method||!!e.body||A>h.request.maxUrlLength;if(C=e.useProxy||!!n.getProxyRule(d))D=n.getProxyUrl(d),K=D.path,!v&&K.length+1+A>h.request.maxUrlLength&&(v=
!0),D.query&&(y=l({},D.query,y));if("HEAD"===c.method&&(v||C)){if(v){if(A>h.request.maxUrlLength)throw z("request:invalid-parameters",Error("URL exceeds maximum length"),a.params);throw z("request:invalid-parameters",Error("cannot use POST request when method is 'head'"),a.params);}if(C)throw z("request:invalid-parameters",Error("cannot use proxy when method is 'head'"),a.params);}v?(c.method="POST",e.body?d=n.addQueryParameters(d,y):(c.body=n.objectToQuery(y),c.headers["Content-Type"]="application/x-www-form-urlencoded")):
d=n.addQueryParameters(d,y);C&&(a.useProxy=!0,d=K+"?"+d);y.token&&R&&c.body instanceof FormData&&(L=c.body,L.set?L.set("token",y.token):L.append("token",y.token));e.hasOwnProperty("withCredentials")?a.withCredentials=e.withCredentials:n.isTrustedServer(d)?a.withCredentials=!0:f.id&&(F=f.id.findServerInfo(d))&&F.webTierAuth&&(a.withCredentials=!0);a.withCredentials&&(c.credentials="include")}E=0;B=!1;0<r&&(E=setTimeout(function(){B=!0;a.controller.abort()},r));k.label=1;case 1:return k.trys.push([1,
18,19,20]),"image"!==e.responseType||"default"!==c.cache||"GET"!==c.method||v||H(e.headers)||!g&&!a.useProxy&&h.request.proxyUrl&&!t(d)?[3,3]:[4,I(d,a)];case 2:return M=k.sent(),[3,17];case 3:return[4,u._abortableFetch(d,c)];case 4:Q=k.sent();a.useProxy||w(d);if(!Q.ok||"HEAD"===c.method)return[3,17];N=p;switch(N){case "array-buffer":return[3,5];case "blob":return[3,7];case "image":return[3,7]}return[3,9];case 5:return[4,Q.arrayBuffer()];case 6:return M=k.sent(),[3,11];case 7:return[4,Q.blob()];case 8:return M=
k.sent(),[3,11];case 9:return[4,Q.text()];case 10:return M=k.sent(),[3,11];case 11:E&&(clearTimeout(E),E=0);if("json"===p||"xml"===p||"document"===p)if(M)switch(p){case "json":M=JSON.parse(M);break;case "xml":M=J(M,"application/xml");break;case "document":M=J(M,"text/html")}else M=null;V=Q.headers.get("Content-Type");if(!/application\/json|text\/plain/i.test(V)||!(M instanceof ArrayBuffer&&750>=M.byteLength||M instanceof Blob&&750>=M.size))return[3,15];k.label=12;case 12:return k.trys.push([12,14,
,15]),[4,(new Response(M)).json()];case 13:return U=k.sent(),U.error&&(M=U),[3,15];case 14:return k.sent(),[3,15];case 15:return"image"===p&&M instanceof Blob?[4,I(URL.createObjectURL(M),a,!0)]:[3,17];case 16:M=k.sent(),k.label=17;case 17:return[3,20];case 18:fa=k.sent();if("AbortError"===fa.name){if(B)throw Error("Timeout exceeded");throw m.createAbortError("Request canceled");}if(!Q&&fa instanceof TypeError&&h.request.proxyUrl&&!e.body&&"post"!==e.method&&"head"!==e.method&&!a.useProxy)a.redoRequest=
!0,n.addProxyRule({proxyUrl:h.request.proxyUrl,urlPrefix:n.removeFile(n.urlToObject(d).path)});else throw fa;return[3,20];case 19:return E&&clearTimeout(E),[7];case 20:return[2,[Q,M]]}})})}function F(a,b){return g(this,void 0,void 0,function(){var d,f,c;return k(this,function(h){switch(h.label){case 0:if(null!=a.responseData)return[2,a.responseData];a.headers&&(b.requestOptions.headers=l({},b.requestOptions.headers,a.headers));a.query&&(b.requestOptions.query=l({},b.requestOptions.query,a.query));
if(!a.before)return[3,5];f=d=void 0;h.label=1;case 1:return h.trys.push([1,3,,4]),[4,a.before(b)];case 2:return f=h.sent(),[3,4];case 3:return c=h.sent(),d=z("request:interceptor",c,b),[3,4];case 4:if(f instanceof Error||f instanceof e)d=z("request:interceptor",f,b);if(d)throw a.error&&a.error(d),d;return[2,f];case 5:return[2]}})})}function H(a){if(a)for(var b=0,d=Object.getOwnPropertyNames(a);b<d.length;b++)if(a[d[b]])return!0;return!1}function J(a,b){var d;try{d=(new DOMParser).parseFromString(a,
b)}catch(W){}if(!d||d.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return d}function K(a){return g(this,void 0,void 0,function(){var b,d,e,c,m,g,p,r,u,w,t;return k(this,function(k){switch(k.label){case 0:return[4,D(a)];case 1:k.sent(),k.label=2;case 2:k.trys.push([2,8,,9]),k.label=3;case 3:return[4,E(a)];case 4:b=k.sent(),d=b[0],e=b[1],k.label=5;case 5:return[4,G(a,d,e)];case 6:if(!k.sent())return[3,3];k.label=7;case 7:return[3,9];case 8:throw c=k.sent(),m=z("request:server",
c,a.params,d),m.details.ssl=a.useSSL,a.interceptor&&a.interceptor.error&&a.interceptor.error(m),m;case 9:return g=a.params.url,/\/sharing\/rest\/(accounts|portals)\/self/i.test(g)&&!a.hasToken&&!a.credentialToken&&e&&e.user&&e.user.username&&!n.isTrustedServer(g)&&(p=n.getOrigin(g,!0))&&h.request.trustedServers.push(p),(r=a.credential)&&f.id&&(w=(u=f.id.findServerInfo(r.server))&&u.owningSystemUrl)&&(w=w.replace(/\/?$/,"/sharing"),(t=f.id.findCredential(w,r.userId))&&-1===f.id._getIdenticalSvcIdx(w,
t)&&t.resources.unshift(w)),[2,{data:e,getHeader:d?function(a){return d.headers.get(a)}:U,requestOptions:a.params.requestOptions,ssl:a.useSSL,url:a.params.url}]}})})}function G(a,b,e){return g(this,void 0,void 0,function(){var c,h,m,n,g,p,r;return k(this,function(k){switch(k.label){case 0:if(a.redoRequest)return a.redoRequest=!1,[2,!1];if(!b)return[2,!0];if(!b.ok)throw Error("Unable to load "+b.url+" status: "+b.status);e&&e.error&&(c=d.mixin(Error(),e.error));c&&(h=Number(c.code),m=c.hasOwnProperty("subcode")?
Number(c.subcode):null,n=(n=c.messageCode)&&n.toUpperCase());g=a.params.requestOptions.authMode;return 403===h&&(4===m||c.message&&-1<c.message.toLowerCase().indexOf("ssl")&&-1===c.message.toLowerCase().indexOf("permission"))?a.useSSL?[3,6]:(a.useSSL=!0,[2,!1]):[3,1];case 1:return!a.useIdentity||"no-prompt"===g&&498!==h||-1===M.indexOf(h)||B(a.params.url)||!(403!==h||-1===Q.indexOf(n)&&(null==m||2===m&&a.credentialToken))?[3,6]:[4,C()];case 2:k.sent(),k.label=3;case 3:return k.trys.push([3,5,,6]),
[4,f.id.getCredential(a.params.url,{error:z("request:server",c,a.params),prompt:"no-prompt"!==g,signal:a.controller.signal,token:a.credentialToken})];case 4:return p=k.sent(),a.credential=p,a.credentialToken=p.token,a.useSSL=a.useSSL||p.ssl,[2,!1];case 5:r=k.sent();if("no-prompt"===g)return a.credential=null,a.credentialToken=null,[2,!1];c=r;return[3,6];case 6:if(c)throw c;return[2,!0]}})})}function I(a,d,e){void 0===e&&(e=!1);return m.create(function(f,c){var h=d.controller.signal;if(m.isAborted(h))throw v();
var n=new Image;n.crossOrigin=d.withCredentials?"use-credentials":"anonymous";var g=function(){r();c(Error("Unable to load "+a))},p=function(){var a=n;r();f(a)},k=function(){if(n){var a=n;r();a.src="";c(v())}},r=function(){b("esri-image-decode")||(n.removeEventListener("error",g),n.removeEventListener("load",p));n=p=g=null;h.removeEventListener("abort",k);k=null;e&&URL.revokeObjectURL(a)};n.alt="";n.src=a;h.addEventListener("abort",k);b("esri-image-decode")?n.decode().then(p,g):(n.addEventListener("error",
g),n.addEventListener("load",p))})}var L,R="FormData"in p,M=[499,498,403,401],Q=["COM_0056","COM_0057","SB_0008"],N=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],U=function(){return null};u._abortableFetch=null;u._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];return u})},"esri/geometry/support/normalizeUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../config ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../Polygon ../Polyline ../SpatialReference ./spatialReferenceUtils ./webMercatorUtils ../../tasks/geometry/cut ../../tasks/geometry/simplify".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y){function w(a){return"polygon"===a.type?a.rings:a.paths}function t(a,b){return Math.ceil((a-b)/(2*b))}function v(a,b){for(var d=0,e=w(a);d<e.length;d++)for(var f=0,c=e[d];f<c.length;f++)c[f][0]+=b;return a}function z(a){for(var b=[],d=0,e=0,f=0;f<a.length;f++){for(var c=a[f],h=null,m=0;m<c.length;m++)h=c[m],b.push(h),0===m?e=d=h[0]:(d=Math.min(d,h[0]),e=Math.max(e,h[0]));h&&b.push([(d+e)/2,0])}return b}function A(a,e){if(!(a instanceof d||a instanceof b))throw F.error("straightLineDensify: the input geometry is neither polyline nor polygon"),
new h("straightLineDensify: the input geometry is neither polyline nor polygon");for(var f=[],c=0,m=w(a);c<m.length;c++){var n=m[c],g=[];f.push(g);g.push([n[0][0],n[0][1]]);for(var p=0;p<n.length-1;p++){var k=n[p][0],r=n[p][1],u=n[p+1][0],t=n[p+1][1],v=Math.sqrt((u-k)*(u-k)+(t-r)*(t-r)),y=(t-r)/v,l=(u-k)/v,z=v/e;if(1<z){for(var A=1;A<=z-1;A++){var H=A*e;g.push([l*H+k,y*H+r])}v=(v+Math.floor(z-1)*e)/2;g.push([l*v+k,y*v+r])}g.push([u,t])}}return"polygon"===a.type?new b({rings:f,spatialReference:a.spatialReference}):
new d({paths:f,spatialReference:a.spatialReference})}function C(a,b,d){b&&(a=A(a,1E6),a=n.webMercatorToGeographic(a,!0));d&&(a=v(a,d));return a}function D(a,b,d){if(Array.isArray(a)){var e=a[0];if(e>b){var f=t(e,b);a[0]=e+-2*f*b}else e<d&&(f=t(e,d),a[0]=e+-2*f*d)}else e=a.x,e>b?(f=t(e,b),a=a.clone().offset(-2*f*b,0)):e<d&&(f=t(e,d),a=a.clone().offset(-2*f*d,0));return a}function B(a,b){for(var d=-1,e=function(e){var f=b.cutIndexes[e],c=b.geometries[e],h=w(c);e=function(a){var b=h[a];b.some(function(d){if(180>
d[0])return!0;for(var e=d=0;e<b.length;e++){var f=b[e][0];d=f>d?f:d}d=Number(d.toFixed(9));d=-360*t(d,180);for(e=0;e<b.length;e++)f=c.getPoint(a,e),c.setPoint(a,e,f.clone().offset(d,0));return!0})};for(var m=0;m<h.length;m++)e(m);if(f===d)if("polygon"===a[0].type)for(e=0,m=w(c);e<m.length;e++)a[f]=a[f].addRing(m[e]);else{if("polyline"===a[0].type)for(e=0,m=w(c);e<m.length;e++)a[f]=a[f].addPath(m[e])}else d=f,a[f]=c},f=0;f<b.cutIndexes.length;f++)e(f);return a}function E(a,f,c){return g(this,void 0,
void 0,function(){var h,m,g,w,z,G,A,J,K,F,W,Y,T,ja,aa,ba,da,pa,ea,ta,qa,ma,oa,Ba,ua,Da,xa,Ca,za,ra,fa,va,na,sa,P,Ka,Ja;return l(this,function(l){switch(l.label){case 0:if(!Array.isArray(a))return[2,E([a],f)];h=f?f.url:k.geometryServiceUrl;F=0;W=[];Y=[];T=0;for(ja=a;T<ja.length;T++)aa=ja[T],e.isNone(aa)?Y.push(aa):(m||(m=aa.spatialReference,g=r.getInfo(m),A=(w=m.isWebMercator)?102100:4326,z=H[A].maxX,G=H[A].minX,J=H[A].plus180Line,K=H[A].minus180Line),g?"mesh"===aa.type?Y.push(aa):"point"===aa.type?
Y.push(D(aa.clone(),z,G)):"multipoint"===aa.type?(ba=aa.clone(),ba.points=ba.points.map(function(a){return D(a,z,G)}),Y.push(ba)):"extent"===aa.type?(da=aa.clone(),pa=da._normalize(!1,!1,g),Y.push(pa.rings?new b(pa):pa)):aa.extent?(da=aa.extent,ea=t(da.xmin,G),ta=2*ea*z,qa=0===ta?aa.clone():v(aa.clone(),ta),da.offset(ta,0),da.intersects(J)&&da.xmax!==z?(F=da.xmax>F?da.xmax:F,qa=C(qa,w),W.push(qa),Y.push("cut")):da.intersects(K)&&da.xmin!==G?(F=2*da.xmax*z>F?2*da.xmax*z:F,qa=C(qa,w,360),W.push(qa),
Y.push("cut")):Y.push(qa)):Y.push(aa.clone()):Y.push(aa));ma=t(F,z);oa=-90;Ba=ma;for(ua=new d;0<ma;)Da=-180+360*ma,ua.addPath([[Da,oa],[Da,-1*oa]]),oa*=-1,ma--;return 0<W.length&&0<Ba?[4,u.cut(h,W,ua,c)]:[3,3];case 1:xa=l.sent();Ca=B(W,xa);za=[];ra=[];for(fa=0;fa<Y.length;fa++)va=Y[fa],"cut"!==va?ra.push(va):(na=Ca.shift(),sa=a[fa],e.isSome(sa)&&"polygon"===sa.type&&sa.rings&&1<sa.rings.length&&na.rings.length>=sa.rings.length?(za.push(na),ra.push("simplify")):ra.push(w?n.geographicToWebMercator(na):
na));return za.length?[4,y.simplify(h,za,c)]:[2,ra];case 2:P=l.sent();Ka=[];for(fa=0;fa<ra.length;fa++)va=ra[fa],"simplify"!==va?Ka.push(va):Ka.push(w?n.geographicToWebMercator(P.shift()):P.shift());return[2,Ka];case 3:Ja=[];for(fa=0;fa<Y.length;fa++)va=Y[fa],"cut"!==va?Ja.push(va):(na=W.shift(),Ja.push(!0===w?n.geographicToWebMercator(na):na));return[2,p.resolve(Ja)]}})})}Object.defineProperty(a,"__esModule",{value:!0});var F=f.getLogger("esri.geometry.support.normalizeUtils"),H={102100:{maxX:2.0037508342788905E7,
minX:-2.0037508342788905E7,plus180Line:new d({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:m.WebMercator}),minus180Line:new d({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:m.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new d({paths:[[[180,-180],[180,180]]],spatialReference:m.WGS84}),minus180Line:new d({paths:[[[-180,-180],[-180,180]]],spatialReference:m.WGS84})}};
a.straightLineDensify=A;a.normalizeCentralMeridian=E;a.getDenormalizedExtent=function(a){var b;if(!a)return null;var d=a.extent;if(!d)return null;var e=a.spatialReference&&r.getInfo(a.spatialReference);if(!e)return d;var e=e.valid,f=e[0],e=e[1],c=d.width,h=d.xmin;b=d.xmax;b=[b,h];h=b[0];b=b[1];if("extent"===a.type||0===c||c<=e||c>2*e||h<f||b>e)return d;var m;switch(a.type){case "polygon":if(1<a.rings.length)m=z(a.rings);else return d;break;case "polyline":if(1<a.paths.length)m=z(a.paths);else return d;
break;case "multipoint":m=a.points}a=d.clone();for(f=0;f<m.length;f++){var n=m[f][0];0>n?(n+=e,b=Math.max(n,b)):(n-=e,h=Math.min(n,h))}a.xmin=h;a.xmax=b;return a.width<c?(a.xmin-=e,a.xmax-=e,a):d};a.normalizeMapX=function(a,b){if(b=r.getInfo(b)){var d=b.valid;b=d[0];var d=d[1],e=d-b;if(a<b)for(;a<b;)a+=e;if(a>d)for(;a>d;)a-=e}return a}})},"esri/tasks/geometry/cut":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});a.cut=function(a,d,c,r){return g(this,void 0,void 0,function(){var b,m,g,w,t,v,z,A;return k(this,function(n){switch(n.label){case 0:return b="string"===typeof a?e.urlToObject(a):a,m=d[0].spatialReference,g=l({},r,{query:l({},b.query,{f:"json",sr:JSON.stringify(m),target:JSON.stringify({geometryType:p.getJsonType(d[0]),geometries:d}),cutter:JSON.stringify(c)})}),[4,f(b.path+"/cut",g)];case 1:return w=n.sent(),t=w.data,v=t.cutIndexes,
z=t.geometries,A=void 0===z?[]:z,[2,{cutIndexes:v,geometries:A.map(function(a){return h.fromJSON(a).set(m)})}]}})})}})},"esri/tasks/geometry/simplify":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(c,a,l,g,k,h,f,e){function p(a){return{geometryType:e.getJsonType(a[0]),geometries:a.map(function(a){return a.toJSON()})}}
function b(a,b,f){var d=e.getGeometryType(b);return a.map(function(a){a=d.fromJSON(a);a.spatialReference=f;return a})}Object.defineProperty(a,"__esModule",{value:!0});a.simplify=function(a,c,r){return g(this,void 0,void 0,function(){var d,m,g,w,t;return k(this,function(n){switch(n.label){case 0:return d="string"===typeof a?f.urlToObject(a):a,m=c[0].spatialReference,g=e.getJsonType(c[0]),w=l({},r,{query:l({},d.query,{f:"json",sr:m.wkid?m.wkid:JSON.stringify(m),geometries:JSON.stringify(p(c))})}),[4,
h(d.path+"/simplify",w)];case 1:return t=n.sent(),[2,b(t.data,g,m)]}})})}})},"esri/tasks/operations/pbfQueryUtils":function(){define(["require","exports","./pbfFeatureServiceParser"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.parsePBFFeatureQuery=function(a,c){if((a=l.parseFeatureQuery(a,c).queryResult.featureResult)&&a.features&&a.features.length&&a.objectIdFieldName){c=a.objectIdFieldName;for(var h=0,f=a.features;h<f.length;h++){var e=f[h];e.attributes&&(e.objectId=e.attributes[c])}}return a}})},
"esri/tasks/operations/pbfFeatureServiceParser":function(){define("require exports ../../core/Error ../../core/Logger ../../core/pbf ./pbfDehydratedFeatureSet ./pbfOptimizedFeatureSet".split(" "),function(c,a,l,g,k,h,f){function e(a,b,d){for(d=b.createPointGeometry(d);a.next();)switch(a.tag()){case 3:for(var e=a.getUInt32(),e=a.pos()+e,f=0;a.pos()<e;)b.addCoordinatePoint(d,a.getSInt64(),0,f++);break;default:a.skip()}return d}function p(a,b,d){var e=b.createGeometry(d);for(d=2+(d.hasZ?1:0)+(d.hasM?
1:0);a.next();)switch(a.tag()){case 2:for(var f=a.getUInt32(),f=a.pos()+f,c=0;a.pos()<f;)b.addLength(e,a.getUInt32(),c++);break;case 3:for(var f=a.getUInt32(),f=a.pos()+f,h=c=0;a.pos()<f;)b.addCoordinate(e,a.getSInt64(),h,c),c++,c===d&&(h++,c=0);break;default:a.skip()}return e}function b(a){for(;a.next();)switch(a.tag()){case 1:return a.getString();case 2:return a.getFloat();case 3:return a.getDouble();case 4:return a.getSInt32();case 5:return a.getUInt32();case 6:return a.getInt64();case 7:return a.getUInt64();
case 8:return a.getSInt64();case 9:return a.getBool();default:return a.skip(),null}return null}function d(a){for(var b={type:0>=A.length?null:A[0]};a.next();)switch(a.tag()){case 1:b.name=a.getString();break;case 2:var d=a.getEnum();b.type=d>=A.length?null:A[d];break;case 3:b.alias=a.getString();break;case 4:d=a.getEnum();d=d>=C.length?null:C[d];b.sqlType=d;break;default:a.skip()}return b}function m(a,d,f,c){for(var h=d.createFeature(f),m=0;a.next();)switch(a.tag()){case 1:var n=c[m++].name;h.attributes[n]=
a.processMessage(b);break;case 2:h.geometry=a.processMessageWithArgs(p,d,f);break;case 4:h.centroid=a.processMessageWithArgs(e,d,f);break;default:a.skip()}return h}function r(a){for(var b=[1,1,1,1];a.next();)switch(a.tag()){case 1:b[0]=a.getDouble();break;case 2:b[1]=a.getDouble();break;case 4:b[2]=a.getDouble();break;case 3:b[3]=a.getDouble();break;default:a.skip()}return b}function n(a){for(var b=[0,0,0,0];a.next();)switch(a.tag()){case 1:b[0]=a.getDouble();break;case 2:b[1]=a.getDouble();break;
case 4:b[2]=a.getDouble();break;case 3:b[3]=a.getDouble();break;default:a.skip()}return b}function u(a){for(var b={originPosition:0>=D.length?null:D[0]};a.next();)switch(a.tag()){case 1:var d=a.getEnum();b.originPosition=d>=D.length?null:D[d];break;case 2:b.scale=a.processMessage(r);break;case 3:b.translate=a.processMessage(n);break;default:a.skip()}return b}function y(a){for(var b={};a.next();)switch(a.tag()){case 1:b.shapeAreaFieldName=a.getString();break;case 2:b.shapeLengthFieldName=a.getString();
break;case 3:b.units=a.getString();break;default:a.skip()}return b}function w(a,b){for(b=b.createSpatialReference();a.next();)switch(a.tag()){case 1:b.wkid=a.getUInt32();break;case 5:b.wkt=a.getString();break;default:a.skip()}return b}function t(a,b){var e=b.createFeatureResult();e.geometryType=0>=b.geometryTypes.length?null:b.geometryTypes[0];for(var f=!1;a.next();)switch(a.tag()){case 1:e.objectIdFieldName=a.getString();break;case 3:e.globalIdFieldName=a.getString();break;case 4:e.geohashFieldName=
a.getString();break;case 5:e.geometryProperties=a.processMessage(y);break;case 7:var c=a.getEnum();e.geometryType=c>=b.geometryTypes.length?null:b.geometryTypes[c];break;case 8:e.spatialReference=a.processMessageWithArgs(w,b);break;case 10:e.hasZ=a.getBool();break;case 11:e.hasM=a.getBool();break;case 12:e.transform=a.processMessage(u);break;case 9:c=a.getBool();e.exceededTransferLimit=c;break;case 13:b.addField(e,a.processMessage(d));break;case 15:f||(b.prepareFeatures(e),f=!0);b.addFeature(e,a.processMessageWithArgs(m,
b,e,e.fields));break;default:a.skip()}b.finishFeatureResult(e);return e}function v(a,b){for(var d={};a.next();)switch(a.tag()){case 1:d.featureResult=a.processMessageWithArgs(t,b);break;default:a.skip()}return d}Object.defineProperty(a,"__esModule",{value:!0});var z=g.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),A="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),
C="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),D=["upperLeft","lowerLeft"];a.parseFeatureQuery=function(a,b){b=b&&"dehydrated"===b.type?new h.Context(b):
new f.Context;try{var d=new k(new Uint8Array(a),new DataView(a));for(a={};d.next();)switch(d.tag()){case 2:a.queryResult=d.processMessageWithArgs(v,b);break;default:d.skip()}return a}catch(H){return d=new l("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:H}),z.error(d),{queryResult:{featureResult:b.createFeatureResult()}}}}})},"esri/tasks/operations/pbfDehydratedFeatureSet":function(){define("require exports ../../Graphic ../../core/compilerUtils ../../geometry/SpatialReference ../../layers/graphics/dehydratedFeatures ../../layers/support/Field".split(" "),
function(c,a,l,g,k,h,f){function e(a,b){return b}function p(a,b,d,e){switch(d){case 0:return r(a,b+e,0);case 1:return("lowerLeft"===a.originPosition?r:n)(a,b+e,1)}}function b(a,b,d,e){switch(d){case 0:return r(a,b+e,0);case 1:return("lowerLeft"===a.originPosition?r:n)(a,b+e,1);case 2:return r(a,b,2)}}function d(a,b,d,e){switch(d){case 0:return r(a,b+e,0);case 1:return("lowerLeft"===a.originPosition?r:n)(a,b+e,1);case 2:return r(a,b,3)}}function m(a,b,d,e){switch(d){case 0:return r(a,b+e,0);case 1:return("lowerLeft"===
a.originPosition?r:n)(a,b+e,1);case 2:return r(a,b,2);case 3:return r(a,b,3)}}function r(a,b,d){return a.translate[d]+b*a.scale[d]}function n(a,b,d){return a.translate[d]-b*a.scale[d]}Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this.options=a;this.geometryTypes=["point","multipoint","polyline","polygon"];this.previousCoordinate=[0,0];this.transform=null;this.applyTransform=e;this.lengths=[];this.vertexDimension=this.toAddInCurrentPath=this.currentLengthIndex=0;this.coordinateBuffer=
null;this.coordinateBufferPtr=0;this.AttributesConstructor=function(){}}a.prototype.createFeatureResult=function(){return new h.DehydratedFeatureSetClass};a.prototype.finishFeatureResult=function(a){this.options.applyTransform&&(a.transform=null);this.AttributesConstructor=function(){};this.coordinateBuffer=null;this.lengths.length=0};a.prototype.createSpatialReference=function(){return new k};a.prototype.addField=function(a,b){a.fields.push(f.fromJSON(b));var d=a.fields.map(function(a){return a.name});
this.AttributesConstructor=function(){for(var a=0;a<d.length;a++)this[d[a]]=null}};a.prototype.addFeature=function(a,b){var d=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(0<d)for(var e in b.attributes){var f=b.attributes[e];"string"===typeof f&&f.length>d&&(b.attributes[e]="")}a.features.push(b)};a.prototype.prepareFeatures=function(a){var b=this;this.options.applyTransform&&a.transform&&(this.transform=a.transform,this.applyTransform=this.deriveApplyTransform(a));
this.vertexDimension=2;a.hasZ&&this.vertexDimension++;a.hasM&&this.vertexDimension++;switch(a.geometryType){case "point":this.addCoordinate=function(a,d,e,f){return b.addCoordinatePoint(a,d,f)};this.createGeometry=function(a){return b.createPointGeometry(a)};break;case "polygon":this.addCoordinate=function(a,d,e,f){return b.addCoordinatePolygon(a,d,f)};this.createGeometry=function(a){return b.createPolygonGeometry(a)};break;case "polyline":this.addCoordinate=function(a,d,e,f){return b.addCoordinatePolyline(a,
d,f)};this.createGeometry=function(a){return b.createPolylineGeometry(a)};break;case "multipoint":this.addCoordinate=function(a,d,e,f){return b.addCoordinateMultipoint(a,d,f)};this.createGeometry=function(a){return b.createMultipointGeometry(a)};break;default:g.neverReached(a.geometryType)}};a.prototype.createFeature=function(){this.currentLengthIndex=this.lengths.length=0;this.previousCoordinate[0]=0;this.previousCoordinate[1]=0;this.coordinateBuffer=null;this.coordinateBufferPtr=0;return new h.DehydratedFeatureClass(l.generateUID(),
null,new this.AttributesConstructor)};a.prototype.addLength=function(a,b,d){0===this.lengths.length&&(this.toAddInCurrentPath=b);this.lengths.push(b)};a.prototype.createPointGeometry=function(a){a={type:"point",x:0,y:0,spatialReference:a.spatialReference,hasZ:!!a.hasZ,hasM:!!a.hasM};a.hasZ&&(a.z=0);a.hasM&&(a.m=0);return a};a.prototype.addCoordinatePoint=function(a,b,d){b=this.applyTransform(this.transform,b,d,0);switch(d){case 0:a.x=b;break;case 1:a.y=b;break;case 2:a.hasZ?a.z=b:a.m=b;break;case 3:a.m=
b}};a.prototype.transformPathLikeValue=function(a,b){var d=0;1>=b&&(d=this.previousCoordinate[b],this.previousCoordinate[b]+=a);return this.applyTransform(this.transform,a,b,d)};a.prototype.addCoordinatePolyline=function(a,b,d){this.dehydratedAddPointsCoordinate(a.paths,b,d)};a.prototype.addCoordinatePolygon=function(a,b,d){this.dehydratedAddPointsCoordinate(a.rings,b,d)};a.prototype.addCoordinateMultipoint=function(a,b,d){0===d&&a.points.push([]);b=this.transformPathLikeValue(b,d);a.points[a.points.length-
1].push(b)};a.prototype.createPolygonGeometry=function(a){return{type:"polygon",rings:[[]],spatialReference:a.spatialReference,hasZ:!!a.hasZ,hasM:!!a.hasM}};a.prototype.createPolylineGeometry=function(a){return{type:"polyline",paths:[[]],spatialReference:a.spatialReference,hasZ:!!a.hasZ,hasM:!!a.hasM}};a.prototype.createMultipointGeometry=function(a){return{type:"multipoint",points:[],spatialReference:a.spatialReference,hasZ:!!a.hasZ,hasM:!!a.hasM}};a.prototype.dehydratedAddPointsCoordinate=function(a,
b,d){if(null===this.coordinateBuffer){var e=this.lengths.reduce(function(a,b){return a+b},0);this.coordinateBuffer=new Float64Array(e*this.vertexDimension)}0===d&&0===this.toAddInCurrentPath--&&(a.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);b=this.transformPathLikeValue(b,d);a=a[a.length-1];0===d&&a.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension));
this.coordinateBuffer[this.coordinateBufferPtr++]=b};a.prototype.deriveApplyTransform=function(a){var e=a.hasZ;a=a.hasM;return e&&a?m:e?b:a?d:p};return a}();a.Context=c})},"esri/Graphic":function(){define("require exports ./core/tsSupport/assignHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./geometry ./PopupTemplate ./symbols ./core/JSONSupport ./core/lang ./core/maybe ./core/accessorSupport/decorators ./geometry/support/jsonUtils ./symbols/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){c=function(a){function c(b,d,e,f){b=a.call(this,b,d,e,f)||this;b.layer=null;b.popupTemplate=null;b.sourceLayer=null;Object.defineProperty(b,"uid",{value:p.generateUID()});return b}g(c,a);p=c;c.prototype.normalizeCtorArgs=function(a,b,d,e){return a&&!a.declaredClass?a:{geometry:a,symbol:b,attributes:d,popupTemplate:e}};Object.defineProperty(c.prototype,"attributes",{set:function(a){var b=this._get("attributes");b!==a&&(this._set("attributes",a),this._notifyLayer("attributes",
b,a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"geometry",{set:function(a){var b=this._get("geometry");b!==a&&(this._set("geometry",a),this._notifyLayer("geometry",b,a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"symbol",{set:function(a){var b=this._get("symbol");b!==a&&(this._set("symbol",a),this._notifyLayer("symbol",b,a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"visible",{set:function(a){var b=this._get("visible");b!==
a&&(this._set("visible",a),this._notifyLayer("visible",b,a))},enumerable:!0,configurable:!0});c.prototype.getEffectivePopupTemplate=function(a){void 0===a&&(a=!1);return this.popupTemplate?this.popupTemplate:this.sourceLayer?this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:a&&d.isSome(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:null:null};c.prototype.getAttribute=function(a){return this.attributes&&this.attributes[a]};c.prototype.setAttribute=function(a,
b){var d;this.attributes?(d=this.getAttribute(a),this.attributes[a]=b,this._notifyLayer("attributes",d,b,a)):(this.attributes=(d={},d[a]=b,d),this._notifyLayer("attributes",void 0,b,a))};c.prototype.getObjectId=function(){return this.sourceLayer?"type"in this.sourceLayer&&"stream"===this.sourceLayer.type?this.getAttribute("__esri_stream_id__"):this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null:null};c.prototype.toJSON=function(){return{geometry:d.isSome(this.geometry)?
this.geometry.toJSON():null,symbol:d.isSome(this.symbol)?this.symbol.toJSON():null,attributes:l({},this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}};c.prototype.clone=function(){return new p(this.cloneProperties())};c.prototype.cloneProperties=function(){return{attributes:b.clone(this.attributes),geometry:b.clone(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:b.clone(this.symbol),visible:this.visible}};
c.prototype._notifyLayer=function(a,b,d,e){this.layer&&this.layer.graphicChanged&&(b={graphic:this,property:a,oldValue:b,newValue:d},"attributes"===a&&(b.attributeName=e),this.layer.graphicChanged(b))};var p;k([m.property({value:null})],c.prototype,"attributes",null);k([m.property({value:null,types:h.geometryTypes,json:{read:r.fromJSON}})],c.prototype,"geometry",null);k([m.property()],c.prototype,"layer",void 0);k([m.property({type:f})],c.prototype,"popupTemplate",void 0);k([m.property()],c.prototype,
"sourceLayer",void 0);k([m.property({value:null,types:e.symbolTypes,json:{read:n.read}})],c.prototype,"symbol",null);k([m.property({type:Boolean,value:!0,set:function(a){}})],c.prototype,"visible",null);return c=p=k([m.subclass("esri.Graphic")],c)}(m.declared(p.JSONSupport));var u=0;(function(a){a.generateUID=function(){return u++}})(c||(c={}));return c})},"esri/PopupTemplate":function(){define("require exports ./core/tsSupport/assignHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/tsSupport/generatorHelper ./core/tsSupport/awaiterHelper ./core/arrayUtils ./core/Collection ./core/iteratorUtils ./core/JSONSupport ./core/lang ./core/Logger ./core/promiseUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./layers/support/fieldUtils ./popup/content ./popup/ExpressionInfo ./popup/FieldInfo ./popup/LayerOptions ./popup/RelatedRecordsInfo ./popup/content/AttachmentsContent ./popup/content/Content ./popup/content/FieldsContent ./popup/content/MediaContent ./popup/content/TextContent ./popup/content/support/mediaInfoTypes ./support/actions/ActionBase ./support/actions/ActionButton ./support/actions/ActionToggle".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B,E,F,H,J,K,G,I){var L=p.ofType({key:"type",defaultKeyValue:"button",base:K,typeMap:{button:G,toggle:I}}),R={base:B,key:"type",typeMap:{media:F,text:H,attachments:D,fields:E}},M=r.getLogger("esri.PopupTemplate");return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.actions=null;b.content="";b.expressionInfos=null;b.fieldInfos=null;b.layerOptions=null;b.lastEditInfoEnabled=!0;b.outFields=null;b.overwriteActions=!1;b.title=
"";b.relatedRecordsInfo=null;return b}g(d,a);c=d;d.prototype.castContent=function(a){if(Array.isArray(a))return a.map(function(a){return y.ensureOneOfType(R,a)});if("string"===typeof a||"function"===typeof a||a instanceof HTMLElement||n.isPromiseLike(a))return a;M.error("content error","unsupported content value",{value:a});return null};d.prototype.readContent=function(a,b){a=b.popupElements;return Array.isArray(a)&&0<a.length?this._readPopupInfoElements(b):this._readPopupInfo(b)};d.prototype.writeContent=
function(a,b){var d=this;"string"===typeof a?b.description=a:Array.isArray(a)&&(b.popupElements=a.map(function(a){return a&&a.toJSON()}),b.popupElements.forEach(function(a){"attachments"===a.type?d._writeAttachmentContent(b):"media"===a.type?d._writeMediaContent(a,b):"text"===a.type&&d._writeTextContent(a,b)}))};d.prototype.writeFieldInfos=function(a,b){var d=this.content,d=Array.isArray(d)?d:null;if(a){var e=d?d.some(function(a){return"fields"===a.type&&(!a.fieldInfos||0===a.fieldInfos.length)}):
!1;b.fieldInfos=a.filter(Boolean).map(function(a){a=a.toJSON();e||(a.visible=!1);return a})}if(d)for(a=0;a<d.length;a++){var f=d[a];"fields"===f.type&&this._writeFieldsContent(f,b)}};d.prototype.writeLayerOptions=function(a,b){b.layerOptions=!a||null===a.showNoDataRecords&&null===a.returnTopmostRaster?null:a.toJSON()};d.prototype.writeTitle=function(a,b){b.title=a||""};d.prototype.clone=function(){var a=this.actions,a=a?m.clone(a.toArray()):[];return new c({actions:a,content:Array.isArray(this.content)?
m.clone(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?m.clone(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?m.clone(this.fieldInfos):null,layerOptions:this.layerOptions?m.clone(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?m.clone(this.outFields):null,overwriteActions:this.overwriteActions,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?m.clone(this.relatedRecordsInfo):
null})};d.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){return h(this,function(d){switch(d.label){case 0:return[4,this._collectExpressionInfoFields(a,b,this.expressionInfos)];case 1:return d.sent(),w.collectFields(a,b,(this.outFields||[]).concat(this._getActionsFields(this.actions),this._getTitleFields(this.title),this._getContentFields(this.content))),[2]}})})};d.prototype.getRequiredFields=function(a){return f(this,void 0,void 0,function(){var d;return h(this,
function(e){switch(e.label){case 0:return d=new Set,[4,this.collectRequiredFields(d,a)];case 1:return e.sent(),[2,b.valuesOfSet(d).sort()]}})})};d.prototype._writeFieldsContent=function(a,b){Array.isArray(a.fieldInfos)&&a.fieldInfos.length&&(a=m.clone(a.fieldInfos),Array.isArray(b.fieldInfos)?a.forEach(function(a){var d=e.find(b.fieldInfos,function(b){return b.fieldName.toLowerCase()===a.fieldName.toLowerCase()});d?d.visible=!0:b.fieldInfos.push(a)}):b.fieldInfos=a)};d.prototype._writeAttachmentContent=
function(a){a.showAttachments||(a.showAttachments=!0)};d.prototype._writeTextContent=function(a,b){!b.description&&a.text&&(b.description=a.text)};d.prototype._writeMediaContent=function(a,b){Array.isArray(a.mediaInfos)&&a.mediaInfos.length&&(a=m.clone(a.mediaInfos),Array.isArray(b.mediaInfos)?b.mediaInfos=b.mediaInfos.concat(a):b.mediaInfos=a)};d.prototype._readPopupInfoElements=function(a){var b=a.description,d=a.mediaInfos,e=!1,f=!1;return a.popupElements.map(function(a){if("media"===a.type)return a.mediaInfos||
!d||f||(a.mediaInfos=d,f=!0),F.fromJSON(a);if("text"===a.type)return a.text||!b||e||(a.text=b,e=!0),H.fromJSON(a);if("attachments"===a.type)return D.fromJSON(a);if("fields"===a.type)return E.fromJSON(a)}).filter(Boolean)};d.prototype._readPopupInfo=function(a){var b=a.description,d=a.mediaInfos;a=a.showAttachments;var e=[];b?e.push(new H({text:b})):e.push(new E);Array.isArray(d)&&d.length&&e.push(F.fromJSON({mediaInfos:d}));a&&e.push(D.fromJSON({displayType:"list"}));return e.length?e:b};d.prototype._getContentElementFields=
function(a){var b=this;if(!a||"attachments"===a.type)return[];if("fields"===a.type)return this._getFieldInfoFields(a.fieldInfos||this.fieldInfos);if("media"===a.type)return(a.mediaInfos||[]).reduce(function(a,d){return a.concat(b._getMediaInfoFields(d))},[]);if("text"===a.type)return this._extractFieldNames(a.text)};d.prototype._getMediaInfoFields=function(a){var b=a.caption,d=a.value||{},e=d.fields,f=void 0===e?[]:e,e=d.normalizeField,c=d.tooltipField,h=d.sourceURL,d=d.linkURL;a=this._extractFieldNames(a.title).concat(this._extractFieldNames(b),
this._extractFieldNames(h),this._extractFieldNames(d),f);e&&a.push(e);c&&a.push(c);return a};d.prototype._getContentFields=function(a){var b=this;return"string"===typeof a?this._extractFieldNames(a):Array.isArray(a)?a.reduce(function(a,d){return a.concat(b._getContentElementFields(d))},[]):[]};d.prototype._collectExpressionInfoFields=function(a,b,d){return f(this,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:return d?[4,n.all(d.map(function(d){return w.collectArcadeFieldNames(a,
b,d.expression)}))]:[2];case 1:return e.sent(),[2]}})})};d.prototype._getFieldInfoFields=function(a){return a?a.filter(function(a){return"undefined"===typeof a.visible?!0:!!a.visible}).map(function(a){return a.fieldName}).filter(function(a){return-1===a.indexOf("relationships/")&&-1===a.indexOf("expression/")}):[]};d.prototype._getActionsFields=function(a){var b=this;return a?a.toArray().reduce(function(a,d){return a.concat(b._getActionFields(d))},[]):[]};d.prototype._getActionFields=function(a){var b=
a.className,d=a.type,d="button"===d||"toggle"===d?a.image:"";return this._extractFieldNames(a.title).concat(this._extractFieldNames(b),this._extractFieldNames(d))};d.prototype._getTitleFields=function(a){return"string"===typeof a?this._extractFieldNames(a):[]};d.prototype._extractFieldNames=function(a){if(!a||"string"!==typeof a)return[];a=a.match(/{[^}]*}/g);if(!a)return[];var b=/\{(\w+):.+\}/;return(a=a.filter(function(a){return!(0===a.indexOf("{relationships/")||0===a.indexOf("{expression/"))}).map(function(a){return a.replace(b,
"{$1}")}))?a.map(function(a){return a.slice(1,-1)}):[]};var c;k([u.property({type:L})],d.prototype,"actions",void 0);k([u.property()],d.prototype,"content",void 0);k([u.cast("content")],d.prototype,"castContent",null);k([u.reader("content",["description","popupElements","mediaInfos","showAttachments"])],d.prototype,"readContent",null);k([u.writer("content",{popupElements:{type:p.ofType(t.types)},showAttachments:{type:Boolean},mediaInfos:{type:p.ofType(J.types)},description:{type:String}})],d.prototype,
"writeContent",null);k([u.property({type:[v],json:{write:!0}})],d.prototype,"expressionInfos",void 0);k([u.property({type:[z]})],d.prototype,"fieldInfos",void 0);k([u.writer("fieldInfos")],d.prototype,"writeFieldInfos",null);k([u.property({type:A})],d.prototype,"layerOptions",void 0);k([u.writer("layerOptions")],d.prototype,"writeLayerOptions",null);k([u.property({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],d.prototype,"lastEditInfoEnabled",
void 0);k([u.property()],d.prototype,"outFields",void 0);k([u.property()],d.prototype,"overwriteActions",void 0);k([u.property({json:{type:String}})],d.prototype,"title",void 0);k([u.writer("title")],d.prototype,"writeTitle",null);k([u.property({type:C,json:{write:!0}})],d.prototype,"relatedRecordsInfo",void 0);return d=c=k([u.subclass("esri.PopupTemplate")],d)}(u.declared(d.JSONSupport))})},"esri/layers/support/fieldUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper @dojo/framework/shim/array ../../core/Error ../../core/iteratorUtils ../../core/maybe ../../core/object ../../core/promiseUtils ./domains ../../support/arcadeOnDemand".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r){function n(a,d,e){if(a)for(var f=0;f<a.length;f++){var c=a[f],h=b.getDeepValue(c,d);(h=h&&"function"!==typeof h&&t(e,h))&&b.setDeepValue(c,h.name,d)}}function u(a,b){if(!a||!b)return[];Q.clear();y(Q,a,b);return e.valuesOfSet(Q).sort()}function y(a,b,d){if(d)if(b&&b.length)if(h.includes(d,"*"))for(d=0;d<b.length;d++)a.add(b[d].name);else for(var e=0;e<d.length;e++)f=d[e],w(a,b,f);else if(h.includes(d,"*"))a.clear(),a.add("*");else for(b=0;b<d.length;b++){var f=d[b];
a.add(f)}}function w(a,b,d){b&&b.length?(b=t(b,d))&&a.add(b.name):"string"===typeof d&&a.add(d)}function t(a,b){if("string"!==typeof b)return null;if(null!=a){b=b.toLowerCase();for(var d=0;d<a.length;d++){var e=a[d];if(e&&e.name.toLowerCase()===b)return e}}return null}function v(a,b,d){return k(this,void 0,void 0,function(){var e,f,c,h,m;return g(this,function(n){switch(n.label){case 0:return d?[4,r.loadArcade()]:[2];case 1:e=n.sent().arcadeUtils;f=e.extractFieldNames(d);c=0;for(h=f;c<h.length;c++)m=
h[c],w(a,b,m);return[2]}})})}function z(a,d){return k(this,void 0,void 0,function(){var e,f;return g(this,function(c){if(!d)return[2];e=d.fields;return(f=b.getDeepValue("elevationInfo.featureExpressionInfo",d))?[2,f.collectRequiredFields(a,e)]:[2]})})}function A(a,b){return k(this,void 0,void 0,function(){var e,f;return g(this,function(c){switch(c.label){case 0:return e=b.labelingInfo,f=b.fields,e&&e.length?[4,d.all(e.map(function(b){return C(a,f,b)}))]:[2];case 1:return c.sent(),[2]}})})}function C(a,
b,d){return k(this,void 0,void 0,function(){var e,f,c,h,m;return g(this,function(n){switch(n.label){case 0:if(!d)return[2];e=d.getLabelExpression();f=d.where;return"arcade"!==e.type?[3,2]:[4,v(a,b,e.expression)];case 1:return n.sent(),[3,3];case 2:(c=e.expression.match(/{[^}]*}/g))&&c.forEach(function(d){w(a,b,d.slice(1,-1))}),n.label=3;case 3:return h=/['"]+/g,f&&(m=f.split(" "),3===m.length&&w(a,b,m[0].replace(h,"")),7===m.length&&(w(a,b,m[0].replace(h,"")),w(a,b,m[4].replace(h,"")))),[2]}})})}
function D(a){return"number"===typeof a&&!isNaN(a)&&isFinite(a)}function B(a){return null===a||D(a)}function E(a){return null===a||N(a)}function F(a){return null!=a&&"string"===typeof a}function H(a){return null===a||F(a)}function J(){return!0}function K(a,b){var d;switch(a.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":d=a.nullable?E:N;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":d=
a.nullable?B:D;break;case "string":case "esriFieldTypeString":d=a.nullable?H:F;break;default:d=J}return 1===arguments.length?d:d(b)}function G(a){return null!=a&&U.has(a.type)}function I(a,b){return a.nullable&&null===b?null:G(a)&&!L(a.type,Number(b))?V.OUT_OF_RANGE:K(a,b)?a.domain?m.validateDomainValue(a.domain,b):null:S.INVALID_TYPE}function L(a,b){return(a="string"===typeof a?R(a):a)?a.isInteger?N(b)&&b>=a.min&&b<=a.max:b>=a.min&&b<=a.max:!1}function R(b){switch(b){case "esriFieldTypeSmallInteger":case "small-integer":return a.smallIntegerRange;
case "esriFieldTypeInteger":case "integer":return a.integerRange;case "esriFieldTypeSingle":case "single":return a.singleRange;case "esriFieldTypeDouble":case "double":return a.doubleRange}}function M(a,b,d){if(!b||!b.attributes||!a){if(p.isSome(d))for(var e=0;e<a.length;e++)b=a[e],d.add(b);return!0}for(var e=b.attributes,f=!1,c=0;c<a.length;c++)if(b=a[c],!(b in e))if(f=!0,p.isSome(d))d.add(b);else break;return f}Object.defineProperty(a,"__esModule",{value:!0});a.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");
a.visualVariableFields=["field","normalizationField"];a.fixRendererFields=function(b,d){if(null!=b&&null!=d){var e=0;for(b=Array.isArray(b)?b:[b];e<b.length;e++){var f=b[e];n(a.rendererFields,f,d);if("visualVariables"in f&&f.visualVariables)for(var c=0,f=f.visualVariables;c<f.length;c++)n(a.visualVariableFields,f[c],d)}}};a.fixTimeInfoFields=function(a,b){if(null!=a&&null!=b)if("startField"in a){var d=t(b,a.startField);b=t(b,a.endField);a.startField=d&&d.name||null;a.endField=b&&b.name||null}else d=
t(b,a.startTimeField),b=t(b,a.endTimeField),a.startTimeField=d&&d.name||null,a.endTimeField=b&&b.name||null};var Q=new Set;a.fixFields=u;a.collectFields=y;a.collectField=w;a.unpackFieldNames=function(a,b){return b&&a?h.includes(b,"*")?a.map(function(a){return a.name}):b:[]};a.packFields=function(a,b,d){void 0===d&&(d=1);if(!b||!a)return[];if(h.includes(b,"*"))return["*"];b=u(a,b);return b.length/a.length>=d?["*"]:b};a.getField=t;a.hasField=function(a,b){if(!a||!b||"string"!==typeof b)return!1;b=b.toLowerCase();
for(var d=0;d<a.length;d++){var e=a[d];if(e&&e.name.toLowerCase()===b)return!0}return!1};a.collectArcadeFieldNames=v;a.getElevationFields=function(a){return k(this,void 0,void 0,function(){var b;return g(this,function(d){switch(d.label){case 0:if(!a)return[2,[]];b=new Set;return[4,z(b,a)];case 1:return d.sent(),[2,e.valuesOfSet(b).sort()]}})})};a.collectElevationFields=z;a.collectFilterFields=function(a,b,e){return k(this,void 0,void 0,function(){var h,m;return g(this,function(n){switch(n.label){case 0:if(!b||
!e||!(e.where&&"1\x3d1"!==e.where||e.timeExtent))return[2];b.timeInfo&&e.timeExtent&&y(a,b.fields,[b.timeInfo.startField,b.timeInfo.endField]);return e.where?[4,d.create(function(a){c(["../../core/sql/WhereClause"],a)})]:[3,2];case 1:h=n.sent();m=h.WhereClause.create(e.where,b.fieldsIndex);if(!m.isStandardized)throw new f("fieldUtils:collectFilterFields","Where clause is not standardized");y(a,b.fields,m.fieldNames);n.label=2;case 2:return[2]}})})};a.getTimeFields=function(a){return k(this,void 0,
void 0,function(){var b;return g(this,function(d){return a?(b="timeInfo"in a&&a.timeInfo)?[2,u(a.fields,[a.trackIdField,b.startField,b.endField])]:[2,[]]:[2,[]]})})};a.getFeatureEditFields=function(a){if(!a)return[];var b="editFieldsInfo"in a&&a.editFieldsInfo;return b?u(a.fields,[b&&b.creatorField,b&&b.creationDateField,b&&b.editorField,b&&b.editDateField]):[]};a.getFeatureGeometryFields=function(a){if(!a)return[];var b="geometryProperties"in a&&a.geometryProperties;return b?u(a.fields,[b&&b.shapeAreaFieldName,
b&&b.shapeLengthFieldName]):[]};a.getLabelingFields=function(a){return k(this,void 0,void 0,function(){var b;return g(this,function(d){switch(d.label){case 0:if(!a)return[2,[]];b=new Set;return[4,A(b,a)];case 1:return d.sent(),[2,e.valuesOfSet(b).sort()]}})})};a.collectLabelingFields=A;a.getFieldDefaultValue=function(a){var b=a.defaultValue;if(void 0!==b&&K(a,b))return b;if(a.nullable)return null};var N=function(){return"isInteger"in Number?Number.isInteger:function(a){return"number"===typeof a&&
isFinite(a)&&Math.floor(a)===a}}();a.isValueMatchingFieldType=K;a.numericTypes=["integer","small-integer","single","double"];var U=e.createSetFromValues(a.numericTypes.concat(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));a.isNumericField=G;a.isStringField=function(a){return null!=a&&("string"===a.type||"esriFieldTypeString"===a.type)};a.isDateField=function(a){return null!=a&&("date"===a.type||"esriFieldTypeDate"===a.type)};a.isValidFieldValue=
function(a,b){return null===I(a,b)};var V;(V=a.NumericRangeValidationError||(a.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";var S;(S=a.TypeValidationError||(a.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";a.sanitizeNullFieldValue=function(a){return null==a||"number"===typeof a&&isNaN(a)?null:a};a.validateFieldValue=I;a.isNumberInRange=L;a.getFieldRange=function(a){var b=m.getDomainRange(a.domain);if(b)return b;if(G(a))return R(a.type)};
a.getNumericTypeForValue=function(b){if(!D(b))return null;if(N(b)){if(b>=a.smallIntegerRange.min&&b<=a.smallIntegerRange.max)return"esriFieldTypeSmallInteger";if(b>=a.integerRange.min&&b<=a.integerRange.max)return"esriFieldTypeInteger"}return b>=a.singleRange.min&&b<=a.singleRange.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};a.smallIntegerRange={min:-32768,max:32767,isInteger:!0};a.integerRange={min:-2147483648,max:2147483647,isInteger:!0};a.singleRange={min:-3.4E38,max:1.2E38,isInteger:!1};a.doubleRange=
{min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};a.validationErrorToString=function(a,b,d){switch(a){case m.DomainValidationError.INVALID_CODED_VALUE:return"Value "+d+" is not in the coded domain - field: "+b.name+", domain: "+JSON.stringify(b.domain);case m.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+d+" is out of the range of valid values - field: "+b.name+", domain: "+JSON.stringify(b.domain);case S.INVALID_TYPE:return"Value "+d+" is not a valid value for the field type - field: "+
b.name+", type: "+b.type+", nullable: "+b.nullable;case V.OUT_OF_RANGE:return a=R(b.type),"Value "+d+" is out of range for the number type - field: "+b.name+", type: "+b.type+", value range is "+a.min+" to "+a.max}};a.featureHasFields=function(a,b){return!M(a,b,null)};a.populateMissingFields=M})},"esri/layers/support/domains":function(){define("require exports ../../core/compilerUtils ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(c,a,l,g,k,h,f){function e(a,d){switch(a.type){case "range":var b=
"range"in a?a.range[1]:a.maxValue;if(+d<("range"in a?a.range[0]:a.minValue)||+d>b)return p.VALUE_OUT_OF_RANGE;break;case "coded-value":case "codedValue":if(null==a.codedValues||a.codedValues.every(function(a){return null==a||a.code!==d}))return p.INVALID_CODED_VALUE}return null}Object.defineProperty(a,"__esModule",{value:!0});a.CodedValueDomain=g;a.DomainBase=k;a.InheritedDomain=h;a.RangeDomain=f;var p;(function(a){a.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";a.INVALID_CODED_VALUE=
"domain-validation-error::invalid-coded-value"})(p=a.DomainValidationError||(a.DomainValidationError={}));a.isValidDomainValue=function(a,d){return null===e(a,d)};a.validateDomainValue=e;a.types={key:"type",base:a.DomainBase,typeMap:{range:a.RangeDomain,"coded-value":a.CodedValueDomain,inherited:a.InheritedDomain}};a.getDomainRange=function(a){if(a&&"range"===a.type)return{min:"range"in a?a.range[0]:a.minValue,max:"range"in a?a.range[1]:a.maxValue}};a.fromJSON=function(b){if(!b||!b.type)return null;
switch(b.type){case "range":return a.RangeDomain.fromJSON(b);case "codedValue":return a.CodedValueDomain.fromJSON(b);case "inherited":return a.InheritedDomain.fromJSON(b);default:l.neverReached(b)}return null}})},"esri/layers/support/CodedValueDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ./CodedValue ./Domain".split(" "),function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=
a.call(this,b)||this;b.codedValues=null;b.type="coded-value";return b}l(b,a);d=b;b.prototype.getName=function(a){var b=null;if(this.codedValues){var d=String(a);this.codedValues.some(function(a){String(a.code)===d&&(b=a.name);return!!b})}return b};b.prototype.clone=function(){return new d({codedValues:k.clone(this.codedValues),name:this.name})};var d;g([h.property({type:[f.default],json:{write:!0}})],b.prototype,"codedValues",void 0);g([h.enumeration.serializable()({codedValue:"coded-value"})],b.prototype,
"type",void 0);return b=d=g([h.subclass("esri.layers.support.CodedValueDomain")],b)}(h.declared(e))})},"esri/layers/support/CodedValue":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(b){b=a.call(this,b)||this;b.name=null;b.code=null;return b}g(e,a);f=e;e.prototype.clone=
function(){return new f({name:this.name,code:this.code})};var f;l([h.property({type:String,json:{write:!0}})],e.prototype,"name",void 0);l([h.property({type:[String,Number],json:{write:!0}})],e.prototype,"code",void 0);return e=f=l([h.subclass("esri.layers.support.CodedValue")],e)}(h.declared(k.JSONSupport));a.CodedValue=c;a.default=c})},"esri/layers/support/Domain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h,f){var e=new k.default({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(a){function b(b){b=a.call(this,b)||this;b.name=null;b.type=null;return b}l(b,a);g([f.property({type:String,json:{write:!0}})],b.prototype,"name",void 0);g([f.enumeration.serializable()(e)],b.prototype,"type",void 0);return b=g([f.subclass("esri.layers.support.Domain")],b)}(f.declared(h.JSONSupport))})},"esri/layers/support/InheritedDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Domain".split(" "),
function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.type="inherited";return b}l(e,a);f=e;e.prototype.clone=function(){return new f};var f;g([k.enumeration.serializable()({inherited:"inherited"})],e.prototype,"type",void 0);return e=f=g([k.subclass("esri.layers.support.InheritedDomain")],e)}(k.declared(h))})},"esri/layers/support/RangeDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Domain".split(" "),
function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.maxValue=null;b.minValue=null;b.type="range";return b}l(e,a);f=e;e.prototype.clone=function(){return new f({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};var f;g([k.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(a,d){return d.range&&d.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(a,
d,e){d[e]=[this.minValue||0,a]}}}})],e.prototype,"maxValue",void 0);g([k.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(a,d){return d.range&&d.range[0]}},write:{target:"range",writer:function(a,d,e){d[e]=[a,this.maxValue||0]}}}})],e.prototype,"minValue",void 0);g([k.enumeration.serializable()({range:"range"})],e.prototype,"type",void 0);return e=f=g([k.subclass("esri.layers.support.RangeDomain")],e)}(k.declared(h))})},"esri/support/arcadeOnDemand":function(){define("require exports ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/assignHelper ../geometry ../core/maybe ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),
function(c,a,l,g,k,h,f,e){function p(){return g(this,void 0,void 0,function(){var a=this;return l(this,function(d){b||(b=function(){return g(a,void 0,void 0,function(){var a;return l(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,b){c(["./arcadeUtils"],a,b)})];case 1:return a=b.sent(),[4,a.arcade.load()];case 2:return b.sent(),[2,{arcade:a.arcade,arcadeUtils:a,Dictionary:a.Dictionary,Feature:a.arcadeFeature}]}})})}());return[2,b]})})}Object.defineProperty(a,"__esModule",{value:!0});
var b;a.loadArcade=p;a.createLabelExpression=function(a,b,e){return d.create(a,b,e,null,["$feature"])};a.createVVExpression=function(a,b,e){return d.create(a,b,e,null,["$feature","$view"])};a.createRendererExpression=function(a,b,e){return d.create(a,b,e,null,["$feature","$view"])};a.createDictionaryExpression=function(a,b,e,f){return d.create(a,b,e,f,["$feature","$view"])};var d=function(){function a(a,b,d,e,f,c,h){this.evaluate=e;this._syntaxTree=d;this._arcade=a;this._arcadeDictionary=b;this._arcadeFeature=
f;this._fields=c;this._spatialReference=h;this._referencesGeometry=a.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"$view.scale")}a.create=function(b,d,c,m,w,t){return g(this,void 0,void 0,function(){var n,g,r,u,y,B,E,F,H,J,K,G,I,L,R;return l(this,function(v){switch(v.label){case 0:return[4,p()];case 1:return n=v.sent(),g=n.arcade,r=n.Feature,u=n.Dictionary,y=h.SpatialReference.fromJSON(d),B=g.parseScript(b,t),E=w.reduce(function(a,b){var d;
return k({},a,(d={},d[b]=null,d))},{}),F=null,f.isSome(m)&&(F=new u(m),F.immutable=!0,E.$config=null),H=g.scriptUsesGeometryEngine(B)&&g.enableGeometrySupport(),J=g.scriptUsesFeatureSet(B)&&g.enableFeatureSetSupport(),K=g.scriptIsAsync(B)&&g.enableAsyncSupport(),G={vars:E,spatialReference:y,useAsync:!!K},I=new u,I.immutable=!1,I.setField("scale",0),L=g.compileScript(B,G),R=function(a){"$view"in a&&a.$view&&(I.setField("scale",a.$view.scale),a.$view=I);F&&(a.$config=F);return L({vars:a,spatialReference:y})},
[4,e.all([H,J,K])];case 2:return v.sent(),[2,new a(g,u,B,R,new r,c,y)]}})})};a.prototype.repurposeFeature=function(a){a.geometry&&!a.geometry.spatialReference&&(a.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(a.geometry,a.attributes,{fields:this._fields});return this._arcadeFeature};a.prototype.createDictionary=function(){return new this._arcadeDictionary};a.prototype.referencesMember=function(a){return this._arcade.referencesMember(this._syntaxTree,
a)};a.prototype.referencesFunction=function(a){return this._arcade.referencesFunction(this._syntaxTree,a)};a.prototype.referencesGeometry=function(){return this._referencesGeometry};a.prototype.referencesScale=function(){return this._referencesScale};a.prototype.extractFieldLiterals=function(a){return this._arcade.extractFieldLiterals(this._syntaxTree,a)};return a}();a.default=d})},"esri/popup/content":function(){define("require exports ./content/AttachmentsContent ./content/Content ./content/FieldsContent ./content/MediaContent ./content/TextContent".split(" "),
function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.AttachmentsContent=l;a.BaseContent=g;a.FieldsContent=k;a.MediaContent=h;a.TextContent=f;a.isContent=function(e){return e instanceof a.BaseContent};a.types={base:null,key:"type",typeMap:{attachment:a.AttachmentsContent,fields:a.FieldsContent,media:a.MediaContent,text:a.TextContent}}})},"esri/popup/content/AttachmentsContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ../../layers/support/AttachmentInfo ./Content".split(" "),
function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.attachmentInfos=null;b.displayType=null;b.type="attachments";return b}l(b,a);d=b;b.prototype.clone=function(){return new d({displayType:this.displayType,attachmentInfos:this.attachmentInfos?k.clone(this.attachmentInfos):null})};var d;g([h.property({type:[f]})],b.prototype,"attachmentInfos",void 0);g([h.property({type:["preview","list"],json:{write:!0}})],b.prototype,"displayType",void 0);g([h.property({type:["attachments"],
readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0);return b=d=g([h.subclass("esri.popup.content.AttachmentsContent")],b)}(h.declared(e))})},"esri/layers/support/AttachmentInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./exifUtils".split(" "),function(c,a,l,g,k,h,f,e){var p={1:{id:1,rotation:0,mirrored:!1},2:{id:2,
rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};return function(a){function b(b){b=a.call(this,b)||this;b.contentType=null;b.exifInfo=null;b.id=null;b.globalId=null;b.keywords=null;b.name=null;b.parentGlobalId=null;b.parentObjectId=null;b.size=null;b.url=null;return b}l(b,a);c=b;Object.defineProperty(b.prototype,"orientationInfo",
{get:function(){var a=e.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return p[a]||null},enumerable:!0,configurable:!0});b.prototype.clone=function(){return new c({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})};var c;g([h.property({type:String})],b.prototype,"contentType",void 0);g([h.property()],
b.prototype,"exifInfo",void 0);g([h.property({readOnly:!0,dependsOn:["exifInfo"]})],b.prototype,"orientationInfo",null);g([h.property({type:f.Integer})],b.prototype,"id",void 0);g([h.property({type:String})],b.prototype,"globalId",void 0);g([h.property({type:String})],b.prototype,"keywords",void 0);g([h.property({type:String})],b.prototype,"name",void 0);g([h.property({json:{read:!1}})],b.prototype,"parentGlobalId",void 0);g([h.property({json:{read:!1}})],b.prototype,"parentObjectId",void 0);g([h.property({type:f.Integer})],
b.prototype,"size",void 0);g([h.property({json:{read:!1}})],b.prototype,"url",void 0);return b=c=g([h.subclass("esri.layers.support.AttachmentInfo")],b)}(h.declared(k.JSONSupport))})},"esri/layers/support/exifUtils":function(){define(["require","exports","../../core/arrayUtils"],function(c,a,l){function g(a){var c=a.tagName;a=a.tags;return a&&c?(a=l.find(a,function(a){return a.name===c}))&&a.value||null:null}Object.defineProperty(a,"__esModule",{value:!0});a.getExifValue=function(a){var c=a.exifInfo,
f=a.exifName;a=a.tagName;return c&&f&&a?(c=l.find(c,function(a){return a.name===f}))?g({tagName:a,tags:c.tags}):null:null}})},"esri/popup/content/Content":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){return function(a){function e(e){e=a.call(this,e)||this;e.type=null;return e}l(e,a);g([h.property({type:["attachments","fields","media","text"],
readOnly:!0,json:{read:!1,write:!0}})],e.prototype,"type",void 0);return e=g([h.subclass("esri.popup.content.Content")],e)}(h.declared(k.JSONSupport))})},"esri/popup/content/FieldsContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ../FieldInfo ./Content".split(" "),function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.fieldInfos=null;b.type="fields";
return b}l(b,a);d=b;b.prototype.writeFieldInfos=function(a,b){b.fieldInfos=a&&a.map(function(a){return a.toJSON()})};b.prototype.clone=function(){return new d({fieldInfos:Array.isArray(this.fieldInfos)?k.clone(this.fieldInfos):null})};var d;g([h.property({type:[f]})],b.prototype,"fieldInfos",void 0);g([h.writer("fieldInfos")],b.prototype,"writeFieldInfos",null);g([h.property({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0);return b=d=g([h.subclass("esri.popup.content.FieldsContent")],
b)}(h.declared(e))})},"esri/popup/FieldInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/FieldInfoFormat".split(" "),function(c,a,l,g,k,h,f,e,p){var b=new k.default({richtext:"rich-text",textarea:"text-area",textbox:"text-box"});return function(a){function d(b){b=a.call(this,b)||this;b.fieldName=null;b.format=null;b.isEditable=!1;b.label=null;
b.stringFieldOption="text-box";b.statisticType=null;b.tooltip=null;b.visible=!0;return b}l(d,a);c=d;d.prototype.writeStringFieldOption=function(a,d){d.stringFieldOption=b.toJSON(a)};d.prototype.readStringFieldOption=function(a){if(a)return b.fromJSON(a)};d.prototype.clone=function(){return new c({fieldName:this.fieldName,format:this.format?f.clone(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,
visible:this.visible})};var c;g([e.property({type:String,json:{write:!0}})],d.prototype,"fieldName",void 0);g([e.property({type:p,json:{write:!0}})],d.prototype,"format",void 0);g([e.property({type:Boolean,json:{write:!0,default:!1}})],d.prototype,"isEditable",void 0);g([e.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);g([e.property({type:b.apiValues,json:{write:!0,default:"text-box",type:b.jsonValues}})],d.prototype,"stringFieldOption",void 0);g([e.writer("stringFieldOption")],
d.prototype,"writeStringFieldOption",null);g([e.reader("stringFieldOption")],d.prototype,"readStringFieldOption",null);g([e.property({type:"count sum min max avg stddev var".split(" "),json:{write:!0}})],d.prototype,"statisticType",void 0);g([e.property({type:String,json:{write:!0}})],d.prototype,"tooltip",void 0);g([e.property({type:Boolean,json:{write:!0}})],d.prototype,"visible",void 0);return d=c=g([e.subclass("esri.popup.FieldInfo")],d)}(e.declared(h.JSONSupport))})},"esri/popup/support/FieldInfoFormat":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/date ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../intl/date ../../intl/number".split(" "),
function(c,a,l,g,k,h,f,e,p,b){return function(a){function d(b){b=a.call(this,b)||this;b.dateFormat=null;b.digitSeparator=!1;b.places=null;return b}l(d,a);c=d;d.prototype.clone=function(){return new c({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})};d.prototype.format=function(a){return this.dateFormat?p.formatDate(a,p.convertDateFormatToIntlOptions(this.dateFormat)):b.formatNumber(a,b.convertNumberFormatToIntlOptions(this))};var c;g([f.enumeration.serializable()(k.dictionary)],
d.prototype,"dateFormat",void 0);g([f.property({type:Boolean,json:{write:!0}})],d.prototype,"digitSeparator",void 0);g([f.property({type:e.Integer,json:{write:!0}})],d.prototype,"places",void 0);return d=c=g([f.subclass("esri.popup.support.FieldInfoFormat")],d)}(f.declared(h.JSONSupport))})},"esri/core/date":function(){define(["require","exports","./jsonMap"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.formats={"short-date":"(datePattern: 'M/d/y', selector: 'date')","short-date-short-time":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
"short-date-short-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","short-date-long-time":"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-long-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')","short-date-le":"(datePattern: 'd/M/y', selector: 'date')","short-date-le-short-time":"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-le-short-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",
"short-date-le-long-time":"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-le-long-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-day-year":"(datePattern: 'MMMM d, y', selector: 'date')","long-month-day-year-short-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-month-day-year-short-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",
"long-month-day-year-long-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')","long-month-day-year-long-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","day-short-month-year":"(datePattern: 'd MMM y', selector: 'date')","day-short-month-year-short-time":"(datePattern: 'd MMM y', timePattern: 'h:mm a', selector: 'date and time')","day-short-month-year-short-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm', selector: 'date and time')",
"day-short-month-year-long-time":"(datePattern: 'd MMM y', timePattern: 'h:mm:ss a', selector: 'date and time')","day-short-month-year-long-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm:ss', selector: 'date and time')","long-date":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","long-date-short-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-date-short-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",
"long-date-long-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')","long-date-long-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-year":"(datePattern: 'MMMM y', selector: 'date')","short-month-year":"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"};a.dictionary=l.strict()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",
shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",
longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",
longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a.toJSON=a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);a.getFormat=function(c){return a.formats[c]}})},"esri/intl/date":function(){define("require exports ../core/tsSupport/assignHelper @dojo/framework/shim/WeakMap ../core/jsonMap ./locale".split(" "),function(c,a,l,g,k,h){function f(a){a=a||y;if(!u.has(a)){var b=h.getLocale(),b=n[h.getLocale()]||b;u.set(a,new Intl.DateTimeFormat(b,
a))}return u.get(a)}Object.defineProperty(a,"__esModule",{value:!0});c={year:"numeric",month:"numeric",day:"numeric"};var e={year:"numeric",month:"long",day:"numeric"},p={year:"numeric",month:"short",day:"numeric"},b={year:"numeric",month:"long",weekday:"long",day:"numeric"},d={hour:"numeric",minute:"numeric"},m=l({},d,{second:"numeric"}),r={"short-date":c,"short-date-short-time":l({},c,d),"short-date-short-time-24":l({},c,d,{hour12:!1}),"short-date-long-time":l({},c,m),"short-date-long-time-24":l({},
c,m,{hour12:!1}),"short-date-le":c,"short-date-le-short-time":l({},c,d),"short-date-le-short-time-24":l({},c,d,{hour12:!1}),"short-date-le-long-time":l({},c,m),"short-date-le-long-time-24":l({},c,m,{hour12:!1}),"long-month-day-year":e,"long-month-day-year-short-time":l({},e,d),"long-month-day-year-short-time-24":l({},e,d,{hour12:!1}),"long-month-day-year-long-time":l({},e,m),"long-month-day-year-long-time-24":l({},e,m,{hour12:!1}),"day-short-month-year":p,"day-short-month-year-short-time":l({},p,
d),"day-short-month-year-short-time-24":l({},p,d,{hour12:!1}),"day-short-month-year-long-time":l({},p,m),"day-short-month-year-long-time-24":l({},p,m,{hour12:!1}),"long-date":b,"long-date-short-time":l({},b,d),"long-date-short-time-24":l({},b,d,{hour12:!1}),"long-date-long-time":l({},b,m),"long-date-long-time-24":l({},b,m,{hour12:!1}),"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":d,"long-time":m};a.dictionary=k.strict()({shortDate:"short-date",
shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",
longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",
longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a.dateFormats=a.dictionary.apiValues;a.toJSON=a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);var n={ar:"ar-u-nu-latn-ca-gregory"},u=new g.default,y=r["short-date-short-time"];h.onLocaleChange(function(){u=new g.default;y=r["short-date-short-time"]});
a.getDateTimeFormatter=f;a.convertDateFormatToIntlOptions=function(a){return r[a]||null};a.formatDate=function(a,b){return f(b).format(a)}})},"@dojo/framework/shim/WeakMap":function(){(function(c){"object"===typeof module&&"object"===typeof module.exports?(c=c(require,exports),void 0!==c&&(module.exports=c)):"function"===typeof define&&define.amd&&define("require exports tslib ./global ./iterator ../has/has ./Symbol".split(" "),c)})(function(c,a){Object.defineProperty(a,"__esModule",{value:!0});var l=
c("tslib"),g=c("./global"),k=c("./iterator"),h=c("../has/has");c("./Symbol");a.WeakMap=g.default.WeakMap;if(!h.default("es6-weakmap")){var f={},e=function(){var a=Math.floor(Date.now()%1E8);return function(){return"__wm"+Math.floor(1E8*Math.random())+(a++ +"__")}}();a.WeakMap=function(){function a(a){this[Symbol.toStringTag]="WeakMap";this._name=e();this._frozenEntries=[];if(a)if(k.isArrayLike(a))for(var b=0;b<a.length;b++){var f=a[b];this.set(f[0],f[1])}else try{for(b=l.__values(a),f=b.next();!f.done;f=
b.next()){var c=l.__read(f.value,2);this.set(c[0],c[1])}}catch(y){h={error:y}}finally{try{f&&!f.done&&(g=b.return)&&g.call(b)}finally{if(h)throw h.error;}}var h,g}a.prototype._getFrozenEntryIndex=function(a){for(var b=0;b<this._frozenEntries.length;b++)if(this._frozenEntries[b].key===a)return b;return-1};a.prototype.delete=function(a){if(void 0===a||null===a)return!1;var b=a[this._name];if(b&&b.key===a&&b.value!==f)return b.value=f,!0;a=this._getFrozenEntryIndex(a);return 0<=a?(this._frozenEntries.splice(a,
1),!0):!1};a.prototype.get=function(a){if(void 0!==a&&null!==a){var b=a[this._name];if(b&&b.key===a&&b.value!==f)return b.value;a=this._getFrozenEntryIndex(a);if(0<=a)return this._frozenEntries[a].value}};a.prototype.has=function(a){if(void 0===a||null===a)return!1;var b=a[this._name];return b&&b.key===a&&b.value!==f||0<=this._getFrozenEntryIndex(a)?!0:!1};a.prototype.set=function(a,d){if(!a||"object"!==typeof a&&"function"!==typeof a)throw new TypeError("Invalid value used as weak map key");var b=
a[this._name];b&&b.key===a||(b=Object.create(null,{key:{value:a}}),Object.isFrozen(a)?this._frozenEntries.push(b):Object.defineProperty(a,this._name,{value:b}));b.value=d;return this};return a}()}a.default=a.WeakMap})},"esri/intl/locale":function(){define(["require","exports","dojo/_base/kernel"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});var g=l.locale;a.getLocale=function(){return g};a.setLocale=function(a){g=a;k.slice().forEach(function(f){f.call(null,a)})};var k=[];a.onLocaleChange=
function(a){k.push(a);return{remove:function(){k.splice(k.indexOf(a),1)}}}})},"esri/intl/number":function(){define(["require","exports","../core/tsSupport/assignHelper","@dojo/framework/shim/WeakMap","./locale"],function(c,a,l,g,k){function h(a){var b=a||p;if(!e.has(b)){var c=k.getLocale(),c=f[k.getLocale()]||c;e.set(b,new Intl.NumberFormat(c,a))}return e.get(b)}Object.defineProperty(a,"__esModule",{value:!0});var f={ar:"ar-u-nu-arab"},e=new g.default,p={};k.onLocaleChange(function(){e=new g.default;
p={}});a.getFormatter=h;a.convertNumberFormatToIntlOptions=function(a){void 0===a&&(a={});var b={};null!=a.digitSeparator&&(b.useGrouping=a.digitSeparator);null!=a.places&&(b.minimumFractionDigits=b.maximumFractionDigits=a.places);return b};a.formatNumber=function(a,d){return h(d).format(a)}})},"esri/popup/content/MediaContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ./BarChartMediaInfo ./ColumnChartMediaInfo ./Content ./ImageMediaInfo ./LineChartMediaInfo ./PieChartMediaInfo ./support/mediaInfoTypes".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r){return function(a){function c(b){b=a.call(this,b)||this;b.mediaInfos=null;b.type="media";return b}l(c,a);n=c;c.prototype.readMediaInfos=function(a){return a&&a.map(function(a){if("image"===a.type)return b.fromJSON(a);if("barchart"===a.type)return f.fromJSON(a);if("columnchart"===a.type)return e.fromJSON(a);if("linechart"===a.type)return d.fromJSON(a);if("piechart"===a.type)return m.fromJSON(a)}).filter(Boolean)};c.prototype.writeMediaInfos=function(a,b){b.mediaInfos=
a&&a.map(function(a){return a.toJSON()})};c.prototype.clone=function(){return new n({mediaInfos:this.mediaInfos?k.clone(this.mediaInfos):null})};var n;g([h.property({types:[r.types]})],c.prototype,"mediaInfos",void 0);g([h.reader("mediaInfos")],c.prototype,"readMediaInfos",null);g([h.writer("mediaInfos")],c.prototype,"writeMediaInfos",null);g([h.property({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],c.prototype,"type",void 0);return c=n=g([h.subclass("esri.popup.content.MediaContent")],c)}(h.declared(p))})},
"esri/popup/content/BarChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type="bar-chart";return b}l(e,a);b=e;e.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;
g([k.property({type:["bar-chart"],readOnly:!0,json:{read:!1,write:f.chartTypeKebabDict.write}})],e.prototype,"type",void 0);return e=b=g([k.subclass("esri.popup.content.BarChartMediaInfo")],e)}(k.declared(h))})},"esri/popup/content/mixins/ChartMediaInfo":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ./MediaInfo ../support/ChartMediaInfoValue".split(" "),function(c,a,l,g,k,h,f){return function(a){function e(b){b=
a.call(this,b)||this;b.type=null;b.value=null;return b}l(e,a);g([k.property({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],e.prototype,"type",void 0);g([k.property({type:f,json:{write:!0}})],e.prototype,"value",void 0);return e=g([k.subclass("esri.popup.content.mixins.ChartMediaInfo")],e)}(k.declared(h))})},"esri/popup/content/mixins/MediaInfo":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h){return function(a){function e(e){e=a.call(this,e)||this;e.caption="";e.title="";e.type=null;return e}l(e,a);g([h.property({type:String,json:{write:!0}})],e.prototype,"caption",void 0);g([h.property({type:String,json:{write:!0}})],e.prototype,"title",void 0);g([h.property({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],e.prototype,"type",void 0);return e=g([h.subclass("esri.popup.content.mixins.MediaInfo")],e)}(h.declared(k.JSONSupport))})},
"esri/popup/content/support/ChartMediaInfoValue":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/lang ../../../core/accessorSupport/decorators ./ChartMediaInfoValueSeries".split(" "),function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.fields=[];b.normalizeField=null;b.series=[];b.tooltipField=null;return b}l(b,a);d=b;b.prototype.clone=function(){return new d({fields:h.clone(this.fields),
normalizeField:this.normalizeField,tooltipField:this.tooltipField})};var d;g([f.property({type:[String],json:{write:!0}})],b.prototype,"fields",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"normalizeField",void 0);g([f.property({type:[e],json:{read:!1}})],b.prototype,"series",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"tooltipField",void 0);return b=d=g([f.subclass("esri.popup.content.support.ChartMediaInfoValue")],b)}(f.declared(k.JSONSupport))})},"esri/popup/content/support/ChartMediaInfoValueSeries":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.tooltip=null;b.x=null;b.y=null;return b}l(e,a);f=e;e.prototype.clone=function(){return new f({tooltip:this.tooltip,x:this.x,y:this.y})};var f;g([h.property()],e.prototype,"tooltip",void 0);g([h.property()],e.prototype,"x",void 0);g([h.property()],e.prototype,"y",void 0);return e=f=g([h.subclass("esri.popup.content.support.ChartMediaInfoValueSeries")],e)}(h.declared(k))})},"esri/popup/content/support/chartMediaInfoUtils":function(){define(["require",
"exports","../../../core/jsonMap"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.chartTypeKebabDict=l.strict()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"})})},"esri/popup/content/ColumnChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(c,a,
l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type="column-chart";return b}l(e,a);b=e;e.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;g([k.property({type:["column-chart"],readOnly:!0,json:{read:!1,write:f.chartTypeKebabDict.write}})],e.prototype,"type",void 0);return e=b=g([k.subclass("esri.popup.content.ColumnChartMediaInfo")],e)}(k.declared(h))})},"esri/popup/content/ImageMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/MediaInfo ./support/ImageMediaInfoValue".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.refreshInterval=null;b.type="image";b.value=null;return b}l(e,a);b=e;e.prototype.clone=function(){return new b({title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})};var b;g([k.property({type:Number,json:{write:!0}})],e.prototype,"refreshInterval",void 0);g([k.property({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],e.prototype,"type",void 0);g([k.property({type:f,
json:{write:!0}})],e.prototype,"value",void 0);return e=b=g([k.subclass("esri.popup.content.ImageMediaInfo")],e)}(k.declared(h))})},"esri/popup/content/support/ImageMediaInfoValue":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.linkURL=null;b.sourceURL=null;return b}l(e,
a);f=e;e.prototype.clone=function(){return new f({linkURL:this.linkURL,sourceURL:this.sourceURL})};var f;g([h.property({type:String,json:{write:!0}})],e.prototype,"linkURL",void 0);g([h.property({type:String,json:{write:!0}})],e.prototype,"sourceURL",void 0);return e=f=g([h.subclass("esri.popup.content.support.ImageMediaInfoValue")],e)}(h.declared(k.JSONSupport))})},"esri/popup/content/LineChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type="line-chart";return b}l(e,a);b=e;e.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;g([k.property({type:["line-chart"],readOnly:!0,json:{read:!1,write:f.chartTypeKebabDict.write}})],e.prototype,"type",void 0);return e=b=g([k.subclass("esri.popup.content.LineChartMediaInfo")],e)}(k.declared(h))})},"esri/popup/content/PieChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type="pie-chart";return b}l(e,a);b=e;e.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;g([k.property({type:["pie-chart"],readOnly:!0,json:{read:!1,write:f.chartTypeKebabDict.write}})],e.prototype,"type",void 0);return e=b=g([k.subclass("esri.popup.content.PieChartMediaInfo")],e)}(k.declared(h))})},"esri/popup/content/support/mediaInfoTypes":function(){define("require exports ../BarChartMediaInfo ../ColumnChartMediaInfo ../ImageMediaInfo ../LineChartMediaInfo ../PieChartMediaInfo ../mixins/MediaInfo".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});a.types={base:e,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":l,"column-chart":g,"line-chart":h,"pie-chart":f,image:k}};a.default=a.types})},"esri/popup/content/TextContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Content".split(" "),function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,
b)||this;b.text=null;b.type="text";return b}l(e,a);f=e;e.prototype.clone=function(){return new f({text:this.text})};var f;g([k.property({type:String,json:{write:!0}})],e.prototype,"text",void 0);g([k.property({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],e.prototype,"type",void 0);return e=f=g([k.subclass("esri.popup.content.TextContent")],e)}(k.declared(h))})},"esri/popup/ExpressionInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.name=null;b.title=null;b.expression=null;b.returnType=null;return b}l(e,a);f=e;e.prototype.clone=function(){return new f({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})};var f;g([h.property({type:String,json:{write:!0}})],e.prototype,"name",void 0);g([h.property({type:String,json:{write:!0}})],e.prototype,"title",void 0);g([h.property({type:String,json:{write:!0}})],e.prototype,
"expression",void 0);g([h.property({type:["string","number"],json:{write:!0}})],e.prototype,"returnType",void 0);return e=f=g([h.subclass("esri.popup.ExpressionInfo")],e)}(h.declared(k.JSONSupport))})},"esri/popup/LayerOptions":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.returnTopmostRaster=
null;b.showNoDataRecords=null;return b}l(e,a);f=e;e.prototype.clone=function(){return new f({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})};var f;g([h.property({type:Boolean,json:{write:!0}})],e.prototype,"returnTopmostRaster",void 0);g([h.property({type:Boolean,json:{write:!0}})],e.prototype,"showNoDataRecords",void 0);return e=f=g([h.subclass("esri.popup.LayerOptions")],e)}(h.declared(k.JSONSupport))})},"esri/popup/RelatedRecordsInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/RelatedRecordsInfoFieldOrder".split(" "),
function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.showRelatedRecords=null;b.orderByFields=null;return b}l(b,a);d=b;b.prototype.clone=function(){return new d({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?h.clone(this.orderByFields):null})};var d;g([f.property({type:Boolean,json:{write:!0}})],b.prototype,"showRelatedRecords",void 0);g([f.property({type:[e],json:{write:!0}})],b.prototype,"orderByFields",void 0);return b=d=g([f.subclass("esri.popup.RelatedRecordsInfo")],
b)}(f.declared(k.JSONSupport))})},"esri/popup/support/RelatedRecordsInfoFieldOrder":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.field=null;b.order=null;return b}l(e,a);f=e;e.prototype.clone=function(){return new f({field:this.field,order:this.order})};var f;g([h.property({type:String,
json:{write:!0}})],e.prototype,"field",void 0);g([h.property({type:["asc","desc"],json:{write:!0}})],e.prototype,"order",void 0);return e=f=g([h.subclass("esri.popup.support.RelatedRecordsInfoFieldOrder")],e)}(h.declared(k.JSONSupport))})},"esri/support/actions/ActionBase":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,
f){return function(a){function e(b){b=a.call(this,b)||this;b.active=!1;b.className=null;b.disabled=!1;b.id=null;b.indicator=!1;b.title=null;b.type=null;b.visible=!0;return b}l(e,a);b=e;e.prototype.clone=function(){return new b({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})};var b;g([f.property()],e.prototype,"active",void 0);g([f.property()],e.prototype,"className",void 0);g([f.property()],e.prototype,
"disabled",void 0);g([f.property()],e.prototype,"id",void 0);g([f.property()],e.prototype,"indicator",void 0);g([f.property()],e.prototype,"title",void 0);g([f.property()],e.prototype,"type",void 0);g([f.property()],e.prototype,"visible",void 0);return e=b=g([f.subclass("esri.support.actions.ActionBase")],e)}(f.declared(h.IdentifiableMixin(k)))})},"esri/core/Identifiable":function(){define(["require","exports","./tsSupport/declareExtendsHelper","./tsSupport/decorateHelper","./accessorSupport/decorators"],
function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});var h=0;a.IdentifiableMixin=function(a){return function(a){function e(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;Object.defineProperty(b,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+h++});return b}l(e,a);return e=g([k.subclass("esri.core.Identifiable")],e)}(k.declared(a))};c=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}l(e,a);return e=
g([k.subclass("esri.core.Identifiable")],e)}(k.declared(a.IdentifiableMixin(function(){return function(){}}())));a.Identifiable=c})},"esri/support/actions/ActionButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ActionBase".split(" "),function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.image=null;b.type="button";return b}l(e,a);f=e;e.prototype.clone=function(){return new f({active:this.active,
className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})};var f;g([k.property()],e.prototype,"image",void 0);return e=f=g([k.subclass("esri.support.Action.ActionButton")],e)}(k.declared(h))})},"esri/support/actions/ActionToggle":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ActionBase".split(" "),function(c,a,
l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.image=null;b.type="toggle";b.value=!1;return b}l(e,a);f=e;e.prototype.clone=function(){return new f({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})};var f;g([k.property()],e.prototype,"image",void 0);g([k.property()],e.prototype,"value",void 0);return e=f=g([k.subclass("esri.support.Action.ActionToggle")],
e)}(k.declared(h))})},"esri/symbols":function(){define("require exports ./core/accessorSupport/ensureType ./symbols/CIMSymbol ./symbols/ExtrudeSymbol3DLayer ./symbols/FillSymbol ./symbols/FillSymbol3DLayer ./symbols/Font ./symbols/IconSymbol3DLayer ./symbols/LabelSymbol3D ./symbols/LineSymbol3D ./symbols/LineSymbol3DLayer ./symbols/MarkerSymbol ./symbols/MeshSymbol3D ./symbols/ObjectSymbol3DLayer ./symbols/PathSymbol3DLayer ./symbols/PictureFillSymbol ./symbols/PictureMarkerSymbol ./symbols/PointSymbol3D ./symbols/PolygonSymbol3D ./symbols/SimpleFillSymbol ./symbols/SimpleLineSymbol ./symbols/SimpleMarkerSymbol ./symbols/Symbol ./symbols/Symbol3D ./symbols/Symbol3DLayer ./symbols/TextSymbol ./symbols/TextSymbol3DLayer ./symbols/WaterSymbol3DLayer ./symbols/WebStyleSymbol ./symbols/callouts/LineCallout3D ./symbols/callouts/LineCallout3DBorder ./symbols/support/Symbol3DVerticalOffset ./symbols/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B,E,F,H,J,K,G,I,L,R,M){Object.defineProperty(a,"__esModule",{value:!0});a.CIMSymbol=g;a.ExtrudeSymbol3DLayer=k;a.BaseFillSymbol=h;a.FillSymbol3DLayer=f;a.Font=e;a.IconSymbol3DLayer=p;a.LabelSymbol3D=b;a.LineSymbol3D=d;a.LineSymbol3DLayer=m;a.BaseMarkerSymbol=r;a.MeshSymbol3D=n;a.ObjectSymbol3DLayer=u;a.PathSymbol3DLayer=y;a.PictureFillSymbol=w;a.PictureMarkerSymbol=t;a.PointSymbol3D=v;a.PolygonSymbol3D=z;a.SimpleFillSymbol=A;a.SimpleLineSymbol=
C;a.SimpleMarkerSymbol=D;a.BaseSymbol=B;a.BaseSymbol3D=E;a.BaseSymbol3DLayer=F;a.TextSymbol=H;a.TextSymbol3DLayer=J;a.WaterSymbol3DLayer=K;a.WebStyleSymbol=G;a.LineCallout3D=I;a.LineCallout3DBorder=L;a.Symbol3DVerticalOffset=R.Symbol3DVerticalOffset;a.fromJSON=M.fromJSON;a.isSymbol=function(b){return b instanceof a.BaseSymbol};a.isSymbol2D=function(a){if(!a)return!1;switch(a.type){case "picture-fill":case "picture-marker":case "simple-fill":case "simple-line":case "simple-marker":case "text":case "cim":return!0;
default:return!1}};a.isSymbol3D=function(a){if(!a)return!1;switch(a.type){case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return!0;default:return!1}};a.symbolTypes={base:a.BaseSymbol,key:"type",typeMap:{"simple-fill":a.SimpleFillSymbol,"picture-fill":a.PictureFillSymbol,"picture-marker":a.PictureMarkerSymbol,"simple-line":a.SimpleLineSymbol,"simple-marker":a.SimpleMarkerSymbol,text:a.TextSymbol,"label-3d":a.LabelSymbol3D,"line-3d":a.LineSymbol3D,"mesh-3d":a.MeshSymbol3D,
"point-3d":a.PointSymbol3D,"polygon-3d":a.PolygonSymbol3D,"web-style":a.WebStyleSymbol,cim:a.CIMSymbol}};a.symbolTypesRenderer={base:a.BaseSymbol,key:"type",typeMap:{"simple-fill":a.SimpleFillSymbol,"picture-fill":a.PictureFillSymbol,"picture-marker":a.PictureMarkerSymbol,"simple-line":a.SimpleLineSymbol,"simple-marker":a.SimpleMarkerSymbol,text:a.TextSymbol,"line-3d":a.LineSymbol3D,"mesh-3d":a.MeshSymbol3D,"point-3d":a.PointSymbol3D,"polygon-3d":a.PolygonSymbol3D,"web-style":a.WebStyleSymbol,cim:a.CIMSymbol}};
a.symbolTypesLabel={base:a.BaseSymbol,key:"type",typeMap:{text:a.TextSymbol,"label-3d":a.LabelSymbol3D}};a.symbolTypes3D={base:a.BaseSymbol,key:"type",typeMap:{"label-3d":a.LabelSymbol3D,"line-3d":a.LineSymbol3D,"mesh-3d":a.MeshSymbol3D,"point-3d":a.PointSymbol3D,"polygon-3d":a.PolygonSymbol3D,"web-style":a.WebStyleSymbol}};a.symbolTypesRenderer3D={base:a.BaseSymbol,key:"type",typeMap:{"line-3d":a.LineSymbol3D,"mesh-3d":a.MeshSymbol3D,"point-3d":a.PointSymbol3D,"polygon-3d":a.PolygonSymbol3D,"web-style":a.WebStyleSymbol}};
a.symbolTypesLabel3D={base:a.BaseSymbol,key:"type",typeMap:{"label-3d":a.LabelSymbol3D}};a.ensureType=l.ensureOneOfType(a.symbolTypes)})},"esri/symbols/CIMSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/lang ../core/promiseUtils ../core/accessorSupport/decorators ../layers/support/fieldUtils ../portal/Portal ./Symbol ./support/cimSymbolUtils".split(" "),function(c,
a,l,g,k,h,f,e,p,b,d,m,r){return function(a){function c(b){b=a.call(this,b)||this;b.data=null;b.portal=null;b.styleUrl="";b.type="cim";return b}l(c,a);m=c;c.prototype.readData=function(a,b){return b.symbol};c.prototype.writeData=function(a,b){a&&(b.symbol=a)};c.prototype.readStyleUrl=function(a,b){return b.symbolUrl?b.symbolUrl:a};c.prototype.writeStyleUrl=function(a,b){a&&(b.symbolUrl=a)};c.prototype.collectRequiredFields=function(a,d){return h(this,void 0,void 0,function(){var f,c,h,m,n,g,p;return k(this,
function(k){switch(k.label){case 0:return[4,r.expandSymbol(this)];case 1:k.sent(),c=(f="object"===typeof this.data&&this.data.length)?this.data:[this.data],h=0,m=c,k.label=2;case 2:if(!(h<m.length))return[3,5];n=m[h];g=n.primitiveOverrides;if(!g)return[3,4];p=g.map(function(e){return b.collectArcadeFieldNames(a,d,e.valueExpressionInfo.expression)});return[4,e.all(p)];case 3:k.sent(),k.label=4;case 4:return h++,[3,2];case 5:return[2]}})})};c.prototype.clone=function(){return new m({color:this.color.clone(),
data:f.clone(this.data),portal:this.portal,styleName:this.styleName,styleUrl:this.styleUrl})};var m;g([p.property({json:{write:!1}})],c.prototype,"color",void 0);g([p.property({json:{write:!0}})],c.prototype,"data",void 0);g([p.reader("data",["data","symbol"])],c.prototype,"readData",null);g([p.writer("data")],c.prototype,"writeData",null);g([p.property({type:d,json:{write:!1}})],c.prototype,"portal",void 0);g([p.property({json:{write:!0}})],c.prototype,"styleName",void 0);g([p.property({type:String,
json:{write:!0}})],c.prototype,"styleUrl",void 0);g([p.reader("styleUrl",["styleUrl","symbolUrl"])],c.prototype,"readStyleUrl",null);g([p.writer("styleUrl")],c.prototype,"writeStyleUrl",null);g([p.enumeration.serializable()({CIMSymbolReference:"cim"})],c.prototype,"type",void 0);return c=m=g([p.subclass("esri.symbols.CIMSymbol")],c)}(p.declared(m))})},"esri/portal/Portal":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/paramHelper dojo/_base/kernel ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../geometry/Extent ./PortalQueryParams ./PortalQueryResult ./PortalUser @dojo/framework/shim/Promise".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B){var E,F={PortalGroup:function(){return t.create(function(a){return c(["./PortalGroup"],a)})},PortalItem:function(){return t.create(function(a){return c(["./PortalItem"],a)})},PortalUser:function(){return t.create(function(a){return c(["./PortalUser"],a)})}};return function(a){function e(d){d=a.call(this,d)||this;d.access=null;d.allSSL=!1;d.authMode="auto";d.authorizedCrossOriginDomains=null;d.basemapGalleryGroupQuery=null;d.bingKey=null;d.canListApps=
!1;d.canListData=!1;d.canListPreProvisionedItems=!1;d.canProvisionDirectPurchase=!1;d.canSearchPublic=!0;d.canShareBingPublic=!1;d.canSharePublic=!1;d.canSignInArcGIS=!1;d.canSignInIDP=!1;d.colorSetsGroupQuery=null;d.commentsEnabled=!1;d.created=null;d.culture=null;d.customBaseUrl=null;d.defaultBasemap=null;d.defaultExtent=null;d.defaultVectorBasemap=null;d.description=null;d.eueiEnabled=!1;d.featuredGroups=null;d.featuredItemsGroupQuery=null;d.galleryTemplatesGroupQuery=null;d.livingAtlasGroupQuery=
null;d.hasCategorySchema=!1;d.helperServices=null;d.homePageFeaturedContent=null;d.homePageFeaturedContentCount=null;d.httpPort=null;d.httpsPort=null;d.id=null;d.ipCntryCode=null;d.isPortal=!1;d.isReadOnly=!1;d.layerTemplatesGroupQuery=null;d.maxTokenExpirationMinutes=null;d.modified=null;d.name=null;d.portalHostname=null;d.portalMode=null;d.portalProperties=null;d.region=null;d.rotatorPanels=null;d.showHomePageDescription=!1;d.sourceJSON=null;d.supportsHostedServices=!1;d.symbolSetsGroupQuery=null;
d.templatesGroupQuery=null;d.units=null;d.url=b.portalUrl;d.urlKey=null;d.user=null;d.useStandardizedQuery=!1;d.useVectorBasemaps=!1;d.vectorBasemapGalleryGroupQuery=null;return d}k(e,a);n=e;e.prototype.normalizeCtorArgs=function(a){return"string"===typeof a?{url:a}:a};e.prototype.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)};e.prototype.readAuthorizedCrossOriginDomains=function(a){if(a)for(var d=0;d<
a.length;d++){var e=a[d];-1===b.request.trustedServers.indexOf(e)&&b.request.trustedServers.push(e)}return a};e.prototype.readDefaultBasemap=function(a){return a?(a=E.fromJSON(a),a.portalItem={portal:this},a):null};e.prototype.readDefaultVectorBasemap=function(a){return a?(a=E.fromJSON(a),a.portalItem={portal:this},a):null};Object.defineProperty(e.prototype,"extraQuery",{get:function(){var a=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!a?" AND orgid:"+this.id:null},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"isOrganization",{get:function(){return!!this.access},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"restUrl",{get:function(){var a=this.url;if(a)var b=a.indexOf("/sharing"),a=0<b?a.substring(0,b):this.url.replace(/\/+$/,""),a=a+"/sharing/rest";return a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"thumbnailUrl",{get:function(){var a=this.restUrl,b=this.thumbnail;return a&&b?this._normalizeSSL(a+"/portals/self/resources/"+
b):null},enumerable:!0,configurable:!0});e.prototype.readUrlKey=function(a){return a?a.toLowerCase():a};e.prototype.readUser=function(a){var b=null;a&&(b=B.fromJSON(a),b.portal=this);return b};e.prototype.load=function(a){var b=this,e=t.create(function(a){return c(["../Basemap"],a)}).then(function(b){t.throwIfAborted(a);E=b}).then(function(){return b.sourceJSON?b.sourceJSON:b._fetchSelf(b.authMode,!1,a)}).then(function(a){if(d.id){var e=d.id;b.credential=e.findCredential(b.restUrl);b.credential||
b.authMode!==n.AUTH_MODE_AUTO||(b._esriId_credentialCreateHandle=e.on("credential-create",function(){e.findCredential(b.restUrl)&&b._signIn()}))}b.sourceJSON=a;b.read(a)});this.addResolvingPromise(e);return this.when()};e.prototype.createClosestFacilityTask=function(){return g(this,void 0,void 0,function(){var a,b;return f(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),a=this._getHelperServiceUrl("closestFacility"),[4,new Promise(function(a,b){c(["../tasks/ClosestFacilityTask"],
a,b)})];case 2:return b=d.sent(),[2,new b(a)]}})})};e.prototype.createElevationLayers=function(){return g(this,void 0,void 0,function(){var a,b;return f(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),a=this._getHelperService("defaultElevationLayers"),[4,new Promise(function(a,b){c(["../layers/ElevationLayer"],a,b)})];case 2:return b=d.sent(),[2,a?a.map(function(a){return new b({id:a.id,url:a.url})}):[]]}})})};e.prototype.createGeometryService=function(){return g(this,
void 0,void 0,function(){var a,b;return f(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),a=this._getHelperServiceUrl("geometry"),[4,new Promise(function(a,b){c(["../tasks/GeometryService"],a,b)})];case 2:return b=d.sent(),[2,new b(a)]}})})};e.prototype.createPrintTask=function(){return g(this,void 0,void 0,function(){var a,b;return f(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),a=this._getHelperServiceUrl("printTask"),[4,
new Promise(function(a,b){c(["../tasks/PrintTask"],a,b)})];case 2:return b=d.sent(),[2,new b(a)]}})})};e.prototype.createRouteTask=function(){return g(this,void 0,void 0,function(){var a,b;return f(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),a=this._getHelperServiceUrl("route"),[4,new Promise(function(a,b){c(["../tasks/RouteTask"],a,b)})];case 2:return b=d.sent(),[2,new b(a)]}})})};e.prototype.createServiceAreaTask=function(){return g(this,void 0,void 0,function(){var a,
b;return f(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),a=this._getHelperServiceUrl("serviceArea"),[4,new Promise(function(a,b){c(["../tasks/ServiceAreaTask"],a,b)})];case 2:return b=d.sent(),[2,new b(a)]}})})};e.prototype.fetchBasemaps=function(a,b){var d=new C;d.query=a||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);d.disableExtraQuery=!0;return this.queryGroups(d,b).then(function(a){d.num=100;d.query='type:"Web Map" -type:"Web Application"';
return a.total?(a=a.results[0],d.sortField=a.sortField||"name",d.sortOrder=a.sortOrder||"desc",a.queryItems(d,b)):null}).then(function(a){return a&&a.total?a.results.filter(function(a){return"Web Map"===a.type}).map(function(a){return new E({portalItem:a})}):[]})};e.prototype.fetchCategorySchema=function(a){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",a).then(function(a){return a.categorySchema}):t.isAborted(a)?t.reject(t.createAbortError()):t.resolve([])};
e.prototype.fetchFeaturedGroups=function(a){var b=this.featuredGroups,d=new C;d.num=100;d.sortField="title";if(b&&b.length){for(var e=[],f=0;f<b.length;f++){var c=b[f];e.push('(title:"'+c.title+'" AND owner:'+c.owner+")")}d.query=e.join(" OR ");return this.queryGroups(d,a).then(function(a){return a.results})}return t.isAborted(a)?t.reject(t.createAbortError()):t.resolve([])};e.prototype.fetchRegions=function(a){return this._request(this.restUrl+"/portals/regions",l({},a,{query:{culture:this.user&&
this.user.culture||this.culture||p.locale}}))};e.getDefault=function(){if(!n._default||n._default.destroyed)n._default=new n;return n._default};e.prototype.queryGroups=function(a,b){return this._queryPortal("/community/groups",a,"PortalGroup",b)};e.prototype.queryItems=function(a,b){return this._queryPortal("/search",a,"PortalItem",b)};e.prototype.queryUsers=function(a,b){a.sortField||(a.sortField="username");return this._queryPortal("/community/users",a,"PortalUser",b)};e.prototype.toJSON=function(){throw new r("internal:not-yet-implemented",
"Portal.toJSON is not yet implemented");};e.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");return new n({sourceJSON:a})};e.prototype._getHelperService=function(a){var b=this.helperServices&&this.helperServices[a];if(!b)throw new r("portal:service-not-found",'The `helperServices` do not include an entry named "'+a+'"');return b};e.prototype._getHelperServiceUrl=function(a){var b=this._getHelperService(a);if(!b.url)throw new r("portal:service-url-not-found",
'The `helperServices` entry "'+a+'" does not include a `url` value');return b.url};e.prototype._fetchSelf=function(a,b,d){void 0===a&&(a=this.authMode);void 0===b&&(b=!1);var e=this.restUrl+"/portals/self";a=l({authMode:a,query:{culture:p.locale}},d);"auto"===a.authMode&&(a.authMode="no-prompt");b&&(a.query.default=!0);return this._request(e,a)};e.prototype._queryPortal=function(a,b,d,e){var f=this,c=z.ensureType(C,b),h=function(b){return f._request(f.restUrl+a,l({},c.toRequestOptions(f),e)).then(function(a){var d=
c.clone();d.start=a.nextStart;return new D({nextQueryParams:d,queryParams:c,total:a.total,results:n._resultsToTypedArray(b,{portal:f},a,e)})}).then(function(a){return t.all(a.results.map(function(b){return"function"===typeof b.when?b.when():a})).then(function(){return a},function(b){t.throwIfAbortError(b);return a})})};return d&&F[d]?F[d]().then(function(a){t.throwIfAborted(e);return h(a)}):h()};e.prototype._signIn=function(){var a=this;if(this.authMode===n.AUTH_MODE_ANONYMOUS)return t.reject(new r("portal:invalid-auth-mode",
'Current "authMode"\' is "'+this.authMode+'"'));if("failed"===this.loadStatus)return t.reject(this.loadError);var b=function(b){return t.resolve().then(function(){if("not-loaded"===a.loadStatus)return b||(a.authMode="immediate"),a.load().then(function(){return null});if("loading"===a.loadStatus)return a.load().then(function(){if(a.credential)return null;a.credential=b;return a._fetchSelf("immediate")});if(a.user&&a.credential===b)return null;a.credential=b;return a._fetchSelf("immediate")}).then(function(b){b&&
(a.sourceJSON=b,a.read(b))})};return d.id?d.id.getCredential(this.restUrl).then(function(a){return b(a)}):b(this.credential)};e.prototype._normalizeSSL=function(a){return a.replace(/^http:/i,"https:").replace(":7080",":7443")};e.prototype._normalizeUrl=function(a){var b=this.credential&&this.credential.token;return this._normalizeSSL(b?a+(-1<a.indexOf("?")?"\x26":"?")+"token\x3d"+b:a)};e.prototype._requestToTypedArray=function(a,b,d){var e=this,f=function(d){return e._request(a,b).then(function(a){var b=
n._resultsToTypedArray(d,{portal:e},a);return t.all(b.map(function(b){return"function"===typeof b.when?b.when():a})).then(function(){return b},function(){return b})})};return d?t.create(function(a){return c(["./"+d],a)}).then(function(a){return f(a)}):f()};e.prototype._request=function(a,b){void 0===b&&(b={});var d=l({f:"json"},b.query),e=b.authMode,f=b.body,c=b.cacheBust,h=b.method,g=b.responseType;b={authMode:void 0===e?this.authMode===n.AUTH_MODE_ANONYMOUS?"anonymous":"auto":e,body:void 0===f?
null:f,cacheBust:void 0===c?!1:c,method:void 0===h?"auto":h,query:d,responseType:void 0===g?"json":g,timeout:0,signal:b.signal};return m(this._normalizeSSL(a),b).then(function(a){return a.data})};e._resultsToTypedArray=function(a,b,d,e){if(d){var f=w.isSome(e)?e.signal:null;d=d.listings||d.notifications||d.userInvitations||d.tags||d.items||d.groups||d.comments||d.provisions||d.results||d.relatedItems||d;if(a||b)d=d.map(function(d){d=u.mixin(a?a.fromJSON(d):d,b);"function"===typeof d.load&&d.load(f);
return d})}else d=[];return d};var n;e.AUTH_MODE_ANONYMOUS="anonymous";e.AUTH_MODE_AUTO="auto";e.AUTH_MODE_IMMEDIATE="immediate";h([v.property()],e.prototype,"access",void 0);h([v.property()],e.prototype,"allSSL",void 0);h([v.property()],e.prototype,"authMode",void 0);h([v.property()],e.prototype,"authorizedCrossOriginDomains",void 0);h([v.reader("authorizedCrossOriginDomains")],e.prototype,"readAuthorizedCrossOriginDomains",null);h([v.property()],e.prototype,"basemapGalleryGroupQuery",void 0);h([v.property()],
e.prototype,"bingKey",void 0);h([v.property()],e.prototype,"canListApps",void 0);h([v.property()],e.prototype,"canListData",void 0);h([v.property()],e.prototype,"canListPreProvisionedItems",void 0);h([v.property()],e.prototype,"canProvisionDirectPurchase",void 0);h([v.property()],e.prototype,"canSearchPublic",void 0);h([v.property()],e.prototype,"canShareBingPublic",void 0);h([v.property()],e.prototype,"canSharePublic",void 0);h([v.property()],e.prototype,"canSignInArcGIS",void 0);h([v.property()],
e.prototype,"canSignInIDP",void 0);h([v.property()],e.prototype,"colorSetsGroupQuery",void 0);h([v.property()],e.prototype,"commentsEnabled",void 0);h([v.property({type:Date})],e.prototype,"created",void 0);h([v.property()],e.prototype,"credential",void 0);h([v.property()],e.prototype,"culture",void 0);h([v.property()],e.prototype,"currentVersion",void 0);h([v.property()],e.prototype,"customBaseUrl",void 0);h([v.property()],e.prototype,"defaultBasemap",void 0);h([v.reader("defaultBasemap")],e.prototype,
"readDefaultBasemap",null);h([v.property({type:A})],e.prototype,"defaultExtent",void 0);h([v.property()],e.prototype,"defaultVectorBasemap",void 0);h([v.reader("defaultVectorBasemap")],e.prototype,"readDefaultVectorBasemap",null);h([v.property()],e.prototype,"description",void 0);h([v.property()],e.prototype,"eueiEnabled",void 0);h([v.property({dependsOn:["user","id","canSearchPublic"],readOnly:!0})],e.prototype,"extraQuery",null);h([v.property()],e.prototype,"featuredGroups",void 0);h([v.property()],
e.prototype,"featuredItemsGroupQuery",void 0);h([v.property()],e.prototype,"galleryTemplatesGroupQuery",void 0);h([v.property()],e.prototype,"livingAtlasGroupQuery",void 0);h([v.property()],e.prototype,"hasCategorySchema",void 0);h([v.property()],e.prototype,"helpBase",void 0);h([v.property()],e.prototype,"helperServices",void 0);h([v.property()],e.prototype,"helpMap",void 0);h([v.property()],e.prototype,"homePageFeaturedContent",void 0);h([v.property()],e.prototype,"homePageFeaturedContentCount",
void 0);h([v.property()],e.prototype,"httpPort",void 0);h([v.property()],e.prototype,"httpsPort",void 0);h([v.property()],e.prototype,"id",void 0);h([v.property()],e.prototype,"ipCntryCode",void 0);h([v.property({dependsOn:["access"],readOnly:!0})],e.prototype,"isOrganization",null);h([v.property()],e.prototype,"isPortal",void 0);h([v.property()],e.prototype,"isReadOnly",void 0);h([v.property()],e.prototype,"layerTemplatesGroupQuery",void 0);h([v.property()],e.prototype,"maxTokenExpirationMinutes",
void 0);h([v.property({type:Date})],e.prototype,"modified",void 0);h([v.property()],e.prototype,"name",void 0);h([v.property()],e.prototype,"portalHostname",void 0);h([v.property()],e.prototype,"portalMode",void 0);h([v.property()],e.prototype,"portalProperties",void 0);h([v.property()],e.prototype,"region",void 0);h([v.property({dependsOn:["url"],readOnly:!0})],e.prototype,"restUrl",null);h([v.property()],e.prototype,"rotatorPanels",void 0);h([v.property()],e.prototype,"showHomePageDescription",
void 0);h([v.property()],e.prototype,"sourceJSON",void 0);h([v.property()],e.prototype,"staticImagesUrl",void 0);h([v.property()],e.prototype,"stylesGroupQuery",void 0);h([v.property()],e.prototype,"supportsHostedServices",void 0);h([v.property()],e.prototype,"symbolSetsGroupQuery",void 0);h([v.property()],e.prototype,"templatesGroupQuery",void 0);h([v.property()],e.prototype,"thumbnail",void 0);h([v.property({dependsOn:["restUrl","thumbnail"],readOnly:!0})],e.prototype,"thumbnailUrl",null);h([v.property()],
e.prototype,"units",void 0);h([v.property()],e.prototype,"url",void 0);h([v.property()],e.prototype,"urlKey",void 0);h([v.reader("urlKey")],e.prototype,"readUrlKey",null);h([v.property()],e.prototype,"user",void 0);h([v.reader("user")],e.prototype,"readUser",null);h([v.property()],e.prototype,"useStandardizedQuery",void 0);h([v.property()],e.prototype,"useVectorBasemaps",void 0);h([v.property()],e.prototype,"vectorBasemapGalleryGroupQuery",void 0);return e=n=h([v.subclass("esri.portal.Portal")],e)}(v.declared(n.JSONSupportMixin(y)))})},
"esri/core/tsSupport/paramHelper":function(){define([],function(){return function(c,a){return function(l,g){a(l,g,c)}}})},"esri/core/Loadable":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./Error ./lang ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){var m=function(a){a=function(a){function e(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];var e=a.apply(this,b)||this;
e.loadError=null;e.loadStatus="not-loaded";e.loadWarnings=null;e._set("loadWarnings",[]);e.addResolvingPromise(p.create(function(a){var b=e.load.bind(e);e.load=function(d){var f=p.create(function(a,b){p.onAbortOrThrow(d,b);e.destroyed&&b(new h("load:instance-destroyed","Instance is destroyed",{instance:e}));e._promiseProps.when(a,b)});if("not-loaded"===e.loadStatus){e._set("loadStatus","loading");var c=e._loadController=p.createAbortController();b({signal:c.signal});p.onAbort(c.signal,function(){e._promiseProps.abort()})}a();
return f}}));e.when(function(){e._set("loadStatus","loaded");e._loadController=null},function(a){e._set("loadStatus","failed");e._set("loadError",a);e._loadController=null});return e}l(e,a);Object.defineProperty(e.prototype,"loaded",{get:function(){return"loaded"===this.loadStatus},enumerable:!0,configurable:!0});e.prototype.load=function(){return null};e.prototype.cancelLoad=function(){if(this.isFulfilled())return this;this._set("loadError",new h("load:cancelled","Cancelled"));this._loadController.abort();
return this};g([d.property({readOnly:!0,dependsOn:["loadStatus"]})],e.prototype,"loaded",null);g([d.property({readOnly:!0})],e.prototype,"loadError",void 0);g([d.property()],e.prototype,"loadStatus",void 0);g([d.property({type:[b],readOnly:!0})],e.prototype,"loadWarnings",void 0);return e=g([d.subclass("esri.core.Loadable")],e)}(d.declared(a));a.prototype["-chains-"]=f.mixin({},k._meta.chains,{load:"after"});return a};c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);
return b=g([d.subclass("esri.core.Loadable")],b)}(d.declared(m(e.EsriPromise)));(function(a){a.LoadableMixin=m;a.isLoadable=function(a){return!(!a||!a.load)}})(c||(c={}));return c})},"esri/core/Promise":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./has ./promiseUtils ./scheduling ./accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});var b=function(){function a(a){var b=this;
this.instance=a;this._resolver=f.createDeferred();this._status=void 0;this._resolvingPromises=[];this._resolver.promise.then(function(){b._status=0;b._cleanUp()},function(){b._status=1;b._cleanUp()})}a.prototype.addResolvingPromise=function(a){this._resolvingPromises.push(a);this._tryResolve()};a.prototype.isResolved=function(){return 0===this._status};a.prototype.isRejected=function(){return 1===this._status};a.prototype.isFulfilled=function(){return null!=this._status};a.prototype.abort=function(){this._resolver.reject(f.createAbortError())};
a.prototype.when=function(a,b){return this._resolver.promise.then(a,b)};a.prototype._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};a.prototype._tryResolve=function(){var a=this;if(!this.isFulfilled()){var b=f.createDeferred(),d=this._resolvingPromises.concat([b.promise]),c=this._allPromise=f.all(d);c.then(function(){a.isFulfilled()||a._allPromise!==c||a._resolver.resolve(a.instance)},function(b){a.isFulfilled()||a._allPromise!==c||f.isAbortError(b)||a._resolver.reject(b)});
h("esri-native-promise")?b.resolve():e.schedule(function(){return b.resolve()})}};return a}();a.EsriPromiseMixin=function(a){return function(a){function d(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];d=a.apply(this,d)||this;d._promiseProps=new b(d);d.addResolvingPromise(h("esri-native-promise")?f.resolve():f.create(function(a){return e.schedule(a)}));return d}l(d,a);d.prototype.isResolved=function(){return this._promiseProps.isResolved()};d.prototype.isRejected=function(){return this._promiseProps.isRejected()};
d.prototype.isFulfilled=function(){return this._promiseProps.isFulfilled()};d.prototype.when=function(a,b){var d=this;return f.create(function(a,b){d._promiseProps.when(a,b)}).then(a,b)};d.prototype.catch=function(a){return this.when(null,a)};d.prototype.addResolvingPromise=function(a){a&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in a?a.when():a)};return d=g([p.subclass("esri.core.Promise")],d)}(p.declared(a))};c=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}l(b,a);return b=g([p.subclass("esri.core.Promise")],b)}(p.declared(a.EsriPromiseMixin(k)));a.EsriPromise=c})},"esri/core/Warning":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(c,a,l,g,k){c=function(a){function f(e,c,b){var d=a.call(this,e,c,b)||this;return d instanceof f?d:new f(e,c,b)}l(f,a);return f}(k);c.prototype.type="warning";return c})},"esri/portal/PortalQueryParams":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){var r=new f.default({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});return function(a){function f(b){b=a.call(this,b)||this;b.categories=null;b.disableExtraQuery=!1;b.extent=null;b.num=10;b.query=null;b.sortField=null;b.start=1;return b}g(f,a);c=f;Object.defineProperty(f.prototype,"sortOrder",{get:function(){return this._get("sortOrder")||"asc"},set:function(a){"asc"!==a&&"desc"!==a||this._set("sortOrder",a)},enumerable:!0,
configurable:!0});f.prototype.clone=function(){return new c({categories:this.categories?e.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};f.prototype.toRequestOptions=function(a,b){var e;this.categories&&(e=this.categories.map(function(a){return Array.isArray(a)?JSON.stringify(a):a}));var f;if(this.extent){var c=m.project(this.extent,
d.WGS84);c&&(f=c.xmin+","+c.ymin+","+c.xmax+","+c.ymax)}c=this.query;!this.disableExtraQuery&&a.extraQuery&&(c="("+c+")"+a.extraQuery);a={categories:e,bbox:f,q:c,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(a.sortField=r.toJSON(this.sortField),a.sortOrder=this.sortOrder);return{query:l({},b,a)}};var c;k([p.property()],f.prototype,"categories",void 0);k([p.property()],f.prototype,"disableExtraQuery",void 0);k([p.property({type:b})],f.prototype,"extent",void 0);k([p.property()],
f.prototype,"num",void 0);k([p.property()],f.prototype,"query",void 0);k([p.property()],f.prototype,"sortField",void 0);k([p.property()],f.prototype,"sortOrder",null);k([p.property()],f.prototype,"start",void 0);return f=c=k([p.subclass("esri.portal.PortalQueryParams")],f)}(p.declared(h))})},"esri/portal/PortalQueryResult":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/accessorSupport/decorators".split(" "),function(c,
a,l,g,k,h){return function(a){function e(e){e=a.call(this,e)||this;e.nextQueryParams=null;e.queryParams=null;e.results=null;e.total=null;return e}l(e,a);g([h.property()],e.prototype,"nextQueryParams",void 0);g([h.property()],e.prototype,"queryParams",void 0);g([h.property()],e.prototype,"results",void 0);g([h.property()],e.prototype,"total",void 0);return e=g([h.subclass("esri.portal.PortalQueryResult")],e)}(h.declared(k))})},"esri/portal/PortalUser":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Error ../core/JSONSupport ../core/promiseUtils ../core/accessorSupport/decorators ./PortalFolder ./PortalGroup".split(" "),
function(c,a,l,g,k,h,f,e,p,b){return function(a){function d(){var b=a.call(this)||this;b.access=null;b.created=null;b.culture=null;b.description=null;b.email=null;b.fullName=null;b.modified=null;b.orgId=null;b.portal=null;b.preferredView=null;b.privileges=null;b.region=null;b.role=null;b.roleId=null;b.sourceJSON=null;b.units=null;b.username=null;b.userType=null;return b}l(d,a);h=d;Object.defineProperty(d.prototype,"thumbnailUrl",{get:function(){var a=this.url,b=this.thumbnail;return a&&b?this.portal._normalizeUrl(a+
"/info/"+b+"?f\x3djson"):null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"userContentUrl",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/users/"+this.username:null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/community/users/"+this.username:null},enumerable:!0,configurable:!0});d.prototype.addItem=function(a){var b=this,d=a&&a.item,e=a&&a.data;a=a&&a.folder;var f=
{method:"post"};d&&(f.query=d.createPostQuery(),null!=e&&("string"===typeof e?f.query.text=e:"object"===typeof e&&(f.query.text=JSON.stringify(e))));e=this.userContentUrl;a&&(e+="/"+("string"===typeof a?a:a.id));return this.portal._request(e+"/addItem",f).then(function(a){d.id=a.id;d.portal=b.portal;return d.loaded?d.reload():d.load()})};d.prototype.deleteItem=function(a){var b=this.userContentUrl;a.ownerFolder&&(b+="/"+a.ownerFolder);return this.portal._request(b+("/items/"+a.id+"/delete"),{method:"post"}).then(function(){a.id=
null;a.portal=null})};d.prototype.deleteItems=function(a){var b=this.userContentUrl+"/deleteItems",d=a.map(function(a){return a.id});return d.length?(d={method:"post",query:{items:d.join(",")}},this.portal._request(b,d).then(function(){a.forEach(function(a){a.id=null;a.portal=null})})):f.resolve(void 0)};d.prototype.fetchFolders=function(){var a=this;return this.portal._request(this.userContentUrl,{query:{num:1}}).then(function(b){return b&&b.folders?b.folders.map(function(b){b=p.fromJSON(b);b.portal=
a.portal;return b}):[]})};d.prototype.fetchGroups=function(){var a=this;return this.portal._request(this.url).then(function(d){return d&&d.groups?d.groups.map(function(d){d=b.fromJSON(d);d.portal=a.portal;return d}):[]})};d.prototype.fetchItems=function(a){var b=this;a||(a={});var d=this.userContentUrl;a.folder&&(d+="/"+a.folder.id);var e;return f.create(function(a){return c(["./PortalItem"],a)}).then(function(f){e=f;return b.portal._request(d,{query:{folders:!1,num:a.num||10,start:a.start||1,sortField:a.sortField||
"created",sortOrder:a.sortOrder||"asc"}})}).then(function(a){var d;return a&&a.items?(d=a.items.map(function(a){a=e.fromJSON(a);a.portal=b.portal;return a}),f.all(d.map(function(a){return a.load()})).catch(function(a){return a}).then(function(){return{items:d,nextStart:a.nextStart,total:a.total}})):{items:[],nextStart:-1,total:0}})};d.prototype.fetchTags=function(){return this.portal._request(this.url+"/tags").then(function(a){return a.tags})};d.prototype.getThumbnailUrl=function(a){var b=this.thumbnailUrl;
b&&a&&(b+="\x26w\x3d"+a);return b};d.prototype.queryFavorites=function(a){return this.favGroupId?(this._favGroup||(this._favGroup=new b({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(a)):f.reject(new k("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};d.prototype.toJSON=function(){throw new k("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};d.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");
var b=new h;b.sourceJSON=a;b.read(a);return b};var h;g([e.property()],d.prototype,"access",void 0);g([e.property({type:Date})],d.prototype,"created",void 0);g([e.property()],d.prototype,"culture",void 0);g([e.property()],d.prototype,"description",void 0);g([e.property()],d.prototype,"email",void 0);g([e.property()],d.prototype,"favGroupId",void 0);g([e.property()],d.prototype,"fullName",void 0);g([e.property({type:Date})],d.prototype,"modified",void 0);g([e.property()],d.prototype,"orgId",void 0);
g([e.property()],d.prototype,"portal",void 0);g([e.property()],d.prototype,"preferredView",void 0);g([e.property()],d.prototype,"privileges",void 0);g([e.property()],d.prototype,"region",void 0);g([e.property()],d.prototype,"role",void 0);g([e.property()],d.prototype,"roleId",void 0);g([e.property()],d.prototype,"sourceJSON",void 0);g([e.property()],d.prototype,"thumbnail",void 0);g([e.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],d.prototype,"thumbnailUrl",null);
g([e.property()],d.prototype,"units",void 0);g([e.property({dependsOn:["portal.restUrl"],readOnly:!0})],d.prototype,"userContentUrl",null);g([e.property({dependsOn:["portal.restUrl"],readOnly:!0})],d.prototype,"url",null);g([e.property()],d.prototype,"username",void 0);g([e.property()],d.prototype,"userType",void 0);return d=h=g([e.subclass("esri.portal.PortalUser")],d)}(e.declared(h.JSONSupport))})},"esri/portal/PortalFolder":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.created=null;b.id=null;b.portal=null;b.title=null;b.username=null;return b}l(e,a);Object.defineProperty(e.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/users/"+this.username+"/"+this.id:null},enumerable:!0,configurable:!0});e.prototype.toJSON=function(){throw new k("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};g([f.property({type:Date})],e.prototype,
"created",void 0);g([f.property()],e.prototype,"id",void 0);g([f.property()],e.prototype,"portal",void 0);g([f.property()],e.prototype,"title",void 0);g([f.property({dependsOn:["portal.restUrl"],readOnly:!0})],e.prototype,"url",null);g([f.property()],e.prototype,"username",void 0);return e=g([f.subclass("esri.portal.PortalFolder")],e)}(f.declared(h.JSONSupport))})},"esri/portal/PortalGroup":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./PortalQueryParams".split(" "),
function(c,a,l,g,k,h,f,e,p,b){return function(a){function d(b){b=a.call(this,b)||this;b.access=null;b.created=null;b.description=null;b.id=null;b.isInvitationOnly=!1;b.modified=null;b.owner=null;b.portal=null;b.snippet=null;b.sortField=null;b.sortOrder=null;b.tags=null;b.title=null;return b}l(d,a);Object.defineProperty(d.prototype,"thumbnailUrl",{get:function(){var a=this.url,b=this.thumbnail;return a&&b?this.portal._normalizeUrl(a+"/info/"+b+"?f\x3djson"):null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/community/groups/"+this.id:null},enumerable:!0,configurable:!0});d.prototype.fetchCategorySchema=function(a){var b=this;return this.portal._request(this.url+"/categorySchema",a).then(function(d){d=d.categorySchema||[];return d.some(function(a){return"contentCategorySetsGroupQuery.LivingAtlas"===a.source})?b._fetchCategorySchemaSet("LivingAtlas",a):d})};d.prototype.fetchMembers=function(a){return this.portal._request(this.url+"/users",
a)};d.prototype.getThumbnailUrl=function(a){var b=this.thumbnailUrl;b&&a&&(b+="\x26w\x3d"+a);return b};d.prototype.toJSON=function(){throw new h("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};d.prototype.queryItems=function(a,d){a=p.ensureType(b,a);if(5<parseFloat(this.portal.currentVersion))return a=a||new b,this.portal._queryPortal("/content/groups/"+this.id+"/search",a,"PortalItem",d);a=a?a.clone():new b;a.query="group:"+this.id+(a.query?" "+a.query:"");return this.portal.queryItems(a,
d)};d.prototype._fetchCategorySchemaSet=function(a,d){var e=this;return this.portal._fetchSelf(this.portal.authMode,!0,d).then(function(a){if(a=a.contentCategorySetsGroupQuery){var f=new b;f.disableExtraQuery=!0;f.num=1;f.query=a;return e.portal.queryGroups(f,d)}throw new h("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(function(e){if(e.total){e=e.results[0];var f=new b;f.num=1;f.query='typekeywords:"'+a+'"';return e.queryItems(f,d)}throw new h("portal-group:fetchCategorySchema",
"contentCategorySetsGroupQuery group not found");}).then(function(a){return a.total?a.results[0].fetchData("json",d).then(function(a){return(a=a&&a.categorySchema)&&a.length?a:[]}):[]})};g([e.property()],d.prototype,"access",void 0);g([e.property({type:Date})],d.prototype,"created",void 0);g([e.property()],d.prototype,"description",void 0);g([e.property()],d.prototype,"id",void 0);g([e.property()],d.prototype,"isInvitationOnly",void 0);g([e.property({type:Date})],d.prototype,"modified",void 0);g([e.property()],
d.prototype,"owner",void 0);g([e.property()],d.prototype,"portal",void 0);g([e.property()],d.prototype,"snippet",void 0);g([e.property()],d.prototype,"sortField",void 0);g([e.property()],d.prototype,"sortOrder",void 0);g([e.property()],d.prototype,"tags",void 0);g([e.property()],d.prototype,"thumbnail",void 0);g([e.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],d.prototype,"thumbnailUrl",null);g([e.property()],d.prototype,"title",void 0);g([e.property({dependsOn:["portal.restUrl"],
readOnly:!0})],d.prototype,"url",null);return d=g([e.subclass("esri.portal.PortalGroup")],d)}(e.declared(f.JSONSupport))})},"esri/symbols/Symbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f,e,p,b){var d=new e.default({esriSMS:"simple-marker",esriPMS:"picture-marker",
esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"}),m=0;return function(a){function e(b){b=a.call(this,b)||this;b.id="sym"+m++;b.type=null;return b}l(e,a);Object.defineProperty(e.prototype,"color",{set:function(a){this._set("color",a)},enumerable:!0,configurable:!0});
e.prototype.readColor=function(a){return a&&null!=a[0]?[a[0],a[1],a[2],a[3]/255]:a};e.prototype.collectRequiredFields=function(a,b){return h(this,void 0,void 0,function(){return k(this,function(a){return[2]})})};e.prototype.clone=function(){};g([b.property({type:d.apiValues,json:{read:d.read,write:{ignoreOrigin:!0,writer:d.write}}})],e.prototype,"type",void 0);g([b.property({type:f,value:new f([0,0,0,1]),json:{write:{allowNull:!0}}})],e.prototype,"color",null);g([b.reader("color")],e.prototype,"readColor",
null);return e=g([b.subclass("esri.symbols.Symbol")],e)}(b.declared(p.JSONSupport))})},"esri/symbols/support/cimSymbolUtils":function(){define("require exports ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/assignHelper ../../request ../../core/Logger ../../core/promiseUtils".split(" "),function(c,a,l,g,k,h,f,e){function p(a,d){return l(this,void 0,void 0,function(){var e,f;return g(this,function(c){switch(c.label){case 0:if(a.data||!a.styleUrl||!a.styleName)return[2,
a];e=a.styleName;f=a;return[4,b(e,a.styleUrl,d)];case 1:return f.data=c.sent(),[2,a]}})})}function b(b,d,e){return l(this,void 0,void 0,function(){var f,c;return g(this,function(g){if(r.has(b))return[2,r.get(b).then(function(b){return a.makeSymbolRef(b.data)})];try{return f=d+"/resources/styles/cim/"+b+".json",c=h(f,k({responseType:"json",query:{f:"json"}},e)),r.set(b,c),[2,c.then(function(b){return a.makeSymbolRef(b.data)})]}catch(z){return m.error("error requesting "+b+", reason is "+z.message),
r.has(b)&&r.delete(b),[2,null]}})})}var d=this;Object.defineProperty(a,"__esModule",{value:!0});var m=f.getLogger("esri/symbols/support/cimSymbolUtils");a.expandSymbols=function(b,f){return l(d,void 0,void 0,function(){return g(this,function(d){return[2,e.all(b.map(function(b){return a.expandSymbol(b,f)}))]})})};a.expandSymbol=function(a,b){return l(d,void 0,void 0,function(){return g(this,function(d){return a?"cim"===a.type?[2,p(a,b)]:"web-style"===a.type?[2,a.fetchCIMSymbol(b)]:[2,a]:[2,null]})})};
a.makeSymbolRef=function(a,b){return null===a?null:"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a,primitiveOverrides:b}};var r=new Map})},"esri/symbols/ExtrudeSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./support/Symbol3DMaterial".split(" "),function(c,a,l,g,k,h,f,e,p){return function(a){function b(b){b=a.call(this,b)||this;
b.type="extrude";b.size=void 0;b.material=null;b.castShadows=!0;b.edges=null;return b}l(b,a);f=b;b.prototype.clone=function(){return new f({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:k.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})};var f;g([h.enumeration.serializable()({Extrude:"extrude"})],b.prototype,"type",void 0);g([h.property({type:Number,json:{write:!0}})],b.prototype,"size",void 0);g([h.property({type:p.default,json:{write:!0}})],
b.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],b.prototype,"castShadows",void 0);g([h.property(e.symbol3dEdgesProperty)],b.prototype,"edges",void 0);return b=f=g([h.subclass("esri.symbols.ExtrudeSymbol3DLayer")],b)}(h.declared(f))})},"esri/symbols/Symbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h,f){var e=k.strict()({Icon:"icon",Object:"object",Line:"line",Path:"path",Fill:"fill",Extrude:"extrude",Text:"text",Water:"water"});c=function(a){function b(b){b=a.call(this,b)||this;b.enabled=!0;b.type=null;return b}l(b,a);b.prototype.writeEnabled=function(a,b,e){a||(b[e]=a)};g([f.property({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],b.prototype,"enabled",void 0);g([f.writer("enabled")],b.prototype,"writeEnabled",null);g([f.property({type:e.apiValues,
readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:e.write}}})],b.prototype,"type",void 0);return b=g([f.subclass("esri.symbols.Symbol3DLayer")],b)}(f.declared(h.JSONSupport));(c||(c={})).typeJSONDictionary=e;return c})},"esri/symbols/edges/utils":function(){define(["require","exports","./Edges3D","./SketchEdges3D","./SolidEdges3D"],function(c,a,l,g,k){function h(a,e,c){if(!a)return a;switch(a.type){case "solid":return e=new k,e.read(a,c),e;case "sketch":return e=new g,e.read(a,c),e}}Object.defineProperty(a,
"__esModule",{value:!0});a.read=h;a.symbol3dEdgesProperty={types:{key:"type",base:l,typeMap:{solid:k,sketch:g}},json:{read:h,write:!0}}})},"esri/symbols/edges/Edges3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../Color ../../core/JSONSupport ../../core/lang ../../core/screenUtils ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){return function(a){function f(b){b=
a.call(this,b)||this;b.color=new h([0,0,0,1]);b.extensionLength=0;b.size=p.px2pt(1);return b}l(f,a);f.prototype.normalizeCtorArgs=function(a){a&&a.type&&(a=k({},a),delete a.type);return a};f.prototype.clone=function(){};f.prototype.cloneProperties=function(){return{color:e.clone(this.color),size:this.size,extensionLength:this.extensionLength}};g([b.property({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],f.prototype,"type",void 0);g([b.property(d.colorAndTransparencyProperty)],
f.prototype,"color",void 0);g([b.property(k({},d.screenSizeProperty,{json:{write:{overridePolicy:function(a){return{enabled:!!a}}}}}))],f.prototype,"extensionLength",void 0);g([b.property(d.screenSizeProperty)],f.prototype,"size",void 0);return f=g([b.subclass("esri.symbols.edges.Edges3D")],f)}(b.declared(f.JSONSupport))})},"esri/core/screenUtils":function(){define(["require","exports","./compilerUtils"],function(c,a,l){function g(a){return a?72*a/96:0}function k(a,b){void 0===a&&(a=0);void 0===b&&
(b=0);return{x:a,y:b}}function h(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return[a,b]}function f(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return{x:a,y:b}}function e(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return[a,b]}function p(a,b){return b?(b[0]=a.x,b[1]=a.y,2<b.length&&(b[2]=0),b):[a.x,a.y]}function b(a){return k(a.x,a.y)}function d(a,b){a=(a instanceof HTMLElement?a:a.surface).getBoundingClientRect();return k(b.clientX-a.left,b.clientY-a.top)}Object.defineProperty(a,"__esModule",{value:!0});
var m=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;a.pt2px=function(a){return a?a/72*96:0};a.px2pt=g;a.toPt=function(a){if("string"===typeof a){if(m.test(a)){var b=a.match(m),d=Number(b[1]),b=b[3]&&b[3].toLowerCase();a="-"===a.charAt(0);d="px"===b?g(d):d;return a?-d:d}console.warn("screenUtils.toPt: input not recognized!");return null}return a};a.createScreenPoint=k;a.createScreenPointArray=h;a.createRenderScreenPoint=f;a.createRenderScreenPointArray=e;a.createRenderScreenPointArray3=function(a,b,d){void 0===
a&&(a=0);void 0===b&&(b=0);void 0===d&&(d=0);return[a,b,d]};a.castRenderScreenPointArray=function(a){return a};a.castRenderScreenPointArray3=function(a){return a};a.castScreenPointArray=function(a){return a};a.screenToRender=function(a,b,d){var e,c;switch(a.type){case "2d":a=window.devicePixelRatio||1;e=b.x*a;c=b.y*a;break;case "3d":p(b,n),a.state.camera.screenToRender(n,r),e=r[0],c=r[1]}return d?(d.x=e,d.y=c,d):f(e,c)};a.renderToScreen=function(a,b,d){var e,f;switch(a.type){case "2d":a=window.devicePixelRatio||
1;e=b.x/a;f=b.y/a;break;case "3d":p(b,r),a.state.camera.renderToScreen(r,n),e=n[0],f=n[1]}return d?(d.x=e,d.y=f,d):k(e,f)};a.screenArrayToRender=function(a,b,d){var f,c;switch(a.type){case "2d":a=window.devicePixelRatio||1;f=b[0]*a;c=b[1]*a;break;case "3d":a.state.camera.screenToRender(b,r),f=r[0],c=r[1]}return d?(d[0]=f,d[1]=c,2<d.length&&(d[2]=0),d):e(f,c)};a.renderArrayToScreen=function(a,b,d){var e,f;switch(a.type){case "2d":a=window.devicePixelRatio||1;e=b[0]/a;f=b[0]/a;break;case "3d":a.state.camera.renderToScreen(b,
n),e=n[0],f=n[1]}return d?(d[0]=e,d[1]=f,d):h(e,f)};a.screenPointArrayToObject=function(a,b){return b?(b.x=a[0],b.y=a[1],b):{x:a[0],y:a[1]}};a.screenPointObjectToArray=p;a.createScreenPointFromEvent=b;a.createScreenPointFromNativeEvent=d;a.createScreenPointFromSupportedEvent=function(a,e){return e instanceof Event?d(a,e):b(e)};a.isSupportedScreenPointEvent=function(a){if(a instanceof Event)return!0;if("object"===typeof a&&"type"in a)switch(a=a.type,a){case "click":case "double-click":case "pointer-down":case "pointer-drag":case "pointer-enter":case "pointer-leave":case "pointer-up":case "pointer-move":case "immediate-click":case "hold":case "drag":case "mouse-wheel":return!0;
case "key-down":case "key-up":case "gamepad":case "focus":case "blur":break;default:l.neverReachedSilent(a)}return!1};var r=e(),n=h()})},"esri/symbols/support/materialUtils":function(){define("require exports ../../Color ../../core/screenUtils ../../core/accessorSupport/ensureType ../../webdoc/support/opacityUtils".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.colorAndTransparencyProperty={type:l,json:{type:[k.Integer],default:null,read:{source:["color","transparency"],
reader:function(a,e){a=null!=e.transparency?h.transparencyToOpacity(e.transparency):1;return(e=e.color)&&Array.isArray(e)?new l([e[0]||0,e[1]||0,e[2]||0,a]):null}},write:{target:{color:{type:[k.Integer]},transparency:{type:k.Integer}},writer:function(a,e){e.color=a.toJSON().slice(0,3);a=h.opacityToTransparency(a.a);0!==a&&(e.transparency=a)}}}};a.screenSizeProperty={type:Number,cast:g.toPt,json:{write:!0}};a.stipplePatternProperty={type:[Number],cast:function(a){return null!=a?a:Array.isArray(a)?
a.map(g.toPt):null},json:{read:!1,write:!1}}})},"esri/webdoc/support/opacityUtils":function(){define(["require","exports","../../core/accessorSupport/ensureType"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.opacityToTransparency=function(a){a=l.ensureInteger(100*(1-a));return Math.max(0,Math.min(a,100))};a.transparencyToOpacity=function(a){return Math.max(0,Math.min(1-a/100,1))}})},"esri/symbols/edges/SketchEdges3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Edges3D".split(" "),
function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.type="sketch";return b}l(e,a);f=e;e.prototype.clone=function(){return new f(this.cloneProperties())};var f;g([k.property({type:["sketch"]})],e.prototype,"type",void 0);return e=f=g([k.subclass("esri.symbols.edges.SketchEdges3D")],e)}(k.declared(h))})},"esri/symbols/edges/SolidEdges3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Edges3D".split(" "),
function(c,a,l,g,k,h){return function(a){function e(b){b=a.call(this,b)||this;b.type="solid";return b}l(e,a);f=e;e.prototype.clone=function(){return new f(this.cloneProperties())};var f;g([k.property({type:["solid"]})],e.prototype,"type",void 0);return e=f=g([k.subclass("esri.symbols.support.SolidEdges3D")],e)}(k.declared(h))})},"esri/symbols/support/Symbol3DMaterial":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=null;return b}l(b,a);d=b;b.prototype.clone=function(){return new d({color:h.isSome(this.color)?this.color.clone():null})};var d;g([f.property(e.colorAndTransparencyProperty)],b.prototype,"color",void 0);return b=d=g([f.subclass("esri.symbols.support.Symbol3DMaterial")],b)}(f.declared(k.JSONSupport));a.Symbol3DMaterial=c;a.default=c})},"esri/symbols/FillSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/accessorSupport/decorators ./SimpleLineSymbol ./Symbol".split(" "),
function(c,a,l,g,k,h,f,e){var p=new k.default({esriSFS:"simple-fill",esriPFS:"picture-fill"});return function(a){function b(b){b=a.call(this,b)||this;b.outline=null;b.type=null;return b}l(b,a);g([h.property({type:f,json:{default:null,write:!0}})],b.prototype,"outline",void 0);g([h.property({type:p.apiValues,readOnly:!0,json:{type:p.jsonValues}})],b.prototype,"type",void 0);return b=g([h.subclass("esri.symbols.FillSymbol")],b)}(h.declared(e))})},"esri/symbols/SimpleLineSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./LineSymbol".split(" "),
function(c,a,l,g,k,h,f,e,p){var b=new k.default({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});return function(a){function d(b,d,e,f,c,h){b=a.call(this,b)||this;b.type="simple-line";
b.style="solid";b.cap="round";b.join="round";b.miterLimit=2;return b}l(d,a);c=d;d.prototype.normalizeCtorArgs=function(a,b,d,e,c,h){if(a&&"string"!==typeof a)return a;var m={};null!=a&&(m.style=a);null!=b&&(m.color=b);null!=d&&(m.width=f.toPt(d));null!=e&&(m.cap=e);null!=c&&(m.join=c);null!=h&&(m.miterLimit=f.toPt(h));return m};d.prototype.clone=function(){return new c({color:h.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})};var c;g([e.enumeration.serializable()({esriSLS:"simple-line"})],
d.prototype,"type",void 0);g([e.property({type:b.apiValues,json:{read:b.read,write:b.write}})],d.prototype,"style",void 0);g([e.property({type:["butt","round","square"],json:{write:{overridePolicy:function(a,b,d){return{enabled:"round"!==a&&(null==d||null==d.origin)}}}}})],d.prototype,"cap",void 0);g([e.property({type:["miter","round","bevel"],json:{write:{overridePolicy:function(a,b,d){return{enabled:"round"!==a&&(null==d||null==d.origin)}}}}})],d.prototype,"join",void 0);g([e.property({type:Number,
json:{read:!1,write:!1}})],d.prototype,"miterLimit",void 0);return d=c=g([e.subclass("esri.symbols.SimpleLineSymbol")],d)}(e.declared(p))})},"esri/symbols/LineSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type="simple-line";b.width=.75;return b}l(e,a);g([h.enumeration.serializable()({esriSLS:"simple-line"})],
e.prototype,"type",void 0);g([h.property({type:Number,cast:k.toPt,json:{write:!0}})],e.prototype,"width",void 0);return e=g([h.subclass("esri.symbols.LineSymbol")],e)}(h.declared(f))})},"esri/symbols/FillSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./support/colors ./support/Symbol3DFillMaterial ./support/Symbol3DOutline".split(" "),function(c,
a,l,g,k,h,f,e,p,b,d){return function(a){function f(b){b=a.call(this,b)||this;b.type="fill";b.material=null;b.castShadows=!0;b.outline=null;b.edges=null;return b}l(f,a);c=f;f.prototype.clone=function(){return new c({edges:k.isSome(this.edges)?this.edges.clone():null,enabled:this.enabled,material:k.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,outline:k.isSome(this.outline)?this.outline.clone():null})};f.fromSimpleFillSymbol=function(a){return new c({material:{color:(a.color||
p.transparentWhite).clone()},outline:a.outline?new d.default({size:a.outline.width||0,color:(a.outline.color||p.white).clone()}):null})};var c;g([h.enumeration.serializable()({Fill:"fill"})],f.prototype,"type",void 0);g([h.property({type:b.default,json:{write:!0}})],f.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],f.prototype,"castShadows",void 0);g([h.property({type:d.default,json:{write:!0}})],f.prototype,"outline",void 0);g([h.property(e.symbol3dEdgesProperty)],
f.prototype,"edges",void 0);return f=c=g([h.subclass("esri.symbols.FillSymbol3DLayer")],f)}(h.declared(f))})},"esri/symbols/support/colors":function(){define(["require","exports","../../Color"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.white=new l("white");a.black=new l("black");a.transparentWhite=new l([255,255,255,0]);a.isBlack=function(a){return 0===a.r&&0===a.g&&0===a.b}})},"esri/symbols/support/Symbol3DFillMaterial":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/maybe ../../core/accessorSupport/decorators ./Symbol3DMaterial".split(" "),
function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}l(e,a);b=e;e.prototype.clone=function(){return new b({color:k.isSome(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})};var b;g([h.enumeration.serializable()({multiply:"multiply",replace:"replace",tint:"tint"})],e.prototype,"colorMixMode",void 0);return e=b=g([h.subclass("esri.symbols.support.Symbol3DFillMaterial")],e)}(h.declared(f.default));
a.Symbol3DFillMaterial=c;a.default=c})},"esri/symbols/support/Symbol3DOutline":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./materialUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.color=new k([0,
0,0,1]);b.size=e.px2pt(1);b.stipplePattern=null;b.stippleOffColor=null;return b}l(d,a);c=d;d.prototype.clone=function(){return new c({color:f.isSome(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})};var c;g([p.property(b.colorAndTransparencyProperty)],d.prototype,"color",void 0);g([p.property(b.screenSizeProperty)],d.prototype,"size",void 0);g([p.property(b.stipplePatternProperty)],
d.prototype,"stipplePattern",void 0);g([p.property({type:k})],d.prototype,"stippleOffColor",void 0);return d=c=g([p.subclass("esri.symbols.support.Symbol3DOutline")],d)}(p.declared(h.JSONSupport));a.Symbol3DOutline=c;a.default=c})},"esri/symbols/Font":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f){return function(a){function e(b){b=
a.call(this,b)||this;b.decoration="none";b.family="sans-serif";b.size=9;b.style="normal";b.weight="normal";return b}l(e,a);b=e;e.prototype.castSize=function(a){return h.toPt(a)};e.prototype.clone=function(){return new b({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})};var b;g([f.property({type:["underline","line-through","none"],json:{default:"none",write:!0}})],e.prototype,"decoration",void 0);g([f.property({type:String,json:{write:!0}})],e.prototype,
"family",void 0);g([f.property({type:Number,json:{write:{overridePolicy:function(a,b,e){return{enabled:!e||!e.textSymbol3D}}}}})],e.prototype,"size",void 0);g([f.cast("size")],e.prototype,"castSize",null);g([f.property({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],e.prototype,"style",void 0);g([f.property({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],e.prototype,"weight",void 0);return e=b=g([f.subclass("esri.symbols.Font")],e)}(f.declared(k.JSONSupport))})},
"esri/symbols/IconSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/IconSymbol3DLayerResource ./support/materialUtils ./support/Symbol3DAnchorPosition2D ./support/Symbol3DMaterial ./support/Symbol3DOutline".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u){function y(a){var b="width"in a?a.width:a.size,
d="height"in a?a.height:a.size,e=w(a.xoffset);a=w(a.yoffset);return(e||a)&&b&&d?{x:-e/b,y:a/d}:null}function w(a){return isFinite(a)?a:0}var t=k.getLogger("esri.symbols.IconSymbol3DLayer"),v={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};return function(a){function c(b){b=a.call(this,b)||this;b.material=null;b.resource=null;b.type="icon";b.size=12;b.anchor="center";b.anchorPosition=void 0;b.outline=void 0;return b}l(c,a);p=c;c.prototype.clone=function(){return new p({anchor:this.anchor,
anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:h.isSome(this.material)?this.material.clone():null,outline:h.isSome(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})};c.fromSimpleMarkerSymbol=function(a){var d=a.color||b.white,e=y(a),f=a.outline&&0<a.outline.width?{size:a.outline.width,color:(a.outline.color||b.white).clone()}:null,c=p,h=a.size;a=a.style;var m=v[a];m?a=m:(t.warn(a+' cannot be mapped to Icon symbol. Fallback to "circle"'),
a="circle");return new c({size:h,resource:{primitive:a},material:{color:d},outline:f,anchor:e?"relative":void 0,anchorPosition:e})};c.fromPictureMarkerSymbol=function(a){var d=!a.color||b.isBlack(a.color)?b.white:a.color,e=y(a);return new p({size:a.width<=a.height?a.height:a.width,resource:{href:a.url},material:{color:d.clone()},anchor:e?"relative":void 0,anchorPosition:e})};c.fromCIMSymbol=function(a){return new p({resource:{href:f.makeData({mediaType:"application/json",data:JSON.stringify(a.data)})}})};
var p;g([e.property({type:n.default,json:{write:!0}})],c.prototype,"material",void 0);g([e.property({type:d.default,json:{write:!0}})],c.prototype,"resource",void 0);g([e.enumeration.serializable()({Icon:"icon"})],c.prototype,"type",void 0);g([e.property(m.screenSizeProperty)],c.prototype,"size",void 0);g([e.enumeration.serializable()({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),
e.property({json:{default:"center"}})],c.prototype,"anchor",void 0);g([e.property({type:r.Symbol3DAnchorPosition2D,json:{type:[Number],read:{reader:function(a){return new r.Symbol3DAnchorPosition2D({x:a[0],y:a[1]})}},write:{writer:function(a,b){b.anchorPosition=[a.x,a.y]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],c.prototype,"anchorPosition",void 0);g([e.property({type:u.default,json:{write:!0}})],c.prototype,"outline",void 0);return c=p=g([e.subclass("esri.symbols.IconSymbol3DLayer")],
c)}(e.declared(p))})},"esri/symbols/support/IconSymbol3DLayerResource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/urlUtils ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});var p=k.strict()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});c=function(a){function b(b){return a.call(this,
b)||this}l(b,a);c=b;b.prototype.readHref=function(a,b,d){return a?f.fromJSON(a,d):b.dataURI};b.prototype.writeHref=function(a,b,d,e){a&&(f.isDataProtocol(a)?b.dataURI=a:(b.href=f.toJSON(a,e),f.isAbsolute(b.href)&&(b.href=f.normalize(b.href))))};b.prototype.clone=function(){return new c({href:this.href,primitive:this.primitive})};var c;g([e.property({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],b.prototype,"href",void 0);g([e.reader("href")],b.prototype,"readHref",null);g([e.writer("href",
{href:{type:String},dataURI:{type:String}})],b.prototype,"writeHref",null);g([e.enumeration.serializable()(p)],b.prototype,"primitive",void 0);return b=c=g([e.subclass("esri.symbols.support.IconSymbol3DLayerResource")],b)}(e.declared(h.JSONSupport));a.IconSymbol3DLayerResource=c;a.defaultPrimitive="circle";a.default=c})},"esri/symbols/support/Symbol3DAnchorPosition2D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.x=0;b.y=0;return b}l(e,a);f=e;e.prototype.clone=function(){return new f({x:this.x,y:this.y})};var f;g([h.property({type:Number})],e.prototype,"x",void 0);g([h.property({type:Number})],e.prototype,"y",void 0);return e=f=g([h.subclass("esri.symbols.support.Symbol3DAnchorPosition2D")],e)}(h.declared(k));a.Symbol3DAnchorPosition2D=c;a.default=c})},"esri/symbols/LabelSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/lang ../core/accessorSupport/decorators ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d){var m=k.ofType({base:null,key:"type",typeMap:{text:p}});return function(a){function e(b){b=a.call(this,b)||this;b.verticalOffset=null;b.callout=null;b.styleOrigin=null;b.symbolLayers=new m;b.type="label-3d";return b}l(e,a);c=e;e.prototype.supportsCallout=function(){return!0};e.prototype.hasVisibleCallout=function(){return b.hasVisibleCallout(this)};e.prototype.hasVisibleVerticalOffset=function(){return b.hasVisibleVerticalOffset(this)};e.prototype.clone=function(){return new c({styleOrigin:h.clone(this.styleOrigin),
symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail),callout:h.clone(this.callout),verticalOffset:h.clone(this.verticalOffset)})};e.fromTextSymbol=function(a){return new c({symbolLayers:[p.fromTextSymbol(a)]})};var c;g([f.property({type:d.default,json:{write:!0}})],e.prototype,"verticalOffset",void 0);g([f.property(b.calloutProperty)],e.prototype,"callout",void 0);g([f.property({json:{read:!1,write:!1}})],e.prototype,"styleOrigin",void 0);g([f.property({type:m})],e.prototype,
"symbolLayers",void 0);g([f.enumeration.serializable()({LabelSymbol3D:"label-3d"})],e.prototype,"type",void 0);return e=c=g([f.subclass("esri.symbols.LabelSymbol3D")],e)}(f.declared(e))})},"esri/symbols/Symbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/collectionUtils ../core/jsonMap ../core/Logger ../core/urlUtils ../core/Warning ../core/accessorSupport/decorators ../portal/Portal ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./PathSymbol3DLayer ./Symbol ./Symbol3DLayer ./TextSymbol3DLayer ./WaterSymbol3DLayer ./support/StyleOrigin ./support/Thumbnail".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B){var E={icon:u,object:w,line:y,path:t,fill:n,extrude:r,text:A,water:C},F=k.ofType({base:z,key:"type",typeMap:E}),H=f.strict()({PointSymbol3D:"point-3d",PolygonSymbol3D:"polygon-3d",LineSymbol3D:"line-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),J=e.getLogger("esri.symbols.Symbol3D");return function(a){function e(b){b=a.call(this,b)||this;b.styleOrigin=null;b.thumbnail=null;b.type=null;var d=b.__accessor__&&b.__accessor__.metadatas&&
b.__accessor__.metadatas.symbolLayers;b._set("symbolLayers",new (d&&d.type||k));return b}l(e,a);Object.defineProperty(e.prototype,"color",{get:function(){return null},set:function(a){J.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"symbolLayers",{set:function(a){h.referenceSetter(a,this._get("symbolLayers"))},enumerable:!0,configurable:!0});e.prototype.readSymbolLayers=
function(a,d,e){d=[];for(var f=0;f<a.length;f++){var c=a[f],h=z.typeJSONDictionary.read(c.type),m=h&&E[h];m?(c=new m,c.read(a[f],e),d.push(c)):(J.warn("Unknown symbol layer type: "+h),e&&e.messages&&e.messages.push(new b("symbol-layer:unsupported","Symbol layers of type '"+(h||c.type||"unknown")+"' are not supported",{definition:c,context:e})))}return d};e.prototype.readStyleOrigin=function(a,d,e){if(a.styleUrl&&a.name)return d=p.fromJSON(a.styleUrl,e),new D({styleUrl:d,name:a.name});if(a.styleName&&
a.name)return new D({portal:e&&e.portal||m.getDefault(),styleName:a.styleName,name:a.name});e&&e.messages&&e.messages.push(new b("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:e,definition:a}))};e.prototype.writeStyleOrigin=function(a,d,e,f){a.styleUrl&&a.name?(e=p.toJSON(a.styleUrl,f),p.isAbsolute(e)&&(e=p.normalize(e)),d.styleOrigin={styleUrl:e,name:a.name}):a.styleName&&a.name&&(a.portal&&f&&f.portal&&!p.hasSamePortal(a.portal.restUrl,
f.portal.restUrl)?f&&f.messages&&f.messages.push(new b("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):d.styleOrigin={styleName:a.styleName,name:a.name})};e.prototype.normalizeCtorArgs=function(a){return a instanceof z||a&&E[a.type]?{symbolLayers:[a]}:Array.isArray(a)?{symbolLayers:a}:a};g([d.property({json:{read:!1,write:!1}})],e.prototype,"color",null);g([d.property({type:F,nonNullable:!0,
json:{write:!0}}),d.cast(h.castForReferenceSetter)],e.prototype,"symbolLayers",null);g([d.reader("symbolLayers")],e.prototype,"readSymbolLayers",null);g([d.property({type:D})],e.prototype,"styleOrigin",void 0);g([d.reader("styleOrigin")],e.prototype,"readStyleOrigin",null);g([d.writer("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],e.prototype,"writeStyleOrigin",null);g([d.property({type:B.default,json:{read:!1}})],e.prototype,
"thumbnail",void 0);g([d.property({type:H.apiValues,readOnly:!0,json:{type:H.jsonValues,read:!1}})],e.prototype,"type",void 0);return e=g([d.subclass("esri.symbols.Symbol3D")],e)}(d.declared(v))})},"esri/core/collectionUtils":function(){define(["require","exports","./Collection"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.referenceSetter=function(a,c,h){void 0===h&&(h=l);c||(c=new h);if(c===a)return c;c.removeAll();a&&(Array.isArray(a)||"items"in a&&Array.isArray(a.items))?
c.addMany(a):a&&c.add(a);return c};a.castForReferenceSetter=function(a){return a}})},"esri/symbols/LineSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/maybe ../core/screenUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/materialUtils ./support/Symbol3DMaterial".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m){return function(a){function c(b){b=a.call(this,b)||this;b.material=null;
b.type="line";b.join="miter";b.cap="butt";b.size=f.px2pt(1);b.stipplePattern=null;b.stippleOffColor=null;return b}l(c,a);p=c;c.prototype.clone=function(){return new p({enabled:this.enabled,material:h.isSome(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})};c.fromSimpleLineSymbol=function(a){return new p({size:a.width||1,cap:a.cap||
"butt",join:a.join||"miter",material:{color:(a.color||b.white).clone()}})};var p;g([e.property({type:m.default,json:{write:!0}})],c.prototype,"material",void 0);g([e.enumeration.serializable()({Line:"line"})],c.prototype,"type",void 0);g([e.property({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],c.prototype,"join",void 0);g([e.property({type:["butt","square","round"],json:{write:!0,default:"butt"}})],c.prototype,"cap",void 0);g([e.property(d.screenSizeProperty)],c.prototype,"size",
void 0);g([e.property(d.stipplePatternProperty)],c.prototype,"stipplePattern",void 0);g([e.property({type:k})],c.prototype,"stippleOffColor",void 0);return c=p=g([e.subclass("esri.symbols.LineSymbol3DLayer")],c)}(e.declared(p))})},"esri/symbols/ObjectSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/ObjectSymbol3DLayerResource ./support/Symbol3DAnchorPosition3D ./support/Symbol3DMaterial".split(" "),
function(c,a,l,g,k,h,f,e,p,b){return function(a){function d(b){b=a.call(this,b)||this;b.material=null;b.castShadows=!0;b.resource=null;b.type="object";b.width=void 0;b.height=void 0;b.depth=void 0;b.anchor=void 0;b.anchorPosition=void 0;b.heading=void 0;b.tilt=void 0;b.roll=void 0;return b}l(d,a);f=d;d.prototype.clone=function(){return new f({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,
height:this.height,material:k.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})};Object.defineProperty(d.prototype,"isPrimitive",{get:function(){return!this.resource||"string"!==typeof this.resource.href},enumerable:!0,configurable:!0});var f;g([h.property({type:b.default,json:{write:!0}})],d.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],d.prototype,
"castShadows",void 0);g([h.property({type:e.default,json:{write:!0}})],d.prototype,"resource",void 0);g([h.enumeration.serializable()({Object:"object"})],d.prototype,"type",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"width",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"height",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"depth",void 0);g([h.enumeration.serializable()({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),
h.property({json:{default:"origin"}})],d.prototype,"anchor",void 0);g([h.property({type:p.Symbol3DAnchorPosition3D,json:{type:[Number],read:{reader:function(a){return new p.Symbol3DAnchorPosition3D({x:a[0],y:a[1],z:a[2]})}},write:{writer:function(a,b){b.anchorPosition=[a.x,a.y,a.z]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],d.prototype,"anchorPosition",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"heading",void 0);g([h.property({type:Number,json:{write:!0}})],
d.prototype,"tilt",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"roll",void 0);g([h.property({readOnly:!0,dependsOn:["resource","resource.href"]})],d.prototype,"isPrimitive",null);return d=f=g([h.subclass("esri.symbols.ObjectSymbol3DLayer")],d)}(h.declared(f))})},"esri/symbols/support/ObjectSymbol3DLayerResource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/urlUtils ../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});var p=k.strict()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);c=b;b.prototype.clone=function(){return new c({href:this.href,primitive:this.primitive})};var c;g([e.property({type:String,json:{read:f.read,write:f.write}})],b.prototype,"href",void 0);g([e.enumeration.serializable()(p)],
b.prototype,"primitive",void 0);return b=c=g([e.subclass("esri.symbols.support.ObjectSymbol3DLayerResource")],b)}(e.declared(h.JSONSupport));a.ObjectSymbol3DLayerResource=c;a.defaultPrimitive="sphere";a.default=c})},"esri/symbols/support/Symbol3DAnchorPosition3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",
{value:!0});c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.x=0;b.y=0;b.z=0;return b}l(e,a);f=e;e.prototype.clone=function(){return new f({x:this.x,y:this.y,z:this.z})};var f;g([h.property({type:Number})],e.prototype,"x",void 0);g([h.property({type:Number})],e.prototype,"y",void 0);g([h.property({type:Number})],e.prototype,"z",void 0);return e=f=g([h.subclass("esri.symbols.support.Symbol3DAnchorPosition3D")],e)}(h.declared(k));a.Symbol3DAnchorPosition3D=c;a.default=c})},
"esri/symbols/PathSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/Symbol3DMaterial".split(" "),function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.material=null;b.castShadows=!0;b.type="path";b.profile="circle";b.join="miter";b.cap="butt";b.width=void 0;b.height=void 0;b.anchor="center";b.profileRotation="all";return b}
l(b,a);d=b;Object.defineProperty(b.prototype,"size",{get:function(){if(this.width&&this.height){if(this.width===this.height)return this.width}else{if(this.width)return this.width;if(this.height)return this.height}},set:function(a){this.height=this.width=a},enumerable:!0,configurable:!0});b.prototype.readSize=function(a,b){return b.height||b.width?a:b.size};b.prototype.clone=function(){return new d({enabled:this.enabled,material:k.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,
size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})};var d;g([h.property({type:e.default,json:{write:!0}})],b.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],b.prototype,"castShadows",void 0);g([h.enumeration.serializable()({Path:"path"})],b.prototype,"type",void 0);g([h.property({type:Number})],b.prototype,"size",null);g([h.reader("size")],
b.prototype,"readSize",null);g([h.property({type:["circle","quad"],json:{write:!0,default:"circle"}})],b.prototype,"profile",void 0);g([h.property({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],b.prototype,"join",void 0);g([h.property({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],b.prototype,"cap",void 0);g([h.property({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],b.prototype,"width",void 0);g([h.property({type:Number,
json:{write:!0}})],b.prototype,"height",void 0);g([h.property({type:["center","bottom","top"],json:{write:!0,default:"center"}})],b.prototype,"anchor",void 0);g([h.property({type:["heading","all"],json:{write:!0,default:"all"}})],b.prototype,"profileRotation",void 0);return b=d=g([h.subclass("esri.symbols.PathSymbol3DLayer")],b)}(h.declared(f))})},"esri/symbols/TextSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/lang ../core/maybe ../core/accessorSupport/decorators ./Font ./Symbol3DLayer ./support/materialUtils ./support/Symbol3DHalo ./support/Symbol3DMaterial".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r){return function(a){function b(b){b=a.call(this,b)||this;b._userSize=void 0;b.halo=null;b.material=null;b.text=void 0;b.type="text";return b}l(b,a);c=b;Object.defineProperty(b.prototype,"font",{get:function(){return this._get("font")||null},set:function(a){a&&this._userSize&&(a.size=this._userSize);this._set("font",a)},enumerable:!0,configurable:!0});b.prototype.writeFont=function(a,b,d,e){d=k({},e,{textSymbol3D:!0});b.font=a.write({},d);delete b.font.size};Object.defineProperty(b.prototype,
"size",{get:function(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9},set:function(a){this._userSize=a;this.font&&(this.font.size=this._userSize);this.notifyChange("size")},enumerable:!0,configurable:!0});b.prototype.clone=function(){return new c({enabled:this.enabled,font:this.font&&h.clone(this.font),halo:this.halo&&h.clone(this.halo),material:f.isSome(this.material)?this.material.clone():null,size:this.size,text:this.text})};b.fromTextSymbol=function(a){var b;
b=a.haloColor;var d=a.haloSize;b=b&&0<d?{color:h.clone(b),size:d}:null;d=a.font?a.font.clone():new p;return new c({size:d.size,font:d,halo:b,material:a.color?{color:a.color.clone()}:null,text:a.text})};var c;g([e.property({type:p,json:{write:!0}})],b.prototype,"font",null);g([e.writer("font")],b.prototype,"writeFont",null);g([e.property({type:m.default,json:{write:!0}})],b.prototype,"halo",void 0);g([e.property({type:r.default,json:{write:!0}})],b.prototype,"material",void 0);g([e.property(d.screenSizeProperty),
e.property({dependsOn:["font.size"]})],b.prototype,"size",null);g([e.property({type:String,json:{write:!0}})],b.prototype,"text",void 0);g([e.enumeration.serializable()({Text:"text"})],b.prototype,"type",void 0);return b=c=g([e.subclass("esri.symbols.TextSymbol3DLayer")],b)}(e.declared(b))})},"esri/symbols/support/Symbol3DHalo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=new k([0,0,0,1]);b.size=0;return b}l(b,a);c=b;b.prototype.clone=function(){return new c({color:f.clone(this.color),size:this.size})};var c;g([e.property(p.colorAndTransparencyProperty)],b.prototype,"color",void 0);g([e.property(p.screenSizeProperty)],b.prototype,"size",void 0);return b=c=g([e.subclass("esri.symbols.support.Symbol3DHalo")],b)}(e.declared(h.JSONSupport));
a.Symbol3DHalo=c;a.default=c})},"esri/symbols/WaterSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/lang ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Symbol3DLayer".split(" "),function(c,a,l,g,k,h,f,e,p){return function(a){function b(b){b=a.call(this,b)||this;b.color=new k("#0077BE");b.type="water";b.waterbodySize="medium";b.waveDirection=null;b.waveStrength="moderate";return b}l(b,
a);c=b;b.prototype.clone=function(){return new c({color:h.clone(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})};var c;g([f.property({type:k,json:{type:[e.Integer],write:!0,default:null}})],b.prototype,"color",void 0);g([f.enumeration.serializable()({Water:"water"})],b.prototype,"type",void 0);g([f.property({type:["small","medium","large"],json:{write:!0,default:"medium"}})],b.prototype,"waterbodySize",void 0);g([f.property({type:Number,
json:{write:!0,default:null}})],b.prototype,"waveDirection",void 0);g([f.property({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],b.prototype,"waveStrength",void 0);return b=c=g([f.subclass("esri.symbols.WaterSymbol3DLayer")],b)}(f.declared(p))})},"esri/symbols/support/StyleOrigin":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ../../portal/Portal".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.portal=null;return b}l(e,a);b=e;e.prototype.clone=function(){return new b({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};var b;g([h.property({type:String})],e.prototype,"name",void 0);g([h.property({type:String})],e.prototype,"styleUrl",void 0);g([h.property({type:String})],e.prototype,"styleName",void 0);g([h.property({type:f})],e.prototype,"portal",void 0);
return e=b=g([h.subclass("esri.symbols.support.StyleOrigin")],e)}(h.declared(k))})},"esri/symbols/support/Thumbnail":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}l(e,a);f=e;e.prototype.clone=function(){return new f({url:this.url})};
var f;g([h.property({type:String})],e.prototype,"url",void 0);return e=f=g([h.subclass("esri.symbols.support.Thumbnail")],e)}(h.declared(k));a.Thumbnail=c;a.default=c})},"esri/symbols/callouts/calloutUtils":function(){define(["require","exports","./Callout3D","./LineCallout3D"],function(c,a,l,g){function k(a){if(!a)return!1;a=a.verticalOffset;return!a||0>=a.screenLength||0>=a.maxWorldLength?!1:!0}function h(a,e,c){if(!a)return a;switch(a.type){case "line":return e=new g,e.read(a,c),e}}Object.defineProperty(a,
"__esModule",{value:!0});a.hasVisibleVerticalOffset=k;a.hasVisibleCallout=function(a){if(!a||!a.supportsCallout||!a.supportsCallout())return!1;var e=a.callout;return e&&e.visible?k(a)?!0:!1:!1};a.isCalloutSupport=function(a){return"point-3d"===a.type||"label-3d"===a.type};a.read=h;a.calloutProperty={types:{key:"type",base:l,typeMap:{line:g}},json:{read:h,write:!0}}})},"esri/symbols/callouts/Callout3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.visible=!0;return b}g(e,a);e.prototype.normalizeCtorArgs=function(a){a&&a.type&&(a=l({},a),delete a.type);return a};e.prototype.clone=function(){};k([f.property({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],e.prototype,"type",void 0);k([f.property({readOnly:!0})],e.prototype,"visible",void 0);return e=k([f.subclass("esri.symbols.callouts.Callout3D")],e)}(f.declared(h.JSONSupport))})},"esri/symbols/callouts/LineCallout3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/lang ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./Callout3D ./LineCallout3DBorder ../support/materialUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){return function(a){function b(b){b=a.call(this,b)||this;b.type="line";b.color=new k([0,0,0,1]);b.size=e.px2pt(1);b.border=null;return b}l(b,a);c=b;Object.defineProperty(b.prototype,"visible",{get:function(){return 0<this.size&&f.isSome(this.color)&&0<this.color.a},enumerable:!0,configurable:!0});b.prototype.clone=function(){return new c({color:h.clone(this.color),size:this.size,border:h.clone(this.border)})};var c;g([p.property({type:["line"]})],b.prototype,"type",
void 0);g([p.property(m.colorAndTransparencyProperty)],b.prototype,"color",void 0);g([p.property(m.screenSizeProperty)],b.prototype,"size",void 0);g([p.property({type:d.default,json:{write:!0}})],b.prototype,"border",void 0);g([p.property({dependsOn:["size","color"],readOnly:!0})],b.prototype,"visible",null);return b=c=g([p.subclass("esri.symbols.callouts.LineCallout3D")],b)}(p.declared(b))})},"esri/symbols/callouts/LineCallout3DBorder":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),
function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=new k("white");return b}l(b,a);c=b;b.prototype.clone=function(){return new c({color:f.clone(this.color)})};var c;g([e.property(p.colorAndTransparencyProperty)],b.prototype,"color",void 0);return b=c=g([e.subclass("esri.symbols.callouts.LineCallout3DBorder")],b)}(e.declared(h.JSONSupport));a.LineCallout3DBorder=c;a.default=c})},"esri/symbols/support/Symbol3DVerticalOffset":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.screenLength=0;b.minWorldLength=0;return b}l(e,a);b=e;e.prototype.clone=function(){return new b({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})};var b;g([h.property(f.screenSizeProperty)],e.prototype,"screenLength",void 0);g([h.property({type:Number,json:{write:!0,default:0}})],e.prototype,"minWorldLength",
void 0);g([h.property({type:Number,json:{write:!0}})],e.prototype,"maxWorldLength",void 0);return e=b=g([h.subclass("esri.symbols.support.Symbol3DVerticalOffset")],e)}(h.declared(k.JSONSupport));a.Symbol3DVerticalOffset=c;a.default=c})},"esri/symbols/LineSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/lang ../core/accessorSupport/decorators ./LineSymbol3DLayer ./PathSymbol3DLayer ./Symbol3D".split(" "),
function(c,a,l,g,k,h,f,e,p,b){var d=k.ofType({base:null,key:"type",typeMap:{line:e,path:p}}),m=k.ofType({base:null,key:"type",typeMap:{line:e,path:p}});return function(a){function b(b){b=a.call(this,b)||this;b.symbolLayers=new d;b.type="line-3d";return b}l(b,a);c=b;b.prototype.clone=function(){return new c({styleOrigin:h.clone(this.styleOrigin),symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail)})};b.fromSimpleLineSymbol=function(a){return new c({symbolLayers:[e.fromSimpleLineSymbol(a)]})};
var c;g([f.property({type:d,json:{type:m}})],b.prototype,"symbolLayers",void 0);g([f.enumeration.serializable()({LineSymbol3D:"line-3d"})],b.prototype,"type",void 0);return b=c=g([f.subclass("esri.symbols.LineSymbol3D")],b)}(f.declared(b))})},"esri/symbols/MarkerSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),function(c,a,l,g,k,h,f,e){var p=
new k.default({esriSMS:"simple-marker",esriPMS:"picture-marker"});return function(a){function b(b){b=a.call(this,b)||this;b.angle=0;b.type=null;b.xoffset=0;b.yoffset=0;b.size=9;return b}l(b,a);g([f.property({type:Number,json:{read:function(a){return a&&-1*a},write:function(a,b){return b.angle=a&&-1*a}}})],b.prototype,"angle",void 0);g([f.property({type:p.apiValues,readOnly:!0,json:{type:p.jsonValues}})],b.prototype,"type",void 0);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],b.prototype,
"xoffset",void 0);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],b.prototype,"yoffset",void 0);g([f.property({type:Number,cast:function(a){return"auto"===a?a:h.toPt(a)},json:{write:!0}})],b.prototype,"size",void 0);return b=g([f.subclass("esri.symbols.MarkerSymbol")],b)}(f.declared(e))})},"esri/symbols/MeshSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/lang ../core/accessorSupport/decorators ./FillSymbol3DLayer ./Symbol3D".split(" "),
function(c,a,l,g,k,h,f,e,p){var b=k.ofType({base:null,key:"type",typeMap:{fill:e}});return function(a){function d(d){d=a.call(this,d)||this;d.symbolLayers=new b;d.type="mesh-3d";return d}l(d,a);e=d;d.prototype.clone=function(){return new e({styleOrigin:h.clone(this.styleOrigin),symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail)})};var e;g([f.property({type:b})],d.prototype,"symbolLayers",void 0);g([f.enumeration.serializable()({MeshSymbol3D:"mesh-3d"})],d.prototype,"type",void 0);
return d=e=g([f.subclass("esri.symbols.MeshSymbol3D")],d)}(f.declared(p))})},"esri/symbols/PictureFillSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./FillSymbol ./support/urlUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b){return function(a){function d(b,d,e,f){b=a.call(this,b)||this;b.type="picture-fill";b.url=null;b.xscale=1;b.yscale=
1;b.width=12;b.height=12;b.xoffset=0;b.yoffset=0;b.source=null;return b}l(d,a);c=d;d.prototype.normalizeCtorArgs=function(a,b,d,e){if(a&&"string"!==typeof a&&null==a.imageData)return a;var c={};a&&(c.url=a);b&&(c.outline=b);null!=d&&(c.width=f.toPt(d));null!=e&&(c.height=f.toPt(e));return c};d.prototype.clone=function(){var a=new c({color:h.clone(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,
yscale:this.yscale});a._set("source",h.clone(this.source));return a};var c;g([e.enumeration.serializable()({esriPFS:"picture-fill"})],d.prototype,"type",void 0);g([e.property(b.urlPropertyDefinition)],d.prototype,"url",void 0);g([e.property({type:Number,json:{write:!0}})],d.prototype,"xscale",void 0);g([e.property({type:Number,json:{write:!0}})],d.prototype,"yscale",void 0);g([e.property({type:Number,cast:f.toPt,json:{write:!0}})],d.prototype,"width",void 0);g([e.property({type:Number,cast:f.toPt,
json:{write:!0}})],d.prototype,"height",void 0);g([e.property({type:Number,cast:f.toPt,json:{write:!0}})],d.prototype,"xoffset",void 0);g([e.property({type:Number,cast:f.toPt,json:{write:!0}})],d.prototype,"yoffset",void 0);g([e.property(b.sourcePropertyDefinition)],d.prototype,"source",void 0);return d=c=g([e.subclass("esri.symbols.PictureFillSymbol")],d)}(e.declared(p))})},"esri/symbols/support/urlUtils":function(){define(["require","exports","../../core/urlUtils"],function(c,a,l){function g(a,
e,c){return e.imageData?l.makeData({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):k(e.url,c)}function k(a,e){return!e||"service"!==e.origin&&"portal-item"!==e.origin||!e.layer||"feature"!==e.layer.type&&"stream"!==e.layer.type||l.isAbsolute(a)||!e.layer.parsedUrl?l.fromJSON(a,e):l.join(e.layer.parsedUrl.path,"images",a)}function h(a,e,c,b){l.isDataProtocol(a)?(a=l.dataComponents(a),e.contentType=a.mediaType,e.imageData=a.data,c&&c.imageData===e.imageData&&c.url&&l.write(c.url,
e,"url",b)):l.write(a,e,"url",b)}Object.defineProperty(a,"__esModule",{value:!0});a.readImageDataOrUrl=g;a.read=k;a.writeImageDataAndUrl=h;a.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:g},write:{writer:function(a,e,c,b){h(a,e,this.source,b)}}}};a.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(a,e,c){a={};e.imageData&&(a.imageData=e.imageData);e.contentType&&(a.contentType=e.contentType);e.url&&(a.url=k(e.url,c));return a}}}}})},
"esri/symbols/PictureMarkerSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./support/urlUtils".split(" "),function(c,a,l,g,k,h,f,e,p){return function(a){function b(b,d,e){b=a.call(this,b)||this;b.color=null;b.type="picture-marker";b.url=null;b.source=null;b.height=12;b.width=12;b.size=null;return b}l(b,a);e=b;b.prototype.normalizeCtorArgs=function(a,
b,d){if(a&&"string"!==typeof a&&null==a.imageData)return a;var e={};a&&(e.url=a);null!=b&&(e.width=h.toPt(b));null!=d&&(e.height=h.toPt(d));return e};b.prototype.readHeight=function(a,b){return b.size||a};b.prototype.readWidth=function(a,b){return b.size||a};b.prototype.clone=function(){var a=new e({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});a._set("source",k.clone(this.source));return a};var e;g([f.property({json:{write:!1}})],b.prototype,
"color",void 0);g([f.enumeration.serializable()({esriPMS:"picture-marker"})],b.prototype,"type",void 0);g([f.property(p.urlPropertyDefinition)],b.prototype,"url",void 0);g([f.property(p.sourcePropertyDefinition)],b.prototype,"source",void 0);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],b.prototype,"height",void 0);g([f.reader("height",["height","size"])],b.prototype,"readHeight",null);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],b.prototype,"width",void 0);g([f.property({json:{write:!1}})],
b.prototype,"size",void 0);return b=e=g([f.subclass("esri.symbols.PictureMarkerSymbol")],b)}(f.declared(e))})},"esri/symbols/PointSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/Error ../core/lang ../core/accessorSupport/decorators ./IconSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,
m,r,n){var u=k.ofType({base:null,key:"type",typeMap:{icon:p,object:b,text:m}}),y=k.ofType({base:null,key:"type",typeMap:{icon:p,object:b}});return function(a){function b(b){b=a.call(this,b)||this;b.verticalOffset=null;b.callout=null;b.symbolLayers=new u;b.type="point-3d";return b}l(b,a);d=b;b.prototype.writeSymbolLayers=function(a,b,d,e){var f=a.filter(function(a){return"text"!==a.type});e&&e.messages&&f.length<a.length&&(a=a.find(function(a){return"text"===a.type}),e.messages.push(new h("symbol-layer:unsupported",
"Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:a})));b[d]=f.map(function(a){return a.write({},e)}).toArray()};b.prototype.supportsCallout=function(){if(1>(this.symbolLayers?this.symbolLayers.length:0))return!1;for(var a=0,b=this.symbolLayers.items;a<b.length;a++)switch(b[a].type){case "icon":case "text":case "object":continue;default:return!1}return!0};b.prototype.hasVisibleCallout=function(){return r.hasVisibleCallout(this)};b.prototype.hasVisibleVerticalOffset=
function(){return r.hasVisibleVerticalOffset(this)};b.prototype.clone=function(){return new d({verticalOffset:f.clone(this.verticalOffset),callout:f.clone(this.callout),styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};b.fromSimpleMarkerSymbol=function(a){return new d({symbolLayers:[p.fromSimpleMarkerSymbol(a)]})};b.fromPictureMarkerSymbol=function(a){return new d({symbolLayers:[p.fromPictureMarkerSymbol(a)]})};b.fromCIMSymbol=function(a){return new d({symbolLayers:[p.fromCIMSymbol(a)],
callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})};b.fromTextSymbol=function(a){return new d({symbolLayers:[m.fromTextSymbol(a)]})};var d;g([e.property({type:n.default,json:{write:!0}})],b.prototype,"verticalOffset",void 0);g([e.property(r.calloutProperty)],b.prototype,"callout",void 0);g([e.property({type:u,json:{type:y,origins:{"web-scene":{type:y}}}})],b.prototype,"symbolLayers",void 0);g([e.writer("web-scene","symbolLayers")],b.prototype,"writeSymbolLayers",null);
g([e.enumeration.serializable()({PointSymbol3D:"point-3d"})],b.prototype,"type",void 0);return b=d=g([e.subclass("esri.symbols.PointSymbol3D")],b)}(e.declared(d))})},"esri/symbols/PolygonSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/Error ../core/lang ../core/maybe ../core/accessorSupport/decorators ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./WaterSymbol3DLayer".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){var t=k.ofType({base:null,key:"type",typeMap:{extrude:b,fill:d,icon:m,line:r,object:n,text:y,water:w}}),v=k.ofType({base:null,key:"type",typeMap:{extrude:b,fill:d,icon:m,line:r,object:n,water:w}});return function(a){function b(b){b=a.call(this,b)||this;b.type="polygon-3d";return b}l(b,a);c=b;b.prototype.writeSymbolLayers=function(a,b,d,e){var f=a.filter(function(a){return"text"!==a.type});e&&e.messages&&f.length<a.length&&(a=a.find(function(a){return"text"===
a.type}),e.messages.push(new h("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:a})));b[d]=f.map(function(a){return a.write({},e)}).toArray()};b.prototype.clone=function(){return new c({styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};b.fromJSON=function(a){var b=new c;b.read(a);if(2===b.symbolLayers.length&&"fill"===b.symbolLayers.getItemAt(0).type&&"line"===b.symbolLayers.getItemAt(1).type){var d=
b.symbolLayers.getItemAt(0),f=b.symbolLayers.getItemAt(1);!f.enabled||a.symbolLayers&&a.symbolLayers[1]&&!1===a.symbolLayers[1].enable||(d.outline={size:f.size,color:e.isSome(f.material)?f.material.color:null});b.symbolLayers.removeAt(1)}return b};b.fromSimpleFillSymbol=function(a){return new c({symbolLayers:[d.fromSimpleFillSymbol(a)]})};var c;g([p.property({type:t,json:{type:v}})],b.prototype,"symbolLayers",void 0);g([p.writer("web-scene","symbolLayers")],b.prototype,"writeSymbolLayers",null);g([p.enumeration.serializable()({PolygonSymbol3D:"polygon-3d"})],
b.prototype,"type",void 0);return b=c=g([p.subclass("esri.symbols.PolygonSymbol3D")],b)}(p.declared(u))})},"esri/symbols/SimpleFillSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../Color ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ./FillSymbol ./SimpleLineSymbol".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){var m=new f.default({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",
esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});return function(a){function b(b,e,f){b=a.call(this,b)||this;b.color=new h([0,0,0,.25]);b.outline=new d;b.type="simple-fill";b.style="solid";return b}l(b,a);f=b;b.prototype.normalizeCtorArgs=function(a,b,d){if(a&&"string"!==typeof a)return a;var e={};a&&(e.style=a);b&&(e.outline=b);d&&(e.color=d);return e};b.prototype.clone=function(){return new f({color:e.clone(this.color),
outline:this.outline&&this.outline.clone(),style:this.style})};var f;g([p.property()],b.prototype,"color",void 0);g([p.property()],b.prototype,"outline",void 0);g([p.enumeration.serializable()({esriSFS:"simple-fill"})],b.prototype,"type",void 0);g([p.property({type:m.apiValues,json:{read:m.read,write:m.write}})],b.prototype,"style",void 0);return b=f=g([p.subclass("esri.symbols.SimpleFillSymbol")],b)}(p.declared(b))})},"esri/symbols/SimpleMarkerSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./SimpleLineSymbol".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d){var m=new h.default({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});return function(a){function b(b,e,f,c){b=a.call(this,b)||this;b.color=new k([255,255,255,.25]);b.type="simple-marker";b.size=12;b.style="circle";b.outline=new d;return b}l(b,a);c=b;b.prototype.normalizeCtorArgs=function(a,b,d,f){if(a&&"string"!==typeof a)return a;var c={};a&&(c.style=a);null!=b&&
(c.size=e.toPt(b));d&&(c.outline=d);f&&(c.color=f);return c};b.prototype.writeColor=function(a,b){a&&"x"!==this.style&&"cross"!==this.style&&(b.color=a.toJSON());null===a&&(b.color=null)};Object.defineProperty(b.prototype,"path",{set:function(a){this.style="path";this._set("path",a)},enumerable:!0,configurable:!0});b.prototype.clone=function(){return new c({angle:this.angle,color:f.clone(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,
yoffset:this.yoffset})};var c;g([p.property()],b.prototype,"color",void 0);g([p.writer("color")],b.prototype,"writeColor",null);g([p.enumeration.serializable()({esriSMS:"simple-marker"})],b.prototype,"type",void 0);g([p.property()],b.prototype,"size",void 0);g([p.property({type:m.apiValues,json:{read:m.read,write:m.write}})],b.prototype,"style",void 0);g([p.property({type:String,json:{write:!0}})],b.prototype,"path",null);g([p.property({type:d,json:{default:null,write:!0}})],b.prototype,"outline",
void 0);return b=c=g([p.subclass("esri.symbols.SimpleMarkerSymbol")],b)}(p.declared(b))})},"esri/symbols/TextSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./Font ./Symbol".split(" "),function(c,a,l,g,k,h,f,e,p,b){return function(a){function b(b,d,e){b=a.call(this,b)||this;b.backgroundColor=null;b.borderLineColor=null;b.borderLineSize=null;b.font=new p;b.horizontalAlignment=
"center";b.kerning=!0;b.haloColor=null;b.haloSize=null;b.rightToLeft=null;b.rotated=!1;b.text="";b.type="text";b.verticalAlignment=null;b.xoffset=0;b.yoffset=0;b.angle=0;b.width=null;return b}l(b,a);d=b;b.prototype.normalizeCtorArgs=function(a,b,d){if(a&&"string"!==typeof a)return a;var e={};a&&(e.text=a);b&&(e.font=b);d&&(e.color=d);return e};b.prototype.clone=function(){return new d({angle:this.angle,backgroundColor:h.clone(this.backgroundColor),borderLineColor:h.clone(this.borderLineColor),borderLineSize:this.borderLineSize,
color:h.clone(this.color),font:this.font&&this.font.clone(),haloColor:h.clone(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})};var d;g([e.property({type:k,json:{write:!0}})],b.prototype,"backgroundColor",void 0);g([e.property({type:k,json:{write:!0}})],b.prototype,"borderLineColor",
void 0);g([e.property({type:Number,json:{write:!0}})],b.prototype,"borderLineSize",void 0);g([e.property({type:p,json:{write:!0}})],b.prototype,"font",void 0);g([e.property({type:["left","right","center","justify"],json:{write:!0}})],b.prototype,"horizontalAlignment",void 0);g([e.property({type:Boolean,json:{write:!0}})],b.prototype,"kerning",void 0);g([e.property({type:k,json:{write:!0}})],b.prototype,"haloColor",void 0);g([e.property({type:Number,cast:f.toPt,json:{write:!0}})],b.prototype,"haloSize",
void 0);g([e.property({type:Boolean,json:{write:!0}})],b.prototype,"rightToLeft",void 0);g([e.property({type:Boolean,json:{write:!0}})],b.prototype,"rotated",void 0);g([e.property({type:String,json:{write:!0}})],b.prototype,"text",void 0);g([e.property({type:String,readOnly:!0})],b.prototype,"type",void 0);g([e.property({type:["baseline","top","middle","bottom"],json:{write:!0}})],b.prototype,"verticalAlignment",void 0);g([e.property({type:Number,cast:f.toPt,json:{write:!0}})],b.prototype,"xoffset",
void 0);g([e.property({type:Number,cast:f.toPt,json:{write:!0}})],b.prototype,"yoffset",void 0);g([e.property({type:Number,json:{read:function(a){return a&&-1*a},write:function(a,b){return b.angle=a&&-1*a}}})],b.prototype,"angle",void 0);g([e.property({type:Number,json:{write:!0}})],b.prototype,"width",void 0);return b=d=g([e.subclass("esri.symbols.TextSymbol")],b)}(e.declared(b))})},"esri/symbols/WebStyleSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/jsonMap ../core/Logger ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ../portal/Portal ./Symbol ./support/Thumbnail".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){function u(){return h(this,void 0,void 0,function(){return k(this,function(a){return[2,p.create(function(a){return c(["./support/styleUtils"],a)})]})})}var y=e.getLogger("esri.symbols.WebStyleSymbol"),w=f.strict()({styleSymbolReference:"web-style"});return function(a){function e(b){b=a.call(this,b)||this;b.styleName=null;b.portal=null;b.styleUrl=null;b.thumbnail=null;b.name=null;b.type="web-style";return b}l(e,a);f=e;e.prototype.read=function(a,b){this.portal=
b?b.portal:void 0;this.inherited(arguments,[a,b])};e.prototype.clone=function(){return new f({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};e.prototype.fetchSymbol=function(a){return this._fetchSymbol("webRef",a)};e.prototype.fetchCIMSymbol=function(a){return this._fetchSymbol("cimRef",a)};e.prototype._fetchSymbol=function(a,b){return h(this,void 0,void 0,function(){var d,e;return k(this,function(f){switch(f.label){case 0:return[4,u()];case 1:return d=f.sent(),
p.throwIfAborted(b),e=d.resolveWebStyleSymbol(this,{portal:this.portal},a,b),e.catch(function(a){y.error("#fetchSymbol()","Failed to create symbol from style",a)}),[2,e]}})})};var f;g([d.property({json:{write:!1}})],e.prototype,"color",void 0);g([d.property({type:String,json:{write:!0}})],e.prototype,"styleName",void 0);g([d.property({type:m,json:{write:!1}})],e.prototype,"portal",void 0);g([d.property({type:String,json:{read:b.read,write:b.write}})],e.prototype,"styleUrl",void 0);g([d.property({type:n.default,
json:{read:!1}})],e.prototype,"thumbnail",void 0);g([d.property({type:String,json:{write:!0}})],e.prototype,"name",void 0);g([d.property({type:w.apiValues,readOnly:!0,json:{type:w.jsonValues,read:!1,write:w.write}})],e.prototype,"type",void 0);return e=f=g([d.subclass("esri.symbols.WebStyleSymbol")],e)}(d.declared(r))})},"esri/symbols/support/jsonUtils":function(){define("require exports ../../core/Error ../../core/Warning ../CIMSymbol ../LabelSymbol3D ../LineSymbol3D ../MeshSymbol3D ../PictureFillSymbol ../PictureMarkerSymbol ../PointSymbol3D ../PolygonSymbol3D ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../Symbol3D ../TextSymbol ../WebStyleSymbol ../callouts/LineCallout3D ./symbolConversion".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z){function A(a,b,d){b=a?D[a.type]||null:null;if(b)return b=new b,b.read(a,d),b;d&&d.messages&&a&&d.messages.push(new g("symbol:unsupported","Symbols of type '"+(a.type||"unknown")+"' are not supported",{definition:a,context:d}));return null}function C(a,b,d){if(!a)return null;if(!(!d||"web-scene"!==d.origin||a instanceof y||a instanceof t)){var e="cim"!==a.type?z.to3D(a):{symbol:null,error:new l("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",
{symbol:a})};if(e.symbol)return e.symbol.write(b,d);d.messages&&d.messages.push(new l("symbol:unsupported","Symbols of type '"+a.declaredClass+"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView",{symbol:a,context:d,error:e.error}));return null}return a.write(b,d)}Object.defineProperty(a,"__esModule",{value:!0});var D={esriSMS:u,esriPMS:b,esriTS:w,esriSLS:n,esriSFS:r,esriPFS:p,PointSymbol3D:d,LineSymbol3D:f,PolygonSymbol3D:m,MeshSymbol3D:e,LabelSymbol3D:h,
styleSymbolReference:t,CIMSymbolReference:k};a.read=A;a.writeTarget=function(a,b,d,e){(a=C(a,{},e))&&(b[d]=a)};a.write=C;a.fromJSON=function(a,b){return A(a,null,b)};a.readCallout3D=function(a,b){if(!a||!a.type)return null;var d=null;switch(a.type){case "line":d=new v}d&&d.read(a,b);return d}})},"esri/symbols/support/symbolConversion":function(){define(["require","exports","../../symbols","../../core/Error"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.to3D=function(a,c,f,
e){void 0===c&&(c=!1);void 0===f&&(f=!1);void 0===e&&(e=!0);if(!a)return{symbol:null};if(l.isSymbol3D(a)||a instanceof l.WebStyleSymbol)e=a.clone();else if("cim"===a.type)e=l.PointSymbol3D.fromCIMSymbol(a);else if(a instanceof l.SimpleLineSymbol)e=l.LineSymbol3D.fromSimpleLineSymbol(a);else if(a instanceof l.SimpleMarkerSymbol)e=l.PointSymbol3D.fromSimpleMarkerSymbol(a);else if(a instanceof l.PictureMarkerSymbol)e=l.PointSymbol3D.fromPictureMarkerSymbol(a);else if(a instanceof l.SimpleFillSymbol)e=
l.PolygonSymbol3D.fromSimpleFillSymbol(a);else if(a instanceof l.TextSymbol)e=e?l.LabelSymbol3D.fromTextSymbol(a):l.PointSymbol3D.fromTextSymbol(a);else return{error:new g("symbol-conversion:unsupported-2d-symbol","2D symbol of type '"+(a.type||a.declaredClass)+"' is unsupported in 3D",{symbol:a})};c&&(e.id=a.id);if(f&&l.isSymbol3D(e))for(a=0;a<e.symbolLayers.length;++a)e.symbolLayers.getItemAt(a)._ignoreDrivers=!0;return{symbol:e}}})},"esri/layers/graphics/dehydratedFeatures":function(){define("require exports ../../geometry ../../Graphic ../../core/compilerUtils ../../core/has ../../core/lang ../../core/maybe ../../core/typedArrayUtil ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ../../geometry/support/quantizationUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y){function w(a,b,d){if(!a)return null;switch(b){case "point":return a={x:a.x,y:a.y,z:a.z,m:a.m,hasZ:null!=a.z,hasM:null!=a.m,type:"point",spatialReference:d};case "polyline":return a={paths:a.paths,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polyline",spatialReference:d};case "polygon":return a={rings:a.rings,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polygon",spatialReference:d};case "multipoint":return a={points:a.points,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"multipoint",spatialReference:d}}}
function t(a,b,d,e){return{x:a,y:b,z:d,hasZ:null!=d,hasM:!1,spatialReference:e,type:"point"}}function v(a){return"declaredClass"in a}function z(a){return"declaredClass"in a}function A(a){return"declaredClass"in a}function C(a){return e.isNone(a)?null:v(a)?a:r.fromJSON(E(a))}function D(a){if(!a)return 0;var b=32,d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d];switch(typeof e){case "string":b+=L(e);break;default:case "number":b+=16}}return b}function B(a){if(e.isNone(a))return 0;var b=32;switch(a.type){case "point":b+=
42;break;case "polyline":case "polygon":var d=0,f=2+(a.hasZ?1:0)+(a.hasM?1:0);a="polyline"===a.type?a.paths:a.rings;for(var c=0;c<a.length;c++)d+=a[c].length;b=b+(8*d*f+64)+128*d+34;b+=32*(a.length+1);break;case "multipoint":d=a.points.length;b+=8*d*(2+(a.hasZ?1:0)+(a.hasM?1:0))+64;b+=128*d;b+=34;b+=32;break;case "extent":b+=98;a.hasM&&(b+=32);a.hasZ&&(b+=32);break;case "mesh":b+=p.estimateSize(a.vertexAttributes.position);b+=p.estimateSize(a.vertexAttributes.normal);b+=p.estimateSize(a.vertexAttributes.uv);
b+=p.estimateSize(a.vertexAttributes.tangent);break;default:k.neverReached(a)}return b}function E(a){var b=a.spatialReference.toJSON();switch(a.type){case "point":return{x:a.x,y:a.y,z:a.z,m:a.m,spatialReference:b};case "polygon":var d=a.hasZ,e=a.hasM;return{rings:F(a.rings),hasZ:d,hasM:e,spatialReference:b};case "polyline":var f=a.paths,d=a.hasZ,e=a.hasM;return{paths:F(f),hasZ:d,hasM:e,spatialReference:b};case "extent":var f=a.xmin,c=a.xmax,h=a.ymin,g=a.ymax,m=a.zmin,n=a.zmax,p=a.mmin,r=a.mmax,d=
a.hasZ,e=a.hasM;return{xmin:f,xmax:c,ymin:h,ymax:g,zmin:m,zmax:n,mmin:p,mmax:r,hasZ:d,hasM:e,spatialReference:b};case "multipoint":return f=a.points,d=a.hasZ,e=a.hasM,{points:K(f)?H(f):f,hasZ:d,hasM:e,spatialReference:b};default:k.neverReached(a)}}function F(a){return J(a)?a.map(function(a){return H(a)}):a}function H(a){return a.map(function(a){return p.toArray(a)})}function J(a){for(var b=0;b<a.length;b++){var d=a[b];if(0!==d.length)return K(d)}return!1}function K(a){return a.length&&(p.isFloat32Array(a[0])||
p.isFloat64Array(a[0]))}function G(a,b){d.empty(b);"mesh"===a.type&&(a=a.extent);switch(a.type){case "point":b[0]=b[3]=a.x;b[1]=b[4]=a.y;a.hasZ&&(b[2]=b[5]=a.z);break;case "polyline":for(var e=0;e<a.paths.length;e++)d.expandWithNestedArray(b,a.paths[e],a.hasZ);break;case "polygon":for(e=0;e<a.rings.length;e++)d.expandWithNestedArray(b,a.rings[e],a.hasZ);break;case "multipoint":d.expandWithNestedArray(b,a.points,a.hasZ);break;case "extent":b[0]=a.xmin;b[1]=a.ymin;b[3]=a.xmax;b[4]=a.ymax;null!=a.zmin&&
(b[2]=a.zmin);null!=a.zmax&&(b[5]=a.zmax);break;default:k.neverReached(a)}}function I(a,b){m.empty(b);"mesh"===a.type&&(a=a.extent);switch(a.type){case "point":b[0]=b[2]=a.x;b[1]=b[3]=a.y;break;case "polyline":for(var d=0;d<a.paths.length;d++)m.expandWithNestedArray(b,a.paths[d]);break;case "polygon":for(d=0;d<a.rings.length;d++)m.expandWithNestedArray(b,a.rings[d]);break;case "multipoint":m.expandWithNestedArray(b,a.points);break;case "extent":b[0]=a.xmin;b[1]=a.ymin;b[2]=a.xmax;b[3]=a.ymax;break;
default:k.neverReached(a)}}Object.defineProperty(a,"__esModule",{value:!0});a.equals=y.equals;c=function(){return function(a,b,d){this.uid=a;this.geometry=b;this.attributes=d;this.visible=!0;this.centroid=this.objectId=null}}();a.DehydratedFeatureClass=c;a.hasGeometry=function(a){return e.isSome(a.geometry)};a.isFeatureGeometry=function(a){return l.isFeatureGeometryType(a.type)};c=function(){return function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=
this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null}}();a.DehydratedFeatureSetClass=c;a.isPoint=function(a){return"point"===a.type};a.fromFeatureSetJSON=function(a){var d=l.featureGeometryTypeKebabDictionary.fromJSON(a.geometryType),e=b.fromJSON(a.spatialReference),f=a.transform,c=a.features.map(function(b){var c=a.objectIdFieldName;b={uid:g.generateUID(),objectId:c&&b.attributes?b.attributes[c]:null,attributes:b.attributes,
geometry:w(b.geometry,d,e),visible:!0};if((c=b.geometry)&&f)switch(c.type){case "point":b.geometry=n.hydratePoint(f,c,c,c.hasZ,c.hasM);break;case "multipoint":b.geometry=n.hydrateMultipoint(f,c,c,c.hasZ,c.hasM);break;case "polygon":b.geometry=n.hydratePolygon(f,c,c,c.hasZ,c.hasM);break;case "polyline":b.geometry=n.hydratePolyline(f,c,c,c.hasZ,c.hasM);break;default:k.neverReached(c)}return b});return{geometryType:d,features:c,spatialReference:e,fields:a.fields?a.fields.map(function(a){return u.fromJSON(a)}):
null,objectIdFieldName:a.objectIdFieldName,globalIdFieldName:a.globalIdFieldName,geohashFieldName:a.geohashFieldName,geometryProperties:a.geometryProperties,hasZ:a.hasZ,hasM:a.hasM,exceededTransferLimit:a.exceededTransferLimit,transform:null}};a.fromJSONGeometry=w;a.makeDehydratedPoint=t;a.isHydratedGeometry=v;a.isHydratedPoint=z;a.isHydratedGraphic=A;a.hydrateGraphic=function(a,b){if(!a||A(a))return a;b=new g({layer:b,sourceLayer:b});b.visible=a.visible;b.symbol=f.clone(a.symbol);b.attributes=f.clone(a.attributes);
b.geometry=C(a.geometry);return b};a.hydrateGeometry=C;a.clonePoint=function(a,b){if(!a)return null;if(z(a)){if(null==b)return a.clone();if(z(b))return b.copy(a)}null!=b?(b.x=a.x,b.y=a.y,b.spatialReference=a.spatialReference,a.hasZ?(b.z=a.z,b.hasZ=a.hasZ):(b.z=null,b.hasZ=!1),a.hasM?(b.m=a.m,b.hasM=!0):(b.m=null,b.hasM=!1)):(b=t(a.x,a.y,a.z,a.spatialReference),a.hasM&&(b.m=a.m,b.hasM=!0));return b};var L=h("esri-text-decoder")?function(a){return 32+a.length}:function(a){return 32*a.length};a.estimateAttributesObjectSize=
D;a.estimateGeometryObjectSize=B;a.estimateSize=function(a){var b;b=32+D(a.attributes);return b=b+3+(8+B(a.geometry))};a.numVertices=function(a){if(e.isNone(a))return 0;switch(a.type){case "point":return 1;case "polyline":var b=0,d=0;for(a=a.paths;d<a.length;d++)b+=a[d].length;return b;case "polygon":d=b=0;for(a=a.rings;d<a.length;d++)b+=a[d].length;return b;case "multipoint":return a.points.length;case "extent":return 2;case "mesh":return(b=a.vertexAttributes&&a.vertexAttributes.position)?b.length/
3:0;default:k.neverReached(a)}};a.hasVertices=function(a){if(!a)return!1;switch(a.type){case "extent":case "point":return!0;case "polyline":var b=0;for(a=a.paths;b<a.length;b++)if(0<a[b].length)return!0;return!1;case "polygon":b=0;for(a=a.rings;b<a.length;b++)if(0<a[b].length)return!0;return!1;case "multipoint":return 0<a.points.length;case "mesh":return a.vertexAttributes&&a.vertexAttributes.position&&0<a.vertexAttributes.position.length;default:k.neverReached(a)}};a.computeAABB=G;a.expandAABB=function(a,
b){G(a,R);d.expand(b,R)};a.computeAABR=I;a.expandAABR=function(a,b){I(a,M);m.expand(b,M)};a.getObjectId=function(a,b){return null!=a.objectId?a.objectId:a.attributes&&b?a.attributes[b]:null};var R=d.create(),M=m.create()})},"esri/geometry/support/aaBoundingBox":function(){define(["require","exports","../Extent","./aaBoundingRect"],function(c,a,l,g){function k(b){void 0===b&&(b=a.ZERO);return[b[0],b[1],b[2],b[3],b[4],b[5]]}function h(a,b,d,e,f,c,h){void 0===h&&(h=k());h[0]=a;h[1]=b;h[2]=d;h[3]=e;h[4]=
f;h[5]=c;return h}function f(a){return a[0]>=a[3]?0:a[3]-a[0]}function e(a){return a[1]>=a[4]?0:a[4]-a[1]}function p(a){return a[2]>=a[5]?0:a[5]-a[2]}function b(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}function d(a){return 6===a.length}Object.defineProperty(a,"__esModule",{value:!0});a.create=k;a.fromValues=h;a.fromExtent=function(a,b){void 0===b&&(b=k());b[0]=a.xmin;b[1]=a.ymin;b[2]=a.zmin;b[3]=a.xmax;b[4]=a.ymax;b[5]=a.zmax;return b};a.toExtent=function(a,b){return isFinite(a[2])||
isFinite(a[5])?new l({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:b}):new l({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:b})};a.fromMinMax=function(a,b,d){void 0===d&&(d=k());d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b[0];d[4]=b[1];d[5]=b[2];return d};a.expandPointInPlace=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[3]&&(a[3]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[4]&&(a[4]=b[1]);b[2]<a[2]&&(a[2]=b[2]);b[2]>a[5]&&(a[5]=b[2])};a.expand=function(a,b,e){void 0===e&&
(e=a);d(b)?(e[0]=Math.min(a[0],b[0]),e[1]=Math.min(a[1],b[1]),e[2]=Math.min(a[2],b[2]),e[3]=Math.max(a[3],b[3]),e[4]=Math.max(a[4],b[4]),e[5]=Math.max(a[5],b[5])):g.is(b)?(e[0]=Math.min(a[0],b[0]),e[1]=Math.min(a[1],b[1]),e[3]=Math.max(a[3],b[2]),e[4]=Math.max(a[4],b[3])):2===b.length?(e[0]=Math.min(a[0],b[0]),e[1]=Math.min(a[1],b[1]),e[3]=Math.max(a[3],b[0]),e[4]=Math.max(a[4],b[1])):3===b.length&&(e[0]=Math.min(a[0],b[0]),e[1]=Math.min(a[1],b[1]),e[2]=Math.min(a[2],b[2]),e[3]=Math.max(a[3],b[0]),
e[4]=Math.max(a[4],b[1]),e[5]=Math.max(a[5],b[2]));return e};a.expandWithBuffer=function(a,b,d,e,f){void 0===f&&(f=a);var c=a[0],h=a[1],g=a[2],m=a[3],n=a[4];a=a[5];for(var p=0;p<e;p++)c=Math.min(c,b[d+3*p]),h=Math.min(h,b[d+3*p+1]),g=Math.min(g,b[d+3*p+2]),m=Math.max(m,b[d+3*p]),n=Math.max(n,b[d+3*p+1]),a=Math.max(a,b[d+3*p+2]);f[0]=c;f[1]=h;f[2]=g;f[3]=m;f[4]=n;f[5]=a;return f};a.expandWithOffset=function(a,b,d,e,f){void 0===f&&(f=a);f[0]=Math.min(a[0],a[0]+b);f[3]=Math.max(a[3],a[3]+b);f[1]=Math.min(a[1],
a[1]+d);f[4]=Math.max(a[4],a[4]+d);f[2]=Math.min(a[2],a[2]+e);f[5]=Math.max(a[5],a[5]+e);return f};a.expandWithNestedArray=function(a,b,d,e){void 0===e&&(e=a);var f=b.length,c=a[0],h=a[1],g=a[2],m=a[3],p=a[4];a=a[5];if(d)for(d=0;d<f;d++){var n=b[d],c=Math.min(c,n[0]),h=Math.min(h,n[1]),g=Math.min(g,n[2]),m=Math.max(m,n[0]),p=Math.max(p,n[1]);a=Math.max(a,n[2])}else for(d=0;d<f;d++)n=b[d],c=Math.min(c,n[0]),h=Math.min(h,n[1]),m=Math.max(m,n[0]),p=Math.max(p,n[1]);e[0]=c;e[1]=h;e[2]=g;e[3]=m;e[4]=p;
e[5]=a;return e};a.allFinite=function(a){for(var b=0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};a.width=f;a.depth=e;a.height=p;a.diameter=function(a){var b=f(a),d=p(a);a=e(a);return Math.sqrt(b*b+d*d+a*a)};a.center=function(a,b){void 0===b&&(b=[0,0,0]);b[0]=a[0]+f(a)/2;b[1]=a[1]+e(a)/2;b[2]=a[2]+p(a)/2;return b};a.size=function(a,b){void 0===b&&(b=[0,0,0]);b[0]=f(a);b[1]=e(a);b[2]=p(a);return b};a.maximumDimension=function(a){return Math.max(f(a),p(a),e(a))};a.containsPoint=function(a,b){return b[0]>=
a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=a[4]&&b[2]<=a[5]};a.containsPointWithMargin=function(a,b,d){return b[0]>=a[0]-d&&b[1]>=a[1]-d&&b[2]>=a[2]-d&&b[0]<=a[3]+d&&b[1]<=a[4]+d&&b[2]<=a[5]+d};a.contains=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[3]<=a[3]&&b[4]<=a[4]&&b[5]<=a[5]};a.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[3],a[3])&&Math.max(b[1],a[1])<=Math.min(b[4],a[4])&&Math.max(b[2],a[2])<=Math.min(b[5],a[5])};a.offset=function(a,b,d,e,f){void 0===
f&&(f=a);f[0]=a[0]+b;f[1]=a[1]+d;f[2]=a[2]+e;f[3]=a[3]+b;f[4]=a[4]+d;f[5]=a[5]+e;return f};a.setMin=function(a,b,d){void 0===d&&(d=a);d[0]=b[0];d[1]=b[1];d[2]=b[2];d!==a&&(d[3]=a[3],d[4]=a[4],d[5]=a[5]);return d};a.setMax=function(a,b,d){void 0===d&&(d=a);d[3]=b[0];d[4]=b[1];d[5]=b[2];d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2]);return a};a.set=b;a.empty=function(d){return d?b(d,a.NEGATIVE_INFINITY):k(a.NEGATIVE_INFINITY)};a.toRect=function(a,b){b||(b=g.create());b[0]=a[0];b[1]=a[1];b[2]=a[3];b[3]=a[4];
return b};a.fromRect=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=b[2];a[4]=b[3];a[5]=Number.POSITIVE_INFINITY;return a};a.is=d;a.isPoint=function(a){return 0===f(a)&&0===e(a)&&0===p(a)};a.equals=function(a,b,e){if(null==a||null==b)return a===b;if(!d(a)||!d(b))return!1;if(e)for(var f=0;f<a.length;f++){if(!e(a[f],b[f]))return!1}else for(f=0;f<a.length;f++)if(a[f]!==b[f])return!1;return!0};a.wrap=function(a,b,d,e,f,c){return h(a,b,d,e,f,c,m)};a.POSITIVE_INFINITY=[-Infinity,-Infinity,
-Infinity,Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0,0,0];var m=k()})},"esri/geometry/support/quantizationUtils":function(){define(["require","exports","./jsonUtils"],function(c,a,l){function g(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function k(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function h(a,b,d){for(var e=[],f,c,h,m,p=0;p<d.length;p++){var n=d[p];if(0<p){if(h=g(a,n[0]),m=k(a,n[1]),h!==
f||m!==c)e.push(b(n,h-f,m-c)),f=h,c=m}else f=g(a,n[0]),c=k(a,n[1]),e.push(b(n,f,c))}return 0<e.length?e:null}function f(a,b,d,e){return h(a,d?e?F:E:e?E:B,b)}function e(a,b,d,e){var f=[];d=d?e?F:E:e?E:B;for(e=0;e<b.length;e++){var c=h(a,d,b[e]);c&&3<=c.length&&f.push(c)}return f.length?f:null}function p(a,b,d,e){var f=[];d=d?e?F:E:e?E:B;for(e=0;e<b.length;e++){var c=h(a,d,b[e]);c&&2<=c.length&&f.push(c)}return f.length?f:null}function b(a,b){return b*a.scale[0]+a.translate[0]}function d(a,b){return a.translate[1]-
b*a.scale[1]}function m(a,e,f){var c=Array(f.length);if(!f.length)return c;var h=a.scale,g=h[0],h=h[1],m=b(a,f[0][0]);a=d(a,f[0][1]);c[0]=e(f[0],m,a);for(var p=1;p<f.length;p++){var k=f[p],m=m+k[0]*g;a-=k[1]*h;c[p]=e(k,m,a)}return c}function r(a,b,d){for(var e=Array(d.length),f=0;f<d.length;f++)e[f]=m(a,b,d[f]);return e}function n(a,b,d,e){return m(a,d?e?F:E:e?E:B,b)}function u(a,b,d,e){return r(a,d?e?F:E:e?E:B,b)}function y(a,b,d,e){return r(a,d?e?F:E:e?E:B,b)}function w(a,b,d){var e=d[0],f=e[0],
e=e[1],c=Math.min(f,b[0]),h=Math.min(e,b[1]),g=Math.max(f,b[2]);b=Math.max(e,b[3]);for(var m=1;m<d.length;m++){var p=d[m],k=p[0],p=p[1],f=f+k,e=e+p;0>k&&(c=Math.min(c,f));0<k&&(g=Math.max(g,f));0>p?h=Math.min(h,e):0<p&&(b=Math.max(b,e))}a[0]=c;a[1]=h;a[2]=g;a[3]=b;return a}function t(a,b){if(!b.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(var d=0;d<b.length;d++)w(a,a,b[d]);return a}function v(a,b,d,e,f){b.xmin=g(a,d.xmin);b.ymin=k(a,d.ymin);b.xmax=g(a,
d.xmax);b.ymax=k(a,d.ymax);b!==d&&(e&&(b.zmin=d.zmin,b.zmax=d.zmax),f&&(b.mmin=d.mmin,b.mmax=d.mmax));return b}function z(a,b,d,e,c){b.points=f(a,d.points,e,c);return b}function A(a,b,d,e,f){b.x=g(a,d.x);b.y=k(a,d.y);b!==d&&(e&&(b.z=d.z),f&&(b.m=d.m));return b}function C(a,b,d,f,c){a=e(a,d.rings,f,c);if(!a)return null;b.rings=a;return b}function D(a,b,d,e,f){a=p(a,d.paths,e,f);if(!a)return null;b.paths=a;return b}Object.defineProperty(a,"__esModule",{value:!0});var B=function(a,b,d){return[b,d]},
E=function(a,b,d){return[b,d,a[2]]},F=function(a,b,d){return[b,d,a[2],a[3]]};a.toQuantizationTransform=function(a){return a?{originPosition:"upper-left"===a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,b){if(a===b||null==a&&null==b)return!0;if(null==a||null==b)return!1;var d,e,f,c;a&&"upperLeft"===a.originPosition?(d=a.translate[0],e=a.translate[1],a=a.scale[0]):
(d=a.extent.xmin,e=a.extent.ymax,a=a.tolerance);b&&"upperLeft"===b.originPosition?(f=b.translate[0],c=b.translate[1],b=b.scale[0]):(f=b.extent.xmin,c=b.extent.ymax,b=b.tolerance);return d===f&&e===c&&a===b};a.quantizeX=g;a.quantizeY=k;a.quantizeBounds=function(a,b,d){b[0]=g(a,d[0]);b[3]=k(a,d[1]);b[2]=g(a,d[2]);b[1]=k(a,d[3]);return b};a.quantizePoints=f;a.quantizeRings=e;a.quantizePaths=p;a.hydrateX=b;a.hydrateY=d;a.hydrateCoordsArray=m;a.hydrateCoordsArrayArray=r;a.hydrateBounds=function(a,e,f){return f?
(e[0]=b(a,f[0]),e[1]=d(a,f[3]),e[2]=b(a,f[2]),e[3]=d(a,f[1]),e):[b(a,e[0]),d(a,e[3]),b(a,e[2]),d(a,e[1])]};a.hydratePoints=n;a.hydratePaths=u;a.hydrateRings=y;a.getQuantizedBoundsCoordsArray=w;a.getQuantizedBoundsCoordsArrayArray=t;a.getQuantizedBoundsPoints=function(a){var b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return w(b,b,a)};a.getQuantizedBoundsPaths=function(a){return t([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return t([0,
0,0,0],a)};a.quantizeExtent=v;a.quantizeMultipoint=z;a.quantizePoint=A;a.quantizePolygon=C;a.quantizePolyline=D;a.quantizeGeometry=function(a,b){return a&&b?l.isPoint(b)?A(a,{},b,!1,!1):l.isPolyline(b)?D(a,{},b,!1,!1):l.isPolygon(b)?C(a,{},b,!1,!1):l.isMultipoint(b)?z(a,{},b,!1,!1):l.isExtent(b)?v(a,{},b,!1,!1):null:null};a.hydrateExtent=function(a,e,f,c,h){e.xmin=b(a,f.xmin);e.ymin=d(a,f.ymin);e.xmax=b(a,f.xmax);e.ymax=d(a,f.ymax);e!==f&&(c&&(e.zmin=f.zmin,e.zmax=f.zmax),h&&(e.mmin=f.mmin,e.mmax=
f.mmax));return e};a.hydrateMultipoint=function(a,b,d,e,f){b.points=n(a,d.points,e,f);return b};a.hydratePoint=function(a,e,f,c,h){e.x=b(a,f.x);e.y=d(a,f.y);e!==f&&(c&&(e.z=f.z),h&&(e.m=f.m));return e};a.hydratePolygon=function(a,b,d,e,f){b.rings=y(a,d.rings,e,f);return b};a.hydratePolyline=function(a,b,d,e,f){b.paths=u(a,d.paths,e,f);return b}})},"esri/layers/support/Field":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./domains ./fieldType".split(" "),
function(c,a,l,g,k,h,f,e,p,b){var d=new k.default({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});return function(a){function c(b){b=a.call(this,b)||this;b.alias=
null;b.defaultValue=void 0;b.description=null;b.domain=null;b.editable=!0;b.length=-1;b.name=null;b.nullable=!0;b.type=null;b.valueType=null;return b}l(c,a);h=c;c.prototype.readDescription=function(a,b){a=b.description;var d;try{d=JSON.parse(a)}catch(t){}return d?d.value:null};c.prototype.readValueType=function(a,b){a=b.description;var e;try{e=JSON.parse(a)}catch(t){}return e?d.fromJSON(e.fieldValueType):null};c.prototype.clone=function(){return new h({alias:this.alias,defaultValue:this.defaultValue,
description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})};var h;g([f.property({type:String,json:{write:!0}})],c.prototype,"alias",void 0);g([f.property({type:[String,Number],json:{write:{allowNull:!0}}})],c.prototype,"defaultValue",void 0);g([f.property()],c.prototype,"description",void 0);g([f.reader("description")],c.prototype,"readDescription",null);g([f.property({types:p.types,
json:{read:{reader:p.fromJSON},write:!0}})],c.prototype,"domain",void 0);g([f.property({type:Boolean,json:{write:!0}})],c.prototype,"editable",void 0);g([f.property({type:e.Integer,json:{write:!0}})],c.prototype,"length",void 0);g([f.property({type:String,json:{write:!0}})],c.prototype,"name",void 0);g([f.property({type:Boolean,json:{write:!0}})],c.prototype,"nullable",void 0);g([f.enumeration.serializable()(b.kebabDict)],c.prototype,"type",void 0);g([f.property()],c.prototype,"valueType",void 0);
g([f.reader("valueType",["description"])],c.prototype,"readValueType",null);return c=h=g([f.subclass("esri.layers.support.Field")],c)}(f.declared(h.JSONSupport))})},"esri/layers/support/fieldType":function(){define(["require","exports","../../core/jsonMap"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.kebabDict=new l.default({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",
esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["require","exports","../../core/compilerUtils","../../core/maybe"],function(c,a,l,g){function k(a,d){if(a===d)return!0;if(null==a||null==d||a.length!==d.length)return!1;for(var b=0;b<
a.length;b++){var e=a[b],f=d[b];if(e.length!==f.length)return!1;for(var c=0;c<e.length;c++)if(e[c]!==f[c])return!1}return!0}function h(a,d){if(a===d)return!0;if(null==a||null==d||a.length!==d.length)return!1;for(var b=0;b<a.length;b++)if(!k(a[b],d[b]))return!1;return!0}function f(a,d){return a===d||a&&d&&a.equals(d)}function e(a,d){if(a===d)return!0;if(g.isNone(a)||g.isNone(d)||a.type!==d.type)return!1;switch(a.type){case "point":return a=f(a.spatialReference,d.spatialReference)?a.x===d.x&&a.y===
d.y&&a.z===d.z&&a.m===d.m:!1,a;case "extent":return a=a.hasZ!==d.hasZ||a.hasM!==d.hasM?!1:f(a.spatialReference,d.spatialReference)?a.xmin===d.xmin&&a.ymin===d.ymin&&a.zmin===d.zmin&&a.xmax===d.xmax&&a.ymax===d.ymax&&a.zmax===d.zmax:!1,a;case "polyline":return a=a.hasZ!==d.hasZ||a.hasM!==d.hasM?!1:f(a.spatialReference,d.spatialReference)?h(a.paths,d.paths):!1,a;case "polygon":return a=a.hasZ!==d.hasZ||a.hasM!==d.hasM?!1:f(a.spatialReference,d.spatialReference)?h(a.rings,d.rings):!1,a;case "multipoint":return a=
a.hasZ!==d.hasZ||a.hasM!==d.hasM?!1:f(a.spatialReference,d.spatialReference)?k(a.points,d.points):!1,a;case "mesh":return!1;default:l.neverReached(a)}}function p(a,d){if(a===d)return!0;if(!a||!d)return!1;var b=Object.keys(a),e=Object.keys(d);if(b.length!==e.length)return!1;for(e=0;e<b.length;e++){var f=b[e];if(a[f]!==d[f])return!1}return!0}Object.defineProperty(a,"__esModule",{value:!0});a.equals=function(a,d){return a===d?!0:null!=a&&null!=d&&a.objectId===d.objectId&&e(a.geometry,d.geometry)&&p(a.attributes,
d.attributes)?!0:!1}})},"esri/tasks/operations/pbfOptimizedFeatureSet":function(){define(["require","exports","../../layers/graphics/OptimizedFeature","../../layers/graphics/OptimizedFeatureSet","../../layers/graphics/OptimizedGeometry"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}a.prototype.createFeatureResult=function(){return new g.default};
a.prototype.prepareFeatures=function(){};a.prototype.finishFeatureResult=function(){};a.prototype.addFeature=function(a,e){a.features.push(e)};a.prototype.createFeature=function(){return new l.default};a.prototype.createSpatialReference=function(){return{wkid:0}};a.prototype.createGeometry=function(){return new k.default};a.prototype.addField=function(a,e){a.fields.push(e)};a.prototype.addCoordinate=function(a,e){a.coords.push(e)};a.prototype.addCoordinatePoint=function(a,e){a.coords.push(e)};a.prototype.addLength=
function(a,e){a.lengths.push(e)};a.prototype.createPointGeometry=function(){return new k.default};return a}();a.Context=c})},"esri/tasks/operations/PBFWorker":function(){define("require exports ../../core/tsSupport/extendsHelper ../../Graphic ../../core/promiseUtils ../../core/requireUtils ../../core/workers ../../geometry/SpatialReference ../../layers/support/Field ./pbfQueryUtils module".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){Object.defineProperty(a,"__esModule",{value:!0});var m=function(){function a(){}
a.prototype._parseFeatureQuery=function(a){var d=b.parsePBFFeatureQuery(a.buffer,a.options);if(a.options&&"dehydrated"===a.options.type&&(d.spatialReference=d.spatialReference.toJSON(),d.fields))for(a=0;a<d.fields.length;a++)d.fields[a]=d.fields[a].toJSON();return k.resolve(d)};return a}(),r=function(a){function m(){var b=a.call(this)||this;b._thread=void 0;f.open(h.getAbsMid("./PBFWorker",c,d),{strategy:"dedicated"}).then(function(a){void 0===b._thread?b._thread=a:a.close()});return b}l(m,a);m.prototype.destroy=
function(){this._thread&&this._thread.close();this._thread=null};m.prototype.parseFeatureQuery=function(a,d){return a&&0!==a.byteLength?this._thread?this._thread.invoke("_parseFeatureQuery",{buffer:a,options:d},{transferList:[a]}).then(function(a){if(d&&"dehydrated"===d.type){a.spatialReference=e.fromJSON(a.spatialReference);if(a.fields)for(var b=0;b<a.fields.length;b++)a.fields[b]=p.fromJSON(a.fields[b]);for(var b=a.spatialReference,f=0,c=a.features;f<c.length;f++){var h=c[f];h.uid=g.generateUID();
h.geometry&&(h.geometry.spatialReference=b)}}return a}):k.resolve(b.parsePBFFeatureQuery(a,d)):k.resolve(null)};return m}(m);a.PBFWorker=r;a.default=function(){return new m}})},"esri/core/requireUtils":function(){define(["require","exports","./deprecate","./Logger","./promiseUtils"],function(c,a,l,g,k){function h(a,c){l.deprecatedFunction(f,"when",{moduleName:"requireUtils",replacement:"Use `promiseUtils.create()` instead.",version:"4.10",warnOnce:!0});return Array.isArray(c)?k.create(function(b){a(c,
function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];b(a)})}):h(a,[c]).then(function(a){return a[0]})}Object.defineProperty(a,"__esModule",{value:!0});var f=g.getLogger("esri.core.requireUtils");a.when=h;a.getAbsMid=function(a,f,b){return f.toAbsMid?f.toAbsMid(a):b.id.replace(/\/[^\/]*$/gi,"/")+a}})},"esri/tasks/operations/urlUtils":function(){define(["require","exports"],function(c,a){function l(a){var c={},h;for(h in a)if("declaredClass"!==h){var f=a[h];if(null!=f&&"function"!==
typeof f)if(Array.isArray(f)){c[h]=[];for(var e=0;e<f.length;e++)c[h][e]=l(f[e])}else"object"===typeof f?f.toJSON&&(c[h]=JSON.stringify(f)):c[h]=f}return c}Object.defineProperty(a,"__esModule",{value:!0});a.mapParameters=l})},"esri/views/2d/engine":function(){define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/util/debug ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TextShaping ./engine/webgl/TextShapingNew ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B,E,F,H,J,K,G,I,L,R,M,Q,N,U,V,S,X,W,Y,T,ja,aa,ba,da,pa,ea,ta,qa,ma,oa,Ba,ua,Da,xa,Ca,za,ra,fa){Object.defineProperty(a,"__esModule",{value:!0});a.Bitmap=l.Bitmap;a.BitmapContainer=g.BitmapContainer;a.BitmapTile=k.BitmapTile;a.Container=h.Container;a.TileContainer=f.default;a.DisplayObject=e.DisplayObject;a.Stage=p.Stage;a.AttributeStoreView=b.AttributeStoreView;a.CollisionGrid=d.CollisionGrid;a.CollisionEngine=m.CollisionEngine;a.LayerViewSorter=
r.LayerViewSorter;a.Point=n.Point;a.alignmentUtils=u;a.color=y;a.definitions=w;a.enums=t;a.fontUtils=v;a.Utils=z;a.debug=N;a.TileClipper=U.TileClipper;a.SimpleBuilder=U.SimpleBuilder;a.tessellate=V.tessellate;a.TessellationState=V.TessellationState;a.splitVertex=V.splitVertex;a.createMatcher=S.createMatcher;a.WGLMeshFactory=X.WGLMeshFactory;a.MeshData=W.MeshData;a.WGLTemplateStore=Y.WGLTemplateStore;a.Painter=T.default;a.PainterOptions=T.PainterOptions;a.TextShaping=ja.TextShaping;a.TextShapingNew=
aa.TextShaping;a.TileData=ba.TileData;a.bidiText=da.bidiText;a.FeatureMatcher=pa.FeatureMatcher;a.getVVFlags=ea.getVVFlags;a.getTypeOfSizeVisualVariable=ta.getTypeOfSizeVisualVariable;a.WGLRendererInfo=qa.WGLRendererInfo;a.WGLTile=ma.WGLTile;a.BitBlitRenderer=oa.BitBlitRenderer;a.createMagnifierProgram=Ba.createMagnifierProgram;a.magnifier=Ba.magnifier;a.CIMSymbolHelper=ua.CIMSymbolHelper;a.Rect=Da.default;a.getLimitCosine=xa.getLimitCosine;c=a.brushes||(a.brushes={});c.Geometry=G.default;c.Marker=
M.default;c.Line=R.default;c.Fill=I.default;c.Text=Q.default;c.Label=L.default;c.Clip=C.default;c.Stencil=B.default;c.Bitmap=A.default;c.TileInfo=D.default;c.VTLBackground=E.WGLBrushVTLBackground;c.VTLFill=H.WGLBrushVTLFill;c.VTLLine=J.WGLBrushVTLLine;c.VTLCircle=F.WGLBrushVTLCircle;c.VTLSymbol=K.WGLBrushVTLSymbol;a.RenderPass=Ca.default;a.TiledDisplayObject=za.TiledDisplayObject;a.BitmapTileContainer=ra.BitmapTileContainer;a.LevelDependentSizeVariable=fa.LevelDependentSizeVariable})},"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),
function(c,a,l,g,k,h,f,e,p){function b(a){var b=document.createElement("canvas");b.width=a.width;b.height=a.height;a.render(b.getContext("2d"));return b}function d(a,b,d){var e={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};b&&d&&(e.width=b,e.height=d);return new f.Texture(a,e)}function m(a){n.has(a)&&(r.splice(r.indexOf(a),1),n.delete(a))}Object.defineProperty(a,"__esModule",{value:!0});var r=[],n=new Set;c=function(a){function e(b,d){void 0===b&&(b=null);void 0===
d&&(d=function(){return null});var e=a.call(this)||this;e.stencilRef=0;e.coordScale=[1,1];e._height=void 0;e.pixelRatio=1;e.resolution=0;e.rotation=0;e._source=null;e._width=void 0;e.x=0;e.y=0;e.transforms={dvs:k.mat3f32.create()};e.source=b;e.requestRender=d;return e}l(e,a);Object.defineProperty(e.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"height",{get:function(){return void 0!==
this._height?this._height:this.sourceHeight},set:function(a){this._height=a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(a){this._source=a;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(a){this._width=a},enumerable:!0,configurable:!0});e.prototype.attach=function(){this.updateTexture();return!0};e.prototype.detach=function(){this._texture.dispose();this._texture=null;m(this)};e.prototype.invalidateTexture=
function(){this.attached?this.updateTexture():m(this)};e.prototype.setTransform=function(a){var b=g.mat3.identity(this.transforms.dvs),d=a.toScreenNoRotation([0,0],this.x,this.y),e=this.resolution/this.pixelRatio/a.resolution,f=e*this.width,e=e*this.height,c=Math.PI*this.rotation/180;g.mat3.translate(b,b,h.vec2f32.fromValues(d[0],d[1]));g.mat3.translate(b,b,h.vec2f32.fromValues(f/2,e/2));g.mat3.rotate(b,b,-c);g.mat3.translate(b,b,h.vec2f32.fromValues(-f/2,-e/2));g.mat3.scaleByVec2(b,b,h.vec2f32.fromValues(f,
e));g.mat3.multiply(this.transforms.dvs,a.displayViewMat3,b)};e.prototype.updateTexture=function(){this._texture||(this._texture=this.source?d(this.stage.context,this.sourceWidth,this.sourceHeight):d(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof p.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(b(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):
this._texture.setData(null)};e.prototype.setSamplingProfile=function(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(a.samplingMode))};e.prototype.bind=function(a){this._texture&&this.stage.context.bindTexture(this._texture,a)};return e}(e.DisplayObject);a.Bitmap=c})},"esri/views/webgl":function(){define("require exports ./webgl/BufferObject ./webgl/enums ./webgl/FramebufferObject ./webgl/Program ./webgl/Renderbuffer ./webgl/RenderingContext ./webgl/ShaderCompiler ./webgl/Texture ./webgl/VertexArrayObject ./webgl/ProgramCache ./webgl/programUtils ./webgl/context-util".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){Object.defineProperty(a,"__esModule",{value:!0});a.BufferObject=l;a.enums=g;a.FramebufferObject=k;a.Program=h;a.Renderbuffer=f;a.RenderingContext=e;a.ShaderCompiler=p;a.Texture=b;a.VertexArrayObject=d;a.ProgramCache=m.ProgramCache;a.createProgram=r.createProgram;a.glslifyDefineMap=r.glslifyDefineMap;a.createContextOrErrorHTML=n.createContextOrErrorHTML})},"esri/views/webgl/BufferObject":function(){define(["require","exports","../../core/has","../../core/typedArrayUtil"],
function(c,a,l,g){return function(){function a(c,f,e,g,b){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=c;this._bufferType=f;this._usage=e;this._id=a._nextId++;this._glName=this._context.gl.createBuffer();g&&this.setData(g,b)}a.createIndex=function(c,f,e,g){return new a(c,34963,f,e,g)};a.createVertex=function(c,f,e){return new a(c,34962,f,e)};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context=null)};a.prototype.setData=function(a,f){if(a){if("number"===typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),
34963===this._bufferType&&f)switch(this._indexType=f,this._size=a,f){case 5123:a*=2;break;case 5125:a*=4}}else f=a.byteLength,g.isUint16Array(a)&&(f/=2,this._indexType=5123),g.isUint32Array(a)&&(f/=4,this._indexType=5125),this._size=f;f=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(f)}};a.prototype.setSubData=function(a,f,e,c){void 0===f&&(f=0);void 0===e&&(e=0);if(a){(0>f||f>=
this._size)&&console.error("offset is out of range!");var b=f,d=e,h=c,p=a.byteLength;g.isUint16Array(a)&&(p/=2,b*=2,d*=2,h*=2);g.isUint32Array(a)&&(p/=4,b*=4,d*=4,h*=4);void 0===c&&(c=p-1);e>=c&&console.error("end must be bigger than start!");f+e-c>this._size&&console.error("An attempt to write beyond the end of the buffer!");f=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);e=this._context.gl;a=ArrayBuffer.isView(a)?a.buffer:a;e.bufferSubData(this._bufferType,
b,a.slice(d,h));this._context.bindVAO(f)}};a._nextId=0;return a}()})},"esri/views/webgl/enums":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.BASE_TEXTURE_UNIT=33984})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","../../core/has","./Renderbuffer","./Texture"],function(c,a,l,g,k){return function(){function a(f,e,c,b){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=
null;this._initialized=!1;this._context=f;this._desc={colorTarget:e.colorTarget,depthStencilTarget:e.depthStencilTarget,width:e.width,height:e.height,multisampled:e.multisampled};this._id=a._nextId++;c&&(f=void 0,c instanceof k?(this._colorAttachment=c,f=c.descriptor):(f=c,this._colorAttachment=new k(this._context,f)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),a._validateTextureDimensions(f,
this._desc));b instanceof g?(2===e.depthStencilTarget?this._stencilAttachment=b:1===e.depthStencilTarget||3===e.depthStencilTarget?this._depthAttachment=b:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),a._validateBufferDimensions(b.descriptor,this._desc)):b&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
e=void 0,b instanceof k?(this._depthStencilTexture=b,e=this._depthStencilTexture.descriptor):(e=b,this._depthStencilTexture=new k(this._context,e)),a._validateTextureDimensions(e,this._desc))}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof k?this._colorAttachment:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"colorAttachment",{get:function(){return this._colorAttachment},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthStencilAttachment",{get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});a.prototype.dispose=function(){if(this._context){var a=this._context,e=a.getBoundFramebufferObject();this._disposeColorAttachment();
this._disposeDepthStencilAttachments();this._glName&&(a.gl.deleteFramebuffer(this._glName),this._glName=null);a.bindFramebuffer(e);this._context=null}};a.prototype.attachColorTexture=function(f){if(f){a._validateTextureDimensions(f.descriptor,this._desc);this._disposeColorAttachment();if(this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,f.glName,0)}this._colorAttachment=f}};a.prototype.detachColorTexture=
function(){var a=void 0;if(this._colorAttachment instanceof k){a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;this._context.gl.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}this._colorAttachment=null}return a};a.prototype.attachDepthStencilTexture=function(f){if(f){var e=f.descriptor;34041!==e.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==e.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");
this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");a._validateTextureDimensions(e,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),e=this._context.gl,e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,f.glName,0));this._depthStencilTexture=
f}};a.prototype.detachDepthStencilTexture=function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;this._context.gl.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return a};a.prototype.attachDepthStencilBuffer=function(f){if(f){var e=f.descriptor;34041!==e.internalFormat&&33189!==e.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");
a._validateBufferDimensions(e,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===e.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),e=this._context.gl,e.framebufferRenderbuffer(e.FRAMEBUFFER,1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,f.glName));this._depthAttachment=f}};a.prototype.detachDepthStencilBuffer=function(){var a=this._context.gl,e=this._depthAttachment;e&&this._initialized&&
(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null));this._depthAttachment=null;return e};a.prototype.copyToTexture=function(a,e,c,b,d,h,g){(0>a||0>e||0>d||0>h)&&console.error("Offsets cannot be negative!");(0>=c||0>=b)&&console.error("Copy width and height must be greater than zero!");var f=this._desc,m=g.descriptor;3553!==g.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");
(a+c>f.width||e+b>f.height||d+c>m.width||h+b>m.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");f=this._context;f.bindTexture(g);f.bindFramebuffer(this);f.gl.copyTexSubImage2D(3553,0,d,h,a,e,c,b)};a.prototype.readPixels=function(a,e,c,b,d,h,g){(0>=c||0>=b)&&console.error("Copy width and height must be greater than zero!");g||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(a,
e,c,b,d,h,g)};a.prototype.resize=function(f,e){var c=this._desc;if(c.width!==f||c.height!==e)if(this._initialized)c.width=f,c.height=e,this._colorAttachment instanceof k?(b=this._colorAttachment,c=b.descriptor,c.width=f,c.height=e,this._colorAttachment.dispose(),this._colorAttachment=new k(this._context,c),a._validateTextureDimensions(b.descriptor,this._desc)):this._colorAttachment&&this._disposeColorAttachment(),null!=this._depthStencilTexture?(c=this._depthStencilTexture.descriptor,c.width=f,c.height=
e,this._depthStencilTexture.dispose(),this._depthStencilTexture=new k(this._context,c)):(this._depthAttachment||this._stencilAttachment)&&this._disposeDepthStencilAttachments(),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1;else{c.width=f;c.height=e;if(this._colorAttachment instanceof k){var b=this._colorAttachment;b.resize(f,e)}this._depthStencilTexture&&this._depthStencilTexture.resize(f,e)}};a.prototype.initialize=function(){if(this._initialized)return!1;
var a=this._context.gl;this._glName&&a.deleteFramebuffer(this._glName);var e=a.createFramebuffer(),c=this._desc;a.bindFramebuffer(a.FRAMEBUFFER,e);if(!this._colorAttachment)if(0===c.colorTarget)this._colorAttachment=new k(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:c.width,height:c.height});else{var b=new g(this._context,{internalFormat:32854,width:c.width,height:c.height});a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,
b.glName);this._colorAttachment=b}this._colorAttachment instanceof k&&a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._colorAttachment.glName,0);switch(c.depthStencilTarget){case 1:case 3:this._depthAttachment||(this._depthAttachment=new g(this._context,{internalFormat:1===c.depthStencilTarget?33189:34041,width:c.width,height:c.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,1===c.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this._depthAttachment.glName);
break;case 2:this._stencilAttachment||(this._stencilAttachment=new g(this._context,{internalFormat:36168,width:c.width,height:c.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:this._depthStencilTexture||(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new k(this._context,
{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:c.width,height:c.height})),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,this._depthStencilTexture.glName,0)}a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");this._glName=e;return this._initialized=!0};a.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof k){var a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);
var e=this._context.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}a.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(a=this._colorAttachment,e=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(a));this._colorAttachment=null};a.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;this._depthAttachment&&
(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&
(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};a._validateBufferDimensions=function(a,e){console.assert(0<=a.width&&0<=a.height);void 0!==e.width&&0<=e.width&&void 0!==e.height&&0<=e.height?e.width===a.width&&e.height===a.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(e.width=a.width,e.height=a.height)};
a._validateTextureDimensions=function(a,e){console.assert(0<=a.width&&0<=a.height);3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==e.width&&0<=e.width&&void 0!==e.height&&0<=e.height?e.width===a.width&&e.height===a.height||console.error("Color attachment texture must match the framebuffer's!"):(e.width=a.width,e.height=a.height)};a._nextId=0;return a}()})},"esri/views/webgl/Renderbuffer":function(){define(["require","exports","../../core/has"],function(c,a,l){return function(){function a(c,
h){this._context=c;this._desc=h;this._glName=null;this._id=-1;c=this._context.gl;this._id=++a._nextId;this._glName=c.createRenderbuffer();this._context.bindRenderbuffer(this);c.renderbufferStorage(c.RENDERBUFFER,h.internalFormat,h.width,h.height)}Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",
{get:function(){return this._glName},enumerable:!0,configurable:!0});a.prototype.resize=function(a,c){var f=this._context.gl,e=this._desc;if(e.width!==a||e.height!==c)e.width=a,e.height=c,this._context.bindRenderbuffer(this),f.renderbufferStorage(f.RENDERBUFFER,e.internalFormat,e.width,e.height)};a.prototype.dispose=function(){this._glName&&(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null);this._context=null};a._nextId=0;return a}()})},"esri/views/webgl/Texture":function(){define(["require",
"exports","../../core/has","../../core/mathUtils"],function(c,a,l,g){return function(){function a(c,f,e){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=c;this._desc={pixelFormat:f.pixelFormat,internalFormat:f.internalFormat,dataType:f.dataType,target:f.target?f.target:3553,samplingMode:f.samplingMode?f.samplingMode:9729,wrapMode:f.wrapMode?f.wrapMode:10497,maxAnisotropy:f.maxAnisotropy,flipped:void 0!==
f.flipped?f.flipped:!1,hasMipmap:void 0!==f.hasMipmap?f.hasMipmap:!1,unpackAlignment:f.unpackAlignment?f.unpackAlignment:4,width:f.width,height:f.height,preMultiplyAlpha:void 0!==f.preMultiplyAlpha?f.preMultiplyAlpha:!1,textureCoordinateScaleFactor:f.textureCoordinateScaleFactor||null};this._id=++a._nextId;this.setData(e)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});a.prototype.dispose=function(){var a=this;if(this._context&&this._context.gl){if(this._glName){var f=this._context.gl;this._boundToUnits.forEach(function(e){a._context.bindTexture(null,e)});f.deleteTexture(this._glName);this._glName=null}this._context=null}};a.prototype.release=function(){this.dispose()};a.prototype.resize=function(a,f){var e=this._desc;
if(e.width!==a||e.height!==f)e.width=a,e.height=f,this.setData(null)};a.prototype.setData=function(c){var f=this._context.gl;this._glName||(this._glName=f.createTexture());void 0===c&&(c=null);null===c&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var e=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var h=this._desc;a._validateTexture(h);f.pixelStorei(f.UNPACK_ALIGNMENT,h.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,h.flipped?1:0);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
h.preMultiplyAlpha?1:0);var b=h.pixelFormat,d=h.internalFormat?h.internalFormat:b;if(c instanceof ImageData||c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement)h.width&&h.height&&console.assert(c.width===h.width&&c.height===h.height),f.texImage2D(f.TEXTURE_2D,0,d,b,h.dataType,c),h.hasMipmap&&this.generateMipmap(),void 0===this._desc.width&&(this._desc.width=c.width),void 0===this._desc.height&&(this._desc.height=c.height);else{null!=h.width&&null!=h.height||
console.error("Width and height must be specified!");f.DEPTH24_STENCIL8&&d===f.DEPTH_STENCIL&&(d=f.DEPTH24_STENCIL8);var g=h.width,k=h.height;if(null!=c&&"type"in c&&"compressed"===c.type){b=Math.round(Math.log(Math.max(g,k))/Math.LN2)+1;h.hasMipmap=h.hasMipmap&&b===c.levels.length;for(var n=0;;++n){f.compressedTexImage2D(f.TEXTURE_2D,n,d,g,k,0,c.levels[Math.min(n,c.levels.length-1)]);if(1===g&&1===k||!h.hasMipmap)break;g=Math.max(1,g>>1);k=Math.max(1,k>>1)}}else if(c)f.texImage2D(f.TEXTURE_2D,0,
d,g,k,0,b,h.dataType,c),h.hasMipmap&&this.generateMipmap();else for(n=0;;++n){f.texImage2D(f.TEXTURE_2D,n,d,g,k,0,b,h.dataType,null);if(1===g&&1===k||!h.hasMipmap)break;g=Math.max(1,g>>1);k=Math.max(1,k>>1)}}a._applySamplingMode(f,this._desc);a._applyWrapMode(f,this._desc);a._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(e,0)};a.prototype.updateData=function(a,c,e,g,b,d){d||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");
var f=this._context.gl,h=this._desc,p=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>c||0>e||g>h.width||b>h.height||c+g>h.width||e+b>h.height)&&console.error("An attempt to update out of bounds of the texture!");f.pixelStorei(f.UNPACK_ALIGNMENT,h.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,h.flipped?1:0);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h.preMultiplyAlpha?1:0);d instanceof ImageData||d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof
HTMLVideoElement?(console.assert(d.width===g&&d.height===b),f.texSubImage2D(f.TEXTURE_2D,a,c,e,h.pixelFormat,h.dataType,d)):f.texSubImage2D(f.TEXTURE_2D,a,c,e,g,b,h.pixelFormat,h.dataType,d);this._context.bindTexture(p,0)};a.prototype.generateMipmap=function(){var c=this._desc;c.hasMipmap||(c.hasMipmap=!0,a._validateTexture(c));9729===c.samplingMode?(this._samplingModeDirty=!0,c.samplingMode=9985):9728===c.samplingMode&&(this._samplingModeDirty=!0,c.samplingMode=9984);c=this._context.getBoundTexture(0);
this._context.bindTexture(this,0);var f=this._context.gl;f.generateMipmap(f.TEXTURE_2D);this._context.bindTexture(c,0)};a.prototype.setSamplingMode=function(c){c!==this._desc.samplingMode&&(this._desc.samplingMode=c,a._validateTexture(this._desc),this._samplingModeDirty=!0)};a.prototype.setWrapMode=function(c){c!==this._desc.wrapMode&&(this._desc.wrapMode=c,a._validateTexture(this._desc),this._wrapModeDirty=!0)};a.prototype.applyChanges=function(){var c=this._context.gl,f=this._desc;this._samplingModeDirty&&
(a._applySamplingMode(c,f),this._samplingModeDirty=!1);this._wrapModeDirty&&(a._applyWrapMode(c,f),this._wrapModeDirty=!1)};a.prototype.setBoundToUnit=function(a,c){c?this._boundToUnits.add(a):this._boundToUnits.delete(a)};a._validateTexture=function(a){(0>a.width||0>a.height)&&console.error("Negative dimension parameters are not allowed!");g.isPowerOfTwo(a.width)&&g.isPowerOfTwo(a.height)||("number"===typeof a.wrapMode?33071!==a.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):
33071===a.wrapMode.s&&33071===a.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),a.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};a._applySamplingMode=function(a,c){var e=c.samplingMode,f=c.samplingMode;if(9985===e||9987===e)e=9729,c.hasMipmap||(f=9729);else if(9984===e||9986===e)e=9728,c.hasMipmap||(f=9728);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,f)};a._applyWrapMode=
function(a,c){"number"===typeof c.wrapMode?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,c.wrapMode),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,c.wrapMode)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,c.wrapMode.s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,c.wrapMode.t))};a._applyAnisotropicFilteringParameters=function(a,c){if(null!=c.maxAnisotropy){var e=a.capabilities.textureFilterAnisotropic;e&&(a=a.gl,a.texParameterf(a.TEXTURE_2D,e.TEXTURE_MAX_ANISOTROPY,c.maxAnisotropy))}};a._nextId=
0;return a}()})},"esri/views/webgl/Program":function(){define(["require","exports","../../core/has","../../core/maybe","./ShaderTranspiler"],function(c,a,l,g,k){function h(a,e){if(g.isNone(a)||a.length!==e.length)return!0;for(var c=0;c<a.length;++c)if(a[c]!==e[c])return!0;return!1}return function(){function a(e,c,b,d,f){void 0===f&&(f={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation=
{};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};e||console.error("RenderingContext isn't initialized!");0===c.length&&console.error("Shaders source should not be empty!");this._context=e;this._vertexShaderSource=c;this._fragmentShaderSource=b;if(Array.isArray(f))for(e=0;e<f.length;e++)this._defines[f[e]]="1";else this._defines=f;this._id=
a._nextId++;this._locations=d}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.getDefine=function(a){return this._defines[a]};a.prototype.dispose=function(){if(this._context){var a=this._context.gl;this._vShader&&
(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),this._glName=null);this._context=null}};a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,c=a.createProgram();a.attachShader(c,this._vShader);a.attachShader(c,this._fShader);
for(var b in this._locations)a.bindAttribLocation(c,this._locations[b],b);a.linkProgram(c);this._glName=c;this._initialized=!0}};a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};a.prototype.getAttribLocation=function(a){this.initialize();void 0===
this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};a.prototype.setUniform1i=function(a,c){var b=this._nameToUniform1[a];if(void 0===b||c!==b)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),c),this._nameToUniform1[a]=c};a.prototype.setUniform1iv=function(e,c){var b=this._nameToUniform1v[e];h(b,c)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(e),
c),void 0===b?this._nameToUniform1v[e]=a._arrayCopy(c):a._arrayAssign(c,b))};a.prototype.setUniform1f=function(a,c){var b=this._nameToUniform1[a];if(void 0===b||c!==b)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),c),this._nameToUniform1[a]=c};a.prototype.setUniform1fv=function(e,c){var b=this._nameToUniform1v[e];h(b,c)&&(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(e),c),void 0===b?this._nameToUniform1v[e]=a._arrayCopy(c):
a._arrayAssign(c,b))};a.prototype.setUniform2f=function(a,c,b){var d=this._nameToUniform2[a];if(void 0===d||c!==d[0]||b!==d[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),c,b),void 0===d?this._nameToUniform2[a]=[c,b]:(d[0]=c,d[1]=b)};a.prototype.setUniform2fv=function(e,c){var b=this._nameToUniform2[e];h(b,c)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(e),c),void 0===b?this._nameToUniform2[e]=a._arrayCopy(c):a._arrayAssign(c,
b))};a.prototype.setUniform3f=function(a,c,b,d){var e=this._nameToUniform3[a];if(void 0===e||c!==e[0]||b!==e[1]||d!==e[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),c,b,d),void 0===e?this._nameToUniform3[a]=[c,b,d]:(e[0]=c,e[1]=b,e[2]=d)};a.prototype.setUniform3fv=function(e,c){var b=this._nameToUniform3[e];h(b,c)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(e),c),void 0===b?this._nameToUniform3[e]=a._arrayCopy(c):
a._arrayAssign(c,b))};a.prototype.setUniform4f=function(a,c,b,d,f){var e=this._nameToUniform4[a];if(void 0===e||c!==e[0]||b!==e[1]||d!==e[2]||f!==e[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),c,b,d,f),void 0===e?this._nameToUniform4[a]=[c,b,d,f]:(e[0]=c,e[1]=b,e[2]=d,e[3]=f)};a.prototype.setUniform4fv=function(e,c){var b=this._nameToUniform4[e];h(b,c)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(e),c),void 0===b?
this._nameToUniform4[e]=a._arrayCopy(c):a._arrayAssign(c,b))};a.prototype.setUniformMatrix3fv=function(e,c,b){void 0===b&&(b=!1);var d=this._nameToUniformMatrix3[e],f;f=g.isNone(d)?!0:9!==d.length?h(d,c):9!==d.length||d[0]!==c[0]||d[1]!==c[1]||d[2]!==c[2]||d[3]!==c[3]||d[4]!==c[4]||d[5]!==c[5]||d[6]!==c[6]||d[7]!==c[7]||d[8]!==c[8];f&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(e),b,c),void 0===d?this._nameToUniformMatrix3[e]=a._arrayCopy(c):a._arrayAssign(c,
d))};a.prototype.setUniformMatrix4fv=function(e,c,b){void 0===b&&(b=!1);var d=this._nameToUniformMatrix4[e],f;f=g.isNone(d)?!0:16!==d.length?h(d,c):16!==d.length||d[0]!==c[0]||d[1]!==c[1]||d[2]!==c[2]||d[3]!==c[3]||d[4]!==c[4]||d[5]!==c[5]||d[6]!==c[6]||d[7]!==c[7]||d[8]!==c[8]||d[9]!==c[9]||d[10]!==c[10]||d[11]!==c[11]||d[12]!==c[12]||d[13]!==c[13]||d[14]!==c[14]||d[15]!==c[15];f&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(e),b,c),void 0===d?this._nameToUniformMatrix4[e]=
a._arrayCopy(c):a._arrayAssign(c,d))};a.prototype.assertCompatibleVertexAttributeLocations=function(a){(a=a.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return a};a._padToThree=function(a){var e=a.toString();1E3>a&&(e=("  "+a).slice(-3));return e};a.prototype._addLineNumbers=function(e){var c=2;return e.replace(/\n/g,function(){return"\n"+a._padToThree(c++)+":"})};a.prototype._loadShader=function(a){var e=35633===a,b=e?this._vertexShaderSource:this._fragmentShaderSource,
d="",c;for(c in this._defines)d+="#define "+c+" "+this._defines[c]+"\n";b=d+b;"webgl2"===this._context.contextVersion&&(b=k.transpileShader(b,e?"vertex":"fragment"));e=this._context.gl;a=e.createShader(a);e.shaderSource(a,b);e.compileShader(a);return a};a._arrayCopy=function(a){for(var e=[],b=0;b<a.length;++b)e.push(a[b]);return e};a._arrayAssign=function(a,c){for(var b=0;b<a.length;++b)c[b]=a[b]};a._nextId=0;return a}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["require","exports",
"./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(c,a,l,g){function k(a){return a.map(function(a){return"eof"!==a.type?a.data:""}).join("")}function h(a,b,d,e){e=e||d;for(var c=0;c<a.length;c++){var f=a[c];if("ident"===f.type&&f.data===d)return e in b?b[e]++:b[e]=0,h(a,b,e+"_"+b[e],e)}return d}function f(a,b,d){void 0===d&&(d="afterVersion");var e={data:"\n",type:"whitespace"},c=function(b){return b<a.length?/[^\r\n]$/.test(a[b].data):!1},f=function(a){for(var b=-1,e=0,c=-1,f=0;f<a.length;f++){var h=
a[f];"preprocessor"===h.type&&(h.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++e:h.data.match(/\#endif\s*.*/)&&--e);("afterVersion"===d||"afterPrecision"===d)&&"preprocessor"===h.type&&/^#version/.test(h.data)&&(c=Math.max(c,f));if("afterPrecision"===d&&"keyword"===h.type&&"precision"===h.data){a:{for(h=f;h<a.length;h++){var g=a[h];if("operator"===g.type&&";"===g.data)break a}h=null}if(null===h)throw Error("precision statement not followed by any semicolons!");c=Math.max(c,h)}b<c&&0===e&&(b=f)}return b+
1}(a);c(f-1)&&a.splice(f++,0,e);for(var h=0;h<b.length;h++){var g=b[h];a.splice(f++,0,g)}c(f-1)&&c(f)&&a.splice(f,0,e)}Object.defineProperty(a,"__esModule",{value:!0});var e=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];a.transpileShader=function(a,b){a=g(a);var d;a:{d="100";var c="300 es";void 0===d&&(d="100");void 0===c&&(c="300 es");for(var p=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,n=0;n<a.length;n++){var u=a[n];if("preprocessor"===u.type){var y=
p.exec(u.data);if(y){p=y[1].replace(/\s\s+/g," ");if(p===c){d=p;break a}if(p===d){u.data="#version "+c;break a}throw Error("unknown glsl version: "+p);}}}a.splice(0,0,{type:"preprocessor",data:"#version "+c},{type:"whitespace",data:"\n"});d=null}if("300 es"===d)throw Error("shader is already glsl 300 es");p=u=null;n={};y={};for(d=0;d<a.length;++d)switch(c=a[d],c.type){case "keyword":"vertex"===b&&"attribute"===c.data?c.data="in":"varying"===c.data&&(c.data="vertex"===b?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(c.data.trim())&&
(c.data=c.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===b&&"gl_FragColor"===c.data){if(!u){var u=h(a,n,"fragColor"),w=void 0;void 0===w&&(w="lowp");f(a,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:w},{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:u},{type:"operator",data:";"}],"afterPrecision")}c.data=u}else"fragment"===b&&"gl_FragDepthEXT"===c.data&&(p||(p=h(a,n,"gl_FragDepth")),c.data=p);break;case "ident":if(0<=
l.indexOf(c.data)){if(w="vertex"===b)a:{for(w=d-1;0<=w;w--){var t=a[w];if("whitespace"!==t.type&&"block-comment"!==t.type)if("keyword"===t.type){if("attribute"===t.data||"in"===t.data){w=!0;break a}}else break}w=!1}if(w)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");c.data in y||(y[c.data]=h(a,n,c.data));c.data=y[c.data]}}for(d=a.length-1;0<=d;--d)c=a[d],"preprocessor"===c.type&&((b=c.data.match(/\#extension\s+(.*)\:/))&&b[1]&&0<=e.indexOf(b[1].trim())&&
(b=a[d+1],a.splice(d,b&&"whitespace"===b.type?2:1)),(b=c.data.match(/\#ifdef\s+(.*)/))&&b[1]&&0<=e.indexOf(b[1].trim())&&(c.data="#if 1"),(b=c.data.match(/\#ifndef\s+(.*)/))&&b[1]&&0<=e.indexOf(b[1].trim())&&(c.data="#if 0"));return k(a)}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(["require","exports"],function(c,a){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(c){"use strict;";return function(a){var l=c(),g=[],g=g.concat(l(a));return g=g.concat(l(null))}})},"esri/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(c,a,l){"use strict;";var g="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function k(a){a.length&&t.push({type:g[n],
data:a,position:A,line:v,column:z})}function h(){w=w.length?[]:w;if("/"===y&&"*"===u)return A=r+m-1,n=0,y=u,m+1;if("/"===y&&"/"===u)return A=r+m-1,n=1,y=u,m+1;if("#"===u)return n=2,A=r+m,m;if(/\s/.test(u))return n=9,A=r+m,m;C=/\d/.test(u);D=/[^\w_]/.test(u);A=r+m;n=C?4:D?3:9999;return m}function f(){if(("\r"===u||"\n"===u)&&"\\"!==y)return k(w.join("")),n=999,m;w.push(u);y=u;return m+1}function e(){if("."===y&&/\d/.test(u))return n=5,m;if("/"===y&&"*"===u)return n=0,m;if("/"===y&&"/"===u)return n=
1,m;if("."===u&&w.length){for(;p(w););n=5;return m}if(";"===u||")"===u||"("===u){if(w.length)for(;p(w););k(u);n=999;return m+1}var a=2===w.length&&"\x3d"!==u;if(/[\w_\d\s]/.test(u)||a){for(;p(w););n=999;return m}w.push(u);y=u;return m+1}function p(b){var d=0,e,c;do{e=a.indexOf(b.slice(0,b.length+d).join(""));c=a[e];if(-1===e){if(0<d--+b.length)continue;c=b.slice(0,1).join("")}k(c);A+=c.length;w=w.slice(c.length);return w.length}while(1)}function b(){if("."===u||/[eE]/.test(u))return w.push(u),n=5,
y=u,m+1;if("x"===u&&1===w.length&&"0"===w[0])return n=11,w.push(u),y=u,m+1;if(/[^\d]/.test(u))return k(w.join("")),n=999,m;w.push(u);y=u;return m+1}function d(){"f"===u&&(w.push(u),y=u,m+=1);if(/[eE]/.test(u)||"-"===u&&/[eE]/.test(y))return w.push(u),y=u,m+1;if(/[^\d]/.test(u))return k(w.join("")),n=999,m;w.push(u);y=u;return m+1}var m=0,r=0,n=999,u,y,w=[],t=[],v=1,z=0,A=0,C=!1,D=!1,B="",E;return function(a){t=[];if(null!==a){a=a.replace?a.replace(/\r\n/g,"\n"):a;m=0;B+=a;for(E=B.length;u=B[m],m<
E;){a=m;switch(n){case 0:"/"===u&&"*"===y?(w.push(u),k(w.join("")),n=999):(w.push(u),y=u);m+=1;break;case 1:m=f();break;case 2:m=f();break;case 3:m=e();break;case 4:m=b();break;case 11:/[^a-fA-F0-9]/.test(u)?(k(w.join("")),n=999):(w.push(u),y=u,m+=1);break;case 5:m=d();break;case 9999:if(/[^\d\w_]/.test(u)){var g=w.join("");n=-1<c.indexOf(g)?8:-1<l.indexOf(g)?7:6;k(w.join(""));n=999}else w.push(u),y=u,m+=1;break;case 9:/[^\s]/g.test(u)?(k(w.join("")),n=999):(w.push(u),y=u,m+=1);break;case 999:m=h()}if(a!==
m)switch(B[a]){case "\n":z=0;++v;break;default:++z}}r+=m;B=B.slice(m);return t}w.length&&k(w.join(""));n=10;k("(eof)");return t}}})},"esri/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/views/webgl/RenderingContext":function(){define("require exports ../../core/has ../../core/maybe ./enums ./InstanceCounter ./renderState ./capabilities/isWebGL2Context ./capabilities/load".split(" "),function(c,a,l,g,k,h,f,e,p){return function(){function a(a,b){var d=this;this.gl=null;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,
g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation=
{face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this._numOfTriangles=this._numOfDrawCalls=0;this.contextVersion=e.default(a)?"webgl2":"webgl";this.gl=a;a instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=p.loadCapabilities(a,b);a=this.gl.getParameter(this.gl.VIEWPORT);
this._viewport={x:a[0],y:a[1],width:a[2],height:a[3]};this._stateTracker=new f.StateTracker({setBlending:function(a){a?(d.setBlendingEnabled(!0),d.setBlendEquationSeparate(a.opRgb,a.opAlpha),d.setBlendFunctionSeparate(a.srcRgb,a.dstRgb,a.srcAlpha,a.dstAlpha),a=a.color,d.setBlendColor(a.r,a.g,a.b,a.a)):d.setBlendingEnabled(!1)},setCulling:function(a){a?(d.setFaceCullingEnabled(!0),d.setCullFace(a.face),d.setFrontFace(a.mode)):d.setFaceCullingEnabled(!1)},setPolygonOffset:function(a){a?(d.setPolygonOffsetFillEnabled(!0),
d.setPolygonOffset(a.factor,a.units)):d.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(a){a?(d.setDepthTestEnabled(!0),d.setDepthFunction(a.func)):d.setDepthTestEnabled(!1)},setStencilTest:function(a){if(a){d.setStencilTestEnabled(!0);var b=a.function;d.setStencilFunction(b.func,b.ref,b.mask);a=a.operation;d.setStencilOp(a.fail,a.zFail,a.zPass)}else d.setStencilTestEnabled(!1)},setDepthWrite:function(a){a?(d.setDepthWriteEnabled(!0),d.setDepthRange(a.zNear,a.zFar)):d.setDepthWriteEnabled(!1)},
setColorWrite:function(a){a?d.setColorMask(a.r,a.g,a.b,a.a):d.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(a){a?d.setStencilWriteMask(a.mask):d.setStencilWriteMask(0)}});this.enforceState()}Object.defineProperty(a.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"parameters",{get:function(){if(!this._parameters){var a=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),
maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:a?this.gl.getParameter(a.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)}}return this._parameters},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap={};this.gl=null};
a.prototype.setPipelineState=function(a){this._stateTracker.setPipeline(a)};a.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a,this._stateTracker.invalidateBlending())};a.prototype.setBlendColor=function(a,b,e,c){if(a!==this._blendColorState.r||b!==this._blendColorState.g||e!==this._blendColorState.b||c!==this._blendColorState.a)this.gl.blendColor(a,b,e,c),this._blendColorState.r=a,this._blendColorState.g=
b,this._blendColorState.b=e,this._blendColorState.a=c,this._stateTracker.invalidateBlending()};a.prototype.setBlendFunction=function(a,b){if(a!==this._blendFunctionState.srcRGB||b!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,b),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=b,this._stateTracker.invalidateBlending()};a.prototype.setBlendFunctionSeparate=function(a,b,e,c){if(this._blendFunctionState.srcRGB!==
a||this._blendFunctionState.srcAlpha!==e||this._blendFunctionState.dstRGB!==b||this._blendFunctionState.dstAlpha!==c)this.gl.blendFuncSeparate(a,b,e,c),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=e,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=c,this._stateTracker.invalidateBlending()};a.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=
a,this._stateTracker.invalidateBlending())};a.prototype.setBlendEquationSeparate=function(a,b){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==b)this.gl.blendEquationSeparate(a,b),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=b,this._stateTracker.invalidateBlending()};a.prototype.setColorMask=function(a,b,e,c){if(this._colorMaskState.r!==a||this._colorMaskState.g!==b||this._colorMaskState.b!==e||this._colorMaskState.a!==c)this.gl.colorMask(a,b,e,c),
this._colorMaskState.r=a,this._colorMaskState.g=b,this._colorMaskState.b=e,this._colorMaskState.a=c,this._stateTracker.invalidateColorWrite()};a.prototype.setClearColor=function(a,b,e,c){if(this._clearColor.r!==a||this._clearColor.g!==b||this._clearColor.b!==e||this._clearColor.a!==c)this.gl.clearColor(a,b,e,c),this._clearColor.r=a,this._clearColor.g=b,this._clearColor.b=e,this._clearColor.a=c};a.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):
this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a,this._stateTracker.invalidateCulling())};a.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a,this._stateTracker.invalidatePolygonOffset())};a.prototype.setPolygonOffset=function(a,b){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==b)this._polygonOffset[0]=a,this._polygonOffset[1]=
b,this.gl.polygonOffset(a,b),this._stateTracker.invalidatePolygonOffset()};a.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a,this._stateTracker.invalidateCulling())};a.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a,this._stateTracker.invalidateCulling())};a.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),
this._scissorTestEnabled=a)};a.prototype.setScissorRect=function(a,b,e,c){if(this._scissorRect.x!==a||this._scissorRect.y!==b||this._scissorRect.width!==e||this._scissorRect.height!==c)this.gl.scissor(a,b,e,c),this._scissorRect.x=a,this._scissorRect.y=b,this._scissorRect.width=e,this._scissorRect.height=c};a.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a,this._stateTracker.invalidateDepthTest())};
a.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)};a.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a,this._stateTracker.invalidateDepthTest())};a.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a,this._stateTracker.invalidateDepthWrite())};a.prototype.setDepthRange=function(a,b){if(this._depthRange.zNear!==a||this._depthRange.zFar!==
b)this.gl.depthRange(a,b),this._depthRange.zNear=a,this._depthRange.zFar=b,this._stateTracker.invalidateDepthWrite()};a.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a,this._stateTracker.invalidateStencilTest())};a.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};a.prototype.setStencilFunction=function(a,
b,e){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==b||this._stencilFunction.mask!==e)this.gl.stencilFunc(a,b,e),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=b,this._stencilFunction.mask=e,this._stateTracker.invalidateStencilTest()};a.prototype.setStencilFunctionSeparate=function(a,b,e,c){if(this._stencilFunction.face!==a||this._stencilFunction.func!==b||this._stencilFunction.ref!==e||this._stencilFunction.mask!==c)this.gl.stencilFuncSeparate(a,
b,e,c),this._stencilFunction.face=a,this._stencilFunction.func=b,this._stencilFunction.ref=e,this._stencilFunction.mask=c,this._stateTracker.invalidateStencilTest()};a.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a,this._stateTracker.invalidateStencilWrite())};a.prototype.setStencilOp=function(a,b,e){if(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==e)this.gl.stencilOp(a,b,e),
this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=b,this._stencilOperation.zPass=e,this._stateTracker.invalidateStencilTest()};a.prototype.setStencilOpSeparate=function(a,b,e,c){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==b||this._stencilOperation.zFail!==e||this._stencilOperation.zPass!==c)this.gl.stencilOpSeparate(a,b,e,c),this._stencilOperation.face=a,this._stencilOperation.face=a,this._stencilOperation.fail=b,this._stencilOperation.zFail=
e,this._stencilOperation.zPass=c,this._stateTracker.invalidateStencilTest()};a.prototype.setActiveTexture=function(a){var b=this._activeTextureUnit;0<=a&&a!==this._activeTextureUnit&&(this.gl.activeTexture(k.BASE_TEXTURE_UNIT+a),this._activeTextureUnit=a);return b};a.prototype.clear=function(a){a&&this.gl.clear(a)};a.prototype.clearSafe=function(a){a&&(a&16384&&this.setColorMask(!0,!0,!0,!0),a&256&&this.setDepthWriteEnabled(!0),a&1024&&this.setStencilWriteMask(255),this.gl.clear(a))};a.prototype.drawArrays=
function(a,b,e){this.gl.drawArrays(a,b,e)};a.prototype.drawElements=function(a,b,e,c){5123===e?this.gl.drawElements(a,b,e,c):5125===e&&this.gl.drawElements(a,b,e,c)};a.prototype.logIno=function(){};Object.defineProperty(a.prototype,"capabilities",{get:function(){return this._capabilities},enumerable:!0,configurable:!0});a.prototype.setViewport=function(a,b,e,c){var d=this._viewport;if(d.x!==a||d.y!==b||d.width!==e||d.height!==c)d.x=a,d.y=b,d.width=e,d.height=c,this.gl.viewport(a,b,e,c)};a.prototype.getViewport=
function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};a.prototype.bindProgram=function(a){a?this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),this._activeShaderProgram=null)};a.prototype.bindTexture=function(b,e){void 0===e&&(e=0);-1===a._MAX_TEXTURE_IMAGE_UNITS&&(a._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(e>=a._MAX_TEXTURE_IMAGE_UNITS||
0>e)&&console.error("Input texture unit is out of range of available units!");var d=this._textureUnitMap[e];this.setActiveTexture(e);null==b||null==b.glName?(null!=d&&(this.gl.bindTexture(d.descriptor.target,null),d.setBoundToUnit(e,!1)),this._textureUnitMap[e]=null):d&&d.id===b.id?b.applyChanges():(d&&d.setBoundToUnit(e,!1),this.gl.bindTexture(b.descriptor.target,b.glName),b.setBoundToUnit(e,!0),b.applyChanges(),this._textureUnitMap[e]=b)};a.prototype.bindFramebuffer=function(a){g.isNone(a)?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,
null),this._activeFramebuffer=null):this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a)};a.prototype.bindBuffer=function(b){b&&(34962===b.bufferType?this._activeVertexBuffer=a._bindBuffer(this.gl,b,b.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=a._bindBuffer(this.gl,b,b.bufferType,this._activeIndexBuffer))};a.prototype.bindRenderbuffer=function(a){var b=this.gl;a||(b.bindRenderbuffer(b.RENDERBUFFER,null),this._activeRenderbuffer=
null);this._activeRenderbuffer!==a&&(b.bindRenderbuffer(b.RENDERBUFFER,a.glName),this._activeRenderbuffer=a)};a.prototype.unbindBuffer=function(b){34962===b?this._activeVertexBuffer=a._bindBuffer(this.gl,null,b,this._activeVertexBuffer):this._activeIndexBuffer=a._bindBuffer(this.gl,null,b,this._activeIndexBuffer)};a.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),
this._activeVertexArrayObject=null)};a.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};a.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};a.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};a.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);
this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);
this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};a.prototype.enforceState=function(){var a=this.gl,b=this.capabilities.vao;b&&b.bindVertexArray(null);for(var e=0;e<this.parameters.maxVertexAttributes;e++)a.disableVertexAttribArray(e);this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):
a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(b&&this._activeVertexArrayObject){if(b=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(b)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,
this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);a.bindRenderbuffer(a.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);a.clearColor(this._clearColor.r,
this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);a.lineWidth(1);
!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);
a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);for(b=0;b<this.parameters.maxTextureImageUnits;b++)a.activeTexture(k.BASE_TEXTURE_UNIT+b),a.bindTexture(3553,null),(e=this._textureUnitMap[b])&&a.bindTexture(e.descriptor.target,e.glName);a.activeTexture(k.BASE_TEXTURE_UNIT+this._activeTextureUnit);
a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};a._bindBuffer=function(a,b,e,c){if(!b)return a.bindBuffer(e,null),null;if(c===b)return c;a.bindBuffer(e,b.glName);return b};a._MAX_TEXTURE_IMAGE_UNITS=-1;return a}()})},"esri/views/webgl/InstanceCounter":function(){define(["require","exports"],function(c,a){return function(){function a(){this._instanceCount={textureCount:0,bufferCount:0,vaoCount:0,programCount:0,framebufferCount:0,renderBufferCount:0}}a.prototype.incrementCount=
function(a){switch(a){case 0:this._instanceCount.textureCount++;break;case 1:this._instanceCount.bufferCount++;break;case 2:this._instanceCount.vaoCount++;break;case 3:this._instanceCount.programCount++;break;case 4:this._instanceCount.framebufferCount++;break;case 5:this._instanceCount.renderBufferCount++}};a.prototype.decrementCount=function(a){switch(a){case 0:this._instanceCount.textureCount--;break;case 1:this._instanceCount.bufferCount--;break;case 2:this._instanceCount.vaoCount--;break;case 3:this._instanceCount.programCount--;
break;case 4:this._instanceCount.framebufferCount--;break;case 5:this._instanceCount.renderBufferCount--}};a.prototype.printResourceCount=function(){console.log("Live objects:");console.log("Textures: "+this._instanceCount.textureCount);console.log("Buffers: "+this._instanceCount.bufferCount);console.log("VAOs: "+this._instanceCount.vaoCount);console.log("Programs: "+this._instanceCount.programCount);console.log("Framebuffers: "+this._instanceCount.framebufferCount);console.log("Renderbuffers: "+
this._instanceCount.renderBufferCount)};return a}()})},"esri/views/webgl/renderState":function(){define(["require","exports","../../core/tsSupport/assignHelper"],function(c,a,l){function g(a){return A.intern(a)}function k(a){return C.intern(a)}function h(a){return D.intern(a)}function f(a){return B.intern(a)}function e(a){return E.intern(a)}function p(a){return F.intern(a)}function b(a){return H.intern(a)}function d(a){return J.intern(a)}function m(a){return"["+a.join(",")+"]"}function r(a){return a?
m([a.srcRgb,a.srcAlpha,a.dstRgb,a.dstAlpha,a.opRgb,a.opAlpha,a.color.r,a.color.g,a.color.b,a.color.a]):null}function n(a){return a?m([a.face,a.mode]):null}function u(a){return a?m([a.factor,a.units]):null}function y(a){return a?m([a.func]):null}function w(a){return a?m([a.function.func,a.function.ref,a.function.mask,a.operation.fail,a.operation.zFail,a.operation.zPass]):null}function t(a){return a?m([a.zNear,a.zFar]):null}function v(a){return a?m([a.r,a.g,a.b,a.a]):null}function z(a){return a?m([a.mask]):
null}Object.defineProperty(a,"__esModule",{value:!0});a.simpleBlendingParams=function(a,b,d,e){void 0===d&&(d=32774);void 0===e&&(e=[0,0,0,0]);return{srcRgb:a,srcAlpha:a,dstRgb:b,dstAlpha:b,opRgb:d,opAlpha:d,color:{r:e[0],g:e[1],b:e[2],a:e[3]}}};a.separateBlendingParams=function(a,b,d,e,c,f,h){void 0===c&&(c=32774);void 0===f&&(f=32774);void 0===h&&(h=[0,0,0,0]);return{srcRgb:a,srcAlpha:b,dstRgb:d,dstAlpha:e,opRgb:c,opAlpha:f,color:{r:h[0],g:h[1],b:h[2],a:h[3]}}};a.backFaceCullingParams={face:1029,
mode:2305};a.defaultDepthWriteParams={zNear:0,zFar:1};a.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};a.makeBlending=g;a.makeCulling=k;a.makePolygonOffset=h;a.makeDepthTest=f;a.makeStencilTest=e;a.makeDepthWrite=p;a.makeColorWrite=b;a.makeStencilWrite=d;a.makePipelineState=function(a){return K.intern(a)};c=function(){function a(a,b){this.makeKey=a;this.makeRef=b;this.interns=new Map}a.prototype.intern=function(a){if(!a)return null;var b=this.makeKey(a),d=this.interns;d.has(b)||d.set(b,this.makeRef(a));
return d.get(b)};return a}();var A=new c(r,function(a){return l({__tag:"Blending"},a)}),C=new c(n,function(a){return l({__tag:"Culling"},a)}),D=new c(u,function(a){return l({__tag:"PolygonOffset"},a)}),B=new c(y,function(a){return l({__tag:"DepthTest"},a)}),E=new c(w,function(a){return l({__tag:"StencilTest"},a)}),F=new c(t,function(a){return l({__tag:"DepthWrite"},a)}),H=new c(v,function(a){return l({__tag:"ColorWrite"},a)}),J=new c(z,function(a){return l({__tag:"StencilWrite"},a)}),K=new c(function(a){return a?
m([r(a.blending),n(a.culling),u(a.polygonOffset),y(a.depthTest),w(a.stencilTest),t(a.depthWrite),v(a.colorWrite),z(a.stencilWrite)]):null},function(a){return{blending:g(a.blending),culling:k(a.culling),polygonOffset:h(a.polygonOffset),depthTest:f(a.depthTest),stencilTest:e(a.stencilTest),depthWrite:p(a.depthWrite),colorWrite:b(a.colorWrite),stencilWrite:d(a.stencilWrite)}});c=function(){function a(a){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=
this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=a}a.prototype.setPipeline=function(a){if(this._pipelineInvalid||a!==this._pipeline)this.setBlending(a.blending),this.setCulling(a.culling),this.setPolygonOffset(a.polygonOffset),this.setDepthTest(a.depthTest),this.setStencilTest(a.stencilTest),this.setDepthWrite(a.depthWrite),this.setColorWrite(a.colorWrite),this.setStencilWrite(a.stencilWrite),this._pipeline=a;
this._pipelineInvalid=!1};a.prototype.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};a.prototype.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};a.prototype.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};a.prototype.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};a.prototype.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.invalidateDepthWrite=
function(){this._pipelineInvalid=this._depthWriteInvalid=!0};a.prototype.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};a.prototype.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.setBlending=function(a){this._blending=this.setSubState(a,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};a.prototype.setCulling=function(a){this._culling=this.setSubState(a,this._culling,this._cullingInvalid,
this._stateSetters.setCulling);this._cullingInvalid=!1};a.prototype.setPolygonOffset=function(a){this._polygonOffset=this.setSubState(a,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};a.prototype.setDepthTest=function(a){this._depthTest=this.setSubState(a,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};a.prototype.setStencilTest=function(a){this._stencilTest=this.setSubState(a,this._stencilTest,
this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};a.prototype.setDepthWrite=function(a){this._depthWrite=this.setSubState(a,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};a.prototype.setColorWrite=function(a){this._colorWrite=this.setSubState(a,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};a.prototype.setStencilWrite=function(a){this._stencilWrite=
this.setSubState(a,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};a.prototype.setSubState=function(a,b,d,e){if(d||a!==b)e(a),this._pipelineInvalid=!0;return a};return a}();a.StateTracker=c})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return window.WebGL2RenderingContext&&a instanceof window.WebGL2RenderingContext}})},
"esri/views/webgl/capabilities/load":function(){define("require exports ./DisjointTimerQuery ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),function(c,a,l,g,k,h,f){function e(a,b,d,e,c){if(e&&k.default(a))return!0;if(b[d])return!1;for(b=0;b<c.length;b++)if(a.getExtension(c[b]))return!0;return!1}Object.defineProperty(a,"__esModule",{value:!0});a.loadCapabilities=function(a,b){var d=b&&b.disabledExtensions||{},c=b&&b.debugWebGLExtensions||{},p,n,u,y,w,t,v,z,A,C=null,D=
null,B=null,E=null;return{get instancing(){p||(p=g.load(a));return p},get vao(){n||(n=f.load(a,d));return n},get compressedTextureS3TC(){if(!u)if(d.compressedTextureS3TC)u=null;else{var b=a.getExtension("WEBGL_compressed_texture_s3tc");u=b?{COMPRESSED_RGB_S3TC_DXT1:b.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:b.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:b.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:b.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}return u},get textureFilterAnisotropic(){if(!y)if(d.textureFilterAnisotropic)y=
null;else{var b=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");y=b?{MAX_TEXTURE_MAX_ANISOTROPY:b.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:b.TEXTURE_MAX_ANISOTROPY_EXT}:null}return y},get disjointTimerQuery(){w||(w=l.load(a,d));return w},get textureFloat(){if(!t)if(k.default(a))t={textureFloat:!0,textureFloatLinear:!d.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),
textureHalfFloat:!0,textureHalfFloatLinear:!d.textureHalfFloatLinear&&!!a.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:a.HALF_FLOAT};else if(a instanceof WebGLRenderingContext){var b=!d.textureHalfFloat&&a.getExtension("OES_texture_half_float");t={textureFloat:!d.textureFloat&&!!a.getExtension("OES_texture_float"),textureFloatLinear:!d.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),textureHalfFloat:!!b,textureHalfFloatLinear:!d.textureHalfFloatLinear&&!!a.getExtension("OES_texture_half_float_linear"),
HALF_FLOAT:b?b.HALF_FLOAT_OES:void 0}}else t=null;return t},get colorBufferFloat(){if(!v)if(k.default(a)){var b=!d.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),e=!d.colorBufferFloat&&a.getExtension("EXT_color_buffer_float");v=b||e?{textureFloat:!!e,textureHalfFloat:!!b,R16F:a.R16F,RG16F:a.RG16F,RGBA16F:a.RGBA16F,R32F:a.R32F,RG32F:a.RG32F,RGBA32F:a.RGBA32F,R11F_G11F_B10F:a.R11F_G11F_B10F,RGB16F:a.RGB16F}:null}else a instanceof WebGLRenderingContext?(b=!d.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),
e=!d.colorBufferFloat&&a.getExtension("WEBGL_color_buffer_float"),v=b||e?{textureFloat:!!e,textureHalfFloat:!!b,RGBA16F:b?b.RGBA16F_EXT:void 0,RGB16F:b?b.RGB16F_EXT:void 0,RGBA32F:e?e.RGBA32F_EXT:void 0}:null):v=null;return v},get blendMinMax(){if(!z)if(k.default(a))z={MIN:a.MIN,MAX:a.MAX};else if(d.blendMinMax)z=null;else{var b=a.getExtension("EXT_blend_minmax");z=b?{MIN:b.MIN_EXT,MAX:b.MAX_EXT}:null}return z},get depthTexture(){null===C&&(C=e(a,d,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture",
"WEBKIT_WEBGL_depth_texture"]));return C},get standardDerivatives(){null===D&&(D=e(a,d,"standardDerivatives",!0,["OES_standard_derivatives"]));return D},get shaderTextureLOD(){null===B&&(B=e(a,d,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return B},get fragDepth(){null===E&&(E=e(a,d,"fragDepth",!0,["EXT_frag_depth"]));return E},get loseContext(){A||(A=h.load(a,c));return A}}}})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["require","exports","./isWebGL2Context"],function(c,
a,l){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,c){if(c.disjointTimerQuery)return null;var h=a.getExtension("EXT_disjoint_timer_query")||a.getExtension("EXT_disjoint_timer_query_webgl2");return h?l.default(a)?{createQuery:function(){return a.createQuery()},resultAvailable:function(c){return a.getQueryParameter(c,a.QUERY_RESULT_AVAILABLE)},getResult:function(c){return a.getQueryParameter(c,a.QUERY_RESULT)},disjoint:function(){return a.getParameter(h.GPU_DISJOINT_EXT)},beginTimeElapsed:function(c){return a.beginQuery(h.TIME_ELAPSED_EXT,
c)},endTimeElapsed:function(){return a.endQuery(h.TIME_ELAPSED_EXT)},createTimestamp:function(a){return h.queryCounterEXT(a,h.TIMESTAMP_EXT)},timestampBits:function(){return a.getQuery(h.TIMESTAMP_EXT,h.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return h.createQueryEXT()},resultAvailable:function(a){return h.getQueryObjectEXT(a,h.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(a){return h.getQueryObjectEXT(a,h.QUERY_RESULT_EXT)},disjoint:function(){return a.getParameter(h.GPU_DISJOINT_EXT)},
beginTimeElapsed:function(a){return h.beginQueryEXT(h.TIME_ELAPSED_EXT,a)},endTimeElapsed:function(){return h.endQueryEXT(h.TIME_ELAPSED_EXT)},createTimestamp:function(a){return h.queryCounterEXT(a,h.TIMESTAMP_EXT)},timestampBits:function(){return h.getQueryEXT(h.TIMESTAMP_EXT,h.QUERY_COUNTER_BITS_EXT)}}:null}})},"esri/views/webgl/capabilities/Instancing":function(){define(["require","exports","./isWebGL2Context"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a){return l.default(a)?
{drawArraysInstanced:a.drawArraysInstanced.bind(a),drawElementsInstanced:a.drawElementsInstanced.bind(a),vertexAttribDivisor:a.vertexAttribDivisor.bind(a)}:(a=a.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:a.drawArraysInstancedANGLE.bind(a),drawElementsInstanced:a.drawElementsInstancedANGLE.bind(a),vertexAttribDivisor:a.vertexAttribDivisorANGLE.bind(a)}:null}})},"esri/views/webgl/capabilities/LoseContext":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,
"__esModule",{value:!0});a.load=function(a,c){var g=c.loseContext&&a.getExtension("WEBGL_lose_context");return g?{loseRenderingContext:function(){return g.loseContext()}}:null}})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["require","exports","./isWebGL2Context"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,c){return l.default(a)?{createVertexArray:a.createVertexArray.bind(a),deleteVertexArray:a.deleteVertexArray.bind(a),bindVertexArray:a.bindVertexArray.bind(a)}:
c.vao?null:(a=a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:a.createVertexArrayOES.bind(a),deleteVertexArray:a.deleteVertexArrayOES.bind(a),bindVertexArray:a.bindVertexArrayOES.bind(a)}:null}})},"esri/views/webgl/ShaderCompiler":function(){define(["require","exports"],function(c,a){return function(){function a(a){this.readFile=a}a.prototype.resolveIncludes=function(a){return this.resolve(a)};
a.prototype.resolve=function(a,c){var h=this;void 0===c&&(c=new Map);if(c.has(a))return c.get(a);var f=this.read(a);if(!f)throw Error("cannot find shader file "+a);for(var e=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,g=e.exec(f),b=[];null!=g;)b.push({path:g[1],start:g.index,length:g[0].length}),g=e.exec(f);var d=0,m="";b.forEach(function(a){m+=f.slice(d,a.start);m+=c.has(a.path)?"":h.resolve(a.path,c);d=a.start+a.length});m+=f.slice(d);c.set(a,m);return m};a.prototype.read=function(a){return this.readFile(a)};
return a}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports","../../core/has","./Util"],function(c,a,l,g){return function(){function a(c,f,e,g,b){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=c;this._layout=e;this._buffers=g;this._locations=f;b&&(this._indexBuffer=b);this._id=a._nextId++}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){var a=this;return Object.keys(this._buffers).reduce(function(c,e){return c+a._buffers[e].size},
this._indexBuffer?this._indexBuffer.size:0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(a){void 0===a&&(a=!0);if(this._context){var c=this._context.capabilities.vao;c&&this._glName&&(c.deleteVertexArray(this._glName),this._glName=null);this._context.getBoundVAO()===
this&&this._context.bindVAO(null);if(a){for(var e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context=null}};a.prototype.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){var c=a.createVertexArray();a.bindVertexArray(c);this._bindLayout();a.bindVertexArray(null);this._glName=c}this._initialized=!0}};a.prototype.bind=function(){this.initialize();var a=this._context.capabilities.vao;
a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};a.prototype._bindLayout=function(){var a=this._buffers,c=!!this._context.capabilities.vao,e=this._layout,k=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var b=this._context.gl,d;for(d in a){var m=a[d];m||console.error("Vertex buffer is uninitialized!");var l=e[d];l||console.error("Vertex element descriptor is empty!");g.bindVertexBufferLayout(this._context,this._locations,m,l)}k&&(c?b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
k.glName):this._context.bindBuffer(k))};a.prototype.unbind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};a.prototype._unbindLayout=function(){var a=this._buffers,c=this._layout;a||console.error("Vertex buffer dictionary is empty!");for(var e in a){var k=a[e];k||console.error("Vertex buffer is uninitialized!");g.unbindVertexBufferLayout(this._context,this._locations,k,c[e])}(a=this._indexBuffer)&&this._context.unbindBuffer(a.bufferType)};
a._nextId=0;return a}()})},"esri/views/webgl/Util":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils"],function(c,a,l,g){function k(a){return a[0].stride}function h(a){switch(a){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw Error("Unknown data type");}}function f(a){switch(a){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;case 6408:return 4;
case 34041:return 4;case 33325:return 2;case 33326:return 4;case 35898:return 4;case 33327:return 4;case 33328:return 8;case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;case 36168:return 1;default:g.neverReached(a)}return 0}function e(a){if(!a)return 0;if("colorAttachment"in a)return a.glName?e(a.colorAttachment)+e(a.depthStencilAttachment):0;if("descriptor"in a)return a.glName?e(a.descriptor):0;var b=a.internalFormat||"pixelFormat"in a&&a.pixelFormat;
if(!b)return 0;var d="hasMipmap"in a&&a.hasMipmap?1.3:1;a=a.width*a.height;return f(b)*a*d}Object.defineProperty(a,"__esModule",{value:!0});a.vertexCount=function(a,b){return a.vertexBuffers[b].size/k(a.layout[b])};a.getStride=k;a.getBytesPerElement=h;a.addDescriptor=function(a,b,d,e,c,f){var g=h(e);if(0<a.length){var m=a[0].stride,k=m+g*d;a.forEach(function(a){return a.stride=k});a.push({name:b,count:d,type:e,offset:m,stride:k,normalized:c,divisor:f})}else a.push({name:b,count:d,type:e,offset:0,
stride:g*d,normalized:c,divisor:f})};a.hasAttribute=function(a,b){for(var d=0;d<a.length;d++)if(a[d].name===b)return!0;return!1};a.findAttribute=function(a,b){for(var d=0;d<a.length;d++)if(a[d].name===b)return a[d];return null};a.copyFramebufferToTexture=function(a,b,d,e,c){void 0===c&&(c=0);var f=a.getBoundFramebufferObject(),h=a.getBoundTexture(0);a.bindFramebuffer(b);a.bindTexture(d,0);a.gl.copyTexImage2D(a.gl.TEXTURE_2D,c,d.descriptor.pixelFormat,e[0],e[1],e[2],e[3],0);a.gl.flush();a.bindFramebuffer(f);
a.bindTexture(h,0)};a.setBaseInstanceOffset=function(a,b){var d={},e;for(e in a)d[e]=a[e].map(function(a){return a.divisor?l({},a,{baseInstance:b}):a});return d};a.bindVertexBufferLayout=function(a,b,d,e,c){var f=a.gl,h=a.capabilities.instancing;a.bindBuffer(d);for(a=0;a<e.length;a++){d=e[a];var g=b[d.name],m=(c?c:0+d.baseInstance?d.baseInstance:0)*d.stride;void 0===g&&console.error("There is no location for vertex attribute '"+d.name+"' defined.");d.baseInstance&&!d.divisor&&console.error("Vertex attribute '"+
d.name+"' uses baseInstanceOffset without divisor.");if(4>=d.count)f.vertexAttribPointer(g,d.count,d.type,d.normalized,d.stride,d.offset+m),f.enableVertexAttribArray(g),d.divisor&&0<d.divisor&&h&&h.vertexAttribDivisor(g,d.divisor);else if(9===d.count)for(var k=0;3>k;k++)f.vertexAttribPointer(g+k,3,d.type,d.normalized,d.stride,d.offset+12*k+m),f.enableVertexAttribArray(g+k),d.divisor&&0<d.divisor&&h&&h.vertexAttribDivisor(g+k,d.divisor);else if(16===d.count)for(k=0;4>k;k++)f.vertexAttribPointer(g+
k,4,d.type,d.normalized,d.stride,d.offset+16*k+m),f.enableVertexAttribArray(g+k),d.divisor&&0<d.divisor&&h&&h.vertexAttribDivisor(g+k,d.divisor);else console.error("Unsupported vertex attribute element count: "+d.count)}};a.unbindVertexBufferLayout=function(a,b,d,e){var c=a.gl,f=a.capabilities.instancing;a.bindBuffer(d);for(d=0;d<e.length;d++){var h=e[d],g=b[h.name];if(4>=h.count)c.disableVertexAttribArray(g),h.divisor&&0<h.divisor&&f&&f.vertexAttribDivisor(g,0);else if(9===h.count)for(var m=0;3>
m;m++)c.disableVertexAttribArray(g+m),h.divisor&&0<h.divisor&&f&&f.vertexAttribDivisor(g+m,0);else if(16===h.count)for(m=0;4>m;m++)c.disableVertexAttribArray(g+m),h.divisor&&0<h.divisor&&f&&f.vertexAttribDivisor(g+m,0);else console.error("Unsupported vertex attribute element count: "+h.count)}a.unbindBuffer(34962)};a.getBytesPerElementFormat=f;a.getGpuMemoryUsage=e})},"esri/views/webgl/ProgramCache":function(){define(["require","exports","./programUtils"],function(c,a,l){Object.defineProperty(a,"__esModule",
{value:!0});c=function(){function a(a){this._programCacheByTemplate=new Map;this._rctx=a}a.prototype.dispose=function(){this._programCacheByTemplate.forEach(function(a){a.programs.forEach(function(a){a.dispose()})});this._programCacheByTemplate=null};a.prototype.getProgram=function(a,c){var f=this;this._programCacheByTemplate.has(a)||this.addProgramTemplate(a,function(e){return l.createProgram(f._rctx,a,e)});return this.getProgramTemplateInstance(a,c)};a.prototype.addProgramTemplate=function(a,c){this._programCacheByTemplate.set(a,
{constructor:c,programs:new Map})};a.prototype.getProgramTemplateInstance=function(a,c){if(a=this._programCacheByTemplate.get(a)){var f=c?JSON.stringify(c):"default";a.programs.has(f)||(c=a.constructor(c),a.programs.set(f,c));return a.programs.get(f)}return null};return a}();a.ProgramCache=c})},"esri/views/webgl/programUtils":function(){define(["require","exports","./Program"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.glslifyDefineMap=function(a){var c="",h;for(h in a){var f=
a[h];if("boolean"===typeof f)f&&(c+="#define "+h+"\n");else if("number"===typeof f)c+="#define "+h+" "+f.toFixed()+"\n";else if("object"===typeof f){var e=f.options,g=0,b;for(b in e)c+="#define "+e[b]+" "+(g++).toFixed()+"\n";c+="#define "+h+" "+e[f.value]+"\n"}}return c};a.createProgram=function(a,c,h,f){h=h||{};f=f||"";h="function"===typeof c.shaders?c.shaders(h):c.shaders;return new l(a,f+h.vertexShader,f+h.fragmentShader,c.attributes)}})},"esri/views/2d/engine/DisplayObject":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._renderRequestedCalled=!1;c._attached=!1;c._isReady=!1;c._opacity=1;c.renderRequested=!1;c._visible=!0;return c}l(c,a);Object.defineProperty(c.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&
this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"visible",{get:function(){return this._visible},
set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});c.prototype.attach=function(){this.ready();return!0};c.prototype.setTransform=function(a){};c.prototype.detach=function(){};c.prototype.processRender=function(a){this.visible&&this.attached&&(this._renderRequestedCalled=!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};c.prototype.requestRender=function(){var a=
this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};c.prototype.dispose=function(){};c.prototype.doRender=function(a){};c.prototype.ready=function(){this._isReady=!0;this.emit("isReady")};return c}(g);a.DisplayObject=c})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",
{value:!0});c=function(){function a(a,c,h){this.pixelBlock=a;this.extent=c;this.originalPixelBlock=h}Object.defineProperty(a.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this.pixelBlock?this.pixelBlock.height:0},enumerable:!0,configurable:!0});a.prototype.render=function(a){var c=this.pixelBlock;if(c){var h=this.filter({pixelBlock:c}),c=h.pixelBlock.getAsRGBA(),h=
a.createImageData(h.pixelBlock.width,h.pixelBlock.height);h.data.set(c);a.putImageData(h,0,0)}};a.prototype.getRenderedRasterPixels=function(){var a=this.filter({pixelBlock:this.pixelBlock});return{width:a.pixelBlock.width,height:a.pixelBlock.height,renderedRasterPixels:new Uint8Array(a.pixelBlock.getAsRGBA().buffer)}};return a}();a.default=c})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),
function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}l(e,a);e.prototype.prepareRenderPasses=function(e){var b=this,d=e.registerRenderPass({name:"bitmap",brushes:[k.brushes.Bitmap],target:function(){return b.children}});return a.prototype.prepareRenderPasses.call(this,e).concat([d])};return e}(h.default);a.BitmapContainer=c})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),
function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(b){var d=a.call(this)||this;d.name=d.constructor.name;d._lastTime=null;d.setClips(b);return d}l(b,a);b.prototype.setClips=function(a){var b=this;k.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(a){return a.destroy()}),this._clippingInfos=null);k.isSome(a)&&a.length&&(this._clippingInfos=a.items.map(function(a){return e.default.fromClipArea(b,a)}));this.requestRender()};b.prototype.doRender=
function(a){this.attachChildren();this.detachChildren();var b=this.createRenderParams(a),d=b.context,e=b.painter,c=b.globalOpacity,f=b.profiler,c=b.drawPhase===p.WGLDrawPhase.LABEL?1:c*this.opacity;f.recordContainerStart(this.name);e.beforeRenderLayer(d,this._clippingInfos?255:0,c);this.updateTransforms(a.state);this.renderChildren(b);e.compositeLayer(d,c);f.recordContainerEnd()};b.prototype.renderChildren=function(a){k.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));
for(var b=0,d=this._renderPasses;b<d.length;b++)d[b].render(a)};b.prototype.createRenderParams=function(a){var b=Date.now(),d=(k.isSome(this._lastTime)?b-this._lastTime:0)/1E3;this._lastTime=b;return g({},a,{context:this.stage.context,painter:this.stage.painter,profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:d,timeline:this.stage.timeline})};b.prototype.prepareRenderPasses=function(a){var b=this;return[a.registerRenderPass({name:"clip",
brushes:[h.brushes.Clip],target:function(){return b._clippingInfos},drawPhase:p.WGLDrawPhase.MAP|p.WGLDrawPhase.LABEL|p.WGLDrawPhase.LABEL_ALPHA|p.WGLDrawPhase.DEBUG})]};b.prototype.updateTransforms=function(a){for(var b=0,d=this.children;b<d.length;b++)d[b].setTransform(a)};return b}(f.Container);a.default=c})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});
c=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._childrenSet=new Set;c._childrenToAttach=[];c._childrenToDetach=[];c.children=[];return c}l(c,a);Object.defineProperty(c.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});c.prototype.detach=function(){for(var a=0,e=this.children.concat(this._childrenToDetach);a<e.length;a++){var c=e[a];c.attached&&(this.detachChild(c),c.attached=!1,c.parent=null)}};c.prototype.doRender=function(a){var e=
a.globalOpacity;a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();this.renderChildren(a);a.globalOpacity=e};c.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};c.prototype.addChildAt=function(a,e){void 0===e&&(e=this.numChildren);if(!a||this.contains(a))return a;var c=a.parent;c&&c!==this&&c.removeChild(a);e>=this.numChildren?this.children.push(a):this.children.splice(e,0,a);this._childrenSet.add(a);e=this._childrenToDetach.indexOf(a);-1<e&&this._childrenToDetach.splice(e,
1);this._childrenToAttach.push(a);this.requestRender();return a};c.prototype.contains=function(a){return this._childrenSet.has(a)};c.prototype.getChildIndex=function(a){return this.children.indexOf(a)};c.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};c.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};c.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};c.prototype.removeChildAt=
function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);if(a.attached)this._childrenToDetach.push(a);else{var e=this._childrenToAttach.indexOf(a);-1<e&&this._childrenToAttach.splice(e,1)}return a};c.prototype.setChildIndex=function(a,e){var c=this.getChildIndex(a);-1<c&&(this.children.splice(c,1),this.children.splice(e,0,a))};c.prototype.sortChildren=function(a){return this.children.sort(a)};c.prototype.attachChildren=function(){var a=
this._childrenToAttach;if(0!==a.length)for(var e=0,c=!1;!c;)c=a[e],c.parent=this,c.stage=this.stage,this.attachChild(c)?(c.attached=!0,a.splice(e,1)):++e,c=a.length===e};c.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var e=a.shift();this.detachChild(e);e.attached=!1;e.parent=null;e.stage=null}};c.prototype.renderChildren=function(a){for(var e=this.children,c=e.length,b=0;b<c;b++)e[b].processRender(a)};c.prototype.attachChild=function(a){return a.attach()};c.prototype.detachChild=
function(a){a.detach()};return c}(g.DisplayObject);a.Container=c})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});var b=k.getLogger("esri.views.2d.engine.webgl.ClippingInfo");c=function(a){function d(b,d){var e=
a.call(this)||this;e._cache={};e.parent=b;e._handle=d.watch("version",function(){return e._invalidate()});e._clip=d;e.attach();e.attached=!0;return e}l(d,a);d.fromClipArea=function(a,b){return new d(a,b)};d.prototype._destroyGL=function(){h.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);h.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};d.prototype.destroy=function(){this._destroyGL();this._handle.remove()};d.prototype.doRender=function(){};
d.prototype.getVAO=function(a,b,d,e){var c=b.size,f=c[0],c=c[1];if("geometry"===this._clip.type||this._lastWidth!==f||this._lastHeight!==c)this._lastWidth=f,this._lastHeight=c,this._destroyGL();h.isNone(this._cache.vao)&&(b=this._createMesh(b,this._clip),f=b.getIndexBuffer(a),c=b.getVertexBuffers(a),this._cache.mesh=b,this._cache.vao=new p(a,d,e,c,f));return this._cache.vao};d.prototype._invalidate=function(){this._destroyGL();this.requestRender()};d.prototype._createScreenRect=function(a,b){var d=
a.size;a=d[0];var d=d[1],e="string"===typeof b.left?parseFloat(b.left)/100*a:b.left,c="string"===typeof b.right?parseFloat(b.right)/100*a:b.right,f="string"===typeof b.top?parseFloat(b.top)/100*d:b.top;b="string"===typeof b.bottom?parseFloat(b.bottom)/100*d:b.bottom;return{x:e,y:f,width:Math.max(a-c-e,0),height:Math.max(d-b-f,0)}};d.prototype._createMesh=function(a,d){switch(d.type){case "rect":return e.default.fromRect(this._createScreenRect(a,d));case "path":return e.default.fromPath(d);case "geometry":return e.default.fromGeometry(a,
d);default:return b.error(new g("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),e.default.fromRect({x:0,y:0,width:1,height:1})}};return d}(f.DisplayObject);a.default=c})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r){Object.defineProperty(a,"__esModule",{value:!0});var n=k.getLogger("esri.views.2d.engine.webgl.Mesh2D"),u=function(a,b){var d=a.coords;a=a.lengths;for(var e=[],c=0,h=0;c<a.length;h+=a[c],c+=1){for(var g=h,m=[];c<a.length-1;c+=1,h+=a[c]){for(var k=h+a[c],n=0,p=1;p<a[c+1];p++)n+=(d[2*(k+p)]-d[2*(k+p-1)])*(d[2*(k+p)+1]+d[2*(k+p-1)+1]);if(!(b?0<n:0>n))break;m.push(h+a[c]-g)}n=d.slice(2*g,2*(h+a[c]));k=0;for(m=f(n,m,2);k<m.length;k++)e.push(m[k]+g)}return e};c=function(){function a(a,
b,d,e){void 0===e&&(e=!1);this._cache={};this.vertices=a;this.indices=b;this.primitiveType=d;this.isMapSpace=e}a.fromRect=function(b){var d=b.x,e=b.y;return a.fromScreenExtent({xmin:d,ymin:e,xmax:d+b.width,ymax:e+b.height})};a.fromPath=function(e){var c=b.convertFromNestedArray(new d.default,e.path,!1,!1);e=c.coords;for(var c=new Uint32Array(u(c,!0)),f=new Uint32Array(e.length/2),h=0;h<f.length;h++)f[h]=m.i1616to32(Math.floor(e[2*h]),Math.floor(e[2*h+1]));return new a({geometry:f},c,4)};a.fromGeometry=
function(b,d){var e=d.geometry.type;switch(e){case "polygon":return a.fromPolygon(b,d.geometry);case "extent":return a.fromMapExtent(b,d.geometry);default:return n.error(new g("mapview-bad-type","Unable to create a mesh from type "+e,d)),a.fromRect({x:0,y:0,width:1,height:1})}};a.fromPolygon=function(c,f){var h=b.convertFromPolygon(new d.default,f,!1,!1);f=h.coords;for(var h=new Uint32Array(u(h,!1)),g=new Uint32Array(f.length/2),k=p.vec2f64.create(),n=p.vec2f64.create(),t=0;t<g.length;t++)e.vec2.set(k,
f[2*t],f[2*t+1]),c.toScreen(n,k),g[t]=m.i1616to32(Math.floor(n[0]),Math.floor(n[1]));return new a({geometry:g},h,4,!0)};a.fromScreenExtent=function(b){var d=b.xmin,e=b.xmax,c=b.ymin;b=b.ymax;d={geometry:new Uint32Array([m.i1616to32(d,c),m.i1616to32(e,c),m.i1616to32(d,b),m.i1616to32(d,b),m.i1616to32(e,c),m.i1616to32(e,b)])};e=new Uint32Array([0,1,2,3,4,5]);return new a(d,e,4)};a.fromMapExtent=function(b,d){var e=b.toScreen([0,0],[d.xmin,d.ymin]),c=e[0],e=e[1];d=b.toScreen([0,0],[d.xmax,d.ymax]);b=
d[0];d=d[1];c={geometry:new Uint32Array([m.i1616to32(c,e),m.i1616to32(b,e),m.i1616to32(c,d),m.i1616to32(c,d),m.i1616to32(b,e),m.i1616to32(b,d)])};e=new Uint32Array([0,1,2,3,4,5]);return new a(c,e,4)};a.prototype.destroy=function(){h.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var a in this._cache.vertexBuffers)h.isSome(this._cache.vertexBuffers[a])&&this._cache.vertexBuffers[a].dispose()};Object.defineProperty(a.prototype,"elementType",{get:function(){var a;a:switch(this.indices.BYTES_PER_ELEMENT){case 1:a=
5121;break a;case 2:a=5123;break a;case 4:a=5125;break a;default:throw new g("Cannot get DataType of array");}return a},enumerable:!0,configurable:!0});a.prototype.getIndexBuffer=function(a,b){void 0===b&&(b=35044);this._cache.indexBuffer||(this._cache.indexBuffer=r.createIndex(a,b,this.indices));return this._cache.indexBuffer};a.prototype.getVertexBuffers=function(a,b){var d=this;void 0===b&&(b=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(function(e,
c){var f;return l({},e,(f={},f[c]=r.createVertex(a,b,d.vertices[c]),f))},{}));return this._cache.vertexBuffers};return a}();a.default=c})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(c,a){function l(a,c,e){return Math.round(Math.max(Math.min(a,e),c))}Object.defineProperty(a,"__esModule",{value:!0});var g=new Float32Array(1),k=new Uint32Array(g.buffer);a.i8=function(a){return l(a,-128,127)};a.i16=function(a){return l(a,-32768,32767)};a.i32=function(a){return l(a,
-2147483648,2147483647)};a.u8=function(a){return l(a,0,255)};a.u16=function(a){return l(a,0,65535)};a.u32=function(a){return l(a,0,4294967295)};a.toUint32=function(a){g[0]=a;return k[0]};a.toFloat32=function(a){k[0]=a;return g[0]};a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>8,(a&16711680)>>>16,(a&4278190080)>>>24]};a.i1616to32=function(a,c){return 65535&a|c<<16};a.i8888to32=function(a,c,e,g){return a&255|(c&255)<<8|(e&255)<<16|g<<24};a.i8816to32=function(a,c,e){return a&255|(c&255)<<8|e<<16};
a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]="LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=
0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=
8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=
1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(e,b,d,c){void 0===c&&(c=null);var f=a.call(this,e,b,d,d)||this;e=f.requestRender.bind(f);f.bitmap=new k.Bitmap(c,e);f.bitmap.coordScale=d;f.bitmap.once("isReady",
function(){return f.ready()});return f}l(e,a);Object.defineProperty(e.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});e.prototype.setTransform=function(e,b){a.prototype.setTransform.call(this,e,b);this.bitmap.transforms.dvs=this.transforms.dvs};e.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};e.prototype.detach=function(){this.bitmap.detach()};
return e}(h.TiledDisplayObject);a.BitmapTile=c})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(b,c,f,g){void 0===g&&(g=f);var d=a.call(this)||this;d.transforms={dvs:h.mat3f32.create(),
tileMat3:h.mat3f32.create()};d.triangleCount=0;d.key=e.pool.acquire(b);d.bounds=c;d.size=f;d.coordRange=g;return d}l(b,a);b.prototype.destroy=function(){e.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(b.prototype,"coords",{get:function(){return this._coords},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"bounds",{get:function(){return this._bounds},set:function(a){this._coords=[a[0],a[3]];this._bounds=a},enumerable:!0,
configurable:!0});b.prototype.setTransform=function(a,b){b/=a.resolution*a.pixelRatio;var d=this.transforms.tileMat3,e=a.toScreenNoRotation([0,0],this.coords);k.mat3.set(d,this.size[0]/this.coordRange[0]*b,0,0,0,this.size[1]/this.coordRange[1]*b,0,e[0],e[1],1);k.mat3.multiply(this.transforms.dvs,a.displayViewMat3,d)};return b}(f.DisplayObject);a.TiledDisplayObject=c})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});a.sortByLevel=function(a,b){return 0!==a.key.level-b.key.level?a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:a.key.col-b.key.col};c=function(c){function b(a,b){b=c.call(this,b)||this;b._tileInfoView=a;return b}l(b,c);b.prototype.renderChildren=function(b){this.sortChildren(a.sortByLevel);this.setStencilReference();c.prototype.renderChildren.call(this,b)};b.prototype.createRenderParams=function(a){var b=
a.state;return g({},c.prototype.createRenderParams.call(this,a),{requiredLevel:this._tileInfoView.getClosestInfoForScale(b.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(b.scale)})};b.prototype.prepareRenderPasses=function(a){var b=this,d=a.registerRenderPass({name:"stencil",brushes:[e.default],drawPhase:k.WGLDrawPhase.DEBUG|k.WGLDrawPhase.MAP,target:function(){return b.children}}),h=a.registerRenderPass({name:"tileInfo",brushes:[f.default],drawPhase:k.WGLDrawPhase.DEBUG,target:function(){return b.children},
has:"esri-tiles-debug"});return c.prototype.prepareRenderPasses.call(this,a).concat([d,h])};b.prototype.updateTransforms=function(a){for(var b=0,d=this.children;b<d.length;b++){var e=d[b],c=this._tileInfoView.getTileResolution(e.key);e.setTransform(a,c)}};b.prototype.setStencilReference=function(){for(var a=1,b=0,e=this.children;b<e.length;b++)e[b].stencilRef=a++};return b}(h.default);a.default=c})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(1,0,0,1);return b}l(b,a);b.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=
null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};b.prototype.prepareState=function(a){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};b.prototype.draw=function(a,b){a=a.context;if(b.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",
b.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",b.coordRange[0],b.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(3,0,4);a.bindVAO();var d=this._getTexture(a,b);d&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(d,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",
b.coordRange[0]/b.size[0],b.coordRange[1]/b.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",d.descriptor.width,d.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};b.prototype._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var b=k.createProgram(a,f.background),d=k.createProgram(a,e.tileInfo),c={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},h=new Int8Array([0,0,
1,0,1,1,0,1]),h=k.BufferObject.createVertex(a,35044,h),h=new k.VertexArrayObject(a,f.background.attributes,c,{geometry:h}),g=new Int8Array([0,0,1,0,0,1,1,1]),g=k.BufferObject.createVertex(a,35044,g);a=new k.VertexArrayObject(a,e.tileInfo.attributes,c,{geometry:g});this._outlineProgram=b;this._tileInfoProgram=d;this._outlineVertexArrayObject=h;this._tileInfoVertexArrayObject=a}};b.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),
this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var d=b.triangleCount,e=b.key.id;0<b.triangleCount&&(e+=", "+d);var c=this._canvas,f=c.getContext("2d");f.font="24px sans-serif";f.textAlign="left";f.textBaseline="top";f.clearRect(0,0,300,32);1E5<d?(f.fillStyle="red",f.fillRect(0,0,300,32),f.fillStyle="black"):(f.clearRect(0,0,300,32),f.fillStyle="blue");f.fillText(e,0,0);
b.texture=new k.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},c);return b.texture};return b}(h.default);a.default=c})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["require","exports","./factories/vec4f32"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.vec4f32=l})},"esri/core/libs/gl-matrix-2/factories/vec4f32":function(){define(["require","exports"],function(c,a){function l(){return new Float32Array(4)}function g(a,d,e,c){var b=
new Float32Array(4);b[0]=a;b[1]=d;b[2]=e;b[3]=c;return b}function k(){return g(1,1,1,1)}function h(){return g(1,0,0,0)}function f(){return g(0,1,0,0)}function e(){return g(0,0,1,0)}function p(){return g(0,0,0,1)}Object.defineProperty(a,"__esModule",{value:!0});a.create=l;a.clone=function(a){var b=new Float32Array(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=g;a.createView=function(a,d){return new Float32Array(a,d,4)};a.zeros=function(){return l()};a.ones=k;a.unitX=h;a.unitY=f;
a.unitZ=e;a.unitW=p;a.ZEROS=l();a.ONES=k();a.UNIT_X=h();a.UNIT_Y=f();a.UNIT_Z=e();a.UNIT_W=p()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this.name=this.constructor.name||"UnnamedBrush"}a.prototype.prepareState=function(a,c,h){};a.prototype.draw=function(a,c,h){};a.prototype.drawMany=function(a,c,h){for(var f=0;f<c.length;f++)this.draw(a,c[f],h)};return a}();a.default=
c})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:{vertexShader:l.resolveIncludes("background/background.vert"),fragmentShader:l.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],
function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});var k=new l.ShaderCompiler(function(a){var c=g;a.split("/").forEach(function(a){c&&(c=c[a])});return c});a.resolveIncludes=function(a){return k.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(c,a){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying vec2 v_dotTextureCoords;\nvarying vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision mediump float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying vec4 v_sizeTex;\nvarying vec3 v_pos;\nvarying float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying float v_overridingOutlineColor;\nvarying float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nuniform vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"precision mediump float;\n#include \x3cmaterials/label/common.glsl\x3e\nuniform mediump vec2 u_screenSize;\nuniform highp float u_pixelRatio;\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  mediump vec2 refTextPos \x3d gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  lowp float sdfAlpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist);\n  gl_FragColor \x3d v_animation.r * sdfAlpha * v_color;\n}",
"label.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_zoomRangeAndEmpty;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/label/common.glsl\x3e\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_zoomRangeAndEmpty.x;\n  float a_minZoom       \x3d max(groupMinZoom, glyphMinZoom);\n  float a_maxZoom       \x3d a_zoomRangeAndEmpty.y;\n  vec2  a_placementDir  \x3d a_refSymbolAndPlacementOffset.zw - 1.0;\n  float a_refSymbolSize \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize        \x3d a_texAndSize.z;\n  float isHalo          \x3d mod(a_pos, 2.0).x;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float z            \x3d getZ(a_minZoom, a_maxZoom, a_refSymbolAndPlacementOffset.x);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  v_color     \x3d a_color;\n  v_tex       \x3d a_texAndSize.xy / u_mosaicSize;\n  v_animation \x3d pow(getAnimationState(), vec4(2.0));\n  v_edgeDistanceOffset \x3d isHalo * OUTLINE_SCALE * a_texAndSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.106 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + PLACEMENT_PADDING);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying vec3 v_pos;\nvarying float v_opacity;\nvarying vec4 v_color;\nvarying vec2 v_tex;\nvarying float v_antialiasingWidth;\nvarying float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  #ifdef HIGHLIGHT\n    glyphEdgeDistance /\x3d 2.0;\n  #endif\n  lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision mediump float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  float a_isHalo    \x3d getBit(a_pos.x, 0);\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d a_isHalo * a_color + (1.0 - a_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texFontSize.xy / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d a_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(VV_ADATA[ATTR_VV_ROTATION]);\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},
stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.tileInfo={name:"tileInfo",shaders:{vertexShader:l.resolveIncludes("tileInfo/tileInfo.vert"),
fragmentShader:l.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(1,
0,0,1);b._initialized=!1;return b}l(e,a);e.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};e.prototype.prepareState=function(a,d){a=a.context;a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunctionSeparate(1032,
516,d.stencilRef,255)};e.prototype.draw=function(a,d){a=a.context;this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",d.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};e.prototype._initialize=function(a){if(this._initialized)return!0;
var b=k.createProgram(a,f.background);if(!b)return!1;var e=new Int8Array([0,0,1,0,0,1,1,1]),e=k.BufferObject.createVertex(a,35044,e);a=new k.VertexArrayObject(a,f.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:e});this._solidProgram=b;this._solidVertexArrayObject=a;return this._initialized=!0};return e}(h.default);a.default=c})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B,E,F){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function c(b,d){var e=a.call(this)||this;e._renderParameters={drawPhase:0,state:e.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};e._clipData=new Float32Array(8);e._upperLeft=u.vec2f64.create();e._upperRight=u.vec2f64.create();e._lowerLeft=u.vec2f64.create();e._lowerRight=u.vec2f64.create();e._mat2=r.mat2df64.create();e._clipRendererInitialized=!1;e._supersampleScreenshots=
!0;e.dataUploadCounter=0;e.stage=e;e._stationary=!0;e.attached=!0;var c=d.canvas,c=void 0===c?document.createElement("canvas"):c,g=d.alpha,m=d.stencil,n=d.renderContext,v=d.supersampleScreenshots,v=void 0===v?!0:v,t=d.contextOptions,t=void 0===t?{}:t;e._canvas=c;g=y.createContextOrErrorHTML(c,{alpha:void 0===g?!0:g,antialias:!1,depth:!0,stencil:void 0===m?!0:m},void 0===n?"webgl":n);e.context=new y.RenderingContext(g,t);e.painter=new A.default(e.context);e._taskHandle=p.addFrameTask({render:function(){return e.renderFrame()}});
e._taskHandle.pause();e._supersampleScreenshots=v;e._lostWebGLContextHandle=h.on(c,"webglcontextlost",function(){e.emit("webgl-error",{error:new k("webgl-context-lost")})});f("esri-2d-profiler")&&(e._debugOutput=document.createElement("div"),e._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),b.appendChild(e._debugOutput));c.setAttribute("style","width: 100%; height:100%; display:block;");e.profiler=new C.Profiler(e.context,e._debugOutput);e.renderingOptions=
d.renderingOptions;e.timeline=d.timeline||new E.Timeline;e.driverTestResult=D.testWebGLDriver(e.context);b.appendChild(c);return e}l(c,a);c.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(c.prototype,"background",{get:function(){return this._background},
set:function(a){this._background=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var d=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=b.init(this._highlightOptions,"version",function(){d.painter.setHighlightOptions(a);d.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(a){this._renderingOptions=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=
a,this.requestRender())},enumerable:!0,configurable:!0});c.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};c.prototype.renderFrame=function(){var a=Date.now()-this._lastRenderRequestTime;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters);a>=v.MAX_ANIMATION_TIME_MS&&
this._taskHandle.pause()};c.prototype.renderChildren=function(a){var b=this.context,d=this.children,d=a.children?a.children:d;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(a);a.drawPhase=z.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(b);for(var e=0;e<d.length;e++){var c=d[e];c.attached&&c.processRender(a)}this.painter.renderLayers(b);a.drawPhase=z.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(b);for(e=0;e<d.length;e++)c=d[e],c.attached&&c.processRender(a);
this.painter.renderLayers(b);if(f("esri-tiles-debug")){a.drawPhase=z.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(b);for(e=0;e<d.length;e++)c=d[e],c.attached&&c.processRender(a);this.painter.renderLayers(b)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};c.prototype.beforeRenderChildren=function(a){var b=this.context,e=a.state,c=a.pixelRatio;if(this.painter){b.enforceState();var f=e.size;a=e.rotation;var h=Math.round(f[0]*c),f=Math.round(f[1]*c);this._boundFBO=b.getBoundFramebufferObject();
if(e.spatialReference&&(e.spatialReference._isWrappable?e.spatialReference._isWrappable():e.spatialReference.isWrappable)){var g=d.common.toRadian(a),k=Math.abs(Math.cos(g)),p=Math.abs(Math.sin(g)),v=Math.round(e.worldScreenWidth);if(Math.round(h*k+f*p)<=v)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===h&&this._clipFBO.height===f||(this._clipFBO=new y.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:h,height:f}));var t=(this.state.padding.left-this.state.padding.right)/
2,w=(this.state.padding.bottom-this.state.padding.top)/2,l=.5*h,r=.5*f,e=1/h,u=1/f,c=.5*v*c,z=.5*(h*p+f*k),h=this._upperLeft,k=this._upperRight,p=this._lowerLeft,v=this._lowerRight;n.vec2.set(h,-c,-z);n.vec2.set(k,c,-z);n.vec2.set(p,-c,z);n.vec2.set(v,c,z);m.mat2d.identity(this._mat2);m.mat2d.translate(this._mat2,this._mat2,[l+t,r+w]);0!==a&&m.mat2d.rotate(this._mat2,this._mat2,g);n.vec2.transformMat2d(h,h,this._mat2);n.vec2.transformMat2d(k,k,this._mat2);n.vec2.transformMat2d(p,p,this._mat2);n.vec2.transformMat2d(v,
v,this._mat2);a=this._clipData;a.set([2*p[0]*e-1,2*(f-p[1])*u-1,2*v[0]*e-1,2*(f-v[1])*u-1,2*h[0]*e-1,2*(f-h[1])*u-1,2*k[0]*e-1,2*(f-k[1])*u-1]);this._clipRendererInitialized||this._initializeClipRenderer(b);this._clipVBO.setData(a);this._boundFBO=b.getBoundFramebufferObject();b.bindFramebuffer(this._clipFBO);b.setDepthWriteEnabled(!0);b.setStencilWriteMask(255);b.setClearColor(0,0,0,0);b.setClearDepth(1);b.setClearStencil(0);b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT|b.gl.STENCIL_BUFFER_BIT);
b.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1}};c.prototype.afterRenderChildren=function(){var a=this.context;a.logIno();this._clipFrame&&this._clipRendererInitialized&&(a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),
a.setStencilFunction(519,1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};c.prototype.doRender=function(b){var d=this.context,e=b.state,c=b.pixelRatio;this._resizeCanvas(b);this.context.enforceState();d.setViewport(0,0,c*e.size[0],c*e.size[1]);d.setDepthWriteEnabled(!0);d.setStencilWriteMask(255);this.background&&this.background.color?
(e=this.background.color,d.setClearColor(e.r/255,e.g/255,e.b/255,e.a)):d.setClearColor(0,0,0,0);d.setClearDepth(1);d.setClearStencil(0);d.clear(d.gl.COLOR_BUFFER_BIT|d.gl.DEPTH_BUFFER_BIT|d.gl.STENCIL_BUFFER_BIT);d.setDepthWriteEnabled(!1);a.prototype.doRender.call(this,b)};c.prototype.takeScreenshot=function(a,b){var d=F.screenshotSuperSampleSettings(a,this._supersampleScreenshots,this._state.padding),c=d.framebufferWidth,f=d.framebufferHeight,h=this.context,g=a.layers,m={drawPhase:null,globalOpacity:1,
stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:d.pixelRatio};if(null!=a.rotation){var k=m.state.viewpoint;k.rotation=a.rotation;m.state.viewpoint=k}0<g.length&&(m.children=[],g.forEach(function(a){var d=b.find(function(b){return b.layer.id===a.id});d&&"container"in d&&d.container&&d.attached&&m.children.push(d.container)}));var n=new y.FramebufferObject(h,{colorTarget:0,depthStencilTarget:3,width:c,height:f}),g=h.getBoundFramebufferObject(),k=h.getViewport();h.bindFramebuffer(n);
h.setViewport(0,0,c,f);c=h.gl;!a.ignoreBackground&&this.background&&this.background.color?(f=this.background.color,h.setClearColor(f.r/255,f.g/255,f.b/255,f.a)):h.setClearColor(0,0,0,0);h.setClearDepth(1);h.setClearStencil(0);h.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT);this.renderChildren(m);d=this._readbackScreenshot(d);h.bindFramebuffer(g);h.setViewport(k.x,k.y,k.width,k.height);this.requestRender();h=this._ensureScreenshotEncodeCanvas();a=F.encodeResult(d,a,h,{flipY:!0,
premultipliedAlpha:!0});return e.resolve(a)};c.prototype._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};c.prototype._readbackScreenshot=function(a){var b=a.framebufferWidth,d=a.framebufferHeight,e=a.region;a=a.resample;var c=this.context.gl;if(a){var f=F.createEmptyImageData(b,d,this._ensureScreenshotEncodeCanvas());c.readPixels(0,0,b,d,6408,5121,new Uint8Array(f.data.buffer));
b=F.createEmptyImageData(e.width,e.height,this._ensureScreenshotEncodeCanvas());return F.resampleHermite(f,b,!0,a.region.x,d-(a.region.y+a.region.height),a.region.width,a.region.height)}f=F.createEmptyImageData(e.width,e.height,this._ensureScreenshotEncodeCanvas());c.readPixels(e.x,d-(e.y+e.height),e.width,e.height,6408,5121,new Uint8Array(f.data.buffer));return f};c.prototype._resizeCanvas=function(a){var b=this._canvas,d=b.style,e=a.state.size,c=a.pixelRatio;a=e[0];var e=e[1],f=Math.round(a*c),
c=Math.round(e*c);if(b.width!==f||b.height!==c)b.width=f,b.height=c;d.width=a+"px";d.height=e+"px"};c.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new t.BitBlitRenderer;var b=B.stencil.attributes,d=y.createProgram(a,B.stencil);if(!d)return!1;var e=y.BufferObject.createVertex(a,35040,32),c=new Uint16Array([0,1,2,2,1,3]),c=y.BufferObject.createIndex(a,35044,c);a=new y.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,
stride:8,normalized:!1,divisor:0}]},{geometry:e},c);this._clipStencilProgram=d;this._clipVBO=e;this._clipVAO=a;return this._clipRendererInitialized=!0};return c}(w.Container);a.Stage=c})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._initialized=!1}a.prototype.dispose=function(){this._program&&(this._program.dispose(),
this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.render=function(a,c,e,g){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),c.setSamplingMode(e),a.bindTexture(c,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",g),a.drawArrays(5,0,4),a.bindVAO())};a.prototype._initialize=function(a){if(this._initialized)return!0;
var c=g.bitBlit.attributes,e=l.createProgram(a,g.bitBlit);if(!e)return!1;var h=new Int8Array(16);h[0]=-1;h[1]=-1;h[2]=0;h[3]=0;h[4]=1;h[5]=-1;h[6]=1;h[7]=0;h[8]=-1;h[9]=1;h[10]=0;h[11]=1;h[12]=1;h[13]=1;h[14]=1;h[15]=1;a=new l.VertexArrayObject(a,c,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:l.BufferObject.createVertex(a,35044,h)});this._program=e;this._vertexArrayObject=
a;return this._initialized=!0};return a}();a.BitBlitRenderer=c})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require","exports","./sources/resolver"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.bitBlit={name:"bitBlit",shaders:{vertexShader:l.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:l.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./painter/RenderPass".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){Object.defineProperty(a,"__esModule",{value:!0});c=function(){return function(){}}();a.PainterOptions=c;c=function(){function a(a){this.context=a;this._blitRenderer=new f.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:k.brushes.Marker,line:k.brushes.Line,fill:k.brushes.Fill,text:k.brushes.Text,label:k.brushes.Label,clip:k.brushes.Clip,stencil:k.brushes.Stencil,bitmap:k.brushes.Bitmap,tileInfo:k.brushes.TileInfo,
vtlBackground:k.brushes.VTLBackground,vtlFill:k.brushes.VTLFill,vtlLine:k.brushes.VTLLine,vtlCircle:k.brushes.VTLCircle,vtlSymbol:k.brushes.VTLSymbol};this.textureManager=new b;this.effects={highlight:new m.default,hittest:new r.HittestEffect,integrate:new d.AnimationEffect};this.materialManager=new p(a);this._vtlProgramCache=new h.default(a)}a.prototype.getFbos=function(a,b){if(a!==this._lastWidth||b!==this._lastHeight){this._lastWidth=a;this._lastHeight=b;if(this._fbos)for(var d in this._fbos)this._fbos[d].dispose();
d={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a,height:b};var e={colorTarget:0,depthStencilTarget:3};a=new g.Renderbuffer(this.context,{width:a,height:b,internalFormat:34041});this._fbos={output:new g.FramebufferObject(this.context,e,d,a),alpha:new g.FramebufferObject(this.context,e,d,a),effect0:new g.FramebufferObject(this.context,e,d,a)}}return this._fbos};a.prototype.beforeRenderLayers=function(a){var b=a.getViewport(),b=this.getFbos(b.width,b.height);this._prevFBO=
a.getBoundFramebufferObject();a.bindFramebuffer(b.output);a.setDepthWriteEnabled(!0);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT);a.setDepthWriteEnabled(!1)};a.prototype.beforeRenderLayer=function(a,b,d){1!==d?(a.bindFramebuffer(this._fbos.alpha),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT)):a.bindFramebuffer(this._fbos.output);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setClearStencil(b);a.setStencilWriteMask(255);
a.clear(a.gl.STENCIL_BUFFER_BIT)};a.prototype.compositeLayer=function(a,b){1!==b&&(a.bindFramebuffer(this._fbos.output),a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.alpha.colorTexture,9728,b))};a.prototype.renderLayers=function(a){a.bindFramebuffer(this._prevFBO);this._fbos&&(a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,
771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.output.colorTexture,9728,1))};a.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(a){return a.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var a in this._fbos)this._fbos[a]&&
this._fbos[a].dispose();if(this.effects)for(var b in this.effects)this.effects[b]&&this.effects[b].dispose();this._prevFBO=null};a.prototype.getGeometryBrush=function(a){var b;a=(b={},b[e.WGLGeometryType.FILL]=k.brushes.Fill,b[e.WGLGeometryType.LINE]=k.brushes.Line,b[e.WGLGeometryType.MARKER]=k.brushes.Marker,b[e.WGLGeometryType.TEXT]=k.brushes.Text,b)[a];b=this._brushCache.get(a);void 0===b&&(b=new a,this._brushCache.set(a,b));return this._brushCache.get(a)};a.prototype.renderObject=function(a,b,
d,e){d=this.brushNameToCtor[d];if(!d)return null;var c=this._brushCache.get(d);void 0===c&&(c=new d,this._brushCache.set(d,c));c.prepareState(a,b,e);c.draw(a,b,e)};a.prototype.renderObjects=function(a,b,d,e){d=this.brushNameToCtor[d];if(!d)return null;var c=this._brushCache.get(d);void 0===c&&(c=new d,this._brushCache.set(d,c));c.drawMany(a,b,e)};a.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};a.prototype.registerRenderPass=function(a){var b=this,d=a.brushes.map(function(a){b._brushCache.has(a)||
b._brushCache.set(a,new a);return b._brushCache.get(a)});return new n.default(d,a)};a.prototype.setHighlightOptions=function(a){this.effects.highlight.setHighlightOptions(a)};return a}();a.default=c})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this._cache=Array(8);for(var c=0;8>c;c++)this._cache[c]={};this._programRepo=
new l.ProgramCache(a)}a.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};a.prototype.getProgram=function(a,c,e){var f=this._cache[a];f[c]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),e),f[c]=a);return f[c]};a.prototype.getProgramAttributes=function(a){switch(a){case 0:return g.background.attributes;case 5:return g.circle.attributes;case 1:return g.fill.attributes;case 4:return g.icon.attributes;case 3:return g.line.attributes;case 2:return g.outline.attributes;
case 6:return g.text.attributes;default:return null}};a.prototype._getProgramTemplate=function(a){switch(a){case 0:return g.background;case 5:return g.circle;case 1:return g.fill;case 4:return g.icon;case 3:return g.line;case 2:return g.outline;case 6:return g.text;default:return null}};return a}();a.default=c})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(c,a,l,g){Object.defineProperty(a,"__esModule",
{value:!0});a.background={name:"background",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+g.resolveIncludes("background/background.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+g.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};a.circle={name:"circle",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id})+g.resolveIncludes("circle/circle.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id})+g.resolveIncludes("circle/circle.frag")}},
attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var k=function(a){return l.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.fill={name:"fill",shaders:function(a){return{vertexShader:k(a)+g.resolveIncludes("fill/fill.vert"),fragmentShader:k(a)+g.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};a.outline={name:"outline",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("outline/outline.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,
DD:a.dd})+g.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};a.icon={name:"icon",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}};var h=function(a){return l.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};
a.line={name:"line",shaders:function(a){return{vertexShader:h(a)+g.resolveIncludes("line/line.vert"),fragmentShader:h(a)+g.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};a.text={name:"text",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("text/text.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,
a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});var k=new l.ShaderCompiler(function(a){var c=g;a.split("/").forEach(function(a){c&&(c=c[a])});return c});a.resolveIncludes=function(a){return k.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require",
"exports"],function(c,a){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(c,
a,l,g,k,h,f){var e=function(a){return a===h.WGLDrawPhase.HITTEST||a===h.WGLDrawPhase.LABEL_ALPHA},p=function(a,d,c,f){f=f.reduce(function(b,d){var e;return l({},b,(e={},e[d]=a.driverTestResult[d],e))},{});d=l({},d.getVariation(),a.rendererInfo.getVariation(),{highlight:a.drawPhase===h.WGLDrawPhase.HIGHLIGHT,id:e(a.drawPhase)},f);if(g.isSome(c))for(f=0;f<c.length;f++)d[c[f]]=!0;return d};return function(){function a(a){this._programByKey=new Map;this._programCache=new k.ProgramCache(a)}a.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};a.prototype.getProgram=function(a,b,e,c){void 0===e&&(e=[]);void 0===c&&(c=[]);var d=b.path+e.join(".")+c.join(".");if(this._programByKey.has(d))return this._programByKey.get(d);c=c.reduce(function(b,d){var e;return l({},b,(e={},e[d]=a.driverTestResult[d],e))},{});e=l({},e.reduce(function(a,b){var d;return l({},a,(d={},d[b]=!0,d))},{}),c);b=this._programCache.getProgram(f.createProgramTemplate(b.path,b.attributes),e);if(!b)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(d,b);return b};a.prototype.getMaterialProgram=function(a,b,c,k,l,y){void 0===y&&(y=["ignoresSamplerPrecision"]);var d,m=y;d=a.rendererInfo;var n=a.drawPhase,m=b.getVariationHash()+"-"+m.join(".")+"-",n=(e(n)?1:0)|(n===h.WGLDrawPhase.HIGHLIGHT?2:0);d=m+n+"-"+d.getVariationHash()+"-"+(g.isSome(l)&&l.join("."));if(this._programByKey.has(d))return this._programByKey.get(d);a=p(a,b,l,y);c=this._programCache.getProgram(f.createProgramTemplate(c,k),a);if(!c)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(d,c);return c};return a}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});var k=function(a){var c={},e;for(e in a){for(var h=e,b=void 0,b=""+h[0].toUpperCase(),d=1;d<h.length;d++){var g=h[d];g===g.toUpperCase()?(b+="_",b+=g):b+=g.toUpperCase()}c[b]=a[e]}return l.glslifyDefineMap(c)};a.createProgramTemplate=function(a,c){var e=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:c,shaders:function(a){return{vertexShader:k(a)+g.resolveIncludes(e+".vert"),fragmentShader:k(a)+g.resolveIncludes(e+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./util/Result ./util/symbolUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C){var D=m.vec2f32.create(),B=p.getLogger("esri.views.2d.engine.webgl.TextureManager"),E=function(){function a(a,b,d){this.mosaicType=a;this.page=b;this.sdf=d}a.fromMosaic=function(b,d){return new a(b,d.page,d.sdf)};return a}();return function(){function a(){this._invalidFontsMap=new Map;this._sdfConverter=new v.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new r.default;this._spriteMosaic=new z(2048,2048,500);
this._glyphSource=new t(h.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new w(1024,1024,this._glyphSource)}Object.defineProperty(a.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=
this._spriteMosaic=null};a.prototype._hashMosaic=function(a,b){return 1|a<<1|(b.sdf?1:0)<<2|b.page<<3};a.prototype._setTextureBinding=function(a,b){var d=this._hashMosaic(a,b);this._hashToBindingIndex.has(d)||(a=E.fromMosaic(a,b),this._hashToBindingIndex.set(d,this._bindingInfos.length+1),this._bindingInfos.push(a));b.textureBinding=this._hashToBindingIndex.get(d)};a.prototype.rasterizeItem=function(a,d,c){var f=this;void 0===d&&(d=null);return a?a.type&&-1!==a.type.toLowerCase().indexOf("3d")?(B.error(new e("mapview-invalid-type",
"MapView does not support 3d symbol type: "+a.type,a)),b.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!a.type||"text"!==a.type&&"esriTS"!==a.type&&"CIMTextSymbol"!==a.type?this._rasterizeSpriteSymbol(a,c).then(function(a){A.ok(a)&&a&&f._setTextureBinding(u.MosaicType.SPRITE,a);return{spriteMosaicItem:a}}):this._rasterizeTextSymbol(a,d,c).then(function(a){a.forEach(function(a){return f._setTextureBinding(u.MosaicType.GLYPH,a)});return{glyphMosaicItems:a}}):(B.error(new e("mapview-null-resource",
"Unable to rasterize null resource")),b.resolve(null))};a.prototype.bindTextures=function(a,b,e,c){void 0===c&&(c=1);if(0!==e.textureBinding){var f=this._bindingInfos[e.textureBinding-1];e=f.page;switch(f.mosaicType){case u.MosaicType.SPRITE:f=this.sprites.getWidth(e)/c;c=this.sprites.getHeight(e)/c;c=d.vec2.set(D,f,c);this._bindSpritePage(a,e,n.TEXTURE_BINDING_SPRITE_ATLAS,9729);b.setUniform1i("u_texture",n.TEXTURE_BINDING_SPRITE_ATLAS);b.setUniform2fv("u_mosaicSize",c);break;case u.MosaicType.GLYPH:f=
this.glyphs.width/c;c=this.glyphs.height/c;c=d.vec2.set(D,f,c);this._bindGlyphsPage(a,e,n.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform1i("u_texture",n.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform2fv("u_mosaicSize",c);break;default:B.error("mapview-texture-manager","Cannot handle unknown type "+f.mosaicType)}}};a.prototype._bindSpritePage=function(a,b,d,e){e||(e=9729);this._spriteMosaic.bind(a,e,b,d)};a.prototype._bindGlyphsPage=function(a,b,d){this._glyphMosaic.bind(a,9729,b,d)};a.prototype._rasterizeTextSymbol=
function(a,b,d){var c=this,f=y.getFullyQualifiedFontName(a.font);a=this._invalidFontsMap.has(f);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":f,b,d).catch(function(){B.error(new e("mapview-invalid-resource","Couldn't find font "+f+". Falling back to Arial Unicode MS Regular"));c._invalidFontsMap.set(f,!0);return c._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",b,d)})};a.prototype._rasterizeSpriteSymbol=function(a,b){return g(this,void 0,void 0,function(){var d,c,f,h,g,
m;return k(this,function(k){k="CIMSolidStroke"===a.type||"CIMSolidFill"===a.type?!0:a&&(C.isFillSymbol(a)||C.isLineSymbol(a))&&"style"in a&&("solid"===a.style||"esriSFSSolid"===a.style||"esriSLSSolid"===a.style||"none"===a.style||"esriSFSNull"===a.style||"esriSLSNull"===a.style);if(k)return[2,null];d=C.keyFromSymbol(a);return this._spriteMosaic.has(d)?[2,this._spriteMosaic.getSpriteItem(d)]:"simple-marker"!==a.type&&"esriSMS"!==a.type||!a.path?a.url||a.imageData?[2,this._handleImage(a,d,b)]:(c=this._rasterizer.rasterizeJSONResource(a))?
(f=c.size,h=c.image,g=c.sdf,m=c.simplePattern,[2,this._addItemToMosaic(d,f,h,!C.isMarkerSymbol(a),g,m)]):[2,new e("TextureManager","unrecognized or null rasterized image")]:[2,this._handleSVG(a,d,b)]})})};a.prototype._handleSVG=function(a,b,d){return g(this,void 0,void 0,function(){var e,c;return k(this,function(f){switch(f.label){case 0:return e=[126,126],[4,this._sdfConverter.draw(a.path,d)];case 1:return c=f.sent(),[2,this._addItemToMosaic(b,e,new Uint32Array(c.buffer),!1,!0,!0)]}})})};a.prototype._handleImage=
function(a,d,c){return g(this,void 0,void 0,function(){var h,g,m,n,p,v,t;return k(this,function(k){switch(k.label){case 0:h=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url,k.label=1;case 1:return k.trys.push([1,3,,4]),[4,f(h,l({responseType:"image"},c))];case 2:return g=k.sent().data,m=this._rasterizer.rasterizeImageResource(g,a.colorSubstitutions),n=m.size,p=m.sdf,v=m.image,[2,this._addItemToMosaic(d,n,v,!C.isMarkerSymbol(a),p,!1)];case 3:return t=k.sent(),b.isAbortError(t)?[3,4]:
[2,new e("mapview-invalid-resource","Could not fetch requested resource at "+h)];case 4:return[2,void 0]}})})};a.prototype._addItemToMosaic=function(a,b,d,e,c,f){return this._spriteMosaic.addSpriteItem(a,b,d,e,c,f)};return a}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};
a.prototype.rasterizeJSONResource=function(a,e){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return e=l.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style),{size:[e[1],e[2]],image:new Uint32Array(e[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return e=l.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[e[1],e[2]],image:new Uint32Array(e[0].buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var c;a="simple-marker"===a.type||"esriSMS"===a.type?l.CIMSymbolHelper.fromSimpleMarker(a):a;if((c=g.getSDFInfo(a))&&!e)return e=g.buildSDF(c),(a=e[0])?{size:[e[1],e[2]],image:new Uint32Array(a.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;e=l.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!e);a=e[0];c=e[3];var b=e[4];return a?{size:[e[1],e[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:c,anchorY:b}:null};a.prototype.rasterizeImageResource=
function(a,e){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var c=this._rasterizationCanvas.getContext("2d");c.drawImage(a,0,0,a.width,a.height);c=c.getImageData(0,0,a.width,a.height);c=new Uint8Array(c.data);if(e)for(var b=0;b<e.length;b++){var d=e[b];if(d&&d.oldColor&&4===d.oldColor.length&&d.newColor&&4===d.newColor.length){var f=d.oldColor,h=f[0],g=f[1],l=f[2],f=f[3],y=d.newColor,
d=y[0],w=y[1],t=y[2],v=y[3];if(h!==d||g!==w||l!==t||f!==v)for(y=0;y<c.length;y+=4)h===c[y]&&g===c[y+1]&&l===c[y+2]&&f===c[y+3]&&(c[y]=d,c[y+1]=w,c[y+2]=t,c[y+3]=v)}}for(y=0;y<c.length;y+=4)e=c[y+3]/255,c[y]*=e,c[y+1]*=e,c[y+2]*=e;e=a.width;b=a.height;h=c;if(512<=e||512<=b)h=a.width/a.height,1<h?(e=512,b=Math.round(512/h)):(b=512,e=Math.round(512*h)),h=new Uint8Array(4*e*b),k.resampleHermite(c,a.width,a.height,new Uint8ClampedArray(h.buffer),e,b,!1);return{size:[e,b],image:new Uint32Array(h.buffer),
sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();a.default=c})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports ../../Color ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMCursor ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){function m(a,b){switch(b.type){case "CIMSymbolReference":var d={type:"point",x:0,y:0};a.drawSymbol(b.symbol,d);break;case "CIMPointSymbol":d=
{type:"point",x:0,y:0};a.drawSymbol(b,d);break;case "CIMVectorMarker":d=new p.Placement,a.drawMarker(b,d)}return a.envelope()}Object.defineProperty(a,"__esModule",{value:!0});var r=Math.PI,n=r/2,u=g.getLogger("esri.symbols.cim.CIMSymbolHelper");c=function(){function a(){}a.getEnvelope=function(a){var d=new b.EnvDrawHelper;if(Array.isArray(a)){for(var e=void 0,c=0;c<a.length;c++){var f=a[c];e?e.union(m(d,f)):e=m(d,f)}return e}return m(d,a)};a.getTextureAnchor=function(a){a=this.getEnvelope(a);if(!a||
0>=a.width||0>=a.height)return[0,0];var b=96/72;return[(a.x+.5*a.width)*b/(a.width*b+2),-(a.y+.5*a.height)*b/(a.height*b+2)]};a.rasterize=function(a,d,e){void 0===e&&(e=!0);var c=this.getEnvelope(d);if(!c||0>=c.width||0>=c.height)return[null,0,0,0,0];var f=96/72,h=(c.x+.5*c.width)*f,g=(c.y+.5*c.height)*f;a.width=c.width*f+2;a.height=c.height*f+2;c=a.getContext("2d");f=b.Transformation.createScale(f,-f);f.translate(.5*a.width-h,.5*a.height+g);f=new b.CanvasDrawHelper(c,f);switch(d.type){case "CIMPointSymbol":f.drawSymbol(d,
{type:"point",x:0,y:0});break;case "CIMVectorMarker":var m=new p.Placement;f.drawMarker(d,m)}d=c.getImageData(0,0,a.width,a.height);d=new Uint8Array(d.data);if(e)for(e=void 0,c=0;c<d.length;c+=4)e=d[c+3]/255,d[c]*=e,d[c+1]*=e,d[c+2]*=e;return[d,a.width,a.height,-h/a.width,-g/a.height]};a.fromSimpleMarker=function(a){var b,d,e=a.style;if("circle"===e||"esriSMSCircle"===e){b=Math.acos(.995);d=Math.ceil(r/b/4);0===d&&(d=1);b=n/d;d*=4;e=[];e.push([50,0]);for(var c=1;c<d;c++)e.push([50*Math.cos(c*b),-50*
Math.sin(c*b)]);e.push([50,0]);b={rings:[e]};d={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===e||"esriSMSCross"===e)b=0,b={rings:[[[b,50],[b,b],[50,b],[50,-b],[b,-b],[b,-50],[-b,-50],[-b,-b],[-50,-b],[-50,b],[-b,b],[-b,50],[b,50]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===e||"esriSMSDiamond"===e)b={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===e||"esriSMSSquare"===e)b={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],
[-50,-50]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===e||"esriSMSX"===e)b=0,b={rings:[[[0,b],[50-b,50],[50,50-b],[b,0],[50,b-50],[50-b,-50],[0,-b],[b-50,-50],[-50,b-50],[-b,0],[-50,50-b],[b-50,50],[0,b]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===e||"esriSMSTriangle"===e)d=2/3*100,e=d-100,b={rings:[[[-57.735026918962575,e],[0,d],[57.735026918962575,e],[-57.735026918962575,e]]]},d={xmin:-57.735026918962575,ymin:e,xmax:57.735026918962575,ymax:d};var f;b&&d&&(f=[{type:"CIMSolidFill",
enable:!0,color:a.color}],a.outline&&f.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),f={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:d,markerGraphics:[{type:"CIMMarkerGraphic",geometry:b,symbol:{type:"CIMPolygonSymbol",symbolLayers:f}}]}]});return f};a.getFillColor=function(b){if(!b)return null;switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers){var d=0;for(b=
b.symbolLayers;d<b.length;d++){var e=a.getFillColor(b[d]);if(null!=e)return e}}break;case "CIMTextSymbol":return a.getFillColor(b.symbol);case "CIMSolidFill":return b.color}};a.getStrokeColor=function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<b.length;d++){var e=a.getStrokeColor(b[d]);if(void 0!==e)return e}}break;case "CIMTextSymbol":return a.getStrokeColor(b.symbol);case "CIMSolidStroke":return b.color}};a.getStrokeWidth=
function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<b.length;d++){var e=a.getStrokeWidth(b[d]);if(void 0!==e)return e}}break;case "CIMTextSymbol":return a.getStrokeWidth(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}};a.getSize=function(b){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var d=0;if(b.symbolLayers){var e=0;for(b=b.symbolLayers;e<
b.length;e++){var c=a.getSize(b[e]);c>d&&(d=c)}}return d;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return b.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return b.size}};a.getMarkerScaleRatio=function(a){if(a)switch(a.type){case "CIMVectorMarker":if(!1!==a.scaleSymbolsProportionally&&a.frame)return a.size/(a.frame.ymax-a.frame.ymin)}return 1};a.executeEffects=function(a,b,d){void 0===d&&(d=!1);var c=96/72,f=a?a.length:0;f&&d&&--f;for(d=
0;d<f;++d){var h=a[d];if(h){var g=e.getEffectOperator(h);g&&(b=g.execute(b,h,c))}}return b};a.processEffects=function(b,d,e){var c;b.effects&&0<b.effects.length&&(c=h.deltaEncodeGeometry(e),c=new f.SimpleGeometryCursor(c),c=a.executeEffects(b.effects,c));b=b.symbolLayers[d];b.effects&&0<b.effects.length&&(d=!1,"CIMGeometricEffectDashes"===b.effects[b.effects.length-1].type&&(d=!0),c||(c=h.deltaEncodeGeometry(e),c=new f.SimpleGeometryCursor(c)),c=a.executeEffects(b.effects,c,d));if(!c)return e;e=[];
for(b=c.next();b;)e.push(b),b=c.next();c=e.length;switch(c){case 0:return null;case 1:return h.deltaEncodeGeometry(e[0]);default:b=e[0];for(d=1;d<c;++d){var g=e[d];k.isPolygon(b)&&k.isPolygon(g)&&Array.prototype.push.apply(b.rings,g.rings);k.isPolyline(b)&&k.isPolyline(g)&&Array.prototype.push.apply(b.paths,g.paths)}return h.deltaEncodeGeometry(b)}};return a}();a.CIMSymbolHelper=c;c=function(){function a(){}a.rasterizeSimpleFill=function(a,b){"solid"!==b&&"none"!==b&&"esriSFSSolid"!==b&&"esriSFSNull"!==
b||console.error("Unexpected: style does not require rasterization");a.width=8;a.height=8;var d=a.getContext("2d");d.strokeStyle="#FFFFFF";d.lineWidth=1;d.beginPath();if("vertical"===b||"cross"===b||"esriSFSCross"===b||"esriSFSVertical"===b)d.moveTo(0,0),d.lineTo(0,8);if("horizontal"===b||"cross"===b||"esriSFSCross"===b||"esriSFSHorizontal"===b)d.moveTo(0,0),d.lineTo(8,0);if("forward-diagonal"===b||"diagonal-cross"===b||"esriSFSDiagonalCross"===b||"esriSFSForwardDiagonal"===b)d.moveTo(0,0),d.lineTo(8,
8);if("backward-diagonal"===b||"diagonal-cross"===b||"esriSFSBackwardDiagonal"===b||"esriSFSDiagonalCross"===b)d.moveTo(8,0),d.lineTo(0,8);d.stroke();b=d.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);for(var e=0;e<b.length;e+=4)d=b[e+3]/255,b[e]*=d,b[e+1]*=d,b[e+2]*=d;return[b,a.width,a.height]};a.rasterizeSimpleLine=function(a,b){switch(b){case "butt":b="Butt";break;case "square":b="Square";break;default:b="Round"}var d="Butt"===b;switch(a){case "dash":case "esriSLSDash":a=d?[4,3]:
[3,4];break;case "dash-dot":case "esriSLSDashDot":a=d?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":a=d?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":a=d?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":a=d?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":a=d?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":a=d?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=d?[4,1,1,1]:[3,2,0,2];break;
case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=d?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=d?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":u.error("Unexpected: style does not require rasterization");a=[0,0];break;default:u.error("Tried to rasterize SLS, but found an unexpected style: "+a+"!"),a=[0,0]}return this.rasterizeDash(a,b)};a.rasterizeDash=function(a,b){var e="Butt"===b,c="Square"===b;b=!e&&!c;for(var f=0,h=0;h<a.length;h++)var g=
a[h],f=f+g;for(var f=15*f,m=31*f,h=new Float32Array(m),k=b?225:15,g=0;g<m;++g)h[g]=k;for(var k=m=0,n=!0,p=0;p<a.length;p++){for(var g=a[p],m=k,k=k+15*g,l=m;l<k;){for(var t=0;31>t;){var g=t*f+l,r=b?(t-15)*(t-15):Math.abs(t-15);h[g]=n?e?Math.max(Math.max(m+7.5-l,r),Math.max(l-k+7.5,r)):r:b?Math.min((l-m)*(l-m)+r,(l-k)*(l-k)+r):c?Math.min(Math.max(l-m,r),Math.max(k-l,r)):Math.min(Math.max(l-m+7.5,r),Math.max(k+7.5-l,r));t++}l++}n=!n}a=h.length;e=new Uint8Array(4*a);for(g=0;g<a;++g)d.packFloatRGBA((b?
Math.sqrt(h[g]):h[g])/15,e,4*g);return[e,f,31]};return a}();a.SymbolHelper=c;c=function(){function a(){}a.findApplicableOverrides=function(b,d,e){if(d){if(b.primitiveName){for(var c=!1,f=0;f<e.length;f++){var h=e[f];if(h.primitiveName===b.primitiveName){c=!0;break}}if(!c)for(c=0;c<d.length;c++)h=d[c],h.primitiveName===b.primitiveName&&e.push(h)}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(c=0,f=b.effects;c<f.length;c++)h=f[c],a.findApplicableOverrides(h,
d,e);if(b.symbolLayers)for(h=0,b=b.symbolLayers;h<b.length;h++)a.findApplicableOverrides(b[h],d,e);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(b.effects)for(c=0,f=b.effects;c<f.length;c++)h=f[c],a.findApplicableOverrides(h,d,e);b.markerPlacement&&a.findApplicableOverrides(b.markerPlacement,d,e);if("CIMVectorMarker"===
b.type){if(b.markerGraphics)for(h=0,b=b.markerGraphics;h<b.length;h++)c=b[h],a.findApplicableOverrides(c,d,e),a.findApplicableOverrides(c.symbol,d,e)}else"CIMCharacterMarker"===b.type?a.findApplicableOverrides(b.symbol,d,e):"CIMHatchFill"===b.type&&a.findApplicableOverrides(b.lineSymbol,d,e)}}};a.applyOverrides=function(b,d,e,c){if(d){if(b.primitiveName)for(var f=0;f<d.length;f++){var h=d[f];if(h.primitiveName===b.primitiveName){var g;g=(g=h.propertyName)?g.charAt(0).toLowerCase()+g.substr(1):g;c&&
c.push({cim:b,nocapPropertyName:g,value:b[g]});h.expression&&(h.value=a.toValue(h.propertyName,h.expression));if(e){for(var m=!1,k=0,n=e;k<n.length;k++)n[k].primitiveName===b.primitiveName&&(m=!0);m||e.push(h)}b[g]=h.value}}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(h=0,g=b.effects;h<g.length;h++)f=g[h],a.applyOverrides(f,d,e,c);if(b.symbolLayers)for(f=0,b=b.symbolLayers;f<b.length;f++)a.applyOverrides(b[f],d,e,c);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(b.effects)for(h=
0,g=b.effects;h<g.length;h++)f=g[h],a.applyOverrides(f,d,e,c);if("CIMVectorMarker"===b.type&&b.markerGraphics)for(f=0,b=b.markerGraphics;f<b.length;f++)h=b[f],a.applyOverrides(h,d,e,c),a.applyOverrides(h.symbol,d,e,c)}}};a.restoreOverrides=function(a){for(var b=0;b<a.length;b++){var d=a[b];d.cim[d.nocapPropertyName]=d.value}};a.buildOverrideKey=function(a){for(var b="",d=0;d<a.length;d++){var e=a[d];void 0!==e.value&&(b+=""+e.primitiveName+e.propertyName+JSON.stringify(e.value))}return b};a.toValue=
function(a,b){return"DashTemplate"===a?b.split(" ").map(function(a){return Number(a)}):"Color"===a?(a=(new l(b)).toRgba(),a[3]*=255,a):b};return a}();a.OverrideHelper=c})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../geometry/support/jsonUtils","./CIMPlacements"],function(c,a,l,g){function k(a){if(a)for(var b=a.length-1;0<b;--b)a[b][0]-=a[b-1][0],a[b][1]-=a[b-1][1]}function h(a){if(a)for(var b=0;b<a.length;b++)k(a[b])}function f(a){if(a)for(var b=a.length,d=1;d<b;++d)a[d][0]+=
a[d-1][0],a[d][1]+=a[d-1][1]}function e(a){if(a)for(var b=0;b<a.length;b++)f(a[b])}function p(a){a&&a.reverse()}function b(a){return{rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}Object.defineProperty(a,"__esModule",{value:!0});a.deltaEncodePath=k;a.deltaEncodeMultipath=h;a.deltaDecodeGeometry=function(a){l.isPolygon(a)?e(a.rings):l.isPolyline(a)?e(a.paths):l.isMultipoint(a)&&f(a.points);return a};a.deltaEncodeGeometry=function(a){l.isPolygon(a)?h(a.rings):
l.isPolyline(a)?h(a.paths):l.isMultipoint(a)&&k(a.points);return a};a.reverseMultipath=function(a){if(a)for(var b=0;b<a.length;b++)p(a[b])};a.reversePath=p;a.getCoord2D=function(a,b,e){return[a[0]+(b[0]-a[0])*e,a[1]+(b[1]-a[1])*e]};a.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};a.getId=function(a){return a[4]};a.setId=function(a,b){a[4]=b};c=function(){function a(a,d,e,c){this.acceptPolygon=d;this.acceptPolyline=e;this.geomUnitsPerPoint=
c;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(l.isPolygon(a)?d&&(this.multiPath=a.rings,this.isClosed=!0):l.isPolyline(a)?e&&(this.multiPath=a.paths,this.isClosed=!1):l.isExtent(a)&&d&&(this.multiPath=b(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new g.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var a=this.processPath(this.multiPath[this.pathIndex]);
if(a)return a}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}();a.PathTransformationCursor=c;c=function(){function a(a,b,d,e){this.inputGeometries=a;this.acceptPolygon=b;this.acceptPolyline=d;this.geomUnitsPerPoint=e;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(l.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):l.isPolyline(a)?this.acceptPolyline&&
(this.multiPath=a.paths,this.isClosed=!1):l.isExtent(a)&&this.acceptPolygon&&(this.multiPath=b(a).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();a.PathGeometryCursor=
c})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this.setIdentity()}a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,c){this.tx=a;this.ty=c};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,c){this.rz=void 0;this.rz_c=a;this.rz_s=c};a.prototype.setRotate=
function(a){this.rz=a;this.rz_s=this.rz_c=void 0};a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=a};return a}();a.Placement=c;c=function(){function a(){}a.prototype.next=function(){return null};return a}();a.EmptyPlacementCursor=c})},"esri/symbols/cim/CIMEffects":function(){define(["require","exports","../../core/lang"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this._geometry=
a}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a};return a}();a.SimpleGeometryCursor=c;a.clone=function(a){return l.clone(a)}})},"esri/symbols/cim/CIMOperators":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.getEffectOperator=function(a){return null};a.getPlacementOperator=function(a){return null}})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./Rect".split(" "),
function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var d=k.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),m=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var b=this._t;return[b[0]*a[0]+b[1]*a[1]+b[2],b[3]*a[0]+b[4]*a[1]+b[5]]};a.createScale=function(b,d){return new a([b,0,0,0,d,0])};a.prototype.scale=function(a,
b){var d=this._t;d[0]*=a;d[1]*=a;d[2]*=a;d[3]*=b;d[4]*=b;d[5]*=b;return this};a.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(b,d){return new a([0,0,b,0,0,d])};a.prototype.translate=function(a,b){var d=this._t;d[2]+=a;d[5]+=b;return this};a.createRotate=function(b){var d=Math.cos(b);b=Math.sin(b);return new a([d,-b,0,b,d,0])};a.prototype.rotate=function(b){return this.multiply(a.createRotate(b))};a.prototype.multiply=function(a){var b=
this._t;a=a._t;var d=b[1]*a[0]+b[4]*a[1],e=b[2]*a[0]+b[5]*a[1]+a[2],c=b[0]*a[3]+b[3]*a[4],f=b[1]*a[3]+b[4]*a[4],h=b[2]*a[3]+b[5]*a[4]+a[5];b[0]=b[0]*a[0]+b[3]*a[1];b[1]=d;b[2]=e;b[3]=c;b[4]=f;b[5]=h;return this};return a}();a.Transformation=m;c=function(){function b(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||m.createIdentity());this._sizeTransfos.push(a?a.scaleRatio():1)}b.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};b.prototype.transformSize=
function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};b.prototype.back=function(){return this._transfos[this._transfos.length-1]};b.prototype.push=function(a){var b=a.scaleRatio();a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)};b.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};b.prototype.drawSymbol=function(a,b){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,
b)}};b.prototype.drawMultiLayerSymbol=function(a,b){if(a){var d=a.symbolLayers;if(d)if(a=a.effects){if(b=this.executeEffects(a,b))for(a=b.next();a;)this.drawSymbolLayers(d,a),a=b.next()}else this.drawSymbolLayers(d,b)}};b.prototype.executeEffects=function(a,b){var d=96/72;b=new f.SimpleGeometryCursor(b);for(var c=a?a.length:0,h=0;h<c;++h){var g=a[h];if(g){var m=e.getEffectOperator(g);m&&(b=m.execute(b,g,d))}}return b};b.prototype.drawSymbolLayers=function(a,b){for(var d=a.length;d--;){var e=a[d];
if(e&&!1!==e.enable){var c=e.effects;if(c){if(c=this.executeEffects(c,b))for(var f=c.next();f;)this.drawSymbolLayer(e,f),f=c.next()}else this.drawSymbolLayer(e,b)}}};b.prototype.drawSymbolLayer=function(a,b){switch(a.type){case "CIMSolidFill":this.drawSolidFill(b,a.color);break;case "CIMSolidStroke":this.drawSolidStroke(b,a.color,a.width);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(a,b)}};b.prototype.drawMarkerLayer=function(a,b){var d=a.markerPlacement;
if(d){var c=96/72,f=e.getPlacementOperator(d);if(f&&(b=f.execute(b,d,c)))for(d=b.next();d;)this.drawMarker(a,d),d=b.next()}else d=new p.Placement,d.tx=b.x,d.ty=b.y,this.drawMarker(a,d)};b.prototype.drawMarker=function(a,b){switch(a.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(a,b);break;case "CIMVectorMarker":this.drawVectorMarker(a,b)}};b.prototype.drawPictureMarker=function(a,b){};b.prototype.drawVectorMarker=function(b,e){if(b){var c=b.markerGraphics;if(c){var f=
b.size,h=b.frame,g=h?h.ymax-h.ymin:0,f=f&&g?f/g:1,g=m.createIdentity();h&&g.translate(.5*-(h.xmax+h.xmin),.5*-(h.ymax+h.ymin));var k=b.anchorPoint;if(k){var n=k.x,k=k.y;"Absolute"!==b.anchorPointUnits&&h&&(n*=h.xmax-h.xmin,k*=h.ymax-h.ymin);g.translate(-n,-k)}1!==f&&g.scale(f,f);b.rotation&&g.rotate(b.rotation*a.C_DEG_TO_RAD);g.translate(b.offsetX||0,b.offsetY||0);g.translate(e.tx,e.ty);this.push(g);for(b=0;b<c.length;b++)(e=c[b])&&e.symbol&&e.geometry||d.error("Invalid marker graphic",e),this.drawSymbol(e.symbol,
e.geometry);this.pop()}}};return b}();a.CIMSymbolDrawHelper=c;g=function(a){function d(){var b=a.call(this)||this;b.reset();return b}l(d,a);d.prototype.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity};d.prototype.envelope=function(){return new b.default(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};d.prototype._merge=function(a,b){a[0]-b<this._xmin&&(this._xmin=a[0]-b);a[0]+b>this._xmax&&(this._xmax=a[0]+b);a[1]-b<this._ymin&&(this._ymin=a[1]-
b);a[1]+b>this._ymax&&(this._ymax=a[1]+b)};d.prototype.drawSolidFill=function(a){if(a&&a.rings){var b=0;for(a=a.rings;b<a.length;b++){var d=a[b],e=d?d.length:0;if(2<e){this._merge(this.transformPt(d[0]),0);for(var c=1;c<e;++c)this._merge(this.transformPt(d[c]),0)}}}};d.prototype.drawSolidStroke=function(a,b,d){b=.5*this.transformSize(d);if(a=h.isPolygon(a)?a.rings:a.paths)for(d=0;d<a.length;d++){var e=a[d],c=e?e.length:0;if(1<c){this._merge(this.transformPt(e[0]),b);for(var f=1;f<c;++f)this._merge(this.transformPt(e[f]),
b)}}};return d}(c);a.EnvDrawHelper=g;c=function(a){function b(b,d){d=a.call(this,d)||this;d._ctx=b;return d}l(b,a);b.prototype.drawSolidFill=function(a,b){if(a&&a.rings){var d=this._ctx;d.fillStyle="string"===typeof b?b:"rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";d.beginPath();b=0;for(a=a.rings;b<a.length;b++){var e=a[b],c=e?e.length:0;if(2<c){var f=this.transformPt(e[0]);d.moveTo(f[0],f[1]);for(var h=1;h<c;++h)f=this.transformPt(e[h]),d.lineTo(f[0],f[1]);d.closePath()}}d.fill("evenodd")}};
b.prototype.drawSolidStroke=function(a,b,d){var e=this._ctx;e.strokeStyle="string"===typeof b?b:"rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";e.lineWidth=this.transformSize(d)+.5;e.beginPath();b=!1;h.isPolygon(a)?(d=a.rings,b=!0):d=a.paths;for(a=0;a<d.length;a++){var c=d[a],f=c?c.length:0;if(1<f){var g=this.transformPt(c[0]);e.moveTo(g[0],g[1]);for(var m=1;m<f;++m)g=this.transformPt(c[m]),e.lineTo(g[0],g[1]);b&&e.closePath()}}e.stroke()};return b}(c);a.CanvasDrawHelper=
c})},"esri/symbols/cim/Rect":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c,h,f){void 0===a&&(a=0);void 0===c&&(c=0);void 0===h&&(h=0);void 0===f&&(f=0);this.x=a;this.y=c;this.width=h;this.height=f}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=
Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=c})},"esri/symbols/cim/packingUtils":function(){define(["require","exports"],function(c,a){function l(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var g=[1,256,65536,16777216],k=[1/256,1/65536,1/16777216,1/4294967296],h=function(a,e){void 0===e&&(e=0);for(var c=0,b=0;4>b;b++)c+=a[e+b]*k[b];return c}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,e,c){void 0===
c&&(c=0);a=0>a?0:a>h?h:a;for(var b=0;4>b;b++)e[c+b]=Math.floor(256*l(a*g[b]))}})},"esri/symbols/cim/SDFHelper":function(){define(["require","exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(c,a,l,g,k){function h(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;return h(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var e=a[0];if(!e)break;a=e.geometry;if(!a)break;e=e.symbol;if(!e||"CIMPolygonSymbol"!==
e.type&&"CIMLineSymbol"!==e.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===e.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function f(a){for(var e=Infinity,b=-Infinity,d=Infinity,c=-Infinity,f=0;f<a.length;f++)for(var h=0,g=a[f];h<g.length;h++){var k=g[h];k[0]<e&&(e=k[0]);k[0]>b&&(b=k[0]);k[1]<d&&(d=k[1]);k[1]>c&&(c=k[1])}return[e,d,b,c]}Object.defineProperty(a,"__esModule",{value:!0});a.getSDFInfo=h;a.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;
a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};a.getExtent=function(a){return a?a.rings?f(a.rings):a.paths?f(a.paths):l.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};a.getSDFMetrics=function(a,c,b,d,f){var e=a[0],h=a[1],g=a[2];a=a[3];if(g<e||a<h)return[0,0,0];var m=g-e,k=a-h,g=Math.floor(31.5);a=(128-2*(g+1))/Math.max(m,k);var m=Math.round(m*a),k=Math.round(k*a)+2*g,p=1;c&&(p=k/a/(c.ymax-c.ymin));var l=0,z=0;d&&(f?c&&b&&0<c.ymax-
c.ymin&&(l=d.x/((c.xmax-c.xmin)/(c.ymax-c.ymin)*b),z=d.y/b):(l=d.x,z=d.y));l=.5*(c.xmax+c.xmin)+l*(c.xmax-c.xmin);z=.5*(c.ymax+c.ymin)+z*(c.ymax-c.ymin);l=(l-e)*a+g;z=(z-h)*a+g;return[p,l/(m+2*g)-.5,-(z/k-.5)]};a.buildSDF=function(a){var e,b=a.geom;e=b?b.rings?b.rings:b.paths?b.paths:void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax?[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]:null:null;var d,b=Infinity,c=-Infinity,f=Infinity,h=-Infinity;for(d=
0;d<e.length;d++)for(var l=0,y=e[d];l<y.length;l++){var w=y[l];w[0]<b&&(b=w[0]);w[0]>c&&(c=w[0]);w[1]<f&&(f=w[1]);w[1]>h&&(h=w[1])}d=new k.default(b,f,c-b,h-f);f=Math.floor(31.5);l=(128-2*(f+1))/Math.max(d.width,d.height);b=Math.round(d.width*l)+2*f;c=Math.round(d.height*l)+2*f;h=[];for(y=0;y<e.length;y++){var t=e[y];if(t&&1<t.length){for(var w=[],v=0;v<t.length;v++){var z=t[v],A=z[0],z=z[1],A=A-d.x,z=z-d.y,A=A*l,z=z*l,A=A+(f-.5),z=z+(f-.5);w.push([A,z])}a.asFill&&(v=w.length-1,w[0][0]===w[v][0]&&
w[0][1]===w[v][1]||w.push(w[0]));h.push(w)}}d=b*c;e=Array(d);y=f*f+1;for(l=0;l<d;++l)e[l]=y;for(y=0;y<h.length;y++)for(w=h[y],v=w.length,l=1;l<v;++l){var t=w[l-1],A=w[l],C=void 0,z=void 0;t[0]<A[0]?(C=t[0],z=A[0]):(C=A[0],z=t[0]);var D=void 0,B=void 0;t[1]<A[1]?(D=t[1],B=A[1]):(D=A[1],B=t[1]);var E=Math.floor(C)-f,z=Math.floor(z)+f,D=Math.floor(D)-f,B=Math.floor(B)+f;0>E&&(E=0);z>b&&(z=b);0>D&&(D=0);B>c&&(B=c);for(var C=A[0]-t[0],F=A[1]-t[1],H=C*C+F*F;E<z;E++)for(var J=D;J<B;J++){var K=(E-t[0])*C+
(J-t[1])*F,G=void 0,I=void 0;0>K?(G=t[0],I=t[1]):K>H?(G=A[0],I=A[1]):(K/=H,G=t[0]+K*C,I=t[1]+K*F);K=(E-G)*(E-G)+(J-I)*(J-I);G=(c-J-1)*b+E;K<e[G]&&(e[G]=K)}}for(l=0;l<d;++l)e[l]=Math.sqrt(e[l]);if(a.asFill)for(a=0;a<h.length;a++)for(d=h[a],l=d.length,y=1;y<l;++y)for(w=d[y-1],v=d[y],A=t=void 0,w[0]<v[0]?(t=w[0],A=v[0]):(t=v[0],A=w[0]),z=D=void 0,w[1]<v[1]?(D=w[1],z=v[1]):(D=v[1],z=w[1]),t=Math.floor(t),A=Math.floor(A)+1,D=Math.floor(D),z=Math.floor(z)+1,t<f&&(t=f),A>b-f&&(A=b-f),D<f&&(D=f),z>c-f&&(z=
c-f);D<z;++D)if(w[1]>D!==v[1]>D){B=(c-D-1)*b;for(C=t;C<A;++C)C<(v[0]-w[0])*(D-w[1])/(v[1]-w[1])+w[0]&&(e[B+C]=-e[B+C]);for(C=f;C<t;++C)e[B+C]=-e[B+C]}f*=2;h=e.length;a=new Uint8Array(4*h);for(d=0;d<h;++d)g.packFloatRGBA(.5-e[d]/f,a,4*d);return[a,b,c]}})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.evaluateValueOrFunction=function(a,c,k,h){return"function"===typeof a?a(c,k,h):a};a.colorToArray=function(a){return[a.r,
a.g,a.b,a.a]};a.resampleHermite=function(a,c,k,h,f,e,p){void 0===p&&(p=!0);var b=c/f;k/=e;for(var d=Math.ceil(b/2),g=Math.ceil(k/2),l=0;l<e;l++)for(var n=0;n<f;n++){for(var u=4*(n+(p?e-l-1:l)*f),y=0,w=0,t=0,v=0,z=0,A=0,C=0,D=(l+.5)*k,B=Math.floor(l*k);B<(l+1)*k;B++)for(var E=Math.abs(D-(B+.5))/g,F=(n+.5)*b,E=E*E,H=Math.floor(n*b);H<(n+1)*b;H++){var J=Math.abs(F-(H+.5))/d,y=Math.sqrt(E+J*J);-1<=y&&1>=y&&(y=2*y*y*y-3*y*y+1,0<y&&(J=4*(H+B*c),C+=y*a[J+3],t+=y,255>a[J+3]&&(y=y*a[J+3]/250),v+=y*a[J],z+=
y*a[J+1],A+=y*a[J+2],w+=y))}h[u]=v/w;h[u+1]=z/w;h[u+2]=A/w;h[u+3]=C/t}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(c,a){function l(a){a=a.toLowerCase().split(" ").join("-");switch(a){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.getFullyQualifiedFontName=
function(a){var c;a:{if(a.weight)switch(a.weight.toLowerCase()){case "bold":case "bolder":c="-bold";break a}c=""}var h;a:{if(a.style)switch(a.style.toLowerCase()){case "italic":case "oblic":h="-italic";break a}h=""}c+=h;return l(a.family)+(0<c.length?c:"-regular")};a.getFontDecorationTop=function(a){switch(a){case "underline":return-26;case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),
function(c,a,l,g,k,h,f){return function(){function a(a,b,d){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=b;this._glyphSource=d;this._binPack=new f(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0);this._addDecorationGlyph()}a.prototype.getGlyphItems=function(a,b,d){for(var e=this,c=[],f=this._glyphSource,h=new Set,k=1/256,
p=0;p<b.length;p++)h.add(Math.floor(b[p]*k));var l=[];h.forEach(function(b){if(256>=b){var c=a+b;e._rangePromises.has(c)?l.push(e._rangePromises.get(c)):(b=f.getRange(a,b,d).then(function(){e._rangePromises["delete"](c)}).catch(function(a){e._rangePromises["delete"](c);if(!g.isAbortError(a))throw Error("Unable to query resource");}),e._rangePromises.set(c,b),l.push(b))}});return g.all(l).then(function(){var d,h=e._glyphIndex[a];h||(h={},e._glyphIndex[a]=h);for(var g=0;g<b.length;g++){d=b[g];var m=
h[d];if(m)c[d]={sdf:!0,rect:m.rect,metrics:m.metrics,page:m.page};else if((m=f.getGlyph(a,d))&&m.metrics){var k=e._recordGlyph(m);h[d]={rect:k,metrics:m.metrics,tileIDs:null,page:e._currentPage};c[d]={sdf:!0,rect:k,metrics:m.metrics,page:e._currentPage};e._dirties[e._currentPage]=!0}}return c})};a.prototype._recordGlyph=function(a){var b=a.metrics;if(0===b.width)b=new h.default(0,0,0,0);else{var d=b.width+6,e=b.height+6,c=d%4?4-d%4:4,g=e%4?4-e%4:4;1===c&&(c=5);1===g&&(g=5);b=this._binPack.allocate(d+
c,e+g);b.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new f(this.width-4,this.height-4),b=this._binPack.allocate(d+c,e+g));c=this._glyphData[this._currentPage];a=a.bitmap;var k=g=void 0;if(a)for(var p=0;p<e;p++)for(var g=d*p,k=this.width*(b.y+p+1)+b.x,l=0;l<d;l++)c[k+l+1]=a[g+l]}return b};a.prototype._addDecorationGlyph=
function(){for(var a=[117,149,181,207,207,181,149,117],b=[],d=0;d<a.length;d++)for(var e=a[d],c=0;11>c;c++)b.push(e);a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(b)};this._recordGlyph(a)};a.prototype.bind=function(a,b,d,e){this._textures[d]||(this._textures[d]=new k.Texture(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var c=this._textures[d];c.setSamplingMode(b);this._dirties[d]&&c.setData(this._glyphData[d]);
a.bindTexture(c,e);this._dirties[d]=!1};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var d=b[a];d&&d.dispose()}this._textures.length=0;this._glyphData.length=0};return a}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(c,a,l){return function(){function a(a,c){this._height=this._width=0;this._free=[];this._width=a;this._height=c;this._free.push(new l.default(0,0,a,c))}Object.defineProperty(a.prototype,
"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});a.prototype.allocate=function(a,c){if(a>this._width||c>this._height)return new l.default;for(var f=null,e=-1,h=0;h<this._free.length;++h){var b=this._free[h];a<=b.width&&c<=b.height&&(null===f||b.y<=f.y&&b.x<=f.x)&&(f=b,e=h)}if(null===f)return new l.default;this._free.splice(e,1);f.width<f.height?(f.width>a&&this._free.push(new l.default(f.x+
a,f.y,f.width-a,c)),f.height>c&&this._free.push(new l.default(f.x,f.y+c,f.width,f.height-c))):(f.width>a&&this._free.push(new l.default(f.x+a,f.y,f.width-a,f.height)),f.height>c&&this._free.push(new l.default(f.x,f.y+c,a,f.height-c)));return new l.default(f.x,f.y,a,c)};a.prototype.release=function(a){for(var c=0;c<this._free.length;++c){var f=this._free[c];if(f.y===a.y&&f.height===a.height&&f.x+f.width===a.x)f.width+=a.width;else if(f.x===a.x&&f.width===a.width&&f.y+f.height===a.y)f.height+=a.height;
else if(a.y===f.y&&a.height===f.height&&a.x+a.width===f.x)f.x=a.x,f.width+=a.width;else if(a.x===f.x&&a.width===f.width&&a.y+a.height===f.y)f.y=a.y,f.height+=a.height;else continue;this._free.splice(c,1);this.release(a)}this._free.push(a)};return a}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),function(c,a,l,g,k,h){var f=function(){function a(a){this._metrics=
[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var e=b.getMessage(),c=void 0,f=void 0,h=void 0,g=void 0,k=void 0,p=void 0,l=void 0;e.next();)switch(e.tag()){case 1:c=e.getUInt32();break;case 2:f=e.getBytes();break;case 3:h=e.getUInt32();break;case 4:g=e.getUInt32();break;case 5:k=e.getSInt32();break;case 6:p=e.getSInt32();break;case 7:l=e.getUInt32();break;default:e.skip()}e.release();c&&(this._metrics[c]={width:h,height:g,left:k,
top:p,advance:l},this._bitmaps[c]=f);break;default:b.skip()}b.release();break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),e=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,d){this._ranges[a]=d};return a}();return function(){function a(a){this._glyphInfo={};this._baseURL=a}a.prototype.getRange=function(a,d,e){var b=
this._getFontStack(a);if(b.getRange(d))return h.resolve();var c=256*d,m=c+255;a=this._baseURL.replace("{fontstack}",a).replace("{range}",c+"-"+m);return g(a,l({responseType:"array-buffer"},e)).then(function(a){b.addRange(d,new f(new k(new Uint8Array(a.data),new DataView(a.data))))})};a.prototype.getGlyph=function(a,d){if(a=this._getFontStack(a)){var b=Math.floor(d/256);if(!(256<b)&&(a=a.getRange(b)))return{metrics:a.getMetrics(d),bitmap:a.getBitmap(d)}}};a.prototype._getFontStack=function(a){var b=
this._glyphInfo[a];b||(b=this._glyphInfo[a]=new e);return b};return a}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");this._gridOuter=new Float64Array(a*
a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,e,c){var b=this;void 0===c&&(c=31);this._initSVG();var d=this._createSVGString(a);return l.create(function(a,f){var h=new Image;h.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(d);h.onload=function(){b.context.clearRect(0,0,b.size,b.size);b.context.drawImage(h,0,0,b.size,b.size);for(var d=b.context.getImageData(0,
0,b.size,b.size),e=new Uint8Array(b.size*b.size*4),f=0;f<b.size*b.size;f++){var g=d.data[4*f+3]/255;b._gridOuter[f]=1===g?0:0===g?1E20:Math.pow(Math.max(0,.5-g),2);b._gridInner[f]=1===g?1E20:0===g?0:Math.pow(Math.max(0,g-.5),2)}b._edt(b._gridOuter,b.size,b.size);b._edt(b._gridInner,b.size,b.size);for(f=0;f<b.size*b.size;f++)k.packFloatRGBA(.5-(b._gridOuter[f]-b._gridInner[f])/(2*c),e,4*f);a(e)};var m=e&&e.signal;if(m)g.onAbort(m,function(){return f(g.createAbortError())})})};a.prototype._initSVG=
function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",a);this._svg.appendChild(e);a=e.getBBox();var c=a.width/a.height,
b=this.size/2,d,f,h;1<c?(f=d=b/a.width,h=this.size/4,c=b-1/c*b/2):(d=f=b/a.height,h=b-b*c/2,c=this.size/4);e.setAttribute("style","transform: matrix("+d+", 0, 0, "+f+", "+(-a.x*d+h)+", "+(-a.y*f+c)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(e);return a};a.prototype._edt=function(a,e,c){for(var b=this._f,d=this._d,f=this._v,h=this._z,g=0;g<e;g++){for(var k=
0;k<c;k++)b[k]=a[k*e+g];this._edt1d(b,d,f,h,c);for(k=0;k<c;k++)a[k*e+g]=d[k]}for(k=0;k<c;k++){for(g=0;g<e;g++)b[g]=a[k*e+g];this._edt1d(b,d,f,h,e);for(g=0;g<e;g++)a[k*e+g]=Math.sqrt(d[g])}};a.prototype._edt1d=function(a,e,c,b,d){c[0]=0;b[0]=-1E20;b[1]=1E20;for(var f=1,h=0;f<d;f++){for(var g=(a[f]+f*f-(a[c[h]]+c[h]*c[h]))/(2*f-2*c[h]);g<=b[h];)h--,g=(a[f]+f*f-(a[c[h]]+c[h]*c[h]))/(2*f-2*c[h]);h++;c[h]=f;b[h]=g;b[h+1]=1E20}for(h=f=0;f<d;f++){for(;b[h+1]<f;)h++;e[f]=(f-c[h])*(f-c[h])+a[c[h]]}};return a}();
a.default=c})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(c,a){function l(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var g=[1,256,65536,16777216],k=[1/256,1/65536,1/16777216,1/4294967296],h=function(a,e){void 0===e&&(e=0);for(var c=0,b=0;4>b;b++)c+=a[e+b]*k[b];return c}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,e,c){void 0===c&&(c=0);a=0>a?0:a>h?h:a;for(var b=0;4>b;b++)e[c+b]=Math.floor(256*
l(a*g[b]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/has ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(c,a,l,g,k,h,f){return function(){function a(a,b,d){void 0===d&&(d=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=l("fix-sprite-locations");this._testId=l("test-id");this._pageHeight=this._pageWidth=0;this._mosaicRects=
new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=b;0<d&&(this._maxItemSize=d);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){a=[];for(var e in this._fixSpriteLocationsTable[this._testId])b=this._fixSpriteLocationsTable[this._testId][e],a[b.page]=b.pageSize;for(e=0;e<a.length;e++)b=a[e],this._mosaicsData.push(new Uint32Array(b[0]*
b[1])),this._dirties.push(!0),this._size.push([b[0],b[1]]),this._textures.push(void 0)}this._binPack=new f(this._pageWidth,this._pageHeight);this._mosaicsData.push(new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight)));this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}a.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};a.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};
a.prototype.getPage=function(a){return a<this._textures.length?this._textures[a]:null};a.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(a.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0});a.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};a.prototype.addSpriteItem=function(a,b,d,e,c,f){var h;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var g,m;this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&
this._fixSpriteLocationsTable[this._testId][a]?(h=this._fixSpriteLocationsTable[this._testId][a],g=h.rect,m=h.page,h=h.pageSize):(h=this._allocateImage(b[0],b[1]),g=h[0],m=h[1],h=h[2]);if(0>=g.width||0>=g.height)return null;f={rect:g,width:b[0],height:b[1],sdf:c,simplePattern:f,pixelRatio:1,page:m};this._mosaicRects.set(a,f);this._copy({rect:g,spriteSize:b,spriteData:d,page:m,pageSize:h,repeat:e,sdf:c});return f};a.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};a.prototype.processNextItem=
function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};a.prototype.getSpriteItems=function(a){for(var b={},d=0;d<a.length;d++){var e=a[d];b[e]=this.getSpriteItem(e)}return b};a.prototype.getMosaicItemPosition=function(a){var b=(a=this.getSpriteItem(a))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;return{size:[a.width,a.height],tl:[(b.x+1)/this._size[a.page][0],(b.y+1)/this._size[a.page][1]],br:[(b.x+1+a.width)/this._size[a.page][0],(b.y+1+a.height)/this._size[a.page][1]],page:a.page}};
a.prototype.bind=function(a,b,d,e){void 0===d&&(d=0);void 0===e&&(e=0);this._textures[d]||(this._textures[d]=new g.Texture(a,{pixelFormat:6408,dataType:5121,width:this._size[d][0],height:this._size[d][1]},new Uint8Array(this._mosaicsData[d].buffer)));var c=this._textures[d];c.setSamplingMode(b);this._dirties[d]&&(c.setData(new Uint8Array(this._mosaicsData[d].buffer)),c.generateMipmap());a.bindTexture(c,e);this._dirties[d]=!1};a._copyBits=function(a,b,d,e,c,f,h,g,k,l,v){var m=e*b+d;h=g*f+h;if(v)for(h-=
f,v=-1;v<=l;v++,m=((v+l)%l+e)*b+d,h+=f)for(g=-1;g<=k;g++)c[h+g]=a[m+(g+k)%k];else for(v=0;v<l;v++){for(g=0;g<k;g++)c[h+g]=a[m+g];m+=b;h+=f}};a.prototype._copy=function(e){if(!(e.page>=this._mosaicsData.length)){var b=e.spriteData,d=this._mosaicsData[e.page];d&&b||console.error("Source or target images are uninitialized!");a._copyBits(b,e.spriteSize[0],0,0,d,e.pageSize[0],e.rect.x+1,e.rect.y+1,e.spriteSize[0],e.spriteSize[1],e.repeat);this._dirties[e.page]=!0}};a.prototype._allocateImage=function(a,
b){a+=2;b+=2;var d=Math.max(a,b);if(this._maxItemSize&&this._maxItemSize<d){var d=Math.pow(2,Math.ceil(k.log2(a))),e=Math.pow(2,Math.ceil(k.log2(b)));a=new h.default(0,0,a,b);this._mosaicsData.push(new Uint32Array(d*e));this._dirties.push(!0);this._size.push([d,e]);this._textures.push(void 0);return[a,this._mosaicsData.length-1,[d,e]]}d=this._binPack.allocate(a,b);return 0>=d.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,
this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new f(this._pageWidth,this._pageHeight),this._allocateImage(a,b)):[d,this._currentPage,[this._pageWidth,this._pageHeight]]};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var d=b[a];d&&d.dispose()}this._textures.length=0;this._mosaicsData.length=0;this._mosaicRects.clear()};
return a}()})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.ok=function(a,c){return a&&"name"in a?(c&&c.error(new l(a.name,a.message,a.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require","exports"],function(c,a){function l(a){switch(a){case "esriSMS":return"simple-marker";case "esriPMS":return"picture-marker";case "esriSLS":return"simple-line";
case "esriPLS":return"picture-line";case "esriSFS":return"simple-fill";case "esriPFS":return"picture-fill";case "esriTS":return"text"}return a}function g(a){if(a=l(a.type))switch(a){case "picture-marker":case "picture-line":case "picture-fill":return!0;case "CIMPictureMarker":return!0}return!1}Object.defineProperty(a,"__esModule",{value:!0});a.keyFromSymbol=function(a){if(a.type){switch(l(a.type)){case "simple-marker":return a.path?"simple-marker"+a.style+a.path:"simple-marker"+a.style;case "simple-line":return"simple-line"+
a.style+a.cap;case "simple-fill":return"simple-fill"+a.style}if(a.mosaicHash)return a.mosaicHash;if(g(a))return a.imageData?a.imageData:a.url+(""+a.width+a.height)}return JSON.stringify(a)};a.normalizeSymbolType=l;a.isMarkerSymbol=function(a){if(a=l(a.type)){switch(a){case "simple-marker":case "picture-marker":return!0;case "CIMPointSymbol":return!0;case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!0}return!1}};a.isFillSymbol=function(a){if(a=l(a.type)){switch(a){case "simple-fill":case "picture-fill":return!0;
case "CIMPolygonSymbol":return!0}return!1}};a.isLineSymbol=function(a){if(a=l(a.type)){switch(a){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}};a.isPictureSymbol=g;a.isTextSymbol=function(a){if(a=l(a.type)){switch(a){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),
function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=[];b._desc={path:"fx/integrate",attributes:{a_position:0}};return b}l(e,a);e.prototype.dispose=function(){this._quad&&this._quad.dispose()};e.prototype.bind=function(){};e.prototype.unbind=function(){};e.prototype.draw=function(a,d){if(d.size){var b=a.context,e=a.renderingOptions;this._quad||(this._quad=new h(b,[0,0,1,0,0,1,1,1]));var c=b.getBoundFramebufferObject(),
f=b.getViewport(),p=f.x,l=f.y,t=f.width,f=f.height;d.bindTextures(b);var v=d.getBlock(k.ATTRIBUTE_DATA_ANIMATION);if(!g.isNone(v)){var z=v.getFBO(b),v=v.getFBO(b,1);b.setViewport(0,0,d.size,d.size);this._computeDelta(a,v,e.labelsAnimationTime);this._updateAnimationState(a,v,z);b.bindFramebuffer(c);b.setViewport(p,l,t,f)}}};e.prototype._computeDelta=function(a,d,e){var b=a.context,c=a.displayLevel,f=a.painter.materialManager.getProgram(a,this._desc,["delta"]);b.bindFramebuffer(d);b.setClearColor(0,
0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);b.bindProgram(f);f.setUniform1i("u_maskTexture",k.TEXTURE_BINDING_ATTRIBUTE_DATA_0);f.setUniform1i("u_sourceTexture",k.TEXTURE_BINDING_ATTRIBUTE_DATA_1);f.setUniform1f("u_timeDelta",a.timeDelta);f.setUniform1f("u_animationTime",e/1E3);f.setUniform1f("u_zoomLevel",Math.round(10*c));this._quad.draw()};e.prototype._updateAnimationState=function(a,d,e){var b=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);b.bindTexture(d.colorTexture,1);
b.bindProgram(a);a.setUniform1i("u_sourceTexture",1);b.bindFramebuffer(e);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);this._quad.draw()};return e}(f.Effect);a.AnimationEffect=c})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports","../../../../core/tsSupport/declareExtendsHelper","../../../webgl"],function(c,a,l,g){return function(){function a(a,c){this.rctx=a;this._vertexBuffer=g.BufferObject.createVertex(a,35044,new Uint16Array(c));this._vao=new g.VertexArrayObject(a,
{a_position:0},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}a.prototype.bind=function(){this._vao.bind()};a.prototype.unbind=function(){this._vao.unbind()};a.prototype.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};a.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return a}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(c,
a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){return function(){this.name=this.constructor.name}}();a.Effect=c})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});
c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=["highlight"];b._hlRenderer=new e.default;b._hlGradient=new f.default;b._width=void 0;b._height=void 0;b._hlSurfaces=new p.default;b._adjustedWidth=void 0;b._adjustedHeight=void 0;b._blitRenderer=new k.BitBlitRenderer;return b}l(b,a);b.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};
b.prototype.bind=function(a){var b=a.context,d=a.painter,e=b.getViewport(),c=e.width,e=e.height,d=d.getFbos(c,e).effect0;this.setup(a,c,e);b.bindFramebuffer(d);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};b.prototype.unbind=function(){};b.prototype.setup=function(a,b,d){a=a.context;this._width=b;this._height=d;var e=b%4,c=d%4;b+=2>e?-e:4-e;d+=2>c?-c:4-c;this._adjustedWidth=b;this._adjustedHeight=d;this._boundFBO=a.getBoundFramebufferObject();b=Math.round(.75*b);d=Math.round(.75*d);this._hlRenderer.setup(a,
b,d);this._hlSurfaces.setup(a,b,d)};b.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);
this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};b.prototype.setHighlightOptions=function(a){this._hlGradient.setHighlightOptions(a)};
return b}(h.Effect);a.default=c})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(c,a,l,g,k,h){function f(a,d){d.fillColor[0]=a.color.r/255;d.fillColor[1]=a.color.g/255;d.fillColor[2]=a.color.b/255;d.fillColor[3]=a.color.a;a.haloColor?(d.outlineColor[0]=a.haloColor.r/255,d.outlineColor[1]=a.haloColor.g/255,d.outlineColor[2]=a.haloColor.b/255,d.outlineColor[3]=
a.haloColor.a):(d.outlineColor[0]=d.fillColor[0],d.outlineColor[1]=d.fillColor[1],d.outlineColor[2]=d.fillColor[2],d.outlineColor[3]=d.fillColor[3]);d.fillColor[3]*=a.fillOpacity;d.outlineColor[3]*=a.haloOpacity;d.fillColor[0]*=d.fillColor[3];d.fillColor[1]*=d.fillColor[3];d.fillColor[2]*=d.fillColor[3];d.outlineColor[0]*=d.outlineColor[3];d.outlineColor[1]*=d.outlineColor[3];d.outlineColor[2]*=d.outlineColor[3];d.outlineWidth=h.HIGHLIGHT_SIZING.outlineWidth;d.outerHaloWidth=h.HIGHLIGHT_SIZING.outerHaloWidth;
d.innerHaloWidth=h.HIGHLIGHT_SIZING.innerHaloWidth;d.outlinePosition=h.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(a,"__esModule",{value:!0});var e=l.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),p=[0,0,0,0];c=function(){function a(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:h.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:h.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:h.HIGHLIGHT_SIZING.innerHaloWidth,
outerHaloWidth:h.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*h.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}a.prototype.setHighlightOptions=function(a){function b(a,b,d){z[0]=(1-d)*a[0]+d*b[0];z[1]=(1-d)*a[1]+d*b[1];z[2]=(1-d)*a[2]+d*b[2];z[3]=(1-d)*a[3]+d*b[3]}var d,c=this._convertedHighlightOptions;f(a,c);a=c.outlinePosition-c.outlineWidth/2-c.outerHaloWidth;var g=c.outlinePosition-c.outlineWidth/2,k=c.outlinePosition+c.outlineWidth/2,l=c.outlinePosition+
c.outlineWidth/2+c.innerHaloWidth,t=Math.sqrt(Math.PI/2)*h.SIGMAS[3],v=Math.abs(a)>t?Math.round(10*(Math.abs(a)-t))/10:0,t=Math.abs(l)>t?Math.round(10*(Math.abs(l)-t))/10:0;v&&!t?e.error("The outer rim of the highlight is "+v+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!v&&t?e.error("The inner rim of the highlight is "+t+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
v&&t&&e.error("The highlight is "+Math.max(v,t)+"px away from the edge of the feature; consider reducing some width values.");for(var z=[void 0,void 0,void 0,void 0],v=this.texelData,t=0;t<h.SHADE_TEXTURE_SIZE;++t)d=a+t/(h.SHADE_TEXTURE_SIZE-1)*(l-a),d<a?(z[4*t+0]=0,z[4*t+1]=0,z[4*t+2]=0,z[4*t+3]=0):d<g?b(p,c.outlineColor,(d-a)/(g-a)):d<k?(d=c.outlineColor,z[0]=d[0],z[1]=d[1],z[2]=d[2],z[3]=d[3]):d<l?b(c.outlineColor,c.fillColor,(d-k)/(l-k)):(d=c.fillColor,z[4*t+0]=d[0],z[4*t+1]=d[1],z[4*t+2]=d[2],
z[4*t+3]=d[3]),v[4*t+0]=255*z[0],v[4*t+1]=255*z[1],v[4*t+2]=255*z[2],v[4*t+3]=255*z[3];this.minMaxDistance[0]=a;this.minMaxDistance[1]=l;this.shadeTexChanged=!0};a.prototype.applyHighlightOptions=function(a,b){this.shadeTex||(this.shadeTex=new g.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:h.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,h.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);a.bindTexture(this.shadeTex,
k.TEXTURE_BINDING_HIGHLIGHT_1);b.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return a}();a.default=c})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.SIGMAS=[void 0,void 0,void 0,1];a.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];a.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=
[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.SHADE_TEXTURE_SIZE=256;a.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=
function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.prototype.preBlur=function(a,c){a.bindTexture(c,g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",k.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.finalBlur=function(a,c){a.bindTexture(c,g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",k.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.renderHighlight=function(a,c,b){a.bindTexture(c,
g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);b.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};a.prototype._initialize=function(a,c,b){this._width=c;this._height=b;c=new l.BufferObject(a,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);b=new l.VertexArrayObject(a,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",
count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:c});var d=l.createProgram(a,h.highlight);a=l.createProgram(a,h.blur);d.setUniform1i("u_texture",g.TEXTURE_BINDING_HIGHLIGHT_0);d.setUniform1i("u_shade",g.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform4fv("u_sigmas",k.SIGMAS);a.setUniform1i("u_texture",g.TEXTURE_BINDING_HIGHLIGHT_0);a.setUniform4fv("u_sigmas",k.SIGMAS);this._resources={quadGeometry:c,quadVAO:b,highlightProgram:d,
blurProgram:a}};a.prototype.setup=function(a,c,b){this._resources?(this._width=c,this._height=b):this._initialize(a,c,b)};return a}();a.default=c})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.highlight={name:"highlight",shaders:{vertexShader:l.resolveIncludes("highlight/textured.vert"),fragmentShader:l.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};a.blur={name:"blur",shaders:{vertexShader:l.resolveIncludes("highlight/textured.vert"),fragmentShader:l.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(c,a,l){function g(a,c,f){c=new l.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:c,height:f,samplingMode:9729});a=new l.FramebufferObject(a,
{colorTarget:0,depthStencilTarget:2},c);return[c,a]}Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};a.prototype._initialize=function(a,c,e){this._width=c;this._height=e;var f=g(a,c,e),b=
f[0],f=f[1];a=g(a,c,e);this._resources={sharedBlur1Tex:b,sharedBlur1Fbo:f,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};a.prototype.setup=function(a,c,e){!this._resources||this._width===c&&this._height===e||this.dispose();this._resources||this._initialize(a,c,e)};Object.defineProperty(a.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return a}();a.default=c})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/iteratorUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._buf=new Uint8Array(4*h.HITTEST_SEARCH_SIZE*h.HITTEST_SEARCH_SIZE);b._buf32=new Uint32Array(b._buf.buffer);return b}l(e,a);e.prototype.dispose=function(){k.isSome(this._fbo)&&this._fbo.dispose()};e.prototype.bind=function(a){var b=a.context;a=a.painter;var e=b.getViewport();a=a.getFbos(e.width,e.height).effect0;
b.bindFramebuffer(a);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};e.prototype.unbind=function(){};e.prototype.draw=function(a,d,e){var b=this,c=a.context,f=a.state,k=a.pixelRatio;void 0===e&&(e=h.HITTEST_SEARCH_SIZE);var m=c.getBoundFramebufferObject(),p=f.size[1],l=e/2,z=e/2;d.forEach(function(a,c){var f=new Map;m.readPixels(Math.floor((c[0]-e/2)*k),Math.floor((p-c[1]-e/2)*k),e,e,6408,5121,b._buf);for(var h=0;h<b._buf32.length;h++){var n=b._buf32[h];if(4294967295!==n&&0!==n){var v=h%
e,t=e-Math.floor(h/e),v=(l-v)*(l-v)+(z-t)*(z-t),t=f.has(n)?f.get(n):4294967295;f.set(n,Math.min(v,t))}}f=g.pairsOfMap(f).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[0]});a.resolve(f);d.delete(c)})};return e}(f.Effect);a.HittestEffect=c})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",
{value:!0});c=function(){function a(a,c){this.brushes=a;this.name=c.name;this.drawPhase=c.drawPhase||h.WGLDrawPhase.MAP;this._targetFn=c.target;this.effects=c.effects||[];this.has=c.has}a.prototype.render=function(a){var e=a.context,b=a.profiler,d=this._targetFn(),c=this.drawPhase&a.drawPhase;b.recordPassStart(this.name);if(c&&(!this.has||g(this.has))){this._doRender(a,d);b.recordPassEnd();for(var c=0,f=this.effects;c<f.length;c++){var h=f[c];if(h.enable()){var k=h.apply;b.recordPassStart(this.name+
"."+k.name);b.recordBrushStart(k.name);var h=h.args&&h.args(),l=e.getViewport(),w=l.x,t=l.y,v=l.width,l=l.height,z=e.getBoundFramebufferObject();k.bind(a,h);this._doRender(a,d,k.defines);k.draw(a,h);k.unbind(a,h);e.bindFramebuffer(z);e.setViewport(w,t,v,l);b.recordBrushEnd();b.recordPassEnd()}}}};a.prototype._doRender=function(a,c,b){if(!k.isNone(c))if(l.isArrayLike(c))for(var d=0;d<c.length;d++){var e=c[d];if(e.isReady&&e.visible)for(var f=0,h=this.brushes;f<h.length;f++){var g=h[f];a.profiler.recordBrushStart(g.name);
g.prepareState(a,e,b);g.draw(a,e,b);a.profiler.recordBrushEnd()}}else for(d=0,e=this.brushes;d<e.length;d++)g=e[d],a.profiler.recordBrushStart(g.name),g.prepareState(a,c,b),g.draw(a,c,b),a.profiler.recordBrushEnd()};return a}();a.default=c})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,
"__esModule",{value:!0});var e=k("esri-2d-profiler");c=function(){function a(a,d){var b=this;this._events=new g;this._entries=new Map;this._timings=new l.default(10);if(e){this._ext=f.load(a.gl,{});this._debugOutput=d;var c=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof c[a]){var d=c[a],e=-1!==a.indexOf("draw");c[a]=function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];b._events.emit("command",{container:b._currentContainer,pass:b._currentPass,brush:b._currentBrush,
method:a,args:f,isDrawCommand:e});b._currentSummary&&(b._currentSummary.commands++,e&&b._currentSummary.drawCommands++);return d.apply(c,f)}}};for(var h in c)a(h)}}}Object.defineProperty(a.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof e&&e.disableCommands)},enumerable:!0,configurable:!0});a.prototype.recordContainerStart=function(a){e&&(this._currentContainer=a)};a.prototype.recordContainerEnd=function(){e&&(this._currentContainer=null)};a.prototype.recordPassStart=function(a){e&&
(this._currentPass=a,this._initSummary())};a.prototype.recordPassEnd=function(){e&&(this._currentPass=null,this._emitSummary())};a.prototype.recordBrushStart=function(a){e&&(this._currentBrush=a)};a.prototype.recordBrushEnd=function(){e&&(this._currentBrush=null)};a.prototype.recordStart=function(a){if(e&&h.isSome(this._ext)){if(this._entries.has(a)){var b=this._entries.get(a),c=this._ext.resultAvailable(b.query),f=this._ext.disjoint();if(c&&!f){c=this._ext.getResult(b.query)/1E6;f=0;if(h.isSome(this._timings.enqueue(c))){for(var f=
this._timings.entries,g=f.length,k=0,p=0;p<f.length;p++)k+=f[p];f=k/g}c=c.toFixed(2);f=f?f.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+a+", "+c+" ms ("+f+" last 10 avg)\n"+b.commandsLen+" Commands ("+b.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(b.summaries),console.log("Commands: ",b.commands),console.groupEnd()):console.log("Frame report for "+a+", "+c+" ms ("+f+" last 10 avg)");this._debugOutput.innerHTML=c+" ("+f+")"}c=0;
for(b=b.handles;c<b.length;c++)b[c].remove();this._entries.delete(a)}var l={name:a,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(l.handles.push(this._events.on("command",function(a){l.commandsLen++;l.commands.push(a);a.isDrawCommand&&l.drawCommands++})),l.handles.push(this._events.on("summary",function(a){delete a.target;l.summaries.push(a)})));this._ext.beginTimeElapsed(l.query);this._entries.set(a,l)}};a.prototype.recordEnd=
function(a){e&&h.isSome(this._ext)&&this._entries.has(a)&&this._ext.endTimeElapsed()};a.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return a}();a.Profiler=c})},"esri/core/CircularArray":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,
"__esModule",{value:!0});c=function(){function a(a){this._start=this.size=0;this.maxSize=a;this._buffer=Array(a)}Object.defineProperty(a.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});a.prototype.enqueue=function(a){if(this.size===this.maxSize){var c=this._buffer[this._start];this._buffer[this._start]=a;this._start=(this._start+1)%this.maxSize;return c}this._buffer[(this._start+this.size++)%this.maxSize]=a;return null};a.prototype.dequeue=function(){if(0===
this.size)return null;var a=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return a};return a}();a.default=c})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});var f=l.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),e=function(){function e(a){this._ignoresSamplerPrecision=
null;this._context=a}Object.defineProperty(e.prototype,"ignoresSamplerPrecision",{get:function(){g.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=a.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return e}();a.testWebGLDriver=function(a){return new e(a)};a.testSamplerPrecision=function(a){var b=new k.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,
width:1,height:1}),d=new Uint8Array(4),e=new h(a,[0,0,1,0,0,1,1,1]),c=new k.Program(a,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),g=new k.Texture(a,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));c.setUniform1i("u_texture",0);a.bindTexture(g,0);a.bindFramebuffer(b);a.bindProgram(c);var p=a.getViewport(),g=p.x,l=p.y,w=p.width,p=p.height;a.setViewport(0,0,1,1);e.draw();a.setViewport(g,l,w,p);b.readPixels(0,0,1,1,6408,5121,d);c.dispose();e.dispose();
b.dispose();(a=255!==d[0]||255!==d[1]||255!==d[2]||255!==d[3])&&f.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+d[0]+"."+d[1]+"."+d[2]+"."+d[3]+"]");return a}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.stencil={name:"stencil",shaders:{vertexShader:l.resolveIncludes("stencil/stencil.vert"),fragmentShader:l.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/support/Timeline":function(){define(["require","exports","../../../core/tsSupport/decorateHelper","../../../core/tsSupport/declareExtendsHelper","../../../core/accessorSupport/decorators"],function(c,a,l,g,k){Object.defineProperty(a,
"__esModule",{value:!0});c=function(){function a(){this._names=new Map}a.prototype.begin=function(a){this._names.has(a)||(this._names.set(a,!1),-1!==a.indexOf("Brush")&&this.record("Esri.FirstDraw"),performance.mark("Esri."+a+".Start"))};a.prototype.end=function(a){this._names.has(a)&&!this._names.get(a)&&(this._names.set(a,!0),performance.mark("Esri."+a+".End"))};a.prototype.record=function(a){this._names.has(a)||(this._names.set(a,!0),performance.mark("Esri."+a))};return a=l([k.subclass("esri.views.2d.support.Timeline")],
a)}();a.Timeline=c})},"esri/views/support/screenshotUtils":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils","../../core/mathUtils"],function(c,a,l,g,k){function h(a,e){var c=a||{},f=c.format,h=c.quality,m=c.rotation,c=c.disableSlice,n=d(a,e.padding),l;l=e.width-n.left-n.right;e=e.height-n.top-n.bottom;n={x:0,y:0,width:l,height:e};if(a&&a.area){null!=a.area.x&&(n.x=Math.floor(a.area.x));null!=a.area.y&&(n.y=Math.floor(a.area.y));var v=null!=a.area.width?
Math.floor(a.area.width):null,t=null!=a.area.height?Math.floor(a.area.height):null;n.width=l-n.x;n.height=e-n.y;null!=v&&null!=t?(n.width=Math.min(n.width,v),n.height=Math.min(n.height,t)):null==v&&null!=t?(v=Math.min(n.width,v),n.height*=v/n.width,n.width=v):null!=v&&null==t&&(v=Math.min(n.height,t),n.width*=v/n.height,n.height=v)}n=b(n,a);v=Math.floor(Math.max(n.x,0));t=Math.floor(Math.max(n.y,0));l={x:v,y:t,width:Math.floor(Math.min(n.width,l-v)),height:Math.floor(Math.min(n.height,e-t))};e=l.width/
l.height;n=n.width/n.height;n!==e&&(n>e?(e=Math.floor(l.width/n),l={x:l.x,y:Math.floor(l.y+(l.height-e)/2),width:l.width,height:e}):(e=Math.floor(l.height*n),l={x:Math.floor(l.x+(l.width-e)/2),y:l.y,width:e,height:l.height}));n=p(a,l);e=n.width;n=n.height;a:switch(f){case "png":case "jpg":case "jpeg":break a;case null:case void 0:f=u;break a;default:g.neverReached(f),f=u}v=y[f];h=k.clamp(null!=h?h:v,0,100);return{format:f,quality:h,area:l,width:e,height:n,rotation:m,disableSlice:!!c,ignoreBackground:!(!a||
!a.ignoreBackground),ignorePadding:!(!a||!a.ignorePadding)}}function f(a,b){return a.toDataURL(n[b.format],b.quality/100)}function e(a,b,d){d||(m||(m=document.createElement("canvas"),m.width=1,m.height=1),d=m);return d.getContext("2d").createImageData(a,b)}function p(a,b){if(!a)return b;var d=a.width;a=a.height;if(null!=d&&null!=a)return{width:Math.floor(d),height:Math.floor(a)};if(null==d&&null==a)return b;b=b.width/b.height;return null==a?{width:Math.floor(d),height:Math.floor(d/b)}:{width:Math.floor(a*
b),height:Math.floor(a)}}function b(a,b){if(!b||null==b.width||null==b.height)return a;b=b.width/b.height;var d=a.width/a.height;if(d===b)return a;if(d<b)return b=Math.floor(a.height*b),a.x-=(b-a.width)/2,a.width=b,a;b=Math.floor(a.width/b);a.y-=(b-a.height)/2;a.height=b;return a}function d(a,b){return!b||a&&a.ignorePadding?w:b}Object.defineProperty(a,"__esModule",{value:!0});a.completeUserSettings=h;a.toRenderSettings=function(a,b){var e=h(a,b),c=e.area,f=e.width/c.width,g=d(e,b.padding),k=g.left+
g.right,m=g.top+g.bottom;return{framebufferWidth:Math.floor((b.width-k)*f+k),framebufferHeight:Math.floor((b.height-m)*f+m),region:{x:Math.floor(c.x*f)+g.left,y:Math.floor(c.y*f)+g.top,width:e.width,height:e.height},format:e.format,quality:e.quality,rotation:e.rotation,pixelRatio:f,layers:a&&a.layers?a.layers:[],disableSlice:e.disableSlice,ignoreBackground:e.ignoreBackground,ignorePadding:e.ignorePadding}};a.encodeResult=function(a,b,d,e){if(e.premultipliedAlpha)for(var c=a.data,h=c.length,g=0;g<
h;g+=4){var k=c[g+3];0<k&&(k/=255,c[g+0]/=k,c[g+1]/=k,c[g+2]/=k)}d.width=a.width;d.height=a.height;c=d.getContext("2d");c.putImageData(a,0,0);e.flipY&&(c.save(),c.globalCompositeOperation="copy",c.scale(1,-1),c.translate(0,-c.canvas.height),c.drawImage(c.canvas,0,0),c.restore());a=c.getImageData(0,0,a.width,a.height);b=f(d,b);d.width=0;d.height=0;return{dataUrl:b,data:a}};a.toDataUrl=f;a.createEmptyImageData=function(a,b,d){if(!a||!b)throw Error("Cannot construct image data without dimensions");if(r)try{return new ImageData(a,
b)}catch(A){r=!1}return e(a,b,d)};a.wrapImageData=function(a,b,d,c){if(!b||!d)throw Error("Cannot construct image data without dimensions");if(r)try{return new ImageData(a,b,d)}catch(C){r=!1}b=e(b,d,c);b.data.set(a,0);return b};a.resampleHermite=function(a,b,d,e,c,f,h,g){void 0===e&&(e=0);void 0===c&&(c=0);void 0===f&&(f=a.width-e);void 0===h&&(h=a.height-c);void 0===g&&(g=!1);var k=a.data,m=b.width,n=b.height,p=b.data;f/=m;h/=n;var l=Math.ceil(f/2),v=Math.ceil(h/2);a=a.width;for(var t=0;t<n;t++)for(var w=
0;w<m;w++){for(var r=4*(w+(g?n-t-1:t)*m),u=0,y=0,z=0,A=0,D=0,C=0,E=(t+.5)*h,B=Math.floor(t*h);B<(t+1)*h;B++)for(var T=Math.abs(E-(B+.5))/v,ja=(w+.5)*f,T=T*T,aa=Math.floor(w*f);aa<(w+1)*f;aa++){var ba=Math.abs(ja-(aa+.5))/l,ba=Math.sqrt(T+ba*ba);if(!(1<=ba)){var ba=2*ba*ba*ba-3*ba*ba+1,da=4*(e+aa+(c+B)*a),C=C+ba*k[da+3],y=y+ba;!d&&255>k[da+3]&&(ba=ba*k[da+3]/255);z+=ba*k[da];A+=ba*k[da+1];D+=ba*k[da+2];u+=ba}}p[r]=z/u;p[r+1]=A/u;p[r+2]=D/u;p[r+3]=C/y}return b};a.screenshotSuperSampleSettings=function(a,
b,e){if(!b)return a;b=a.framebufferWidth;var c=a.framebufferHeight,f=a.pixelRatio,h=a.region;e=d(a,e);var g=e.left+e.right,k=e.top+e.bottom,m=b-g,n=c-k,p=Math.min(8,Math.min((2048-g)/m,(2048-k)/n));return 1.5>p?a:l({},a,{framebufferWidth:Math.round(m*p)+g,framebufferHeight:Math.round(n*p)+k,pixelRatio:f*p,resample:{region:{x:Math.round((h.x-e.left)*p)+e.left,y:Math.round((h.y-e.top)*p)+e.top,width:Math.round(h.width*p),height:Math.round(h.height*p)},width:b,height:c}})};var m=null,r=!0,n={png:"image/png",
jpg:"image/jpeg",jpeg:"image/jpeg"},u="jpg",y={png:100,jpg:98,jpeg:98},w={top:0,right:0,bottom:0,left:0}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),function(c,
a,l,g,k,h,f,e,p,b,d,m,r,n){Object.defineProperty(a,"__esModule",{value:!0});var u=f.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),y=r.createDebugLogger(r.DEBUG_ATTR_UPDATES,u),w=function(){function a(a,b,d){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var c=a.buffer,f=a.pixelType;a=a.textureOnly;var h=m.getPixelArrayCtor(f);this.shared=d;this.pixelType=f;this.size=b;this.textureOnly=a;a||(this.data=new h(e.expect(c)));this._resetRange()}a.prototype.destroy=function(){e.andThen(this._texture,
function(a){return a.dispose()});var a=function(a){e.andThen(b._fbos[a],function(b){"0"===a&&b.detachColorTexture();b.dispose()});b._fbos[a]=null},b=this,d;for(d in this._fbos)a(d);this._texture=null};Object.defineProperty(a.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});a.prototype.setData=function(a,b,d){a&=2147483647;var c=e.expect(this.data);
b=a*this.texelSize+b;!c||b>=c.length||(c[b]=d,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.getData=function(a,b){if(e.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+b;return!this.data||a>=this.data.length?null:this.data[a]};a.prototype.getTexture=function(a){var b=this;return e.unwrapOr(this._texture,function(){return b._initTexture(a)})};a.prototype.getFBO=function(a,b){void 0===b&&(b=0);if(e.isNone(this._fbos[b])){var d=0===b?this.getTexture(a):
this._textureDesc;this._fbos[b]=new n(a,{colorTarget:0,depthStencilTarget:0},d)}return this._fbos[b]};Object.defineProperty(a.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&h("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});a.prototype.updateTexture=function(a){if(!this.locked)try{var b=this.dirtyStart,d=this.dirtyEnd;if(!(b>d)){this._resetRange();var c=e.expect(this.data).buffer,f=this.getTexture(a),h=(b-
b%this.size)/this.size,g=(d-d%this.size)/this.size,n=h*this.size*4,p=4*(this.size+g*this.size)-n,l=m.getPixelArrayCtor(this.pixelType),v=l.BYTES_PER_ELEMENT;try{new l(c,n*v,p)}catch(L){console.debug(L)}var t=new l(c,n*v,p),w=this.size;a=g-h+1;a>this.size?u.error(new k("mapview-webgl","Out-of-bounds index when updating AttributeData")):f.updateData(0,0,h,w,a,t)}}catch(L){console.debug(L)}};a.prototype.update=function(a){var b=a.data,d=a.start,c=a.end;if(e.isSome(b))for(var f=this.data,h=d*this.texelSize,
g=0;g<b.length;g++)a.layout&1<<g%this.texelSize&&(f[h+g]=b[g]);this.dirtyStart=Math.min(this.dirtyStart,d);this.dirtyEnd=Math.max(this.dirtyEnd,c)};a.prototype.resize=function(a,b){var d=this.size;this.size=b;this.textureOnly?d!==this.size&&(this._lastTexture=this._texture,this._texture=null):(b=m.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new b(e.expect(a.buffer)))};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};a.prototype._initTexture=function(a){var d=
new b.Texture(a,this._textureDesc,e.unwrapOr(this.data,void 0));if(e.isSome(this._lastTexture)&&this._fbos[0]){var c=this._lastTexture.descriptor.width,f=this._lastTexture.descriptor.height,h=this._lastTexture.descriptor.dataType,g=this._lastTexture.descriptor.pixelFormat,k=this.getFBO(a),n=m.getPixelBytes(h),p=m.getPixelArrayCtor(h),n=new ArrayBuffer(c*f*n*this.texelSize),p=new p(n),n=a.getBoundFramebufferObject(),l=a.getViewport(),v=l.x,t=l.y,w=l.width,l=l.height;a.bindFramebuffer(k);k.readPixels(0,
0,c,f,g,h,p);d.updateData(0,0,0,2*c,f/2,p);a.setViewport(v,t,w,l);a.bindFramebuffer(n)}this.destroy();return this._texture=d};return a}();c=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var b=a.blocks,d=a.shared,c=a.size;this.shared=d;this.size=c;y("Initializing AttributeStoreView",a);if(e.isNone(this._data))this._data=e.mapMany(b,function(a){return new w(a,c,d)});else for(a=0;a<this._data.length;a++){var f=this._data[a],h=b[a];
e.isSome(h)&&(e.isNone(f)?this._data[a]=new w(h,c,d):f.resize(h,c))}this._initialized=!0};a.prototype.destroy=function(){e.andThen(this._data,function(a){return e.mapMany(a,function(a){return a.destroy()})});e.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return e.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,b){this.setData(a,0,1,b)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,d.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,b,d,c){if(!this._data)return 0;b=e.expect(this._data)[b];if(e.isNone(b))return 0;a=b.getData(a,d);return e.isSome(a)?a:c};a.prototype.setData=function(a,b,d,c){b=e.expect(this._data)[b];e.expect(b).setData(a,d,c)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return g(this,void 0,void 0,function(){var b;return l(this,function(d){if(this._pendingAttributeUpdate)return u.error(new k("mapview-webgl","Tried to update attribute data with a pending update")),[2];b=p.createResolver();y("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:b};return[2,b.promise]})})};a.prototype.update=function(){if(this._initialized&&e.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,b=a.data,a=a.resolver,d=e.expect(this._data),c=function(a){var c=b.blocks[a];e.andThen(d[a],function(b){return e.andThen(c,function(d){y("Updating block "+a,d);b.update(d)})})},f=0;f<b.blocks.length;f++)c(f);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var b=this._getDefaultTexture(a);if(this._initialized){var c=e.expect(this._data);if(!this._locked||this._forceNextUpload)e.forEachSome(c,function(b){return b.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(e.mapOr(c[0],b,function(b){return b.getTexture(a)}),d.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(e.mapOr(c[1],b,function(b){return b.getTexture(a)}),d.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(e.mapOr(c[2],b,function(b){return b.getTexture(a)}),d.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(e.mapOr(c[3],b,function(b){return b.getTexture(a)}),d.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(b,d.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(b,
d.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(b,d.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(b,d.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){e.isNone(this._defaultTexture)&&(this._defaultTexture=new b.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();a.AttributeStoreView=c})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){function r(a){for(var b={},d=0;d<a.length;d++){var e=a[d];b[e.name]=e.strideInBytes}return b}function n(a){switch(a){case d.WGLGeometryType.MARKER:return A;case d.WGLGeometryType.FILL:return C;case d.WGLGeometryType.LINE:return D;case d.WGLGeometryType.TEXT:return B;case d.WGLGeometryType.LABEL:return E}return null}function u(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function y(a){return"string"===typeof a}function w(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function t(a){var b={},d=function(d){var e=0;b[d]=a[d].map(function(a){var b=l({},a,{normalized:a.normalized||!1,divisor:a.divisor||0,offset:e,stride:0});e+=a.count*w(a.type);return b});b[d].forEach(function(a){return a.stride=e})},e;for(e in a)d(e);return b}Object.defineProperty(a,"__esModule",{value:!0});var v,z=k.getLogger("esri.views.2d.engine.webgl.Utils");a.C_VBO_GEOMETRY="geometry";a.C_VBO_PERINSTANCE="per_instance";a.C_VBO_PERINSTANCE_VV=
"per_instance_vv";a.C_ICON_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF_DD=[{name:a.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];a.C_LINE_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_TEXT_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];a.C_LABEL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];a.C_ICON_STRIDE_SPEC=r(a.C_ICON_VERTEX_DEF);
a.C_FILL_STRIDE_SPEC=r(a.C_FILL_VERTEX_DEF);a.C_FILL_STRIDE_SPEC_DD=r(a.C_FILL_VERTEX_DEF_DD);a.C_LINE_STRIDE_SPEC=r(a.C_LINE_VERTEX_DEF);a.C_TEXT_STRIDE_SPEC=r(a.C_TEXT_VERTEX_DEF);a.C_LABEL_STRIDE_SPEC=r(a.C_LABEL_VERTEX_DEF);a.getStrides=function(b,e){switch(b){case d.WGLGeometryType.MARKER:return a.C_ICON_STRIDE_SPEC;case d.WGLGeometryType.FILL:return e?a.C_FILL_STRIDE_SPEC_DD:a.C_FILL_STRIDE_SPEC;case d.WGLGeometryType.LINE:return a.C_LINE_STRIDE_SPEC;case d.WGLGeometryType.TEXT:return a.C_TEXT_STRIDE_SPEC;
case d.WGLGeometryType.LABEL:return a.C_LABEL_STRIDE_SPEC}return null};var A=[a.C_VBO_GEOMETRY],C=[a.C_VBO_GEOMETRY],D=[a.C_VBO_GEOMETRY],B=[a.C_VBO_GEOMETRY],E=[a.C_VBO_GEOMETRY];a.getNamedBuffers=n;a.strideToPackingFactor=u;a.allocateTypedArrayBuffer=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(Math.floor(a*b/4));case 1:case 3:return new Uint8Array(a*b)}};a.allocateTypedArrayBufferwithData=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
a.getTextProperties=function(a){return m.TextProperties.pool.acquire(a.color?b.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?b.copyAndPremultiply(a.haloColor):[255,255,255,255],f.pt2px(a.haloSize),f.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};a.isDefined=function(a){return null!=a};a.isNumber=function(a){return"number"===
typeof a};a.isString=y;a.isStringOrNull=function(a){return null==a||y(a)};a.getCapType=function(a,b){switch(a){case "butt":return e.CapType.BUTT;case "round":return b?e.CapType.SQUARE:e.CapType.ROUND;case "square":return e.CapType.SQUARE;default:return z.error(new g("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),e.CapType.ROUND}};a.getJoinType=function(a){switch(a){case "miter":return e.JoinType.MITER;case "bevel":return e.JoinType.BEVEL;case "round":return e.JoinType.ROUND;
default:return z.error(new g("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),e.JoinType.ROUND}};a.getVVType=function(a){switch(a){case "opacity":return d.VVType.OPACITY;case "color":return d.VVType.COLOR;case "rotation":return d.VVType.ROTATION;case "size":return d.VVType.SIZE;default:return z.error("Cannot interpret unknown vv: "+a),null}};a.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};a.copyMeshData=function(a,b,d,e,
c,f,h){for(var g in f)for(var k=f[g].stride,m=u(k),n=f[g].data,p=d[g].data,l=k*c.vertexCount/m,v=k*a/m,m=k*c.vertexFrom/m,k=0;k<l;++k)p[k+v]=n[k+m];d=c.indexCount;for(k=0;k<d;++k)e[k+b]=h[k+c.indexFrom]-c.vertexFrom+a};a.C_VBO_INFO=(v={},v[a.C_VBO_GEOMETRY]=35044,v);a.createGeometryData=function(a,b){for(var d=[],e=0;5>e;++e){for(var c={},f=0,h=n(e);f<h.length;f++){var g=h[f];c[g]={data:b(e,g)}}d.push({data:a(e),buffers:c})}return d};a.createTextureFromTexelData=function(a,b){var d,e;h.isPowerOfTwo(b.width)&&
h.isPowerOfTwo(b.height)?(d=!0,e=9987):(d=!1,e=9729);return new p.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:d,samplingMode:e,wrapMode:33071,flipped:!0},b)};a.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};a.getBytes=w;a.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:z.error(new g("webgl-utils","Unable to handle type "+a))}};a.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:z.error(new g("webgl-utils","Unable to handle type "+a))}};var F=new Map;a.createProgramDescriptor=function(a,b){if(!F.has(a)){var d=t(b),e={},c;for(c in d){var f=d[c];e[c]=f.length?f[0].stride:0}c={};for(var h in b)for(var f=0,g=b[h];f<g.length;f++){var k=g[f];c[k.name]=k.location}F.set(a,{strides:e,bufferLayouts:d,attributes:c})}return F.get(a)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],
function(c,a,l){function g(a,e){Array.isArray(e)?(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3]):(a[0]=e.r,a[1]=e.g,a[2]=e.b,a[3]=e.a);return a}function k(a,e,c){void 0===e&&(e=0);void 0===c&&(c=!1);var b=a[e+3];a[e+0]*=b;a[e+1]*=b;a[e+2]*=b;c||(a[e+3]*=255);return a}Object.defineProperty(a,"__esModule",{value:!0});a.white=[255,255,255,1];var h=[0,0,0,0];a.premultiplyAlpha=k;a.copyAndPremultiply=function(a){return k(g([],a))};a.premultiplyAlphaUint32=function(a){k(g(h,a));return l.i8888to32(h[0],h[1],h[2],
h[3])};a.premultiplyAlphaRGBA=function(a){if(!a)return 0;var e=a.a;return l.i8888to32(a.r*e,a.g*e,a.b*e,255*e)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}a.prototype.acquire=function(a,c,f,e,g,
b,d,m,l){this.color=a;this.haloColor=c;this.haloSize=f;this.size=e;this.angle=g;this.offsetX=b;this.offsetY=d;this.hAnchor=m;this.vAnchor=l};a.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};a.pool=new l(a);return a}();a.TextProperties=c})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require",
"exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.createDebugLogger=function(a,c){return a&&function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];return c.warn.apply(c,["DEBUG:"].concat(a))}||function(){return null}};a.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this._bucketSize=
a;this._rowsLength=l.TILE_SIZE/a;this._colsLength=l.TILE_SIZE/a;this._grid=this._initGrid()}a.prototype.checkOverlap=function(a,c){a=Math.floor(a/this._bucketSize);c=Math.floor(c/this._bucketSize);if(0>a||a>=this._rowsLength||0>c||c>=this._colsLength||this._grid[c][a])return!0;this._grid[c][a]=!0;return!1};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=function(){for(var a=[],c=0;c<this._rowsLength;c++)a.push(Array(this._colsLength));return a};return a}();a.CollisionGrid=
c})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/iteratorUtils ../../../../../core/Logger ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});var b=f.TILE_SIZE/f.COLLISION_BUCKET_SIZE,d=k.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");c=function(){function a(a){this._layers=
new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(a.prototype,"collisionInfos",{get:function(){return g.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});a.prototype.registerLayerView=function(a,b){if(!this._layers.has(a)){var d=p.default.create(a,b,this.collisionInfos,this._tilingScheme);this._layers.set(a,d);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(d.index)})}};a.prototype.unregisterLayerView=function(a){var b=
this;if(this._layers.has(a)){var d=this._layers.get(a);p.default.delete(d.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,e){var c=a.getTile(d.index);c&&(a.onUnregisterLayer(d.index),a.canDelete()&&b._collisionBuckets.delete(e),c.reference&&(c.reference.isDirty=!1))})}};a.prototype.addTile=function(a,b){var d=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(d)||this._collisionBuckets.set(d,new e.default(b.key,this._layers.size)),a=this._getIndex(a),
this._collisionBuckets.get(d).getTile(a).reference=b)};a.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(a=this._getIndex(a),b=this._collisionBuckets.get(b).getTile(a),b.dirty=!1,b.reference=null)};a.prototype.run=function(a,b){var e=g.valuesOfMap(this._collisionBuckets).sort(function(a,b){return a.key.compareRowMajor(b.key)}),c=!0,f=a.renderingOptions.labelCollisionsEnabled&&!this._didError,h=this.collisionInfos;try{for(var k=0;k<e.length;k++)for(var m=e[k],
c=c||m.isDirty,n=0;n<this._layers.size;n++){var r=p.default.find(n,h);m.computeNeighbors(this._collisionBuckets);m.reset(a,c,r)}for(a=0;a<this._layers.size;a++)for(r=p.default.find(a,h),c=0,k=e;c<k.length;c++)m=k[c],this._run(f,m,r,b)}catch(D){d.error(new l("mapview-labeling","Encountered an error during decluttering. Disabling collisions",D)),this._didError=!0}for(b=0;b<e.length;b++)m=e[b],m.ready()};a.prototype._run=function(a,b,d,e){var c=b.getReference(d.index);c&&c.hasData&&(c.key.level!==e?
this._resetLabelsMinZoom(b,d):this._runVisibility(a,b,c,d,e))};a.prototype._resetLabelsMinZoom=function(a,b){if(a&&"polyline"!==b.geometryType&&(a=a.getReference(b.index))&&a.hasData){b=b.layerView.tileRenderer.featuresView.attributeView;var d=0;for(a=a.displayObjects;d<a.length;d++)b.setLabelMinZoom(a[d].id,255)}};a.prototype._checkLabelsVisible=function(a,b){var d=!b.effect||b.effect.excludedLabelsVisible||!!(a&f.EFFECT_FLAG_0);return(!b.filter||!!(a&f.FILTER_FLAG_0))&&d};a.prototype._runVisibility=
function(a,b,d,e,c){var f=e.layerView.tileRenderer.featuresView.attributeView,h=0;for(d=d.displayObjects.sort(function(a,b){a=f.getLabelMinZoom(a.id);b=f.getLabelMinZoom(b.id);return a-b});h<d.length;h++){var g=d[h];if(g.metrics.length){var k="polyline"===e.geometryType?0:10*(c-1),m=f.getFilterFlags(g.id),n=this._checkLabelsVisible(m,e.layerView);if(a)for(var p=0;p<g.metrics.length;p++)m=g.metrics[p],m=n?-1!==m.minZoom?m.minZoom:this._computeLabelVisibility(g,m,e.index,b,m.baseZoom,c):255,k=Math.max(m,
k);f.setLabelMinZoom(g.id,k);n=0;for(g=g.metrics;n<g.length;n++)m=g[n],m.minZoom=k}}};a.prototype._computeLabelVisibility=function(a,d,e,c,f,h){for(var g=d.xBucket,k=d.yBucket,m=d.xOverflow,n=d.yOverflow,p=g-m,g=g+m+1,m=k+n+1,k=k-n;k<m;k++)for(n=p;n<g;n++)if(!(n<-b||k<-b||n>b||k>b))for(var l=0;l<=e;l++){var t=this._getRelativeSubBucket(l,c,n,k);if(t)for(var w=0;w<t.length;w++){var r=t[w];r.id!==a.id&&(r=this._compareLabels(d,r,f,h),f=Math.max(r,f))}}return f};a.prototype._compareLabels=function(a,
b,d,e){if(-1===b.minZoom||b.minZoom>10*(e+1))return d;a=a.findCollisionDelta(b);e=h.clamp(Math.floor(10*(a+e)),0,255);return b.minZoom>=e?d:Math.max(d,e)};a.prototype._getNeighboringTile=function(a,b,d,e){return(b=b.neighbors[3*(1+e)+(1+d)])&&b.getTile(a)};a.prototype._getRelativeSubBucket=function(a,b,d,e){var c=h.sign(Math.floor(d/4)),f=h.sign(Math.floor(e/4));return(a=this._getNeighboringTile(a,b,c,f))&&a.reference&&a.index&&a.reference.hasData?a.index[e-4*f][d-4*c]:null};a.prototype._getIndex=
function(a){return this._layers.get(a).index};return a}();a.CollisionEngine=c})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c){this.neighbors=Array(9);this._tiles=Array(c);for(var e=0;e<c;e++)this._tiles[e]=new g.default;this.key=a}Object.defineProperty(a.prototype,"isDirty",{get:function(){for(var a=0,c=this._tiles;a<
c.length;a++)if(c[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});a.prototype.getTile=function(a){return this._tiles[a]};a.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};a.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};a.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};a.prototype.onLabelsRendered=
function(){};a.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};a.prototype.add=function(a){this._add(a)};a.prototype.remove=function(a){this._remove(a)};a.prototype.canDelete=function(){return 0===this._tiles.length};a.prototype.ready=function(){for(var a=0,c=this._tiles;a<c.length;a++)c[a].dirty=!1};a.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,
1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};a.prototype.reset=function(a,c,e){for(var f=0,b=this._tiles;f<b.length;f++){var d=b[f];d&&d.reset(a,c,e)}};a.prototype._add=function(a){var c=[];if(a>=this._tiles.length)this._tiles.push(new g.default);else{for(var e=0;e<this._tiles.length;e++)e===a&&c.push(new g.default),
c.push(this._tiles[e]);this._tiles=c}};a.prototype._remove=function(a){for(var c=[],e=0;e<this._tiles.length;e++)e!==a&&c.push(this._tiles[e]);this._tiles=c};a.prototype._getNeighbor=function(a,c,e){var f=this.key;c=l.TileKey.getId(f.level,f.row+e,f.col+c,f.world);return a.has(c)?a.get(c):null};return a}();a.default=c})},"esri/views/2d/tiling":function(){define("require exports ./tiling/TileInfoView ./tiling/TileKey ./tiling/TileQueue ./tiling/TileStrategy".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,
"__esModule",{value:!0});a.TileInfoView=l;a.TileKey=g;a.TileQueue=k;a.TileStrategy=h})},"esri/views/2d/tiling/TileQueue":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/vec2 ../../support/QueueProcessor".split(" "),function(c,a,l,g,k,h,f,e,p,b){function d(a,
b){a.length=0;b.forEach(function(b){return a.push(b)});return a}var m=new Set,r=[],n=new Map,u=[0,0];return function(a){function c(b){b=a.call(this,b)||this;b._keyToItem=new Map;b.concurrency=6;b.strategy="scale-first";b.tileInfoView=null;return b}l(c,a);c.prototype.initialize=function(){var a=this,d=this.concurrency,e=this.process,c="scale-first"===this.strategy?this._peekByScaleFirst.bind(this):this._peekByCenterFirst.bind(this);this._queue=new b.QueueProcessor({concurrency:d,process:function(b,
d){b=a._keyToItem.get(b);return e(b,{signal:d})},peeker:c})};c.prototype.destroy=function(){this.clear();this._queue.destroy();this._queue=null};Object.defineProperty(c.prototype,"length",{get:function(){return this._queue?this._queue.length:0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"onGoingCount",{get:function(){return this._keyToItem.size},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"updating",{get:function(){return 0<this.length||0<this.onGoingCount},
enumerable:!0,configurable:!0});c.prototype.abort=function(a){this._queue.abort("string"===typeof a?a:a.id)};c.prototype.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};c.prototype.get=function(a){return this._queue.get("string"===typeof a?a:a.id)};c.prototype.has=function(a){return"string"===typeof a?this._keyToItem.has(a):this._keyToItem.has(a.id)};c.prototype.isOngoing=function(a){a="string"===typeof a?a:a.id;return this.has(a)&&this._queue.isOngoing(a)};
c.prototype.pause=function(){this._queue.pause()};c.prototype.push=function(a){return h(this,void 0,void 0,function(){var b,d,e,c=this;return k(this,function(f){b=a.key.id;if(this.has(b))return[2,this.get(b)];d=this._queue.push(b);e=function(){c._keyToItem.delete(b);c.notifyChange("updating")};this._keyToItem.set(b,a);d.then(e,e);this.notifyChange("updating");return[2,d]})})};c.prototype.reset=function(){this._queue.reset();this.notifyChange("updating")};c.prototype.resume=function(){this._queue.resume()};
c.prototype._peekByScaleFirst=function(a){if(!this.state)return a[0];for(var b=this.tileInfoView,e=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,f=0;f<a.length;f++){var h=this._keyToItem.get(a[f]),g=this.tileInfoView.getTileScale(h.key);n.has(g)||(n.set(g,[]),e=Math.max(g,e),c=Math.min(g,c));n.get(g).push(h.key);m.add(g)}var k=this.state.scale;n.has(k)||(d(r,m),r.sort(),k=r.reduce(function(a,b){return Math.abs(b-k)<Math.abs(a-k)?b:a},r[0]));k=Math.min(k,e);k=Math.max(k,c);a=n.get(k);var p=b.getClosestInfoForScale(k),
l=p.getColumnForX(this.state.center[0]),t=p.getRowForY(this.state.center[1]);a.sort(function(a,b){var d=p.denormalizeCol(a.col,a.world),e=p.denormalizeCol(b.col,b.world);return Math.sqrt((l-d)*(l-d)+(t-a.row)*(t-a.row))-Math.sqrt((l-e)*(l-e)+(t-b.row)*(t-b.row))});m.clear();n.clear();return a[0].id};c.prototype._peekByCenterFirst=function(a){if(!this.state)return a[0];for(var b=this.tileInfoView,d=this.state.center,e=Number.POSITIVE_INFINITY,c=null,f=0;f<a.length;f++){var h=this._keyToItem.get(a[f]);
b.getTileCoords(u,h.key);var g=p.vec2.distance(u,d);g<e&&(e=g,c=h.key)}return c.id};g([e.property({constructOnly:!0})],c.prototype,"concurrency",void 0);g([e.property({constructOnly:!0})],c.prototype,"process",void 0);g([e.property()],c.prototype,"state",void 0);g([e.property({constructOnly:!0})],c.prototype,"strategy",void 0);g([e.property({constructOnly:!0})],c.prototype,"tileInfoView",void 0);g([e.property({readOnly:!0})],c.prototype,"updating",null);return c=g([e.subclass("esri.views.2d.tiling.TileQueue")],
c)}(e.declared(f))})},"esri/views/support/QueueProcessor":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});var p=function(){return function(a,d){this.item=a;this.controller=d;this.promise=null}}();c=function(){function a(a){var b=this;this._deferreds=new Map;this._controllers=
new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;a.concurrency&&(this.concurrency=a.concurrency);this._queue=new f({peeker:a.peeker});this.process=a.process;var d=a.scheduler;a.task&&k.isSome(d)&&(this._task=d.registerTask(a.task,function(a){return b.update(a)},function(){return b.needsUpdate()}))}a.prototype.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=
null)};Object.defineProperty(a.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0});a.prototype.abort=function(a){(a=this._controllers.get(a))&&a.abort()};a.prototype.clear=function(){this._queue.clear();var a=[];this._controllers.forEach(function(b){return a.push(b)});this._controllers.clear();a.forEach(function(a){return a.abort()});this._processingItems.clear();this._cancelNext()};a.prototype.get=function(a){return(a=this._deferreds.get(a))?
a.promise:void 0};a.prototype.isOngoing=function(a){return this._processingItems.has(a)};a.prototype.has=function(a){return this._deferreds.has(a)};a.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};a.prototype.push=function(a){return g(this,void 0,void 0,function(){var b,d,e,c,f,g,k=this;return l(this,function(m){if(b=this.get(a))return[2,b];e=h.createAbortController();c=function(){var b=k._processingItems.get(a);b&&b.controller.abort();f();d.reject(h.createAbortError())};
f=function(){g.remove();k._deferreds.delete(a);k._controllers.delete(a);k._queue.remove(a);k._processingItems.delete(a);k._scheduleNext()};g=h.onAbortOrThrow(e.signal,c);d=h.createDeferred();this._deferreds.set(a,d);this._controllers.set(a,e);d.promise.then(f,f);this._queue.push(a);this._scheduleNext();return[2,d.promise]})})};a.prototype.reset=function(){var a=[];this._processingItems.forEach(function(b){return a.push(b)});this._processingItems.clear();for(var b=0;b<a.length;b++){var e=a[b];this._queue.push(e.item);
e.controller.abort()}this._scheduleNext()};a.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};a.prototype.needsUpdate=function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency};a.prototype.update=function(a){for(;!a.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),a.madeProgress()};a.prototype._scheduleNext=function(){var a=this;this._task||this._isPaused||this._schedule||
(this._schedule=e.schedule(function(){a._schedule=null;a._next()}))};a.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};a.prototype._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};a.prototype._processResult=function(a,b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).resolve(b))};a.prototype._processError=function(a,b){this._canProcessFulfillment(a)&&
(this._scheduleNext(),this._deferreds.get(a.item).reject(b))};a.prototype._canProcessFulfillment=function(a){return this._deferreds.get(a.item)&&this._processingItems.get(a.item)===a?!0:!1};a.prototype._process=function(a){var b=this;if(!k.isNone(a)){var d,e=h.createAbortController(),c=new p(a,e);this._processingItems.set(a,c);try{d=this.process(a,e.signal)}catch(y){this._processError(c,y)}d&&"function"===typeof d.then?(c.promise=d,d.then(function(a){return b._processResult(c,a)},function(a){return b._processError(c,
a)})):this._processResult(c,d)}};Object.defineProperty(a.prototype,"test",{get:function(){var a=this;return{update:function(b){return a.update(b)}}},enumerable:!0,configurable:!0});return a}();a.QueueProcessor=c})},"esri/core/Queue":function(){define(["require","exports"],function(c,a){return function(){function a(a){this._items=[];this._itemSet=new Set;this._peeker=function(a){return a[0]};this._length=0;a&&a.peeker&&(this._peeker=a.peeker)}Object.defineProperty(a.prototype,"length",{get:function(){return this._length},
enumerable:!0,configurable:!0});a.prototype.clear=function(){this._itemSet.clear();this._length=this._items.length=0};a.prototype.peek=function(){if(0!==this._length)return this._peeker(this._items)};a.prototype.push=function(a){this.contains(a)||this._add(a)};a.prototype.contains=function(a){return 0<this._length&&this._itemSet.has(a)};a.prototype.pop=function(){if(0!==this._length){var a=this.peek();this._remove(a);return a}};a.prototype.remove=function(a){this.contains(a)&&this._remove(a)};a.prototype._add=
function(a){this._items.push(a);this._itemSet.add(a);this._length++};a.prototype._remove=function(a){this._itemSet.delete(a);this._items.splice(this._items.indexOf(a),1);this._length--};return a}()})},"esri/views/2d/tiling/TileStrategy":function(){define("require exports ../../../core/tsSupport/extendsHelper ./TileCache ./TileCoverage ./TileKey".split(" "),function(c,a,l,g,k,h){var f=new h(0,0,0,0),e=new Map,p=[],b=[];return function(){function a(a){var b=this;this._previousScale=Number.POSITIVE_INFINITY;
this.cachePolicy="keep";this.coveragePolicy="closest";this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this.resampling=null==a.resampling||!!a.resampling;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);a.coveragePolicy&&(this.coveragePolicy=a.coveragePolicy);null!=a.buffer&&(this.buffer=a.buffer);a.cacheSize&&(this._tileCache=new g.default(a.cacheSize,this.tileInfoView,function(a){b.releaseTile(a)}))}
a.prototype.destroy=function(){this.tileIndex.clear()};a.prototype.update=function(a){var d=this,c=this.resampling,h=this.tileIndex,g=this.tileInfoView.getTileCoverage(a.state,this.buffer,this.coveragePolicy);b.length=0;p.length=0;e.clear();if(g){var m=this.tileInfoView.tileInfo,l=m.minScale,v=m.maxScale,z=g.spans,A=g.lodInfo,C=A.level,D=a.state,B=D.scale,m=D.center,D=D.resolution,E=!a.stationary&&B>this._previousScale;this._previousScale=B;this.tiles.length=0;if(!c&&(B>l||B<v))return this.tiles.length=
0,e.clear(),h.forEach(function(a){d.releaseTile(a)}),h.clear(),b.length=0,p.length=0,e.clear(),k.pool.release(g),!0;h.forEach(function(a){return a.visible=!0});v=l=0;if(0<z.length)for(B=0;B<z.length;B++){a=z[B];for(var F=a.row,H=a.colTo,J=a.colFrom;J<=H;J++)if(l++,a=f.set(C,F,A.normalizeCol(J),A.getWorldForColumn(J)).id,h.has(a))c=h.get(a),c.isReady?(e.set(a,c),v++):E||this._addParentTile(a,e);else{c=void 0;if(this._tileCache&&this._tileCache.has(a)){if(c=this._tileCache.pop(a),this.tileIndex.set(a,
c),c.isReady){e.set(a,c);v++;continue}}else c=this.acquireTile(f),this.tileIndex.set(a,c);E||this._addParentTile(a,e)}}var K=v===l;h.forEach(function(a,c){f.set(c);if(!e.has(c)){var h=d.tileInfoView.intersects(g,f);!h||!E&&K?"purge"===d.cachePolicy?f.level===C&&h||p.push(c):(f.level>C||!h)&&p.push(c):a.isReady?b.push(c):f.level>C&&p.push(c)}});for(z=0;z<b.length;z++)a=b[z],(c=h.get(a))&&c.isReady&&e.set(a,c);for(z=0;z<p.length;z++)a=p[z],c=h.get(a),this._tileCache?this._tileCache.add(c):this.releaseTile(c),
h["delete"](a);e.forEach(function(a){return d.tiles.push(a)});h.forEach(function(a){e.has(a.key.id)||(a.visible=!1)});this._tileCache&&this._tileCache.prune(C,m,D);k.pool.release(g);return K}};a.prototype.clear=function(a){var b=this;void 0===a&&(a=!0);var d=this.tileIndex;a&&d.forEach(function(a){b.releaseTile(a)});d.clear()};a.prototype._addParentTile=function(a,b){for(var d=null;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)){if((d=this.tileIndex.get(a))&&d.isReady){b.has(d.key.id)||
b.set(d.key.id,d);break}}else if(this._tileCache&&this._tileCache.has(a)&&(d=this._tileCache.pop(a),this.tileIndex.set(a,d),d&&d.isReady)){b.has(d.key.id)||b.set(d.key.id,d);break}}};return a}()})},"esri/views/2d/tiling/TileCache":function(){define(["require","exports","../../../core/libs/gl-matrix-2/vec2"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c,f){this.maxSize=a;this.tileInfoView=c;this.removedFunc=f;this._tilePerId=new Map;this._tileKeysPerLevel=
[]}a.prototype.has=function(a){return this._tilePerId.has(a)};a.prototype.get=function(a){return this._tilePerId.get(a)};a.prototype.pop=function(a){var c=this._tilePerId.get(a);if(!c)return null;var f=this._tileKeysPerLevel[c.key.level];this._tilePerId["delete"](a);for(var e=0;e<f.length;e++)if(f[e].id===a){f.splice(e,1);break}c.visible=!0;return c};a.prototype.add=function(a){a.visible=!1;var c=a.key,f=c.id;this._tilePerId.has(f)||(this._tilePerId.set(f,a),a=c.level,this._tileKeysPerLevel[a]||(this._tileKeysPerLevel[a]=
[]),this._tileKeysPerLevel[a].push(c))};a.prototype.prune=function(a,c,f){var e=this._tilePerId.size;if(!(e<=this.maxSize)){for(var h=this._tileKeysPerLevel.length-1;e>this.maxSize&&0<=h;)h!==a&&(e=this._pruneAroundCenterTile(e,c,f,h)),h--;e>this.maxSize&&(e=this._pruneAroundCenterTile(e,c,f,a))}};a.prototype._pruneAroundCenterTile=function(a,c,f,e){e=this._tileKeysPerLevel[e];if(!e||0===e.length)return a;var h=this.tileInfoView.tileInfo,b=h.size,d=h.origin,g=f*b[0],k=f*b[1],n=[0,0],u=[0,0];for(e.sort(function(a,
b){n[0]=d.x+g*(a.col+.5);n[1]=d.y-k*(a.row+.5);u[0]=d.x+g*(b.col+.5);u[1]=d.y-k*(b.row+.5);return l.vec2.squaredDistance(n,c)-l.vec2.squaredDistance(u,c)});0<e.length&&(f=e.pop(),this._removeTile(f.id),a--,a!==this.maxSize););return a};a.prototype._removeTile=function(a){var c=this._tilePerId.get(a);this.removedFunc&&this.removedFunc(c);this._tilePerId["delete"](a)};return a}();a.default=c})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],
function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._reference=null}Object.defineProperty(a.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(a){this.reference&&this.reference.hasData&&(a||this.reference.isDirty)&&(this.reference.isDirty=a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"reference",{get:function(){return this._reference},set:function(a){this._reference=a},enumerable:!0,configurable:!0});a.prototype.reset=function(a,c,f){a=a.state;var e=f.layerView.tileRenderer,h=this.reference;if(!h||!h.hasData)return!1;c&&(h.isDirty=!0);c=h.transforms.labelMat2d;for(var b=c[4],d=c[5],g=0,k=h.displayObjects;g<k.length;g++)for(var n=k[g],u=e.featuresView.attributeView,u=f.hasVV()?u.getVVSize(n.id):0,y=0,n=n.metrics;y<n.length;y++){var w=n[y];f.hasVV()&&
w.computeOffset(u,f.vvEval);var t=w.bounds.center,v=w.bounds.centerT;h.isDirty&&(w.minZoom=-1);var z=l.vec2.copy(v,w.anchor);a.rotation?l.vec2.transformMat2d(z,z,c):(v[0]=z[0]+b,v[1]=z[1]+d);l.vec2.add(v,z,t);v[0]+=w.offsetX;v[1]+=w.offsetY;if(w.boxes)for(t=0,v=w.boxes;t<v.length;t++){var z=v[t],A=z.centerT;l.vec2.add(A,w.anchor,z.center);a.rotation?l.vec2.transformMat2d(A,A,c):(A[0]+=b,A[1]+=d)}}return!0};return a}();a.default=c})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),
function(c,a,l,g,k,h){function f(a){return function(b){return k.pt2px(h.getSizeForValueSimple(b,a))}}function e(a){if(!a)return null;for(var b=0;b<a.length;b++){var d=a[b];if("size"===d.type)return f(d)}return null}Object.defineProperty(a,"__esModule",{value:!0});var p=function(a,b){return a.order-b.order},b=function(a,b){return a.index-b.index},d=l.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");a.createLabelVVEvaluator=e;c=function(){function a(a,b,d,c){var f=this;this._vvHandle=
null;var h=a.layer,k=h.geometryType,m=h.labelingInfo,n=h.renderer;this.vvEval=e("visualVariables"in n&&n.visualVariables);this._vvHandle=h.watch("visualVariables",function(a){f.vvEval=e(a)});h=m.map(function(a){var b=!!a.maxScale,d=!!a.minScale&&c.scaleToZoom(a.minScale)||0;a=b&&c.scaleToZoom(a.maxScale)||255;return{minZoom:g.clamp(Math.floor(10*d),0,255),maxZoom:g.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=k;this.index=b;this.order=d;this.zoomRanges=h;this.layerView=a}a.prototype.hasVV=
function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(b,d,e,c){e=e.sort(p);for(var f=!1,h=-1,g=0;g<e.length;g++){var k=e[g];!f&&k.order>d&&(h=k.index,f=!0);f&&k.index++}f||(h=e.length);return new a(b,h,d,c)};a.delete=function(a,d){for(var e=d.sort(b),c=a+1;c<e.length;c++)d[c].index--;d[a].destroy();d.splice(a,1)};a.find=function(a,b){for(var e=0;e<b.length;e++){var c=b[e];
if(c.index===a)return c}d.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();a.default=c})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(c,a,l,g){function k(a,b){switch(b.transformationType){case "additive":var d=h(b.minSize,a);return a+(d||b.minDataValue);case "constant":return d=(d=b.stops)&&d.length&&d[0].size,
null==d&&(d=b.minSize),h(d,a);case "clamped-linear":var d=(a-b.minDataValue)/(b.maxDataValue-b.minDataValue),c=h(b.minSize,a),k=h(b.maxSize,a);a=a<=b.minDataValue?c:a>=b.maxDataValue?k:c+d*(k-c);return a;case "proportional":return d=a/b.minDataValue,c=h(b.minSize,a),a=h(b.maxSize,a),l.clamp(d*c,c,a);case "stops":return c=f(a,b.cache.ipData),k=c[0],d=c[1],c=c[2],k===d?a=h(b.stops[k].size,a):(k=h(b.stops[k].size,a),a=h(b.stops[d].size,a),a=k+(a-k)*c),a;case "real-world-size":d=g.meterIn[b.valueUnit];
c=h(b.minSize,a);k=h(b.maxSize,a);b=b.valueRepresentation;var n=null,n="area"===b?2*Math.sqrt(a/e)/d:"radius"===b||"distance"===b?2*a/d:a/d;return l.clamp(n,c,k);case "identity":return a;case "unknown":return null}}function h(a,b){return"number"===typeof a?a:k(b,a)}function f(a,b){if(b){var d=0,e=b.length-1;b.some(function(b,c){if(a<b)return e=c,!0;d=c;return!1});return[d,e,(a-b[d])/(b[e]-b[d])]}}Object.defineProperty(a,"__esModule",{value:!0});var e=Math.PI;a.getSizeForValueSimple=k})},"esri/renderers/support/utils":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/Logger ../../core/unitUtils ../../intl/date ./numberUtils ../visualVariables/support/ColorStop".split(" "),
function(c,a,l,g,k,h,f,e){function p(a,b,d){var e="";0===b?e=m.lt+" ":b===d&&(e=m.gt+" ");return e+a}function b(a){var b=a.minValue,d=a.maxValue,e=a.isFirstBreak?"":m.gt+" ";a="percent-of-total"===a.normalizationType?m.pct:"";b=null==b?"":f.format(b);d=null==d?"":f.format(d);return e+b+a+" "+m.ld+" "+d+a}Object.defineProperty(a,"__esModule",{value:!0});var d=g.getLogger("esri.renderers.support.utils"),m={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},r={millisecond:0,second:1,
minute:2,hour:3,day:4,month:5,year:6},n={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};a.meterIn={inches:k.convertUnit(1,"meters","inches"),feet:k.convertUnit(1,"meters","feet"),"us-feet":k.convertUnit(1,"meters","us-feet"),yards:k.convertUnit(1,"meters","yards"),miles:k.convertUnit(1,"meters","miles"),"nautical-miles":k.convertUnit(1,
"meters","nautical-miles"),millimeters:k.convertUnit(1,"meters","millimeters"),centimeters:k.convertUnit(1,"meters","centimeters"),decimeters:k.convertUnit(1,"meters","decimeters"),meters:k.convertUnit(1,"meters","meters"),kilometers:k.convertUnit(1,"meters","kilometers"),"decimal-degrees":1/k.lengthToDegrees(1,"meters")};a.timelineDateFormatOptions=h.convertDateFormatToIntlOptions("short-date");a.createColorStops=function(a){var b=a.values,d=a.colors,c=a.labelIndexes,g=a.isDate,k=a.dateFormatOptions;
return b.map(function(a,m){var n=null;if(!c||-1<c.indexOf(m)){var l=void 0;(l=g?h.formatDate(a,k):f.format(a))&&(n=p(l,m,b.length-1))}return new e({value:a,color:d[m],label:n})})};a.updateColorStops=function(a){var b=a.stops,d=a.changes,e=a.isDate,c=a.dateFormatOptions,g=b.map(function(a){return a.value});a=[];for(var k=0;k<d.length;k++){var m=d[k];a.push(m.index);g[m.index]=m.value}var n=f.round(g,{indexes:a});b.forEach(function(a,d){a.value=g[d];if(null!=a.label){var k=void 0,m=null;(k=e?h.formatDate(n[d],
c):f.format(n[d]))&&(m=p(k,d,b.length-1));a.label=m}})};a.createClassBreakLabel=b;a.setLabelsForClassBreaks=function(a){var e=a.classBreakInfos,c=a.normalizationType,h=[];if(e&&e.length)if("standard-deviation"===a.classificationMethod)d.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(a.round){h.push(e[0].minValue);for(a=0;a<e.length;a++)h.push(e[a].maxValue);h=f.round(h);e.forEach(function(a,d){a.label=b({minValue:0===d?h[0]:
h[d],maxValue:h[d+1],isFirstBreak:0===d,normalizationType:c})})}else e.forEach(function(a,d){a.label=b({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===d,normalizationType:c})})};a.updateClassBreak=function(a){if("standard-deviation"===a.classificationMethod)d.warn("updateClassBreak","cannot update labels for class breaks generated using 'standard-deviation' method.");else{var e=a.classBreaks,c=a.change,f=c.index,c=c.value,h=e.length,g=-1,k=-1;0===f?g=f:f===h?k=f-1:(k=f-1,g=f);a=a.normalizationType;
f=null;-1<g&&g<h&&(f=e[g],f.minValue=c,f.label=b({minValue:f.minValue,maxValue:f.maxValue,isFirstBreak:0===g,normalizationType:a}));-1<k&&k<h&&(f=e[k],f.maxValue=c,f.label=b({minValue:f.minValue,maxValue:f.maxValue,isFirstBreak:0===k,normalizationType:a}))}};a.calculateDateFormatInterval=function(a){a=a.map(function(a){return new Date(a)});for(var b=a.length,d=Infinity,e=null,c=0;c<b-1;c++){for(var f=a[c],h=[],g=Infinity,k=null,m=c+1;m<b;m++){var n=a[m],n=f.getFullYear()!==n.getFullYear()&&"year"||
f.getMonth()!==n.getMonth()&&"month"||f.getDate()!==n.getDate()&&"day"||f.getHours()!==n.getHours()&&"hour"||f.getMinutes()!==n.getMinutes()&&"minute"||f.getSeconds()!==n.getSeconds()&&"second"||"millisecond",l=r[n];l<g&&(g=l,k=n);h.push(n)}g<d&&(d=g,e=k)}return e};a.createUniqueValueLabel=function(a){var b=a.value,d=a.domain,e=a.fieldInfo;a=a.dateFormatInterval;var c=String(b);(d=d&&"codedValues"in d&&d.codedValues?d.getName(b):null)?c=d:"number"===typeof b&&(c=e&&"date"===e.type?h.formatDate(b,
a&&h.convertDateFormatToIntlOptions(n[a])):f.format(b));return c}})},"esri/renderers/support/numberUtils":function(){define(["require","exports","../../intl"],function(c,a,l){function g(a,b){return a-b}function k(a,b){var d;d=Number(a.toFixed(b));d<a?a=d+1/Math.pow(10,b):(a=d,d-=1/Math.pow(10,b));d=Number(d.toFixed(b));a=Number(a.toFixed(b));return[d,a]}function h(a,b,c,f,h){a=e(a,b,c,f);b=null==a.next||a.next<=h;return(null==a.previous||a.previous<=h)&&b||a.previous+a.next<=2*h}function f(a){a=String(a);
var b=a.match(p);if(b&&b[1])return{integer:b[1].split("").length,fractional:b[3]?b[3].split("").length:0};if(-1<a.toLowerCase().indexOf("e")&&(b=a.split("e"),a=b[0],b=b[1],a&&b)){a=Number(a);var b=Number(b),d=0<b;d||(b=Math.abs(b));a=f(a);d?(a.integer+=b,a.fractional=b>a.fractional?0:a.fractional-b):(a.fractional+=b,a.integer=b>a.integer?1:a.integer-b);return a}return{integer:0,fractional:0}}function e(a,b,e,c){var d={previous:null,next:null};if(null!=e){var f=a-e;d.previous=Math.floor(Math.abs(100*
(b-e-f)/f))}null!=c&&(f=c-a,d.next=Math.floor(Math.abs(100*(c-b-f)/f)));return d}Object.defineProperty(a,"__esModule",{value:!0});var p=/^-?(\d+)(\.(\d+))?$/i;a.numDigits=f;a.percentChange=e;a.round=function(a,b){void 0===b&&(b={});a=a.slice(0);var d=b.tolerance,d=void 0===d?2:d,e=b.strictBounds,e=void 0===e?!1:e;b=b.indexes;b=void 0===b?a.map(function(a,b){return b}):b;b.sort(g);for(var c=0;c<b.length;c++){var m=b[c],l=a[m],p=0===m?null:a[m-1],v=m===a.length-1?null:a[m+1],z=f(l).fractional;if(z){for(var A=
0,C=!1,D=void 0;A<=z&&!C;)C=k(l,A),D=e&&0===c?C[1]:C[0],C=h(l,D,p,v,d),A++;C&&(a[m]=D)}}return a};var b={maximumFractionDigits:20};a.format=function(a){return l.formatNumber(a,b)}})},"esri/intl":function(){define(["require","exports","./intl/date","./intl/number","./intl/substitute"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});a.formatDate=l.formatDate;a.convertDateFormatToIntlOptions=l.convertDateFormatToIntlOptions;a.formatNumber=g.formatNumber;a.convertNumberFormatToIntlOptions=
g.convertNumberFormatToIntlOptions;a.substitute=k.substitute})},"esri/intl/substitute":function(){define("require exports ../core/Logger ../core/object ../core/string ./date ./number".split(" "),function(c,a,l,g,k,h,f){function e(a){switch(typeof a){case "string":return a;case "number":return f.formatNumber(a);case "boolean":return""+a;default:return a instanceof Date?h.formatDate(a):""}}Object.defineProperty(a,"__esModule",{value:!0});var p=l.getLogger("esri.intl");a.substitute=function(a,d,c){void 0===
c&&(c={});c=c.format;var b=void 0===c?{}:c;return k.replace(a,function(a){var c;var k,m=a.indexOf(":");-1===m?k=a.trim():(k=a.slice(0,m).trim(),c=a.slice(m+1).trim());if(k)if(a=g.getDeepValue(k,d),null==a)c="";else if(k=b[c]||b[k])b:switch(k.type){case "date":c=h.formatDate(a,k.intlOptions);break b;case "number":c=f.formatNumber(a,k.intlOptions);break b;default:p.warn("missing format descriptor for key {key}"),c=e(a)}else if(c)b:switch(c.toLowerCase()){case "dateformat":c=h.formatDate(a);break b;
case "numberformat":c=f.formatNumber(a);break b;default:p.warn("inline format is unsupported since 4.12: "+c),c=/^(dateformat|datestring)/i.test(c)?h.formatDate(a):/^numberformat/i.test(c)?f.formatNumber(a):e(a)}else c=e(a);else c="";return c})}})},"esri/renderers/visualVariables/support/ColorStop":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType".split(" "),
function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.color=null;b.label=null;b.value=null;return b}l(b,a);d=b;b.prototype.writeValue=function(a,b,d){b[d]=null==a?0:a};b.prototype.clone=function(){return new d({color:this.color&&this.color.clone(),label:this.label,value:this.value})};var d;g([f.property({type:k,json:{type:[e.Integer],write:!0}})],b.prototype,"color",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([f.property({type:Number,
json:{write:{allowNull:!0}}})],b.prototype,"value",void 0);g([f.writer("value")],b.prototype,"writeValue",null);return b=d=g([f.subclass("esri.renderers.visualVariables.support.ColorStop")],b)}(f.declared(h.JSONSupport))})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","../../../../../core/Error","../../../../../core/Logger"],function(c,a,l,g){function k(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===
a.declaredClass}Object.defineProperty(a,"__esModule",{value:!0});var h=g.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");c=function(){function a(a,c){this.registerLayer=a;this.unregisterLayer=c;this._layerViewState=new Map}a.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(e){return e.uid===a.uid})};a.prototype.update=function(a){for(var e=a.added,b=0,d=a.removed;b<d.length;b++)a=d[b],k(a)&&this._layerViewState.has(a)&&this._deleteState(a);for(b=0;b<e.length;b++){a=
e[b];if(d=k(a))a:if(a.layer&&a.layer.renderer)switch(a.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":d=!0;break a;default:h.error(new l("mapview-labeling","Renderer of type "+a.layer.renderer.type+" does not currently support labeling")),d=!1}else d=!1;d&&!this._layerViewState.has(a)&&this._createState(a)}this._recomputeOrder()};a.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handle.remove()})};a.prototype._createState=
function(a){var e={priority:-1,handle:null};e.handle=a.watch("labelsVisible",this._recomputeOrder.bind(this));this._layerViewState.set(a,e);return e};a.prototype._deleteState=function(a){if(this._layerViewState.has(a)){var e=this._layerViewState.get(a);e.handle.remove();-1!==e.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};a.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(e,b){var d=b.view.map.allLayers.findIndex(function(a){return a.uid===
b.layer.uid}),c=b.layer,d=c.visible&&c.labelsVisible&&c.labelingInfo?4294967295-d:-1;d!==e.priority&&(e.priority=d,a.unregisterLayer(b),-1!==d&&a.registerLayer(b,d))})};return a}();a.LayerViewSorter=c})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.getXAnchorDirection=function(a){switch(a){case "left":return 1;case "right":return-1;case "center":case "justify":return 0}};a.getYAnchorDirection=function(a){switch(a){case "top":return-1;
case "middle":return 0;case "baseline":case "bottom":return 1}};a.getJustification=function(a){switch(a){case "left":return 0;case "right":return 1;case "center":case "justify":return.5}}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../definitions ../VertexStream ./WGLBrush".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});var f={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],
samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return b}l(e,a);e.prototype.dispose=function(){this._quad&&this._quad.dispose()};e.prototype.prepareState=function(a,d){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);
a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,d.stencilRef,255)};e.prototype.draw=function(a,d){var b=a.context,e=a.renderingOptions,c=a.painter;if(d.source){a.timeline.begin(this.name);this._quad||(this._quad=new k(b,[0,0,1,0,0,1,1,1]));if("dynamic"===e.samplingMode)var e=a.state,h=d.resolution/d.pixelRatio/e.resolution,l=Math.round(a.pixelRatio)!==a.pixelRatio,e=e.rotation||1.05<h||.95>h||l||d.isSourceScaled||d.rotation?f.bilinear:f.nearest;else e=f[e.samplingMode];
c=c.materialManager.getProgram(a,this._desc,e.defines);d.setSamplingProfile(e);d.bind(g.TEXTURE_BINDING_BITMAP);b.bindProgram(c);c.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);c.setUniform1i("u_texture",g.TEXTURE_BINDING_BITMAP);c.setUniform2fv("u_coordScale",d.coordScale);this._quad.draw();a.timeline.end(this.name)}};return e}(h.default);a.default=c})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(0,1,0,1);return b}l(b,a);b.prototype.dispose=function(){this._program&&this._program.dispose()};b.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,
0,255)};b.prototype.draw=function(a,b){var d=a.context;a=a.state;this._program||(this._program=e.createProgram(d,f.background));var c=this._program,h=k.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});b=b.getVAO(d,a,h.attributes,h.bufferLayouts);d.bindProgram(this._program);c.setUniform2fv("u_coord_range",[1,1]);c.setUniform4fv("u_color",this._color);c.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);d.bindVAO(b);d.drawElements(4,b.indexBuffer.size,5125,0);d.bindVAO()};
return b}(h.default);a.default=c})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function d(){var b=null!==a&&a.apply(this,
arguments)||this;b._color=k.vec4f32.fromValues(1,0,0,1);b._patternMatrix=g.mat3f32.create();b._programOptions={id:!1,pattern:!1};return b}l(d,a);d.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};d.prototype.drawMany=function(a,d){var c=a.context,f=a.styleLayerId;this._loadWGLResources(c);var h=a.displayLevel,g=a.styleLayer,k=a.painter.getVectorTileProgramCach(),m=g.getPaintValue("background-color",h),n=g.getPaintValue("background-opacity",
h),l=g.getPaintValue("background-pattern",h),r=void 0!==l,u=m[3]*n,F=a.spriteMosaic,H,J=(window.devicePixelRatio|1)>e.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===p.WGLDrawPhase.HITTEST;var K=this._programOptions;K.id=a;K.pattern=r;k=k.getProgram(0,(a?1:0)<<1|(r?1:0),K);c.bindVAO(this._vao);c.bindProgram(k);if(r){H=F.getMosaicItemPosition(l,!0);if(!H)return;k.setUniform1f("u_opacity",n);k.setUniform2f("u_pattern_tl",H.tl[0],H.tl[1]);k.setUniform2f("u_pattern_br",H.br[0],H.br[1]);k.setUniform1i("u_texture",
e.VTL_TEXTURE_BINDING_UNIT_SPRITES);F.bind(c,9729,H.page,e.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=u*m[0],this._color[1]=u*m[1],this._color[2]=u*m[2],this._color[3]=u,k.setUniform4fv("u_color",this._color);k.setUniform1f("u_depth",g.z||0);a&&(f=b.u32to4Xu8(f),k.setUniform4f("u_id",f[0],f[1],f[2],f[3]));for(f=0;f<d.length;f++)g=d[f],k.setUniform1f("u_coord_range",g.coordRange[0]),k.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),r&&(m=J*g.size[0]*Math.max(Math.pow(2,Math.round(h)-g.key.level),
1),n=m/H.size[1],this._patternMatrix[0]=m/H.size[0],this._patternMatrix[4]=n,k.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),c.setStencilFunction(514,g.stencilRef,255),c.drawArrays(5,0,4)};d.prototype._loadWGLResources=function(a){if(!this._program||!this._vao){var b=h.createProgram(a,f.background);if(b){var d=new Int8Array([0,0,1,0,0,1,1,1]),d=h.BufferObject.createVertex(a,35044,d);a=new h.VertexArrayObject(a,f.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,
stride:2,normalized:!1,divisor:0}]},{geometry:d});this._program=b;this._vao=a}}};return d}(d.default);a.WGLBrushVTLBackground=c})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});var p=[1,1,1,1];c=function(a){function b(){var b=null!==
a&&a.apply(this,arguments)||this;b._color=g.vec4f32.create();b._strokeColor=g.vec4f32.create();b._programOptions={id:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return b}l(b,a);b.prototype.dispose=
function(){};b.prototype.drawMany=function(a,b){var d=a.context,e=a.state,c=a.drawPhase,g=a.styleLayerId,k=a.displayLevel,m=a.styleLayer;a=a.painter.getVectorTileProgramCach();var l=m.hasDataDrivenRadius?1:m.getPaintValue("circle-radius",k),r=m.hasDataDrivenColor?p:m.getPaintValue("circle-color",k),C=m.hasDataDrivenOpacity?1:m.getPaintValue("circle-opacity",k),D=m.hasDataDrivenStrokeWidth?1:m.getPaintValue("circle-stroke-width",k),B=m.hasDataDrivenStrokeColor?p:m.getPaintValue("circle-stroke-color",
k),E=m.hasDataDrivenStrokeOpacity?1:m.getPaintValue("circle-stroke-opacity",k),F=m.hasDataDrivenBlur?0:m.getPaintValue("circle-blur",k),C=C*r[3];this._color[0]=C*r[0];this._color[1]=C*r[1];this._color[2]=C*r[2];this._color[3]=C;C=E*B[3];this._strokeColor[0]=C*B[0];this._strokeColor[1]=C*B[1];this._strokeColor[2]=C*B[2];this._strokeColor[3]=C;r=m.getPaintValue("circle-translate",k);k=m.getPaintValue("circle-translate-anchor",k);B=c===h.WGLDrawPhase.HITTEST;c=this._programOptions;c.id=B;c=a.getProgram(5,
B?1:0,c);d.bindProgram(c);c.setUniformMatrix3fv("u_displayMat3",1===k?e.displayMat3:e.displayViewMat3);c.setUniform2fv("u_circleTranslation",r);c.setUniform1f("u_depth",m.z);c.setUniform1f("u_radius",l);c.setUniform4fv("u_color",this._color);c.setUniform1f("u_blur",F);c.setUniform1f("u_stroke_width",D);c.setUniform4fv("u_stroke_color",this._strokeColor);c.setUniform1f("u_antialiasingWidth",1.2);B&&(e=f.u32to4Xu8(g),c.setUniform4f("u_id",e[0],e[1],e[2],e[3]));for(e=0;e<b.length;e++)if(m=b[e],m.layerData[g]&&
(l=m.layerData[g],D=this._getCircleVAO(d,m,a)))d.bindVAO(D),c.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),d.setStencilFunction(514,m.stencilRef,255),d.drawElements(4,l.triangleElementCount,5125,12*l.triangleElementStart),m.triangleCount+=l.triangleElementCount/3};b.prototype._getCircleVAO=function(a,b,d){if(b.circleVertexArrayObject)return b.circleVertexArrayObject;var e=b.circleVertexBuffer,c=b.circleIndexBuffer;if(!e||!c)return null;b.circleVertexArrayObject=new k.VertexArrayObject(a,d.getProgramAttributes(5),
this._vertexAttributes,{geometry:e},c);return b.circleVertexArrayObject};return b}(e.default);a.WGLBrushVTLCircle=c})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});var d=
1/65536,m=[1,1,1,1];c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};b._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};b._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},
{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};b._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,
divisor:0}]};b._color=k.vec4f32.create();b._outlineColor=k.vec4f32.create();b._fillProgramOptions={id:!1,dd:!1,pattern:!1};b._outlineProgramOptions={id:!1,dd:!1};b._patternMatrix=g.mat3f32.create();return b}l(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var d=a.displayLevel,c=a.drawPhase,f=a.renderPass,h=a.styleLayerId,g=a.styleLayer,k=g.getPaintValue("fill-pattern",d),n=g.hasDataDrivenColor?m:g.getPaintValue("fill-color",d),l=g.hasDataDrivenOpacity?1:g.getPaintValue("fill-opacity",
d),r=l*n[3],u=void 0!==k||1>r||g.hasDataDrivenFill;if(!u||"opaque"!==f){this._color[0]=r*n[0];this._color[1]=r*n[1];this._color[2]=r*n[2];this._color[3]=r;var y;c===e.WGLDrawPhase.HITTEST&&(y=p.u32to4Xu8(h));c=g.getPaintValue("fill-translate",d);d=g.getPaintValue("fill-translate-anchor",d);this._drawFill(a,h,g,b,c,d,k,u,y);this._drawOutline(a,h,g,b,c,d,k,y,l)}};b.prototype._drawFill=function(a,b,c,h,g,k,m,n,l){var p=a.context,v=a.displayLevel,t=a.drawPhase,w=a.renderPass,r=a.spriteMosaic,u=a.state;
if(n||"translucent"!==w){n=void 0!==m;var w=a.pixelRatio>f.VTL_HIGH_RES_CUTOFF?2:1,y=c.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var z,A=t===e.WGLDrawPhase.HITTEST,t=this._fillProgramOptions;t.id=A;t.dd=y;t.pattern=n;t=a.getProgram(1,(A?1:0)<<2|(y?1:0)<<1|(n?1:0),t);p.bindProgram(t);if(n){z=r.getMosaicItemPosition(m,!0);if(!z){p.bindProgram();return}t.setUniform2f("u_pattern_tl",z.tl[0],z.tl[1]);t.setUniform2f("u_pattern_br",z.br[0],z.br[1]);t.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES);
r.bind(p,9729,z.page,f.VTL_TEXTURE_BINDING_UNIT_SPRITES)}t.setUniformMatrix3fv("u_displayMat3",1===k?u.displayMat3:u.displayViewMat3);t.setUniform2fv("u_fillTranslation",g);t.setUniform1f("u_depth",c.z+d);t.setUniform4fv("u_color",this._color);A&&t.setUniform4f("u_id",l[0],l[1],l[2],l[3]);for(c=0;c<h.length;c++)if(g=h[c],g.layerData[b]&&(m=this._getFillVAO(p,g,y,a)))k=g.layerData[b],p.bindVAO(m),t.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),n&&(m=g.coordRange[0]/(w*g.size[0]*Math.max(Math.pow(2,
Math.round(v)-g.key.level),1)),l=1/(z.size[1]*m),this._patternMatrix[0]=1/(z.size[0]*m),this._patternMatrix[4]=l,t.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),p.setStencilFunction(514,g.stencilRef,255),p.drawElements(4,k.triangleElementCount,5125,12*k.triangleElementStart),g.triangleCount+=k.triangleElementCount/3}};b.prototype._drawOutline=function(a,b,c,f,h,g,k,n,l){var p=a.context,v=a.displayLevel,t=a.drawPhase,w=a.pixelRatio,r=a.state;if("opaque"!==a.renderPass&&(k=void 0!==k,
c.getPaintValue("fill-antialias",v)&&!k||c.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();k=c.hasDataDrivenOutline;if(c.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else v=c.hasDataDrivenOutlineColor?m:c.getPaintValue("fill-outline-color",v),l*=v[3],this._outlineColor[0]=l*v[0],this._outlineColor[1]=l*v[1],this._outlineColor[2]=
l*v[2],this._outlineColor[3]=l;w=.75/w;l=t===e.WGLDrawPhase.HITTEST;t=this._outlineProgramOptions;t.id=l;t.dd=k;t=a.getProgram(2,(l?1:0)<<1|(k?1:0),t);p.bindProgram(t);t.setUniformMatrix3fv("u_displayMat3",1===g?r.displayMat3:r.displayViewMat3);t.setUniform2fv("u_fillTranslation",h);t.setUniform1f("u_depth",c.z+d);t.setUniform1f("u_outline_width",w);t.setUniform4fv("u_color",this._outlineColor);l&&t.setUniform4f("u_id",n[0],n[1],n[2],n[3]);for(c=0;c<f.length;c++)if(h=f[c],h.layerData[b]){g=h.layerData[b];
n=this._getOutlineVAO(p,h,k,a);if(!n)break;p.bindVAO(n);t.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs);p.setStencilFunction(514,h.stencilRef,255);p.drawElements(4,g.outlineElementCount,5125,12*g.outlineElementStart);h.triangleCount+=g.outlineElementCount/3}}};b.prototype._getFillVAO=function(a,b,d,e){if(d){if(b.fillDDVertexArrayObject)return b.fillDDVertexArrayObject;d=b.fillDDVertexBuffer;var c=b.fillIndexBuffer;if(!d||!c)return null;b.fillDDVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(1),
this._fillVertexAttributesDD,{geometry:d},c);return b.fillDDVertexArrayObject}if(b.fillVertexArrayObject)return b.fillVertexArrayObject;d=b.fillVertexBuffer;c=b.fillIndexBuffer;if(!d||!c)return null;b.fillVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(1),this._fillVertexAttributes,{geometry:d},c);return b.fillVertexArrayObject};b.prototype._getOutlineVAO=function(a,b,d,e){if(d){if(b.outlineDDVertexArrayObject)return b.outlineDDVertexArrayObject;d=b.outlineDDVertexBuffer;var c=
b.outlineIndexBuffer;if(!d||!c)return null;b.outlineDDVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:d},c);return b.outlineDDVertexArrayObject}if(b.outlineVertexArrayObject)return b.outlineVertexArrayObject;d=b.outlineVertexBuffer;c=b.outlineIndexBuffer;if(!d||!c)return null;b.outlineVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:d},c);return b.outlineVertexArrayObject};
return b}(b.default);a.WGLBrushVTLFill=c})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var d=[1,1,1,1];c=function(a){function b(){var b=null!==
a&&a.apply(this,arguments)||this;b._color=k.vec4f32.create();b._dashArray=g.vec2f32.create();b._programOptions={id:!1,dd:!1,pattern:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};b._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,
normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return b}l(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var c=a.context,h=a.displayLevel,g=a.state,k=a.drawPhase,
m=a.styleLayerId,n=a.styleLayer,l=a.painter.getVectorTileProgramCach(),r=n.getPaintValue("line-translate",h),u=n.getPaintValue("line-translate-anchor",h),E=n.getPaintValue("line-pattern",h),F=void 0!==E,H=1/a.pixelRatio,J=n.getPaintValue("line-blur",h),K=n.hasDataDrivenColor?d:n.getPaintValue("line-color",h),G=n.hasDataDrivenOpacity?1:n.getPaintValue("line-opacity",h),I=n.hasDataDrivenWidth?1:n.getPaintValue("line-width",h),G=G*K[3];this._color[0]=G*K[0];this._color[1]=G*K[1];this._color[2]=G*K[2];
this._color[3]=G;var K=n.hasDataDrivenLine,G=k===e.WGLDrawPhase.HITTEST,L;G&&(L=p.u32to4Xu8(m));k=this._programOptions;k.id=G;k.dd=K;k.pattern=F;k=l.getProgram(3,(G?1:0)<<2|(K?1:0)<<1|(F?1:0),k);c.bindProgram(k);k.setUniformMatrix3fv("u_displayViewMat3",g.displayViewMat3);k.setUniformMatrix3fv("u_displayMat3",1===u?g.displayMat3:g.displayViewMat3);k.setUniform2fv("u_lineTranslation",r);k.setUniform1f("u_depth",n.z);k.setUniform1f("u_blur",J);k.setUniform1f("u_antialiasing",H);k.setUniform4fv("u_color",
this._color);k.setUniform1f("u_width",I);G&&k.setUniform4f("u_id",L[0],L[1],L[2],L[3]);if(F){if(a=a.spriteMosaic,E=a.getMosaicItemPosition(E,!0))a.bind(c,9729,E.page,f.VTL_TEXTURE_BINDING_UNIT_SPRITES),k.setUniform2f("u_pattern_tl",E.tl[0],E.br[1]),k.setUniform2f("u_pattern_br",E.br[0],E.tl[1]),k.setUniform2f("u_spriteSize",8*E.size[0],E.size[1]),k.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else E=n.getPaintValue("line-dasharray",h),2>E.length&&(E=[1,-1]),this._dashArray[0]=8*E[0],
this._dashArray[1]=8*E[1],k.setUniform2fv("u_dasharray",this._dashArray);for(E=0;E<b.length;E++)if(a=b[E],a.layerData[m]&&(h=a.layerData[m],g=this._getLineVAO(c,a,K,l)))c.bindVAO(g),k.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),c.setStencilFunction(514,a.stencilRef,255),c.drawElements(4,h.triangleElementCount,5125,12*h.triangleElementStart),a.triangleCount+=h.triangleElementCount/3};b.prototype._getLineVAO=function(a,b,d,e){if(d){if(b.lineDDVertexArrayObject)return b.lineDDVertexArrayObject;
d=b.lineDDVertexBuffer;var c=b.lineIndexBuffer;if(!d||!c)return null;b.lineDDVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(3),this._vertexAttributesDD,{geometry:d},c);return b.lineDDVertexArrayObject}if(b.lineVertexArrayObject)return b.lineVertexArrayObject;d=b.lineVertexBuffer;c=b.lineIndexBuffer;if(!d||!c)return null;b.lineVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(3),this._vertexAttributes,{geometry:d},c);return b.lineVertexArrayObject};return b}(b.default);
a.WGLBrushVTLLine=c})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){Object.defineProperty(a,"__esModule",{value:!0});var m=1/65536,r=[1,1,1,1];c=function(a){function d(){var b=null!==a&&a.apply(this,
arguments)||this;b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};b._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",
count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]};b._iconProgramOptions={id:!1,dd:!1,sdf:!1};b._sdfProgramOptions={id:!1,dd:!1};b._spritesTextureSize=g.vec2f32.create();b._haloColor=
k.vec4f32.create();b._sdfColor=k.vec4f32.create();b._color=k.vec4f32.create();return b}l(d,a);d.prototype.dispose=function(){};d.prototype.drawMany=function(a,d){var c=a.drawPhase,f=a.styleLayerId,h=a.styleLayer,g=a.fadeRecorder.getFadeValues(),k;c===e.WGLDrawPhase.HITTEST&&(k=b.u32to4Xu8(f));this._drawIcons(a,h,d,g,k);this._drawText(a,h,d,g,k)};d.prototype._drawIcons=function(a,b,d,c,h){for(var g=this,k=a.context,m=a.displayLevel,n=a.drawPhase,l=a.painter,v=a.state,t=a.styleLayerId,w,u=!1,z=0;z<
d.length;z++){var y=d[z];if(y.layerData[t]&&(w=y.layerData[t],0<w.iconPerPageElementsMap.size)){u=!0;break}}if(u){var y=b.hasDataDrivenIconSize?1:b.getLayoutValue("icon-size",m),L=b.hasDataDrivenIconColor?r:b.getPaintValue("icon-color",m),R=b.hasDataDrivenIconOpacity?1:b.getPaintValue("icon-opacity",m),u=b.getPaintValue("icon-translate",m),z=b.getPaintValue("icon-translate-anchor",m),M=l.getVectorTileProgramCach(),l=L[3]*R;this._color[0]=l*L[0];this._color[1]=l*L[1];this._color[2]=l*L[2];this._color[3]=
l;l=b.getLayoutValue("icon-rotation-alignment",m);2===l&&(l=1===b.getLayoutValue("symbol-placement",m)?0:1);var L=w.isSDF,Q=b.hasDataDrivenIcon,n=n===e.WGLDrawPhase.HITTEST,R=this._iconProgramOptions;R.id=n;R.dd=Q;R.sdf=L;var N=M.getProgram(4,(n?1:0)<<2|(Q?1:0)<<1|(L?1:0),R);k.bindProgram(N);L&&(L=b.getPaintValue("icon-halo-color",m),R=b.getPaintValue("icon-halo-width",m),N.setUniform4f("u_outlineColor",L[0],L[1],L[2],L[3]),N.setUniform1f("u_outlineSize",R));N.setUniformMatrix3fv("u_displayViewMat3",
0===l?v.displayViewMat3:v.displayMat3);N.setUniformMatrix3fv("u_displayMat3",1===z?v.displayMat3:v.displayViewMat3);N.setUniform2fv("u_iconTranslation",u);N.setUniform1f("u_depth",b.z);N.setUniform1f("u_mapRotation",p.degToByte(v.rotation));N.setUniform1f("u_keepUpright",0);N.setUniform1f("u_level",10*m);N.setUniform1f("u_fadeSpeed",10*c.fadeSpeed);N.setUniform1f("u_minfadeLevel",10*c.minfadeLevel);N.setUniform1f("u_maxfadeLevel",10*c.maxfadeLevel);N.setUniform1f("u_fadeChange",10*(m+c.fadeChange));
N.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES);N.setUniform1f("u_size",y);N.setUniform4fv("u_color",this._color);n&&N.setUniform4fv("u_id",h);b=function(b){if(!b.layerData[t])return"continue";w=b.layerData[t];if(0===w.iconPerPageElementsMap.size)return"continue";var d=U._getIconVAO(k,b,Q,M);if(!d)return"continue";k.bindVAO(d);N.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);w.iconPerPageElementsMap.forEach(function(d,e){g._renderIconRange(a,N,d,e,b)})};var U=this;for(c=0;c<d.length;c++)y=
d[c],b(y)}};d.prototype._renderIconRange=function(a,b,d,e,c){var h=a.context,g=a.hasClipping,k=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(e)/4;this._spritesTextureSize[1]=a.getHeight(e)/4;b.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(h,9729,e,f.VTL_TEXTURE_BINDING_UNIT_SPRITES);b=!0;k!==c.key.level||g?h.setStencilFunction(514,c.stencilRef,255):b=!1;h.setStencilTestEnabled(b);h.drawElements(4,d[1],5125,12*d[0]);c.triangleCount+=d[1]/3};d.prototype._drawText=
function(a,b,d,c,h){for(var k=this,n=a.context,l=a.displayLevel,v=a.drawPhase,t=a.glyphMosaic,w=a.hasClipping,u=a.painter,z=a.pixelRatio,y=a.requiredLevel,G=a.state,I=a.styleLayerId,L,R=!1,M=0;M<d.length;M++)if(a=d[M],a.layerData[I]&&(L=a.layerData[I],0<L.glyphPerPageElementsMap.size)){R=!0;break}if(R){a=b.getLayoutValue("text-rotation-alignment",l);2===a&&(a=1===b.getLayoutValue("symbol-placement",l)?0:1);var R=0===a,R=b.getLayoutValue("text-keep-upright",l)&&R,v=v===e.WGLDrawPhase.HITTEST,z=.8*
3/z,M=b.hasDataDrivenTextSize?1:b.getLayoutValue("text-size",l),Q=b.hasDataDrivenTextColor?r:b.getPaintValue("text-color",l),N=b.hasDataDrivenTextOpacity?1:b.getPaintValue("text-opacity",l),U=b.getPaintValue("text-halo-color",l),V=b.getPaintValue("text-halo-width",l),S=3*b.getPaintValue("text-halo-blur",l),X=3*V,W=u.getVectorTileProgramCach(),u=Q[3]*N;this._sdfColor[0]=u*Q[0];this._sdfColor[1]=u*Q[1];this._sdfColor[2]=u*Q[2];this._sdfColor[3]=u;u=U[3]*N;this._haloColor[0]=u*U[0];this._haloColor[1]=
u*U[1];this._haloColor[2]=u*U[2];this._haloColor[3]=u;this._glyphTextureSize||(this._glyphTextureSize=g.vec2f32.fromValues(t.width/4,t.height/4));var u=b.getPaintValue("text-translate",l),Q=b.getPaintValue("text-translate-anchor",l),Y=b.hasDataDrivenText,N=this._sdfProgramOptions;N.id=v;N.dd=Y;var T=W.getProgram(6,(v?1:0)<<1|(Y?1:0),N);n.bindProgram(T);T.setUniformMatrix3fv("u_displayViewMat3",0===a?G.displayViewMat3:G.displayMat3);T.setUniformMatrix3fv("u_displayMat3",1===Q?G.displayMat3:G.displayViewMat3);
T.setUniform2fv("u_textTranslation",u);T.setUniform1f("u_depth",b.z+m);T.setUniform2fv("u_mosaicSize",this._glyphTextureSize);T.setUniform1f("u_mapRotation",p.degToByte(G.rotation));T.setUniform1f("u_keepUpright",R?1:0);T.setUniform1f("u_level",10*l);T.setUniform1f("u_fadeSpeed",10*c.fadeSpeed);T.setUniform1f("u_minfadeLevel",10*c.minfadeLevel);T.setUniform1f("u_maxfadeLevel",10*c.maxfadeLevel);T.setUniform1f("u_fadeChange",10*(l+c.fadeChange));T.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
T.setUniform1f("u_size",M);T.setUniform1f("u_antialiasingWidth",z);v&&T.setUniform4f("u_id",h[0],h[1],h[2],h[3]);b=function(a){if(!a.layerData[I])return"continue";L=a.layerData[I];if(0===L.glyphPerPageElementsMap.size)return"continue";var b=ja._getSDFVAO(n,a,Y,W);if(!b)return"continue";n.bindVAO(b);T.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b=!0;y!==a.key.level||w?n.setStencilFunction(514,a.stencilRef,255):b=!1;n.setStencilTestEnabled(b);L.glyphPerPageElementsMap.forEach(function(b,d){k._renderGlyphRange(n,
b,d,t,T,U[3],V,S,X,a)})};var ja=this;for(c=0;c<d.length;c++)a=d[c],b(a)}};d.prototype._renderGlyphRange=function(a,b,d,e,c,h,g,k,m,n){e.bind(a,9729,d,f.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<h&&0<g&&(c.setUniform4fv("u_color",this._haloColor),c.setUniform1f("u_halo",1),c.setUniform1f("u_edgeDistance",m),c.setUniform1f("u_edgeBlur",k),a.drawElements(4,b[1],5125,12*b[0]),n.triangleCount+=b[1]/3);0<this._sdfColor[3]&&(c.setUniform4fv("u_color",this._sdfColor),c.setUniform1f("u_halo",0),c.setUniform1f("u_edgeDistance",
0),c.setUniform1f("u_edgeBlur",0),a.drawElements(4,b[1],5125,12*b[0]),n.triangleCount+=b[1]/3)};d.prototype._getIconVAO=function(a,b,d,e){if(d){if(b.iconDDVertexArrayObject)return b.iconDDVertexArrayObject;d=b.iconDDVertexBuffer;var c=b.iconIndexBuffer;if(!d||!c)return null;b.iconDDVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(4),this._vertexAttributesDD,{geometry:d},c);return b.iconDDVertexArrayObject}if(b.iconVertexArrayObject)return b.iconVertexArrayObject;d=b.iconVertexBuffer;
c=b.iconIndexBuffer;if(!d||!c)return null;b.iconVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(4),this._vertexAttributes,{geometry:d},c);return b.iconVertexArrayObject};d.prototype._getSDFVAO=function(a,b,d,e){if(d){if(b.textDDVertexArrayObject)return b.textDDVertexArrayObject;d=b.textDDVertexBuffer;var c=b.textIndexBuffer;if(!d||!c)return null;b.textDDVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(6),this._vertexAttributesDD,{geometry:d},c);return b.textDDVertexArrayObject}if(b.textVertexArrayObject)return b.textVertexArrayObject;
d=b.textVertexBuffer;c=b.textIndexBuffer;if(!d||!c)return null;b.textVertexArrayObject=new h.VertexArrayObject(a,e.getProgramAttributes(6),this._vertexAttributes,{geometry:d},c);return b.textVertexArrayObject};return d}(d.default);a.WGLBrushVTLSymbol=c})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../definitions ./WGLBrush".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",
{value:!0});c=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}l(e,a);e.prototype.prepareState=function(a,b,d){a=a.context;d=d&&-1!==d.indexOf("id");a.setBlendingEnabled(!d);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};e.prototype.draw=function(a,b,d){var e=this;if(b.isReady&&b.hasData){b.commitChanges();var c=this.getGeometryType(),f=b.getDisplayList(),h=
b.getGeometry(c);h&&f&&(a.timeline.begin(this.name),f.byType(c,function(c){e.drawGeometry(a,b,c,h,d)}),a.timeline.end(this.name))}};e.prototype._getVAO=function(a,b,d,e){e.vao||(e.vao=new g.VertexArrayObject(a,d,b,e.vertexBufferMap,e.indexBuffer));return e.vao};e.prototype._setSharedUniforms=function(a,b,d){a.setUniform1f("u_pixelRatio",b.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",b.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",
b.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",b.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",b.rendererInfo.insideOpacities);a.setUniform1fv("u_outsideOpacities",b.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",b.attributeView.size);a.setUniform1i("u_attributeData0",k.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",k.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",k.TEXTURE_BINDING_ATTRIBUTE_DATA_2);
a.setUniform1i("u_attributeData3",k.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return e}(h.default);a.default=c})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(c,a,l,g,k,h,f,e,p,b,d){Object.defineProperty(a,"__esModule",{value:!0});
c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._dotTextureSize=0;b._dotTextures=null;b._dotSamplers=new Int32Array([f.TEXTURE_BINDING_RENDERER_0,f.TEXTURE_BINDING_RENDERER_1]);return b}l(b,a);b.prototype.dispose=function(){this._disposeTextures()};b.prototype.getGeometryType=function(){return e.WGLGeometryType.FILL};b.prototype.drawGeometry=function(a,b,e,c,h){var g=a.context,k=a.painter,m=a.rendererInfo,n=a.requiredLevel,l=e.indexCount,t=e.indexFrom;e=d.FillMaterialKey.load(e.materialKey);
var w=p.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}].concat(e.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],e.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),r=w.bufferLayouts,w=w.attributes;
h=k.materialManager.getMaterialProgram(a,e,"materials/fill",w,h);c=this._getVAO(g,r,w,c);g.bindProgram(h);g.bindVAO(c);this._setSharedUniforms(h,a,b);e.textureBinding&&(k.textureManager.bindTextures(g,h,e),k=1/Math.pow(2,n-b.key.level)/a.pixelRatio,h.setUniform1f("u_zoomFactor",k));e.vvColor&&(h.setUniform1fv("u_vvColorValues",m.vvColorValues),h.setUniform4fv("u_vvColors",m.vvColors));e.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),h.setUniform1fv("u_vvOpacities",m.vvOpacities));
e.dotDensity&&(e=f.TILE_SIZE/m.ddDotSize,c=e*window.devicePixelRatio*e*window.devicePixelRatio,k=1/Math.pow(2,n-b.key.level),b=1/k*(1/k),a=m.ddDotScale?a.state.scale/m.ddDotScale:1,h.setUniform1f("u_tileZoomFactor",k),h.setUniform1f("u_tileDotsOverArea",c/(f.TILE_SIZE*window.devicePixelRatio*f.TILE_SIZE*window.devicePixelRatio)),h.setUniformMatrix4fv("u_dotColors",m.ddColors),h.setUniform4fv("u_isActive",m.ddActiveDots),h.setUniform4fv("u_dotBackgroundColor",m.ddBackgroundColor),h.setUniform1f("u_dotValue",
Math.max(1,m.ddDotValue*a*b)),this._bindDotDensityTextures(g,h,m,e));g.drawElements(4,l,5125,4*t);g.bindVAO(null)};b.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};b.prototype._bindDotDensityTextures=function(a,b,d,e){d=this._createDotDensityTextures(a,e,d.ddSeed);b.setUniform1iv("u_dotTextures",this._dotSamplers);for(b=0;b<d.length;b++)a.bindTexture(d[b],this._dotSamplers[b])};b.prototype._createDotDensityTextures=
function(a,b,d){if(this._dotTextureSize!==b||this._seed!==d)this._disposeTextures(),this._dotTextureSize=b,this._seed=d;null===this._dotTextures&&(d=new k(d),this._dotTextures=[this._allocDotDensityTexture(a,b,d),this._allocDotDensityTexture(a,b,d)]);return this._dotTextures};b.prototype._allocDotDensityTexture=function(a,b,d){for(var e=new Float32Array(b*b*4),c=0;c<e.length;c++)e[c]=d.getFloat();return new h.Texture(a,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:b,height:b},
e)};return b}(b.default);a.default=c})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});a.createMaterialKey=function(a,b,d,c){if(f.isSome(b)){a:{if("heatmap"===
b.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case e.WGLGeometryType.FILL:a=n.from(b);break a;case e.WGLGeometryType.LINE:a=y.from(b,d);break a;case e.WGLGeometryType.MARKER:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=u.from(b);break a;case e.WGLGeometryType.TEXT:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Text GeometryTypes");a=w.from(b);break a;case e.WGLGeometryType.LABEL:if("dot-density"===
b.type)throw Error("Dot Density renderer does not support Label GeometryTypes");a=t.from(b,c);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}}return a}switch(a){case e.WGLGeometryType.FILL:return n.from(null);case e.WGLGeometryType.LINE:return y.from(null,d);case e.WGLGeometryType.MARKER:return u.from(null);case e.WGLGeometryType.TEXT:return w.from(null);case e.WGLGeometryType.LABEL:return t.from(null,c);default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}};c=function(){function a(a){this._data=0;this._data=a}a.load=function(a){var b=this.shared;b.data=a;return b};Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.bits(5,8)},set:function(a){this.setBits(a,5,8)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mapAligned",{get:function(){return!!this.bit(17)},set:function(a){this.setBit(17,
a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sdf",{get:function(){return!!this.bit(8)},set:function(a){this.setBit(8,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"pattern",{get:function(){return!!this.bit(9)},set:function(a){this.setBit(9,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this.bits(0,5)},set:function(a){this.setBits(a,0,5)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"geometryTypeString",{get:function(){switch(this.geometryType){case e.WGLGeometryType.FILL:return"fill";case e.WGLGeometryType.MARKER:return"marker";case e.WGLGeometryType.LINE:return"line";case e.WGLGeometryType.TEXT:return"text";case e.WGLGeometryType.LABEL:return"label";default:throw new h("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});a.prototype.setBit=function(a,b){a=1<<a;this._data=b?this._data|a:this._data&~a};a.prototype.bit=function(a){return(this._data&
1<<a)>>a};a.prototype.setBits=function(a,b,d){for(var e=0;b<d;b++,e++)this.setBit(b,0!==(a&1<<e))};a.prototype.bits=function(a,b){for(var d=0,e=0;a<b;a++,e++)d|=this.bit(a)<<e;return d};a.prototype.hasVV=function(){return!1};a.prototype.setVV=function(a,b){};a.prototype.getVariation=function(){var a={},b;for(b in this)"boolean"===typeof this[b]&&(a[b]=this[b]);return a};a.prototype.getVariationHash=function(){return this._data&~(4&this.textureBinding)};a.shared=new a(0);return a}();a.MaterialKeyBase=
c;g=function(a){return function(a){function d(){return null!==a&&a.apply(this,arguments)||this}l(d,a);Object.defineProperty(d.prototype,"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vvSizeFieldStops",{get:function(){return 0!==
this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vvSizeUnitValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});d.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};d.prototype.setVV=function(d,c){a.prototype.setVV.call(this,d,c);d&=b.getSizeFlagsMask(d,c);this.vvSizeMinMaxValue=
!!(d&e.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(d&e.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(d&e.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(d&e.WGLVVFlag.SIZE_SCALE_STOPS)};return d}(a)};var d=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);Object.defineProperty(b.prototype,"vvRotation",{get:function(){return 0!==this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||
this.vvRotation};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);this.vvRotation=!d&&!!(b&e.WGLVVFlag.ROTATION)};return b}(a)},m=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);Object.defineProperty(b.prototype,"vvColor",{get:function(){return 0!==this.bit(10)},set:function(a){this.setBit(10,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};b.prototype.setVV=function(b,
d){a.prototype.setVV.call(this,b,d);this.vvColor=!d&&!!(b&e.WGLVVFlag.COLOR)};return b}(a)},r=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);Object.defineProperty(b.prototype,"vvOpacity",{get:function(){return 0!==this.bit(11)},set:function(a){this.setBit(11,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);this.vvOpacity=
!d&&!!(b&e.WGLVVFlag.OPACITY)};return b}(a)},n=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}l(d,a);d.load=function(a){var b=this.shared;b.data=a;return b};d.from=function(a){var d=this.load(0);d.geometryType=e.WGLGeometryType.FILL;f.isSome(a)&&(a instanceof k.DotDensityRenderer?d.dotDensity=!0:(a=b.getVVFlags(a.visualVariables),d.setVV(a,!1)));return d.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(d.prototype,
"dotDensity",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});d.shared=new d(0);return d}(m(r(c)));a.FillMaterialKey=n;var u=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}l(d,a);d.load=function(a){var b=this.shared;b.data=a;return b};d.from=function(a){var d=this.load(0);d.geometryType=e.WGLGeometryType.MARKER;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),d.setVV(a,!1));return d.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};
d.shared=new d(0);return d}(m(r(d(g(c)))));a.MarkerMaterialKey=u;var y=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}l(d,a);d.load=function(a){var b=this.shared;b.data=a;return b};d.from=function(a,d){var c=this.load(0);c.geometryType=e.WGLGeometryType.LINE;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),c.setVV(a,d));return c.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};d.shared=new d(0);return d}(m(r(g(c))));a.LineMaterialKey=y;
var w=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}l(d,a);d.load=function(a){var b=this.shared;b.data=a;return b};d.from=function(a){var d=this.load(0);d.geometryType=e.WGLGeometryType.TEXT;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),d.setVV(a,!1));return d.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};d.shared=new d(0);return d}(m(r(d(g(c)))));a.TextMaterialKey=w;var t=function(a){function d(){return null!==a&&a.apply(this,arguments)||
this}l(d,a);d.load=function(a){var b=this.shared;b.data=a;return b};d.from=function(a,d){var c=this.load(0);c.geometryType=e.WGLGeometryType.LABEL;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),c.setVV(a,!1));c.mapAligned=!!p.isMapAligned(d.labelPlacement);return c.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};d.shared=new d(0);return d}(g(c));a.LabelMaterialKey=t})},"esri/renderers":function(){define("require exports ./renderers/ClassBreaksRenderer ./renderers/DictionaryRenderer ./renderers/DotDensityRenderer ./renderers/HeatmapRenderer ./renderers/Renderer ./renderers/SimpleRenderer ./renderers/UniqueValueRenderer ./renderers/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});a.ClassBreaksRenderer=l;a.DictionaryRenderer=g;a.DotDensityRenderer=k;a.HeatmapRenderer=h;a.BaseRenderer=f;a.SimpleRenderer=e;a.UniqueValueRenderer=p;a.isRenderer=function(b){return b instanceof a.BaseRenderer};a.read=b.read;a.write=b.write;a.fromJSON=b.fromJSON;a.rendererTypes={key:"type",base:a.BaseRenderer,typeMap:{heatmap:a.HeatmapRenderer,simple:a.SimpleRenderer,"unique-value":a.UniqueValueRenderer,"class-breaks":a.ClassBreaksRenderer,
"dot-density":a.DotDensityRenderer,dictionary:a.DictionaryRenderer}};a.webSceneRendererTypes={key:"type",base:a.BaseRenderer,typeMap:{simple:a.SimpleRenderer,"unique-value":a.UniqueValueRenderer,"class-breaks":a.ClassBreaksRenderer}}})},"esri/renderers/ClassBreaksRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/assignHelper ../symbols ../symbols ../core/jsonMap ../core/lang ../core/Logger ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./support/LegendOptions ../support/arcadeOnDemand ../symbols/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B){var E=r.getLogger("esri.renderers.ClassBreaksRenderer"),F=new d.default({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),H=w.ensureType(A.ClassBreakInfo);return function(a){function d(b){b=a.call(this,b)||this;b.backgroundFillSymbol=null;b.classBreakInfos=null;b.defaultLabel=null;b.defaultSymbol=null;b.field=null;b.isMaxInclusive=!0;b.legendOptions=null;b.normalizationField=null;b.normalizationTotal=
null;b.type="class-breaks";b.valueExpression=null;b.valueExpressionTitle=null;b._set("classBreakInfos",[]);return b}l(d,a);c=d;Object.defineProperty(d.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!0,configurable:!0});d.prototype.readClassBreakInfos=function(a,b,d){if(Array.isArray(a)){var e=b.minValue;return a.map(function(a){var b=new A.ClassBreakInfo;b.read(a,d);null==b.minValue&&(b.minValue=e);null==b.maxValue&&(b.maxValue=b.minValue);e=b.maxValue;return b})}};d.prototype.writeClassBreakInfos=
function(a,b,d,e){a=a.map(function(a){return a.write({},e)});this._areClassBreaksConsecutive()&&a.forEach(function(a){return delete a.classMinValue});b[d]=a};d.prototype.readDefaultSymbol=function(a,b,d){return B.read(a,b,d)};d.prototype.writeDefaultSymbolWebScene=function(a,b,d,e){B.writeTarget(a,b,d,e)};d.prototype.writeDefaultSymbol=function(a,b,d,e){B.writeTarget(a,b,d,e)};d.prototype.castField=function(a){return null==a?a:"function"===typeof a?(E.error(".field: field must be a string value"),
null):w.ensureString(a)};Object.defineProperty(d.prototype,"minValue",{get:function(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"normalizationType",{get:function(){var a=this._get("normalizationType"),b=!!this.normalizationField,d=null!=this.normalizationTotal;if(b||d)a=b&&"field"||d&&"percent-of-total"||null,b&&d&&E.warn("warning: both normalizationField and normalizationTotal are set!");
else if("field"===a||"percent-of-total"===a)a=null;return a},set:function(a){this._set("normalizationType",a)},enumerable:!0,configurable:!0});d.prototype.addClassBreakInfo=function(a,d,e){var c=null,c="number"===typeof a?new A.ClassBreakInfo({minValue:a,maxValue:d,symbol:b.ensureType(e)}):H(m.clone(a));this.classBreakInfos.push(c);1===this.classBreakInfos.length&&this.notifyChange("minValue")};d.prototype.removeClassBreakInfo=function(a,b){for(var d=this.classBreakInfos.length,e=0;e<d;e++){var c=
[this.classBreakInfos[e].minValue,this.classBreakInfos[e].maxValue];if(c[0]===a&&c[1]===b){this.classBreakInfos.splice(e,1);break}}};d.prototype.getBreakIndex=function(a,b){this.valueExpression&&(n.isNone(b)||n.isNone(b.arcade))&&E.warn("");return this.valueExpression?this._getBreakIndexForExpression(a,b):this._getBreakIndexForField(a)};d.prototype.getClassBreakInfo=function(a,b){return f(this,void 0,void 0,function(){var d,c,f,g;return h(this,function(h){switch(h.label){case 0:d=b;if(!this.valueExpression||
!n.isNone(b)&&!n.isNone(b.arcade))return[3,2];c=[{},d];f={};return[4,D.loadArcade()];case 1:d=e.apply(void 0,c.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return g=this.getBreakIndex(a,d),[2,-1!==g?this.classBreakInfos[g]:null]}})})};d.prototype.getSymbol=function(a,b){if(this.valueExpression&&(n.isNone(b)||n.isNone(b.arcade)))E.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");else return a=this.getBreakIndex(a,b),-1<a?this.classBreakInfos[a].symbol:this.defaultSymbol};
d.prototype.getSymbolAsync=function(a,b){return f(this,void 0,void 0,function(){var d,c,f,g;return h(this,function(h){switch(h.label){case 0:d=b;if(!this.valueExpression||!n.isNone(b)&&!n.isNone(b.arcade))return[3,2];c=[{},d];f={};return[4,D.loadArcade()];case 1:d=e.apply(void 0,c.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return g=this.getBreakIndex(a,d),[2,-1<g?this.classBreakInfos[g].symbol:this.defaultSymbol]}})})};d.prototype.getSymbols=function(){var a=[];this.classBreakInfos.forEach(function(b){b.symbol&&
a.push(b.symbol)});this.defaultSymbol&&a.push(this.defaultSymbol);return a};d.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};d.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),b=JSON.stringify(this.defaultSymbol),d=this.normalizationField+"."+this.normalizationType+"."+this.normalizationTotal,e=this.classBreakInfos.reduce(function(a,b){return a+b.getMeshHash()},"");return a+
"."+b+"."+e+"."+d+"."+this.field+"."+this.valueExpression};Object.defineProperty(d.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression},enumerable:!0,configurable:!0});d.prototype.clone=function(){return new c({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
classBreakInfos:m.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:m.clone(this.visualVariables),legendOptions:m.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};d.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){switch(e.label){case 0:return d=
[this.collectVVRequiredFields(a,b),this.collectSymbolFields(a,b)],[4,u.all(d)];case 1:return e.sent(),[2]}})})};d.prototype.collectSymbolFields=function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){switch(e.label){case 0:return d=this.getSymbols().map(function(d){return d.collectRequiredFields(a,b)}).concat([t.collectArcadeFieldNames(a,b,this.valueExpression)]),t.collectField(a,b,this.field),t.collectField(a,b,this.normalizationField),[4,u.all(d)];case 1:return e.sent(),
[2]}})})};d.prototype._getBreakIndexForExpression=function(a,b){var d=n.unwrapOr(b,{});b=d.viewingMode;var e=d.scale,c=d.spatialReference,f=this._cache.compiledFunc,d=n.expect(d.arcade).arcadeUtils;f||(f=d.createSyntaxTree(this.valueExpression),f=d.createFunction(f),this._cache.compiledFunc=f);a=d.executeFunction(f,d.createExecContext(a,d.getViewInfo({viewingMode:b,scale:e,spatialReference:c})));return this._getBreakIndexfromInfos(a)};d.prototype._getBreakIndexForField=function(a){var b=a.attributes;
a=this.normalizationType;var d=parseFloat(b[this.field]);if(a){var e=this.normalizationTotal,b=parseFloat(b[this.normalizationField]);if("log"===a)d=Math.log(d)*Math.LOG10E;else if("percent-of-total"===a&&!isNaN(e))d=d/e*100;else if("field"===a&&!isNaN(b)){if(isNaN(d)||isNaN(b))return-1;d/=b}}return this._getBreakIndexfromInfos(d)};d.prototype._getBreakIndexfromInfos=function(a){var b=this.isMaxInclusive;if(null!=a&&"number"===typeof a&&!isNaN(a))for(var d=0;d<this.classBreakInfos.length;d++){var e=
[this.classBreakInfos[d].minValue,this.classBreakInfos[d].maxValue];if(e[0]<=a&&(b?a<=e[1]:a<e[1]))return d}return-1};d.prototype._areClassBreaksConsecutive=function(){for(var a=this.classBreakInfos,b=a.length,d=1;d<b;d++)if(a[d-1].maxValue!==a[d].minValue)return!1;return!0};var c;g([y.property({readOnly:!0,dependsOn:["valueExpression"]})],d.prototype,"_cache",null);g([y.property({types:{base:p.BaseSymbol,key:"type",typeMap:{"simple-fill":b.symbolTypesRenderer.typeMap["simple-fill"],"picture-fill":b.symbolTypesRenderer.typeMap["picture-fill"],
"polygon-3d":b.symbolTypesRenderer.typeMap["polygon-3d"]}},json:{origins:{"web-scene":{type:p.PolygonSymbol3D,read:B.read,write:B.writeTarget}},read:B.read,write:B.writeTarget}})],d.prototype,"backgroundFillSymbol",void 0);g([y.property({type:[A.ClassBreakInfo]})],d.prototype,"classBreakInfos",void 0);g([y.reader("classBreakInfos")],d.prototype,"readClassBreakInfos",null);g([y.writer("classBreakInfos")],d.prototype,"writeClassBreakInfos",null);g([y.property({type:String,json:{write:!0}})],d.prototype,
"defaultLabel",void 0);g([y.property({types:b.symbolTypesRenderer})],d.prototype,"defaultSymbol",void 0);g([y.reader("defaultSymbol")],d.prototype,"readDefaultSymbol",null);g([y.writer("web-scene","defaultSymbol",{defaultSymbol:{types:b.symbolTypesRenderer3D}})],d.prototype,"writeDefaultSymbolWebScene",null);g([y.writer("defaultSymbol")],d.prototype,"writeDefaultSymbol",null);g([y.property({type:String,json:{write:!0}})],d.prototype,"field",void 0);g([y.cast("field")],d.prototype,"castField",null);
g([y.property({type:Boolean})],d.prototype,"isMaxInclusive",void 0);g([y.property({type:C.default,json:{write:!0}})],d.prototype,"legendOptions",void 0);g([y.property({type:Number,readOnly:!0,value:null,dependsOn:["classBreakInfos"],json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],d.prototype,"minValue",null);g([y.property({type:String,json:{write:!0}})],d.prototype,"normalizationField",void 0);
g([y.property({type:Number,cast:function(a){return w.ensureNumber(a)},json:{write:!0}})],d.prototype,"normalizationTotal",void 0);g([y.property({type:F.apiValues,value:null,dependsOn:["normalizationField","normalizationTotal"],json:{type:F.jsonValues,read:F.read,write:F.write}})],d.prototype,"normalizationType",null);g([y.enumeration.serializable()({classBreaks:"class-breaks"})],d.prototype,"type",void 0);g([y.property({type:String,json:{write:!0}})],d.prototype,"valueExpression",void 0);g([y.property({type:String,
json:{write:!0}})],d.prototype,"valueExpressionTitle",void 0);return d=c=g([y.subclass("esri.renderers.ClassBreaksRenderer")],d)}(y.declared(z.VisualVariablesMixin(v)))})},"esri/renderers/Renderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/iteratorUtils ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators ./support/AuthoringInfo".split(" "),function(c,
a,l,g,k,h,f,e,p,b,d){var m=new e.default({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});return function(a){function e(b){b=a.call(this,b)||this;b.authoringInfo=null;b.type=null;return b}l(e,a);e.prototype.getRequiredFields=function(a){return h(this,void 0,void 0,function(){var b;return k(this,function(d){switch(d.label){case 0:if(!this.collectRequiredFields)return[2,[]];b=new Set;return[4,
this.collectRequiredFields(b,a)];case 1:return d.sent(),[2,f.valuesOfSet(b).sort()]}})})};e.prototype.getSymbol=function(a,b){};e.prototype.getSymbolAsync=function(a,b){return h(this,void 0,void 0,function(){return k(this,function(a){return[2]})})};e.prototype.getSymbols=function(){return[]};e.prototype.getAttributeHash=function(){return JSON.stringify(this)};e.prototype.getMeshHash=function(){return JSON.stringify(this)};g([b.property({type:d,json:{write:!0}})],e.prototype,"authoringInfo",void 0);
g([b.property({type:m.apiValues,readOnly:!0,json:{type:m.jsonValues,read:!1,write:{writer:m.write,ignoreOrigin:!0}}})],e.prototype,"type",void 0);return e=g([b.subclass("esri.renderers.Renderer")],e)}(b.declared(p.JSONSupport))})},"esri/renderers/support/AuthoringInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./AuthoringInfoFieldInfo ./AuthoringInfoVisualVariable ../../tasks/support/colorRamps".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){var r=new k.default({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),n=new k.default({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),
u="inches feet yards miles nautical-miles millimeters centimeters decimeters meters kilometers decimal-degrees".split(" ");return function(a){function c(b){b=a.call(this,b)||this;b.colorRamp=null;b.lengthUnit=null;b.maxSliderValue=null;b.minSliderValue=null;b.visualVariables=null;return b}l(c,a);h=c;Object.defineProperty(c.prototype,"classificationMethod",{get:function(){var a=this._get("classificationMethod"),b=this.type;return b&&"relationship"!==b?"class-breaks-size"===b||"class-breaks-color"===
b?a||"manual":null:a},set:function(a){this._set("classificationMethod",a)},enumerable:!0,configurable:!0});c.prototype.readColorRamp=function(a){if(a)return m.fromJSON(a)};Object.defineProperty(c.prototype,"fields",{get:function(){return this.type&&"predominance"!==this.type?null:this._get("fields")},set:function(a){this._set("fields",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"field1",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field1")},
set:function(a){this._set("field1",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"field2",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field2")},set:function(a){this._set("field2",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"focus",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("focus")},set:function(a){this._set("focus",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"numClasses",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")},set:function(a){this._set("numClasses",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"standardDeviationInterval",{get:function(){var a=this.type;return a&&"relationship"!==a&&"class-breaks-size"!==a&&"class-breaks-color"!==a?null:this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")},set:function(a){this._set("standardDeviationInterval",
a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"type",{get:function(){return this._get("type")},set:function(a){var b=a;"classed-size"===a?b="class-breaks-size":"classed-color"===a&&(b="class-breaks-color");this._set("type",b)},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new h({classificationMethod:this.classificationMethod,colorRamp:f.clone(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:f.clone(this.field1),field2:f.clone(this.field2),
focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(a){return a.clone()})})};var h;g([e.property({type:r.apiValues,value:null,dependsOn:["type"],json:{type:r.jsonValues,read:r.read,write:r.write,origins:{"web-document":{default:"manual",type:r.jsonValues,read:r.read,write:r.write}}}})],
c.prototype,"classificationMethod",null);g([e.property({types:m.types,json:{write:!0}})],c.prototype,"colorRamp",void 0);g([e.reader("colorRamp")],c.prototype,"readColorRamp",null);g([e.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],c.prototype,"fields",null);g([e.property({type:b.default,value:null,dependsOn:["type"],json:{write:!0}})],c.prototype,"field1",null);g([e.property({type:b.default,value:null,dependsOn:["type"],json:{write:!0}})],c.prototype,"field2",null);g([e.property({type:["HH",
"HL","LH","LL"],value:null,dependsOn:["type"],json:{write:!0}})],c.prototype,"focus",null);g([e.property({type:Number,value:null,dependsOn:["type"],json:{type:p.Integer,write:!0}})],c.prototype,"numClasses",null);g([e.property({type:u,json:{type:u,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],c.prototype,"lengthUnit",void 0);g([e.property({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],c.prototype,"maxSliderValue",void 0);g([e.property({type:Number,json:{write:!0,
origins:{"web-scene":{write:!1,read:!1}}}})],c.prototype,"minSliderValue",void 0);g([e.property({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],c.prototype,"standardDeviationInterval",null);g([e.property({type:String,value:null,json:{type:n.jsonValues,read:n.read,write:n.write,origins:{"web-scene":{type:n.jsonValues.filter(function(a){return"dotDensity"!==a}),read:n.read,write:n.write}}}})],c.prototype,"type",null);g([e.property({type:[d],
json:{write:!0}})],c.prototype,"visualVariables",void 0);return c=h=g([e.subclass("esri.renderers.support.AuthoringInfo")],c)}(e.declared(h.JSONSupport))})},"esri/renderers/support/AuthoringInfoFieldInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./AuthoringInfoClassBreakInfo".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});
c=function(a){function b(b){b=a.call(this,b)||this;b.field="";b.normalizationField="";b.classBreakInfos=[];return b}l(b,a);d=b;b.prototype.clone=function(){return new d({field:this.field,normalizationField:this.normalizationField,classBreakInfos:h.clone(this.classBreakInfos)})};var d;g([f.property({type:String,json:{write:!0}})],b.prototype,"field",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"normalizationField",void 0);g([f.property({type:[e.default],json:{write:!0}})],b.prototype,
"classBreakInfos",void 0);return b=d=g([f.subclass("esri.renderers.support.AuthoringInfoFieldInfo")],b)}(f.declared(k.JSONSupport));a.AuthoringInfoFieldInfo=c;a.default=c})},"esri/renderers/support/AuthoringInfoClassBreakInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(b){b=
a.call(this,b)||this;b.minValue=0;b.maxValue=0;return b}l(e,a);c=e;e.prototype.clone=function(){return new c({minValue:this.minValue,maxValue:this.maxValue})};var c;g([h.property({type:Number,json:{write:!0}})],e.prototype,"minValue",void 0);g([h.property({type:Number,json:{write:!0}})],e.prototype,"maxValue",void 0);return e=c=g([h.subclass("esri.renderer.support.AuthoringInfoClassBreakInfo")],e)}(h.declared(k.JSONSupport));a.AuthoringInfoClassBreakInfo=c;a.default=c})},"esri/renderers/support/AuthoringInfoVisualVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast".split(" "),
function(c,a,l,g,k,h,f,e){var p=new k.default({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),b=new k.default({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),d={key:function(a){return"number"===typeof a?"number":"string"},typeMap:{number:Number,string:String},base:null},m=["high-to-low","above-and-below","centered-on","extremes"],r="seconds minutes hours days months years".split(" ");return function(a){function c(b){b=a.call(this,b)||this;
b.endTime=null;b.field=null;b.maxSliderValue=null;b.minSliderValue=null;b.startTime=null;b.type=null;b.units=null;return b}l(c,a);h=c;c.prototype.castEndTime=function(a){return"string"===typeof a||"number"===typeof a?a:null};c.prototype.castStartTime=function(a){return"string"===typeof a||"number"===typeof a?a:null};Object.defineProperty(c.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(a){this._set("style",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(a){this._set("theme",a)},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new h({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})};var h;g([f.property({types:d,json:{write:!0}})],c.prototype,"endTime",void 0);g([e.cast("endTime")],
c.prototype,"castEndTime",null);g([f.property({type:String,json:{write:!0}})],c.prototype,"field",void 0);g([f.property({type:Number,json:{write:!0}})],c.prototype,"maxSliderValue",void 0);g([f.property({type:Number,json:{write:!0}})],c.prototype,"minSliderValue",void 0);g([f.property({types:d,json:{write:!0}})],c.prototype,"startTime",void 0);g([e.cast("startTime")],c.prototype,"castStartTime",null);g([f.property({type:p.apiValues,value:null,dependsOn:["type"],json:{type:p.jsonValues,read:p.read,
write:p.write}})],c.prototype,"style",null);g([f.property({type:m,value:null,dependsOn:["type"],json:{type:m,write:!0}})],c.prototype,"theme",null);g([f.property({type:b.apiValues,json:{type:b.jsonValues,read:b.read,write:b.write}})],c.prototype,"type",void 0);g([f.property({type:r,json:{type:r,write:!0}})],c.prototype,"units",void 0);return c=h=g([f.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],c)}(f.declared(h.JSONSupport))})},"esri/tasks/support/colorRamps":function(){define(["require",
"exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});a.types={key:"type",base:g,typeMap:{algorithmic:l,multipart:k}};a.fromJSON=function(a){return a&&a.type?"algorithmic"===a.type?l.fromJSON(a):"multipart"===a.type?k.fromJSON(a):null:null}})},"esri/tasks/support/AlgorithmicColorRamp":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../Color ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./ColorRamp".split(" "),
function(c,a,l,g,k,h,f,e,p){return function(a){function b(b){b=a.call(this,b)||this;b.algorithm=null;b.fromColor=null;b.toColor=null;b.type="algorithmic";return b}g(b,a);c=b;b.prototype.clone=function(){return new c({fromColor:h.clone(this.fromColor),toColor:h.clone(this.toColor),algorithm:this.algorithm})};var c;l([f.enumeration.serializable()({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],b.prototype,"algorithm",void 0);l([f.property({type:k,json:{type:[e.Integer],
write:!0}})],b.prototype,"fromColor",void 0);l([f.property({type:k,json:{type:[e.Integer],write:!0}})],b.prototype,"toColor",void 0);l([f.property({type:["algorithmic"]})],b.prototype,"type",void 0);return b=c=l([f.subclass("esri.tasks.support.AlgorithmicColorRamp")],b)}(f.declared(p))})},"esri/tasks/support/ColorRamp":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h){return function(a){function e(e){e=a.call(this,e)||this;e.type=null;return e}l(e,a);g([h.property({readOnly:!0,json:{read:!1,write:!0}})],e.prototype,"type",void 0);return e=g([h.subclass("esri.tasks.support.ColorRamp")],e)}(h.declared(k.JSONSupport))})},"esri/tasks/support/MultipartColorRamp":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/lang ../../core/accessorSupport/decorators ./AlgorithmicColorRamp ./ColorRamp".split(" "),
function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.colorRamps=null;b.type="multipart";return b}g(b,a);d=b;b.prototype.clone=function(){return new d({colorRamps:k.clone(this.colorRamps)})};var d;l([h.property({type:[f],json:{write:!0}})],b.prototype,"colorRamps",void 0);l([h.property({type:["multipart"]})],b.prototype,"type",void 0);return b=d=l([h.subclass("esri.tasks.support.MultipartColorRamp")],b)}(h.declared(e))})},"esri/renderers/mixins/VisualVariablesMixin":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../visualVariables/ColorVariable ../visualVariables/OpacityVariable ../visualVariables/RotationVariable ../visualVariables/SizeVariable ../visualVariables/VisualVariable ../visualVariables/VisualVariableFactory".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){Object.defineProperty(a,"__esModule",{value:!0});var u={base:r,key:"type",typeMap:{opacity:b,color:p,rotation:d,size:m}};a.VisualVariablesMixin=function(a){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._vvFactory=new n;return b}l(b,a);Object.defineProperty(b.prototype,"visualVariables",{set:function(a){this._vvFactory.visualVariables=a;this._set("visualVariables",this._vvFactory.visualVariables)},enumerable:!0,configurable:!0});
b.prototype.readVisualVariables=function(a,b,d){return this._vvFactory.readVariables(a,b,d)};b.prototype.writeVisualVariables=function(a,b,d,e){b[d]=this._vvFactory.writeVariables(a,e)};Object.defineProperty(b.prototype,"arcadeRequiredForVisualVariables",{get:function(){if(!this.visualVariables)return!1;for(var a=0,b=this.visualVariables;a<b.length;a++)if(b[a].arcadeRequired)return!0;return!1},enumerable:!0,configurable:!0});b.prototype.hasVisualVariables=function(a,b){return a?!!this.getVisualVariablesForType(a,
b):!!(this.getVisualVariablesForType("size",b)||this.getVisualVariablesForType("color",b)||this.getVisualVariablesForType("opacity",b)||this.getVisualVariablesForType("rotation",b))};b.prototype.getVisualVariablesForType=function(a,b){var d=this.visualVariables;if(d&&(d=d.filter(function(d){return d.type===a&&("string"===typeof b?d.target===b:!1===b?!d.target:!0)}),!d||0!==d.length))return d};b.prototype.collectVVRequiredFields=function(a,b){return h(this,void 0,void 0,function(){var d,c,f,h;return k(this,
function(g){switch(g.label){case 0:d=[],this.visualVariables&&(d=d.concat(this.visualVariables)),c=0,f=d,g.label=1;case 1:if(!(c<f.length))return[3,4];h=f[c];if(!h)return[3,3];h.field&&e.collectField(a,b,h.field);h.normalizationField&&e.collectField(a,b,h.normalizationField);return h.valueExpression?[4,e.collectArcadeFieldNames(a,b,h.valueExpression)]:[3,3];case 2:g.sent(),g.label=3;case 3:return c++,[3,1];case 4:return[2]}})})};g([f.property({types:[u],value:null,json:{write:!0}})],b.prototype,"visualVariables",
null);g([f.reader("visualVariables",["visualVariables","rotationType","rotationExpression"])],b.prototype,"readVisualVariables",null);g([f.writer("visualVariables")],b.prototype,"writeVisualVariables",null);return b=g([f.subclass("esri.renderers.mixins.VisualVariablesMixin")],b)}(f.declared(a))}})},"esri/renderers/visualVariables/ColorVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./VisualVariable ./support/ColorStop".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type="color";b.normalizationField=null;return b}l(e,a);b=e;Object.defineProperty(e.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value}));this._set("stops",
a)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new b({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&this.legendOptions.clone()})};e.prototype.getAttributeHash=function(){return this.inherited(arguments)+"-"+this.normalizationField};e.prototype._interpolateData=function(){return this.stops&&
this.stops.map(function(a){return a.value||0})};var b;g([k.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],e.prototype,"cache",null);g([k.property({type:["color"],json:{type:["colorInfo"]}})],e.prototype,"type",void 0);g([k.property({type:String,json:{write:!0}})],e.prototype,"normalizationField",void 0);g([k.property({type:[f],json:{write:!0}})],e.prototype,"stops",null);return e=b=g([k.subclass("esri.renderers.visualVariables.ColorVariable")],e)}(k.declared(h))})},"esri/renderers/visualVariables/VisualVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./support/VisualVariableLegendOptions".split(" "),
function(c,a,l,g,k,h,f,e,p,b){var d=f.getLogger("esri.renderers.visualVariables.VisualVariable"),m=new k.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});return function(a){function c(b){b=a.call(this,b)||this;b.index=null;b.type=null;b.field=null;b.valueExpression=null;b.valueExpressionTitle=null;b.legendOptions=null;return b}l(c,a);c.prototype.castField=function(a){return null==a?a:"function"===typeof a?(d.error(".field: field must be a string value"),
null):p.ensureString(a)};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return!!this.valueExpression},enumerable:!0,configurable:!0});c.prototype.clone=function(){};c.prototype.getAttributeHash=function(){return this.type+"-"+this.field+"-"+this.valueExpression};g([e.property()],c.prototype,"index",void 0);g([e.property({type:m.apiValues,readOnly:!0,json:{read:m.read,write:m.write}})],c.prototype,"type",void 0);g([e.property({type:String,json:{write:!0}})],c.prototype,"field",
void 0);g([e.cast("field")],c.prototype,"castField",null);g([e.property({type:String,json:{write:!0}})],c.prototype,"valueExpression",void 0);g([e.property({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0);g([e.property({readOnly:!0,dependsOn:["valueExpression"]})],c.prototype,"arcadeRequired",null);g([e.property({type:b,json:{write:!0}})],c.prototype,"legendOptions",void 0);return c=g([e.subclass("esri.renderers.visualVariables.VisualVariable")],c)}(e.declared(h.JSONSupport))})},
"esri/renderers/visualVariables/support/VisualVariableLegendOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../support/LegendOptions".split(" "),function(c,a,l,g,k,h){return function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.showLegend=null;return b}l(e,a);c=e;e.prototype.clone=function(){return new c({title:this.title,showLegend:this.showLegend})};var c;
g([k.property({type:Boolean,json:{write:!0}})],e.prototype,"showLegend",void 0);return e=c=g([k.subclass("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],e)}(k.declared(h.default))})},"esri/renderers/support/LegendOptions":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});
c=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.title=null;return b}l(e,a);c=e;e.prototype.clone=function(){return new c({title:this.title})};var c;g([h.property({type:String,json:{write:!0}})],e.prototype,"title",void 0);return e=c=g([h.subclass("esri.renderers.support.LegendOptions")],e)}(h.declared(k.JSONSupport));a.LegendOptions=c;a.default=c})},"esri/renderers/visualVariables/OpacityVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./VisualVariable ./support/OpacityStop".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.type="opacity";b.normalizationField=null;return b}l(e,a);b=e;Object.defineProperty(e.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value}));this._set("stops",
a)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new b({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&this.legendOptions.clone()})};e.prototype.getAttributeHash=function(){return this.inherited(arguments)+"-"+this.normalizationField};e.prototype._interpolateData=function(){return this.stops&&
this.stops.map(function(a){return a.value||0})};var b;g([k.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],e.prototype,"cache",null);g([k.property({type:["opacity"],json:{type:["transparencyInfo"]}})],e.prototype,"type",void 0);g([k.property({type:String,json:{write:!0}})],e.prototype,"normalizationField",void 0);g([k.property({type:[f],json:{write:!0}})],e.prototype,"stops",null);return e=b=g([k.subclass("esri.renderers.visualVariables.OpacityVariable")],e)}(k.declared(h))})},"esri/renderers/visualVariables/support/OpacityStop":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../../../webdoc/support/opacityUtils".split(" "),
function(c,a,l,g,k,h,f,e){return function(a){function b(b){b=a.call(this,b)||this;b.label=null;b.opacity=null;b.value=null;return b}l(b,a);d=b;b.prototype.readOpacity=function(a,b){return e.transparencyToOpacity(b.transparency)};b.prototype.writeOpacity=function(a,b,d){b[d]=e.opacityToTransparency(a)};b.prototype.clone=function(){return new d({label:this.label,opacity:this.opacity,value:this.value})};var d;g([h.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([h.property({type:Number,
json:{type:f.Integer,write:{target:"transparency"}}})],b.prototype,"opacity",void 0);g([h.reader("opacity",["transparency"])],b.prototype,"readOpacity",null);g([h.writer("opacity")],b.prototype,"writeOpacity",null);g([h.property({type:Number,json:{write:!0}})],b.prototype,"value",void 0);return b=d=g([h.subclass("esri.renderers.visualVariables.support.OpacityStop")],b)}(h.declared(k.JSONSupport))})},"esri/renderers/visualVariables/RotationVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Error ../../core/accessorSupport/decorators ./VisualVariable".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.axis=null;b.type="rotation";b.rotationType="geographic";b.valueExpressionTitle=null;return b}l(e,a);b=e;Object.defineProperty(e.prototype,"cache",{get:function(){return{hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});e.prototype.writeValueExpressionTitleWebScene=function(a,b,e,c){c&&c.messages&&c.messages.push(new k("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:"visualVariables["+this.index+"].valueExpressionTitle",context:c}))};e.prototype.clone=function(){return new b({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})};var b;g([h.property({readOnly:!0,dependsOn:["valueExpression"]})],e.prototype,"cache",null);g([h.property({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",
write:!0}}}})],e.prototype,"axis",void 0);g([h.property({type:["rotation"],json:{type:["rotationInfo"]}})],e.prototype,"type",void 0);g([h.property({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],e.prototype,"rotationType",void 0);g([h.property({type:String,json:{write:!0}})],e.prototype,"valueExpressionTitle",void 0);g([h.writer("web-scene","valueExpressionTitle")],e.prototype,"writeValueExpressionTitleWebScene",null);return e=b=g([h.subclass("esri.renderers.visualVariables.RotationVariable")],
e)}(h.declared(f))})},"esri/renderers/visualVariables/SizeVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/Error ../../core/jsonMap ../../core/Logger ../../core/screenUtils ../../core/accessorSupport/decorators ./VisualVariable ./support/SizeStop ./support/SizeVariableLegendOptions ./support/sizeVariableUtils".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){function u(a){if(null!=
a){if("string"===typeof a||"number"===typeof a)return p.toPt(a);if("size"===a.type){if(n.isSizeVariable(a))return a;a=k({},a);delete a.type;return new A(a)}}}function y(a,b,d){if("object"!==typeof a)return a;b=new A;b.read(a,d);return b}var w=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,t=e.getLogger("esri.renderers.visualVariables.SizeVariable"),v=new f.default({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),z=new f.default({unknown:"unknown",inch:"inches",
foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"}),A=function(a){function d(b){b=a.call(this,b)||this;b.axis=null;b.legendOptions=null;b.normalizationField=null;b.scaleBy=null;b.target=null;b.type="size";b.useSymbolValue=null;b.valueExpression=null;b.valueRepresentation=null;b.valueUnit=null;return b}l(d,a);e=d;Object.defineProperty(d.prototype,
"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:w.test(this.valueExpression)}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"expression",{set:function(a){t.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'.");"view.scale"===a?(this.valueExpression="$view.scale",this._set("expression",a)):this._set("expression",null)},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"index",{set:function(a){n.isSizeVariable(this.maxSize)&&(this.maxSize.index="visualVariables["+a+"].maxSize");n.isSizeVariable(this.minSize)&&(this.minSize.index="visualVariables["+a+"].minSize");this._set("index",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"inputValueType",{get:function(){return n.getInputValueType(this)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maxDataValue",{set:function(a){a&&
this.stops&&(t.warn("cannot set maxDataValue when stops is not null."),a=null);this._set("maxDataValue",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maxSize",{set:function(a){a&&this.stops&&(t.warn("cannot set maxSize when stops is not null."),a=null);this._set("maxSize",a)},enumerable:!0,configurable:!0});d.prototype.castMaxSize=function(a){return u(a)};d.prototype.readMaxSize=function(a,b,d){return y(a,b,d)};Object.defineProperty(d.prototype,"minDataValue",{set:function(a){a&&
this.stops&&(t.warn("cannot set minDataValue when stops is not null."),a=null);this._set("minDataValue",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"minSize",{set:function(a){a&&this.stops&&(t.warn("cannot set minSize when stops is not null."),a=null);this._set("minSize",a)},enumerable:!0,configurable:!0});d.prototype.castMinSize=function(a){return u(a)};d.prototype.readMinSize=function(a,b,d){return y(a,b,d)};Object.defineProperty(d.prototype,"arcadeRequired",{get:function(){return this.valueExpression?
!0:this.minSize&&"object"===typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"===typeof this.maxSize&&this.maxSize.arcadeRequired},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"stops",{set:function(a){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value})):a&&(t.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),
a=null);this._set("stops",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"transformationType",{get:function(){return n.getTransformationType(this,this.inputValueType)},enumerable:!0,configurable:!0});d.prototype.readValueExpression=function(a,b){return a||b.expression&&"$view.scale"};d.prototype.writeValueExpressionWebScene=function(a,b,d,e){"$view.scale"===a?e&&e.messages&&(a=this.index,e.messages.push(new h("property:unsupported",this.type+"VisualVariable.valueExpression \x3d '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:("string"===typeof a?a:"visualVariables["+a+"]")+".valueExpression",context:e}))):b[d]=a};d.prototype.readValueUnit=function(a){return a?z.read(a):null};d.prototype.clone=function(){return new e({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:n.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:n.isSizeVariable(this.minSize)?
this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})};d.prototype.flipSizes=function(){if("clamped-linear"===this.transformationType){var a=this.minSize;this.minSize=this.maxSize;this.maxSize=a;return this}if("stops"===this.transformationType)for(var a=
this.stops,b=a.map(function(a){return a.size}).reverse(),d=a.length,e=0;e<d;e++)a[e].size=b[e];return this};d.prototype.getAttributeHash=function(){return this.inherited(arguments)+"-"+this.target+"-"+this.normalizationField};d.prototype._interpolateData=function(){return this.stops&&this.stops.map(function(a){return a.value||0})};var e;g([b.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],d.prototype,"cache",null);g([b.property({type:v.apiValues,json:{type:v.jsonValues,origins:{"web-map":{read:!1}},
read:v.read,write:v.write}})],d.prototype,"axis",void 0);g([b.property({type:String,value:null,json:{read:!1}})],d.prototype,"expression",null);g([b.property()],d.prototype,"index",null);g([b.property({type:String,readOnly:!0,dependsOn:["field","valueExpression"]})],d.prototype,"inputValueType",null);g([b.property({type:r,json:{write:!0}})],d.prototype,"legendOptions",void 0);g([b.property({type:Number,value:null,json:{write:!0}})],d.prototype,"maxDataValue",null);g([b.property({type:Number,value:null,
json:{write:!0}})],d.prototype,"maxSize",null);g([b.cast("maxSize")],d.prototype,"castMaxSize",null);g([b.reader("maxSize")],d.prototype,"readMaxSize",null);g([b.property({type:Number,value:null,json:{write:!0}})],d.prototype,"minDataValue",null);g([b.property({type:Number,value:null,json:{write:!0}})],d.prototype,"minSize",null);g([b.cast("minSize")],d.prototype,"castMinSize",null);g([b.reader("minSize")],d.prototype,"readMinSize",null);g([b.property({type:String,json:{write:!0}})],d.prototype,"normalizationField",
void 0);g([b.property({readOnly:!0,dependsOn:["valueExpression","minSize.arcadeRequired","maxSize.arcadeRequired"]})],d.prototype,"arcadeRequired",null);g([b.property({type:String})],d.prototype,"scaleBy",void 0);g([b.property({type:[m],value:null,json:{write:!0}})],d.prototype,"stops",null);g([b.property({type:["outline"],json:{write:!0}})],d.prototype,"target",void 0);g([b.property({type:String,readOnly:!0,dependsOn:"minDataValue maxDataValue minSize maxSize valueUnit inputValueType stops".split(" ")})],
d.prototype,"transformationType",null);g([b.property({type:["size"],json:{type:["sizeInfo"]}})],d.prototype,"type",void 0);g([b.property({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],d.prototype,"useSymbolValue",void 0);g([b.property({type:String,json:{write:!0}})],d.prototype,"valueExpression",void 0);g([b.reader("valueExpression",["valueExpression","expression"])],d.prototype,"readValueExpression",null);g([b.writer("web-scene","valueExpression")],d.prototype,"writeValueExpressionWebScene",
null);g([b.property({type:["radius","diameter","area","width","distance"],json:{write:!0}})],d.prototype,"valueRepresentation",void 0);g([b.property({type:z.apiValues,json:{write:z.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],d.prototype,"valueUnit",void 0);g([b.reader("valueUnit")],d.prototype,"readValueUnit",null);return d=e=g([b.subclass("esri.renderers.visualVariables.SizeVariable")],d)}(b.declared(d));return A})},"esri/renderers/visualVariables/support/SizeStop":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/screenUtils ../../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h,f){return function(a){function e(b){b=a.call(this,b)||this;b.label=null;b.size=null;b.value=null;return b}l(e,a);b=e;e.prototype.clone=function(){return new b({label:this.label,size:this.size,value:this.value})};var b;g([f.property({type:String,json:{write:!0}})],e.prototype,"label",void 0);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],e.prototype,"size",void 0);g([f.property({type:Number,json:{write:!0}})],e.prototype,"value",void 0);return e=b=g([f.subclass("esri.renderers.visualVariables.support.SizeStop")],
e)}(f.declared(k.JSONSupport))})},"esri/renderers/visualVariables/support/SizeVariableLegendOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ./VisualVariableLegendOptions".split(" "),function(c,a,l,g,k,h){return function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.customValues=null;return b}l(e,a);c=e;e.prototype.clone=function(){return new c({title:this.title,
showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})};var c;g([k.property({type:[Number],json:{write:!0}})],e.prototype,"customValues",void 0);return e=c=g([k.subclass("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],e)}(k.declared(h))})},"esri/renderers/visualVariables/support/sizeVariableUtils":function(){define(["require","exports"],function(c,a){function l(a){return a.valueExpression?"expression":a.field&&"string"===typeof a.field?"field":
"unknown"}Object.defineProperty(a,"__esModule",{value:!0});a.isSizeVariable=function(a){return a&&"esri.renderers.visualVariables.SizeVariable"===a.declaredClass};a.isValidNumber=function(a){return null!=a&&!isNaN(a)&&isFinite(a)};a.getInputValueType=l;a.getTransformationType=function(a,c){return"unknown"===(c||l(a))?"constant":a.stops?"stops":null!=a.minSize&&null!=a.maxSize&&null!=a.minDataValue&&null!=a.maxDataValue?"clamped-linear":"unknown"===(a.valueUnit||"unknown")?null!=a.minSize&&null!=a.minDataValue?
a.minSize&&a.minDataValue?"proportional":"additive":"identity":"real-world-size"}})},"esri/renderers/visualVariables/VisualVariableFactory":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/jsonMap ../../core/Logger ../../core/Warning ../../core/accessorSupport/decorators ./ColorVariable ./OpacityVariable ./RotationVariable ./SizeVariable".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m,r){var n=f.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),
u={color:b,size:r,opacity:d,rotation:m},y=new h.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),w=/^\[([^\]]+)\]$/i;return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.colorVariables=null;b.opacityVariables=null;b.rotationVariables=null;b.sizeVariables=null;return b}l(b,a);Object.defineProperty(b.prototype,"visualVariables",{set:function(a){this._resetVariables();if((a=a&&a.filter(function(a){return!!a}))&&a.length){for(var b=
0,d=a;b<d.length;b++){var e=d[b];switch(e.type){case "color":this.colorVariables.push(e);break;case "opacity":this.opacityVariables.push(e);break;case "rotation":this.rotationVariables.push(e);break;case "size":this.sizeVariables.push(e)}}this.sizeVariables.length&&this.sizeVariables.some(function(a){return!!a.target})&&a.sort(function(a,b){var d=null;return d=a.target===b.target?0:a.target?1:-1});for(b=0;b<a.length;b++)e=a[b],e.index=b}this._set("visualVariables",a)},enumerable:!0,configurable:!0});
b.prototype.readVariables=function(a,b,d){var c=b.rotationExpression;b=b.rotationType;if(c=(c=c&&c.match(w))&&c[1])a||(a=[]),a.push({type:"rotationInfo",rotationType:b,field:c});if(a)return a.map(function(a){var b=y.read(a.type),c=u[b];c||(n.warn("Unknown variable type: "+b),d&&d.messages&&d.messages.push(new e("visual-variable:unsupported","visualVariable of type '"+b+"' is not supported",{definition:a,context:d})));b=new c;b.read(a,d);return b})};b.prototype.writeVariables=function(a,b){for(var d=
[],e=0;e<a.length;e++){var c=a[e].toJSON(b);c&&d.push(c)}return d};b.prototype._resetVariables=function(){this.colorVariables=[];this.opacityVariables=[];this.rotationVariables=[];this.sizeVariables=[]};g([p.property()],b.prototype,"visualVariables",null);return b=g([p.subclass("esri.renderers.visualVariables.VisualVariableFactory")],b)}(p.declared(k))})},"esri/renderers/support/ClassBreakInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.minValue=null;b.maxValue=0;b.symbol=null;return b}l(b,a);d=b;b.prototype.clone=function(){return new d({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})};b.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol);return this.minValue+"."+this.maxValue+
"."+a};var d;g([f.property({type:String,json:{write:!0}})],b.prototype,"description",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([f.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],b.prototype,"minValue",void 0);g([f.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],b.prototype,"maxValue",void 0);g([f.property({types:k.symbolTypesRenderer,json:{origins:{"web-scene":{types:k.symbolTypesRenderer3D,
read:e.read,write:e.writeTarget}},read:e.read,write:e.writeTarget}})],b.prototype,"symbol",void 0);return b=d=g([f.subclass("esri.renderers.support.ClassBreakInfo")],b)}(f.declared(h.JSONSupport));a.ClassBreakInfo=c;a.default=c})},"esri/renderers/DictionaryRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../request ../core/Error ../core/iteratorUtils ../core/lang ../core/Logger ../core/LRUCache ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ../support/arcadeOnDemand ../symbols/CIMSymbol".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C){var D=r.getLogger("esri.renderers.DictionaryRenderer");return function(a){function c(b){b=a.call(this,b)||this;b._ongoingRequests=new Map;b._symbolCache=new n(100);b.config=null;b.description=null;b.fieldMap=null;b.label=null;b.scaleExpression=null;b.url=null;b.type="dictionary";return b}l(c,a);v=c;c.prototype.clone=function(){return new v({config:m.clone(this.config),scaleExpression:m.clone(this.scaleExpression),description:m.clone(this.description),
fieldMap:m.clone(this.fieldMap),label:m.clone(this.label),url:m.clone(this.url),visualVariables:m.clone(this.visualVariables)})};c.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var d,e;return h(this,function(c){switch(c.label){case 0:return[4,this.collectVVRequiredFields(a,b)];case 1:return c.sent(),this.scaleExpression?[4,t.collectArcadeFieldNames(a,b,this.scaleExpression)]:[3,3];case 2:c.sent(),c.label=3;case 3:d=b.map(function(a){return a.name});for(e in this.fieldMap)0>
d.indexOf(this.fieldMap[e])||a.add(this.fieldMap[e]);return[2]}})})};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return!0},enumerable:!0,configurable:!0});c.prototype.fetchResources=function(a){return f(this,void 0,void 0,function(){var e,c,f,g,m,n,l,t,v,r,w,z,H,F,C,E,B;return h(this,function(h){switch(h.label){case 0:if(!this.url)return D.error("no valid URL!"),[2,void 0];e=u.isSome(a)?a.abortOptions:null;c=p(this.url+"/resources/styles/dictionary-info.json",k({responseType:"json",
query:{f:"json"}},e));return[4,y.all([c,A.loadArcade()])];case 1:f=h.sent()[0].data;if(!f)throw new b("esri.renderers.DictionaryRenderer","Bad dictionary data!");g=f.expression;m=f.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+f.cimRefTemplateUrl;this._itemNames=d.createSetFromValues(f.itemsNames);this._symbolAttributes=m.symbol;n={};if(this.config)for(t in l=this.config,l)n[t]=l[t];v=0;for(r=m.configuration;v<r.length;v++)t=r[v],n.hasOwnProperty(t.name)||(n[t.name]=t.value);w=[];if(u.isSome(a)&&
a.fields)for(z=function(b){var d=H.fieldMap[b],e=a.fields.filter(function(a){return a.name===d});0<e.length&&w.push(k({},e[0],{name:b}))},H=this,F=0,C=this._symbolAttributes;F<C.length;F++)t=C[F],z(t);return[4,A.createDictionaryExpression(g,u.isSome(a)?a.spatialReference:null,w,n)];case 2:return E=h.sent(),B={scale:0},[2,function(a,b){a=E.repurposeFeature({geometry:null,attributes:a});B.scale=u.isSome(b)?b.scale:void 0;return E.evaluate({$feature:a,$view:B})}]}})})};c.prototype.getSymbol=function(){return null};
c.prototype.getSymbolAsync=function(a,b){return f(this,void 0,void 0,function(){var d,c,f,g,k,m,n,l,p,t,v,r,w,u,y,z,A,H,D,F,C,J,E,B,oa;return h(this,function(h){switch(h.label){case 0:return this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(b)),[4,this._dictionaryPromise];case 1:d=h.sent();c={};f=0;for(g=this._symbolAttributes;f<g.length;f++)k=g[f],(m=this.fieldMap[k])&&null!==a.attributes[m]&&void 0!==a.attributes[m]?(n=""+a.attributes[m],c[k]=n):c[k]="";l=d(c,b);if(!l||"string"!==
typeof l)return[2,null];p=l.split(";");t=[];v=[];r=0;for(w=p;r<w.length;r++)if((u=w[r])&&0!==u.length)if(-1!==u.indexOf("po:"))y=u.substr(3).split("|"),3===y.length&&(z=y[0],A=y[1],H=y[2],"DashTemplate"===A?H=H.split(" ").map(function(a){return Number(a)}):"Color"===A?(D=(new e(H)).toRgba(),H=[D[0],D[1],D[2],255*D[3]]):H=Number(H),v.push({primitiveName:z,propertyName:A,value:H}));else if(-1!==u.indexOf("|"))for(F=0,C=u.split("|");F<C.length;F++)J=C[F],this._itemNames.has(J)&&t.push(J);else this._itemNames.has(u)&&
t.push(u);E=t.join(";")+v.map(function(a){return a.primitiveName+";"+a.propertyName+";"+a.value});if(B=this._symbolCache.get(E))return[2,B];oa=this._cimPartsToCIMSymbol(t,v,b);this._symbolCache.put(E,oa,1);return[2,oa]}})})};c.prototype.getSymbols=function(){return[]};c.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){return this.url+"-"+JSON.stringify(this.fieldMap)};
c.prototype._getSymbolPart=function(a,b){return f(this,void 0,void 0,function(){var d,e,c;return h(this,function(f){switch(f.label){case 0:if(this._ongoingRequests.has(a))return[2,this._ongoingRequests.get(a).then(function(a){return a.data})];d=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,a);e=p(d,k({responseType:"json",query:{f:"json"}},b));this._ongoingRequests.set(a,e);return[4,e];case 1:return c=f.sent(),[2,c.data]}})})};c.prototype._combineSymbolParts=function(a,b){var d;if(!a||0===a.length)return null;
if(1===a.length)return{type:"CIMSymbolReference",symbol:a[0],primitiveOverrides:b};var e=k({},a[0]);e.symbolLayers=[];for(var c=0;c<a.length;c++){var f=a[c];(d=e.symbolLayers).unshift.apply(d,f.symbolLayers)}return{type:"CIMSymbolReference",symbol:e,primitiveOverrides:b}};c.prototype._cimPartsToCIMSymbol=function(a,b,d){return f(this,void 0,void 0,function(){var e,c,f;return h(this,function(h){switch(h.label){case 0:e=Array(a.length);for(c=0;c<a.length;c++)e[c]=this._getSymbolPart(a[c],d);return[4,
y.eachAlwaysValues(e)];case 1:return f=h.sent(),[2,new C({data:this._combineSymbolParts(f,b)})]}})})};var v;g([w.property({type:Object,json:{write:!0}})],c.prototype,"config",void 0);g([w.property({type:String,json:{write:!0}})],c.prototype,"description",void 0);g([w.property({type:Object,json:{write:!0}})],c.prototype,"fieldMap",void 0);g([w.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);g([w.property({type:String,json:{write:!0}})],c.prototype,"scaleExpression",void 0);g([w.property({type:String,
json:{write:!0}})],c.prototype,"url",void 0);return c=v=g([w.subclass("esri.renderers.DictionaryRenderer")],c)}(w.declared(z.VisualVariablesMixin(v)))})},"esri/core/LRUCache":function(){define(["require","exports","./MemCache"],function(c,a,l){return function(){function a(a,c){this._storage=new l.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c,f){this._storage.put(a,c,f,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},set:function(a){this._storage.maxSize=a},enumerable:!0,configurable:!0});return a}()})},"esri/core/MemCache":function(){define(["require","exports","./iteratorUtils","./PooledArray","./string"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});
a.MIN_PRIORITY=-3;c=function(){function a(a,e,c){this._namespace=a;this._storage=e;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";c&&(this._storage.registerRemoveFunc(this._namespace,c),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!0,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,e,c,b){void 0===
b&&(b=0);this._storage.put(this._namespace+a,e,c,b)};a.prototype.get=function(a){a=this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.updateSize=function(a,e,c){this._storage.updateSize(this._namespace+a,e,c)};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=
function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=c;c=function(){function c(a){void 0===a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new g}c.prototype.register=function(a){this._users.push(a)};c.prototype.deregister=function(a){this._users.removeUnordered(a)};c.prototype.registerRemoveFunc=function(a,e){this._removeFuncs.push([a,e])};c.prototype.deregisterRemoveFunc=
function(a){this._removeFuncs=this._removeFuncs.filter(function(e){return e[0]!==a})};Object.defineProperty(c.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._checkSizeLimit()},enumerable:!0,configurable:!0});c.prototype.put=function(c,e,h,b){var d=this._db.get(c);d&&(this._size-=d.size,this._db.delete(c),d.entry!==e&&this._notifyRemoved(c,
d.entry));h>this._maxSize?this._notifyRemoved(c,e):void 0===e?console.warn("Refusing to cache undefined entry "):!h||0>h?console.warn("Refusing to cache entry with invalid size "+h):(b=1+Math.max(b,a.MIN_PRIORITY)-a.MIN_PRIORITY,this._db.set(c,{entry:e,size:h,lifetime:b,lives:b}),this._size+=h,this._checkSizeLimit())};c.prototype.updateSize=function(a,e,c){var b=this._db.get(a);b&&b.entry===e&&(this._size-=b.size,c>this._maxSize?this._notifyRemoved(a,e):(b.size=c,this._size+=c,this._checkSizeLimit()))};
c.prototype.pop=function(a){var e=this._db.get(a);if(e)return this._size-=e.size,this._db.delete(a),++this._hit,e.entry;++this._miss};c.prototype.get=function(a){var e=this._db.get(a);if(void 0===e)++this._miss;else return this._db.delete(a),e.lives=e.lifetime,this._db.set(a,e),++this._hit,e.entry};c.prototype.getStats=function(){var c=this,e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},
h={},b=[];this._db.forEach(function(a,d){var e=a.lifetime;b[e]=(b[e]||0)+a.size;c._users.forEach(function(b){b=b.namespace;k.startsWith(d,b)&&(h[b]=(h[b]||0)+a.size)})});var d={};this._users.forEach(function(a){var b=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(h[b]=h[b]||0,d[b]=Math.round(100*a.hitRate)+"%"):d[b]="0%"});var g=Object.keys(h);g.forEach(function(a){return h[a]=h[a]/c._size*100});g.sort(function(a,b){return h[b]-h[a]});g.forEach(function(a){return e[a]=Math.round(h[a])+"% / "+d[a]});
for(g=b.length-1;0<=g;--g){var l=b[g];l&&(e["Priority "+(g+a.MIN_PRIORITY-1)]=Math.round(l/this.size*100)+"%")}return e};c.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEach(function(a){return a.resetHitRate()})};c.prototype.clear=function(a){var e=this;this._db.forEach(function(c,b){k.startsWith(b,a)&&(e._size-=c.size,e._db.delete(b),e._notifyRemoved(b,c.entry))})};c.prototype.clearAll=function(){var a=this;this._db.forEach(function(e,c){a._notifyRemoved(c,e.entry)});this._size=
0;this._db.clear()};c.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};c.prototype._notifyRemoved=function(a,e){this._removeFuncs.forEach(function(c){if(k.startsWith(a,c[0]))c[1](e)})};c.prototype._checkSizeLimit=function(){var a=this;this._size<=this._maxSize||l.someMap(this._db,function(e,c){a._db.delete(c);1>=e.lives?(a._size-=e.size,a._notifyRemoved(c,e.entry)):(--e.lives,a._db.set(c,e));return a._size<=.9*a.maxSize})};return c}();a.MemCacheStorage=c})},"esri/renderers/DotDensityRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/AttributeColorInfo ./support/DotDensityLegendOptions ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){return function(a){function c(b){b=a.call(this,b)||this;b.attributes=null;b.backgroundColor=new e([0,0,0,0]);b.blendDots=!0;b.dotBlendingEnabled=!0;b.dotShape="square";b.dotSize=1;b.legendOptions=null;b.outline=new w;b.dotValue=null;b.referenceDotValue=null;b.referenceScale=null;b.seed=1;b.type="dot-density";return b}l(c,a);k=c;c.prototype.calculateDotValue=function(a){if(null==this.referenceScale)return this.dotValue;a=a/this.referenceScale*this.dotValue;
return 1>a?1:a};c.prototype.getSymbol=function(){return new y({outline:this.outline})};c.prototype.getSymbolAsync=function(){return f(this,void 0,void 0,function(){return h(this,function(a){return[2,this.getSymbol()]})})};c.prototype.getSymbols=function(){return[this.getSymbol()]};c.prototype.getAttributeHash=function(){return this.attributes&&this.attributes.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){return JSON.stringify(this.outline)};c.prototype.clone=
function(){return new k({attributes:p.clone(this.attributes),backgroundColor:p.clone(this.backgroundColor),dotBlendingEnabled:p.clone(this.dotBlendingEnabled),dotShape:p.clone(this.dotShape),dotSize:p.clone(this.dotSize),dotValue:p.clone(this.dotValue),legendOptions:p.clone(this.legendOptions),outline:p.clone(this.outline),referenceScale:p.clone(this.referenceScale),visualVariables:p.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};c.prototype.getControllerHash=
function(){var a=this.attributes.map(function(a){return a.field||a.valueExpression||""}),b=this.outline&&JSON.stringify(this.outline.toJSON())||"";return a+"-"+b};c.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var e,c,f;return h(this,function(h){switch(h.label){case 0:return[4,this.collectVVRequiredFields(a,b)];case 1:h.sent(),e=0,c=this.attributes,h.label=2;case 2:if(!(e<c.length))return[3,6];f=c[e];return f.valueExpression?[4,d.collectArcadeFieldNames(a,b,
f.valueExpression)]:[3,4];case 3:h.sent(),h.label=4;case 4:f.field&&a.add(f.field),h.label=5;case 5:return e++,[3,2];case 6:return[2]}})})};var k;g([b.property({type:[n],json:{write:!0}})],c.prototype,"attributes",void 0);g([b.property({type:e,json:{write:!0}})],c.prototype,"backgroundColor",void 0);g([b.property({type:Boolean}),b.aliasOf("dotBlendingEnabled")],c.prototype,"blendDots",void 0);g([b.property({type:Boolean,json:{write:!0}})],c.prototype,"dotBlendingEnabled",void 0);g([b.property({type:String,
json:{write:!0}})],c.prototype,"dotShape",void 0);g([b.property({type:Number,json:{write:!0}})],c.prototype,"dotSize",void 0);g([b.property({type:u,json:{write:!0}})],c.prototype,"legendOptions",void 0);g([b.property({type:w,json:{default:null,write:!0}})],c.prototype,"outline",void 0);g([b.property({type:Number,json:{write:!0}})],c.prototype,"dotValue",void 0);g([b.property({type:Number}),b.aliasOf("dotValue")],c.prototype,"referenceDotValue",void 0);g([b.property({type:Number,json:{write:!0}})],
c.prototype,"referenceScale",void 0);g([b.property({type:Number,json:{write:!0}})],c.prototype,"seed",void 0);g([b.enumeration.serializable()({dotDensity:"dot-density"})],c.prototype,"type",void 0);return c=k=g([b.subclass("esri.renderers.DotDensityRenderer")],c)}(b.declared(r.VisualVariablesMixin(m)))})},"esri/renderers/support/AttributeColorInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(c,a,l,g,k,h,f,e,p){var b=f.getLogger("esri.renderers.support.AttributeColorInfo");return function(a){function d(b){b=a.call(this,b)||this;b.color=null;b.field=null;b.label=null;b.valueExpression=null;b.valueExpressionTitle=null;return b}l(d,a);c=d;d.prototype.castField=function(a){return null==a?a:"function"===typeof a?(b.error(".field: field must be a string value"),null):p.ensureString(a)};d.prototype.getAttributeHash=function(){return this.field+"-"+this.valueExpression};d.prototype.clone=
function(){return new c({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})};var c;g([e.property({type:k,json:{type:[Number],write:!0}})],d.prototype,"color",void 0);g([e.property({type:String,json:{write:!0}})],d.prototype,"field",void 0);g([e.cast("field")],d.prototype,"castField",null);g([e.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);g([e.property({type:String,json:{write:!0}})],
d.prototype,"valueExpression",void 0);g([e.property({type:String,json:{write:!0}})],d.prototype,"valueExpressionTitle",void 0);return d=c=g([e.subclass("esri.renderers.support.AttributeColorInfo")],d)}(e.declared(h.JSONSupport))})},"esri/renderers/support/DotDensityLegendOptions":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h){return function(a){function e(){var b=
null!==a&&a.apply(this,arguments)||this;b.unit=null;return b}g(e,a);c=e;e.prototype.clone=function(){return new c({unit:this.unit})};var c;l([h.property({type:String,json:{write:!0}})],e.prototype,"unit",void 0);return e=c=l([h.subclass("esri.renderers.support.DotDensityLegendOptions")],e)}(h.declared(k.JSONSupport))})},"esri/renderers/HeatmapRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./support/HeatmapColorStop".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){return function(a){function d(b){b=a.call(this,b)||this;b.blurRadius=10;b.colorStops=[new m.HeatmapColorStop({ratio:0,color:new f("rgba(255, 140, 0, 0)")}),new m.HeatmapColorStop({ratio:.75,color:new f("rgba(255, 140, 0, 1)")}),new m.HeatmapColorStop({ratio:.9,color:new f("rgba(255, 0,   0, 1)")})];b.field=null;b.fieldOffset=0;b.maxPixelIntensity=100;b.minPixelIntensity=0;b.type="heatmap";return b}l(d,a);c=d;d.prototype.collectRequiredFields=function(a,d){return h(this,
void 0,void 0,function(){var e;return k(this,function(c){(e=this.field)&&"string"===typeof e&&b.collectField(a,d,e);return[2]})})};d.prototype.getAttributeHash=function(){return null};d.prototype.getMeshHash=function(){return JSON.stringify(this.colorStops)+"."+this.blurRadius};d.prototype.clone=function(){return new c({blurRadius:this.blurRadius,colorStops:e.clone(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})};var c;g([p.property({type:Number,
json:{write:!0}})],d.prototype,"blurRadius",void 0);g([p.property({type:[m.HeatmapColorStop],json:{write:!0}})],d.prototype,"colorStops",void 0);g([p.property({type:String,json:{write:!0}})],d.prototype,"field",void 0);g([p.property({type:Number,json:{write:{overridePolicy:function(a,b,d){return{enabled:null==d}}}}})],d.prototype,"fieldOffset",void 0);g([p.property({type:Number,json:{write:!0}})],d.prototype,"maxPixelIntensity",void 0);g([p.property({type:Number,json:{write:!0}})],d.prototype,"minPixelIntensity",
void 0);g([p.enumeration.serializable()({heatmap:"heatmap"})],d.prototype,"type",void 0);return d=c=g([p.subclass("esri.renderers.HeatmapRenderer")],d)}(p.declared(d))})},"esri/renderers/support/HeatmapColorStop":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function e(b){b=
a.call(this,b)||this;b.color=null;b.ratio=null;return b}l(e,a);b=e;e.prototype.clone=function(){return new b({color:this.color,ratio:this.ratio})};var b;g([f.property({type:k,json:{write:!0}})],e.prototype,"color",void 0);g([f.property({type:Number,json:{write:!0}})],e.prototype,"ratio",void 0);return e=b=g([f.subclass("esri.renderers.support.HeatmapColorStop")],e)}(f.declared(h.JSONSupport));a.HeatmapColorStop=c;a.default=c})},"esri/renderers/SimpleRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../symbols ../core/lang ../core/promiseUtils ../core/accessorSupport/decorators ./Renderer ./mixins/VisualVariablesMixin ../symbols/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r){return function(a){function d(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.symbol=null;b.type="simple";return b}l(d,a);c=d;d.prototype.writeSymbolWebScene=function(a,b,d,e){r.writeTarget(a,b,d,e)};d.prototype.writeSymbol=function(a,b,d,e){r.writeTarget(a,b,d,e)};d.prototype.readSymbol=function(a,b,d){return r.read(a,b,d)};d.prototype.collectRequiredFields=function(a,b){return h(this,void 0,void 0,function(){return k(this,function(d){switch(d.label){case 0:return[4,
p.all([this.collectSymbolFields(a,b),this.collectVVRequiredFields(a,b)])];case 1:return d.sent(),[2]}})})};d.prototype.collectSymbolFields=function(a,b){return h(this,void 0,void 0,function(){return k(this,function(d){switch(d.label){case 0:return[4,p.all(this.getSymbols().map(function(d){return d.collectRequiredFields(a,b)}))];case 1:return d.sent(),[2]}})})};d.prototype.getSymbol=function(a,b){return this.symbol};d.prototype.getSymbolAsync=function(a,b){return h(this,void 0,void 0,function(){return k(this,
function(a){return[2,this.symbol]})})};d.prototype.getSymbols=function(){return this.symbol?[this.symbol]:[]};d.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};d.prototype.getMeshHash=function(){return this.getSymbols().reduce(function(a,b){return a+=JSON.stringify(b)},"")};Object.defineProperty(d.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables},enumerable:!0,configurable:!0});
d.prototype.clone=function(){return new c({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:e.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};var c;g([b.property({type:String,json:{write:!0}})],d.prototype,"description",void 0);g([b.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);g([b.property({types:f.symbolTypesRenderer})],d.prototype,"symbol",void 0);g([b.writer("web-scene","symbol",
{symbol:{types:f.symbolTypesRenderer3D}})],d.prototype,"writeSymbolWebScene",null);g([b.writer("symbol")],d.prototype,"writeSymbol",null);g([b.reader("symbol")],d.prototype,"readSymbol",null);g([b.enumeration.serializable()({simple:"simple"})],d.prototype,"type",void 0);return d=c=g([b.subclass("esri.renderers.SimpleRenderer")],d)}(b.declared(m.VisualVariablesMixin(d)))})},"esri/renderers/UniqueValueRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/assignHelper ../symbols ../symbols ../core/arrayUtils ../core/Error ../core/lang ../core/Logger ../core/maybe ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ../core/accessorSupport/diffUtils ../core/accessorSupport/ensureType ../layers/support/fieldUtils ../portal/Portal ./Renderer ./mixins/VisualVariablesMixin ./support/LegendOptions ./support/UniqueValueInfo ../support/arcadeOnDemand ../symbols/support/jsonUtils ../symbols/support/styleUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B,E,F,H,J,K){var G=n.getLogger("esri.renderers.UniqueValueRenderer"),I=z.ensureType(F.default);return function(a){function c(b){b=a.call(this,b)||this;b._valueInfoMap={};b._isDefaultSymbolDerived=!1;b.type="unique-value";b.backgroundFillSymbol=null;b.field=null;b.field2=null;b.field3=null;b.valueExpression=null;b.valueExpressionTitle=null;b.legendOptions=null;b.defaultLabel=null;b.fieldDelimiter=null;b.portal=null;b.styleOrigin=null;b.diff={uniqueValueInfos:function(a,
b){if(a||b){if(!a||!b)return{type:"complete",oldValue:a,newValue:b};for(var e=!1,c={type:"collection",added:[],removed:[],changed:[],unchanged:[]},f=function(f){var h=d.find(a,function(a){return a.value===b[f].value});h?v.diff(h,b[f])?(c.changed.push({type:"complete",oldValue:h,newValue:b[f]}),e=!0):c.unchanged.push({oldValue:h,newValue:b[f]}):(c.added.push(b[f]),e=!0)},h=0;h<b.length;h++)f(h);f=function(f){d.find(b,function(b){return b.value===a[f].value})||(c.removed.push(a[f]),e=!0)};for(h=0;h<
a.length;h++)f(h);return e?c:void 0}}};b._set("uniqueValueInfos",[]);return b}l(c,a);k=c;Object.defineProperty(c.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!0,configurable:!0});c.prototype.writeBackgroundFillSymbolWebScene=function(a,b,d,e){J.writeTarget(a,b,d,e)};c.prototype.castField=function(a){return null==a||"function"===typeof a?a:z.ensureString(a)};c.prototype.writeField=function(a,b,d,e){"string"===typeof a?b[d]=a:e&&e.messages?e.messages.push(new m("property:unsupported",
"UniqueValueRenderer.field set to a function cannot be written to JSON")):G.error(".field: cannot write field to JSON since it's not a string value")};Object.defineProperty(c.prototype,"defaultSymbol",{set:function(a){this._isDefaultSymbolDerived=!1;this._set("defaultSymbol",a)},enumerable:!0,configurable:!0});c.prototype.readDefaultSymbol=function(a,b,d){return J.read(a,b,d)};c.prototype.writeDefaultSymbolWebScene=function(a,b,d,e){this._isDefaultSymbolDerived||J.writeTarget(a,b,d,e)};c.prototype.writeDefaultSymbol=
function(a,b,d,e){this._isDefaultSymbolDerived||J.writeTarget(a,b,d,e)};c.prototype.readPortal=function(a,b,d){return d.portal||C.getDefault()};c.prototype.readStyleOrigin=function(a,b,d){if(b.styleName)return Object.freeze({styleName:b.styleName});if(b.styleUrl)return a=w.fromJSON(b.styleUrl,d),Object.freeze({styleUrl:a})};c.prototype.writeStyleOrigin=function(a,b,d,e){a.styleName?b.styleName=a.styleName:a.styleUrl&&(b.styleUrl=w.toJSON(a.styleUrl,e))};Object.defineProperty(c.prototype,"uniqueValueInfos",
{set:function(a){this.styleOrigin?G.error("#uniqueValueInfos\x3d","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",a),this._updateValueInfoMap())},enumerable:!0,configurable:!0});c.prototype.addUniqueValueInfo=function(a,d){this.styleOrigin?G.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(a="object"===typeof a?I(a):new F.default({value:a,symbol:b.ensureType(d)}),
this.uniqueValueInfos.push(a),this._valueInfoMap[a.value]=a)};c.prototype.removeUniqueValueInfo=function(a){if(this.styleOrigin)G.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var b=0;b<this.uniqueValueInfos.length;b++)if(this.uniqueValueInfos[b].value===a+""){delete this._valueInfoMap[a];this.uniqueValueInfos.splice(b,1);break}};c.prototype.getUniqueValueInfo=function(a,b){return f(this,void 0,void 0,function(){var d,
c,f;return h(this,function(h){switch(h.label){case 0:d=b;if(!this.valueExpression||!u.isNone(b)&&!u.isNone(b.arcade))return[3,2];c=[{},d];f={};return[4,H.loadArcade()];case 1:d=e.apply(void 0,c.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return[2,this._getUniqueValueInfo(a,d)]}})})};c.prototype.getSymbol=function(a,b){if(this.valueExpression&&(u.isNone(b)||u.isNone(b.arcade)))G.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");else return(a=this._getUniqueValueInfo(a,
b))&&a.symbol||this.defaultSymbol};c.prototype.getSymbolAsync=function(a,b){return f(this,void 0,void 0,function(){var d,c,f,g;return h(this,function(h){switch(h.label){case 0:d=b;if(!this.valueExpression||!u.isNone(d)&&!u.isNone(d.arcade))return[3,2];c=[{},d];f={};return[4,H.loadArcade()];case 1:d=e.apply(void 0,c.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return g=this._getUniqueValueInfo(a,d),[2,g&&g.symbol||this.defaultSymbol]}})})};c.prototype.getSymbols=function(){for(var a=[],b=0,d=
this.uniqueValueInfos;b<d.length;b++){var e=d[b];e.symbol&&a.push(e.symbol)}this.defaultSymbol&&a.push(this.defaultSymbol);return a};c.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),b=JSON.stringify(this.defaultSymbol),d=this.uniqueValueInfos.reduce(function(a,b){return a+b.getMeshHash()},"");return a+"."+b+"."+d+"."+(this.field+
"."+this.field2+"."+this.field3+"."+this.fieldDelimiter)+"."+this.valueExpression};c.prototype.clone=function(){var a=new k({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:r.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:r.clone(this.visualVariables),legendOptions:r.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),
backgroundFillSymbol:r.clone(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(a._isDefaultSymbolDerived=!0);a._set("portal",this.portal);var b=r.clone(this.uniqueValueInfos);this.styleOrigin&&(a._set("styleOrigin",Object.freeze(r.clone(this.styleOrigin))),Object.freeze(b));a._set("uniqueValueInfos",b);a._updateValueInfoMap();return a};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression},enumerable:!0,configurable:!0});
c.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){switch(e.label){case 0:return d=[this.collectVVRequiredFields(a,b),this.collectSymbolFields(a,b)],[4,y.all(d)];case 1:return e.sent(),[2]}})})};c.prototype.collectSymbolFields=function(a,b){return f(this,void 0,void 0,function(){var d;return h(this,function(e){switch(e.label){case 0:return d=this.getSymbols().map(function(d){return d.collectRequiredFields(a,b)}).concat([A.collectArcadeFieldNames(a,
b,this.valueExpression)]),A.collectField(a,b,this.field),A.collectField(a,b,this.field2),A.collectField(a,b,this.field3),[4,y.all(d)];case 1:return e.sent(),[2]}})})};c.prototype.populateFromStyle=function(){var a=this;return K.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(b){var d=[];a._valueInfoMap={};b&&b.data&&Array.isArray(b.data.items)&&b.data.items.forEach(function(e){var c=new p.WebStyleSymbol({styleUrl:b.styleUrl,styleName:b.styleName,portal:a.portal,name:e.name});a.defaultSymbol||
e.name!==b.data.defaultItem||(a.defaultSymbol=c,a._isDefaultSymbolDerived=!0);c=new F.default({value:e.name,symbol:c});d.push(c);a._valueInfoMap[e.name]=c});a._set("uniqueValueInfos",Object.freeze(d));!a.defaultSymbol&&a.uniqueValueInfos.length&&(a.defaultSymbol=a.uniqueValueInfos[0].symbol,a._isDefaultSymbolDerived=!0);return a})};c.prototype._updateValueInfoMap=function(){var a=this;this._valueInfoMap={};this.uniqueValueInfos.forEach(function(b){return a._valueInfoMap[b.value+""]=b})};c.prototype._getUniqueValueInfo=
function(a,b){return this.valueExpression?this._getUnqiueValueInfoForExpression(a,b):this._getUnqiueValueInfoForFields(a)};c.prototype._getUnqiueValueInfoForExpression=function(a,b){var d=u.unwrapOr(b,{});b=d.viewingMode;var e=d.scale,c=d.spatialReference,f=this._cache.compiledFunc,d=u.expect(d.arcade).arcadeUtils;f||(f=d.createSyntaxTree(this.valueExpression),f=d.createFunction(f),this._cache.compiledFunc=f);a=d.executeFunction(f,d.createExecContext(a,d.getViewInfo({viewingMode:b,scale:e,spatialReference:c})));
return this._valueInfoMap[a+""]};c.prototype._getUnqiueValueInfoForFields=function(a){var b=this.field,d=a.attributes,e;if("function"!==typeof b&&this.field2){a=this.field2;e=this.field3;var c=[];b&&c.push(d[b]);a&&c.push(d[a]);e&&c.push(d[e]);e=c.join(this.fieldDelimiter||"")}else"function"===typeof b?e=b(a):b&&(e=d[b]);return this._valueInfoMap[e+""]};c.fromPortalStyle=function(a,b){var d=new k(b&&b.properties);d._set("styleOrigin",Object.freeze({styleName:a}));d._set("portal",b&&b.portal||C.getDefault());
b=d.populateFromStyle();b.catch(function(b){G.error("#fromPortalStyle('"+a+"'[, ...])","Failed to create unique value renderer from style name",b)});return b};c.fromStyleUrl=function(a,b){b=new k(b&&b.properties);b._set("styleOrigin",Object.freeze({styleUrl:a}));b=b.populateFromStyle();b.catch(function(b){G.error("#fromStyleUrl('"+a+"'[, ...])","Failed to create unique value renderer from style URL",b)});return b};var k;g([t.property({readOnly:!0,dependsOn:["valueExpression"]})],c.prototype,"_cache",
null);g([t.enumeration.serializable()({uniqueValue:"unique-value"})],c.prototype,"type",void 0);g([t.property({types:{base:p.BaseSymbol,key:"type",typeMap:{"simple-fill":b.symbolTypesRenderer.typeMap["simple-fill"],"picture-fill":b.symbolTypesRenderer.typeMap["picture-fill"],"polygon-3d":b.symbolTypesRenderer.typeMap["polygon-3d"]}},json:{read:J.read,write:J.writeTarget}})],c.prototype,"backgroundFillSymbol",void 0);g([t.writer("web-scene","backgroundFillSymbol",{backgroundFillSymbol:{type:p.PolygonSymbol3D}})],
c.prototype,"writeBackgroundFillSymbolWebScene",null);g([t.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],c.prototype,"field",void 0);g([t.cast("field")],c.prototype,"castField",null);g([t.writer("field")],c.prototype,"writeField",null);g([t.property({type:String,json:{write:!0}})],c.prototype,"field2",void 0);g([t.property({type:String,json:{write:!0}})],c.prototype,"field3",void 0);g([t.property({type:String,json:{write:!0}})],c.prototype,"valueExpression",void 0);
g([t.property({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0);g([t.property({type:E.default,json:{write:!0}})],c.prototype,"legendOptions",void 0);g([t.property({type:String,json:{write:!0}})],c.prototype,"defaultLabel",void 0);g([t.property({types:b.symbolTypesRenderer})],c.prototype,"defaultSymbol",null);g([t.reader("defaultSymbol")],c.prototype,"readDefaultSymbol",null);g([t.writer("web-scene","defaultSymbol",{defaultSymbol:{types:b.symbolTypesRenderer3D}})],c.prototype,
"writeDefaultSymbolWebScene",null);g([t.writer("defaultSymbol")],c.prototype,"writeDefaultSymbol",null);g([t.property({type:String,json:{write:!0}})],c.prototype,"fieldDelimiter",void 0);g([t.property({type:C,readOnly:!0})],c.prototype,"portal",void 0);g([t.reader("portal",["styleName"])],c.prototype,"readPortal",null);g([t.property({readOnly:!0,json:{write:{enabled:!1,overridePolicy:function(){return{enabled:!0}}}}})],c.prototype,"styleOrigin",void 0);g([t.reader("styleOrigin",["styleName","styleUrl"])],
c.prototype,"readStyleOrigin",null);g([t.writer("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],c.prototype,"writeStyleOrigin",null);g([t.property({type:[F.default],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],c.prototype,"uniqueValueInfos",null);return c=k=g([t.subclass("esri.renderers.UniqueValueRenderer")],c)}(t.declared(B.VisualVariablesMixin(D)))})},"esri/core/accessorSupport/diffUtils":function(){define("require exports ../Accessor ../Collection ../maybe ./utils".split(" "),
function(c,a,l,g,k,h){function f(a){return a instanceof g?Object.keys(a.items):a instanceof l?h.getProperties(a).keys():a?Object.keys(a):[]}function e(a,b){return a instanceof g?a.items[b]:a[b]}function p(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}function b(a){return a?a.declaredClass:null}function d(a,c){var h,g=a.diff;if(g&&"function"===typeof g)return g(a,c);var m=f(a),n=f(c);if(0!==m.length||0!==n.length){if(!m.length||!n.length||p(a,c))return{type:"complete",oldValue:a,
newValue:c};var u=n.filter(function(a){return-1===m.indexOf(a)}),A=m.filter(function(a){return-1===n.indexOf(a)}),u=m.filter(function(b){return-1<n.indexOf(b)&&e(a,b)!==e(c,b)}).concat(u,A).sort();if((A=b(a))&&-1<r.indexOf(A)&&u.length)return{type:"complete",oldValue:a,newValue:c};for(var C,A=a instanceof l&&c instanceof l,D=0;D<u.length;D++){var B=u[D],E=e(a,B),F=e(c,B),H=void 0;!(A||"function"!==typeof E&&"function"!==typeof F)||E===F||null==E&&null==F||(H=g&&g[B]&&"function"===typeof g[B]?g[B](E,
F):"object"===typeof E&&"object"===typeof F&&b(E)===b(F)?d(E,F):{type:"complete",oldValue:E,newValue:F},k.isSome(H)&&(k.isSome(C)?C.diff[B]=H:C={type:"partial",diff:(h={},h[B]=H,h)}))}return C}}function m(a){if(k.isNone(a))return!0;switch(a.type){case "complete":return!1;case "collection":for(var b=0,d=a.added;b<d.length;b++){var e=d[b];if(!m(e))return!1}b=0;for(d=a.removed;b<d.length;b++)if(e=d[b],!m(e))return!1;b=0;for(a=a.changed;b<a.length;b++)if(e=a[b],!m(e))return!1;return!0;case "partial":for(b in a.diff)if(e=
a.diff[b],!m(e))return!1;return!0}}Object.defineProperty(a,"__esModule",{value:!0});var r=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];a.diff=function(a,e){if("function"!==typeof a&&"function"!==typeof e&&(a||e))return!a||!e||"object"===typeof a&&"object"===typeof e&&b(a)!==b(e)?{type:"complete",oldValue:a,newValue:e}:d(a,e)};a.isEmpty=m})},"esri/renderers/support/UniqueValueInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.symbol=null;b.value=null;return b}l(b,a);d=b;b.prototype.clone=function(){return new d({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})};b.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol&&this.symbol.toJSON());return this.value+"."+a};var d;g([f.property({type:String,
json:{write:!0}})],b.prototype,"description",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([f.property({types:k.symbolTypesRenderer,json:{origins:{"web-scene":{types:k.symbolTypesRenderer3D,read:e.read,write:e.writeTarget}},read:e.read,write:e.writeTarget}})],b.prototype,"symbol",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"value",void 0);return b=d=g([f.subclass("esri.renderers.support.UniqueValueInfo")],b)}(f.declared(h.JSONSupport));a.UniqueValueInfo=
c;a.default=c})},"esri/symbols/support/styleUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../request ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags ./jsonUtils ./StyleOrigin ./Thumbnail".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u){function y(a,b){return B(a,b).then(function(b){return{data:b.data,baseUrl:p.removeFile(a),styleUrl:a}})}
function w(a,d,e){d=d.portal||b.getDefault();var c,f=d.url+" - "+(d.user&&d.user.username)+" - "+a;E[f]||(E[f]=t(a,d,e).then(function(a){c=a;return a.fetchData()}).then(function(b){return{data:b,baseUrl:c.itemUrl,styleName:a}}));return E[f]}function t(a,b,e){return b.load(e).then(function(){var c=new d({disableExtraQuery:!0,query:"owner:"+F+" AND type:"+H+' AND typekeywords:"'+a+'"'});return b.queryItems(c,e)}).then(function(b){b=b.results;var d=null,c=a.toLowerCase();if(b&&Array.isArray(b))for(var h=
0;h<b.length;h++){var g=b[h];if(g.typeKeywords.some(function(a){return a.toLowerCase()===c})&&g.type===H&&g.owner===F){d=g;break}}if(!d)throw new f("symbolstyleutils:style-not-found","The style '"+a+"' could not be found",{styleName:a});return d.load(e)})}function v(a,b,d){return a.styleUrl?y(a.styleUrl,d):a.styleName?w(a.styleName,b,d):e.reject(new f("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function z(a,b,d,c,g){for(var m=a.data,
l={portal:d.portal,url:p.urlToObject(a.baseUrl),origin:"portal-item"},t=function(e){if(e.name!==b)return"continue";var f=p.fromJSON(C(e,c),l),m=e.thumbnail&&e.thumbnail.href,t=e.thumbnail&&e.thumbnail.imageData;h.isDevEnvironment()&&(f=h.adjustStaticAGOUrl(f),m=h.adjustStaticAGOUrl(m));var v={portal:d.portal,url:p.urlToObject(p.removeFile(f)),origin:"portal-item"};return{value:B(f,g).then(function(e){e="cimRef"===c?A(e.data):e.data;if((e=r.fromJSON(e,v))&&k.isSymbol3D(e)){if(m){var f=p.fromJSON(m,
l);e.thumbnail=new u.default({url:f})}else t&&(e.thumbnail=new u.default({url:"data:image/png;base64,"+t}));a.styleUrl?e.styleOrigin=new n({portal:d.portal,styleUrl:a.styleUrl,name:b}):a.styleName&&(e.styleOrigin=new n({portal:d.portal,styleName:a.styleName,name:b}))}return e})}},v=0,m=m.items;v<m.length;v++){var w=t(m[v]);if("object"===typeof w)return w.value}return e.reject(new f("symbolstyleutils:symbol-name-not-found","The symbol name '"+b+"' could not be found",{symbolName:b}))}function A(a){return null===
a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}}function C(a,b){if("cimRef"===b)return a.cimRef;if(a.formatInfos&&!m.enableWebStyleForceWOSR()){b=0;for(var d=a.formatInfos;b<d.length;b++){var e=d[b];if("gltf"===e.type)return e.href}}return a.webRef}function D(a,b,d){var e=J.replace(/\{SymbolName\}/gi,a.name);return B(e,d).then(function(a){a=A(a.data);return r.fromJSON(a,{portal:b.portal,url:p.urlToObject(p.removeFile(e)),origin:"portal-item"})})}function B(a,b){b=l({responseType:"json",
query:{f:"json"}},b);return g(p.normalize(a),b)}Object.defineProperty(a,"__esModule",{value:!0});var E={};a.fetchStyle=v;a.resolveWebStyleSymbol=function(a,b,d,c){return a.name?a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?D(a,b,c):v(a,b,c).then(function(e){return z(e,a.name,b,d,c)}):e.reject(new f("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};a.fetchSymbolFromStyle=z;a.styleNameFromItem=function(a){var b=0;for(a=a.typeKeywords;b<a.length;b++){var d=
a[b];if(/^Esri.*Style$/.test(d)&&"Esri Style"!==d)return d}};var F="esri_en",H="Style",J="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson"})},"esri/core/devEnvironmentUtils":function(){define(["require","exports","./global"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.isDevEnvironment=function(a){a=a||l.location.hostname;return e.some(function(b){return null!=a.match(b)})};a.adjustStaticAGOUrl=
function(a,b){if(!a)return a;b=b||l.location.hostname;return null!=b.match(g)||null!=b.match(h)?a.replace("static.arcgis.com","staticdev.arcgis.com"):null!=b.match(k)||null!=b.match(f)?a.replace("static.arcgis.com","staticqa.arcgis.com"):a};a.isTelemetryDevEnvironment=function(a){a=a||l.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(e).some(function(b){return null!=a.match(b)})};var g=/^devext.arcgis.com$/,k=/^qaext.arcgis.com$/,h=/^[\w-]*\.mapsdevext.arcgis.com$/,f=/^[\w-]*\.mapsqa.arcgis.com$/,
e=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,g,k,/^jsapps.esri.com$/,h,f]})},"esri/support/featureFlags":function(){define(["require","exports","../core/has"],function(c,a,l){function g(a,c){return!!l("enable-feature:"+a+"/"+c)}Object.defineProperty(a,"__esModule",{value:!0});a.hasEnableFeature=g;a.enableWebStyleForceWOSR=function(){return g("jschmid","force-wosr")};a.enableEditing3D=function(){return g("editing","3d")}})},"esri/renderers/support/jsonUtils":function(){define("require exports ../../core/compilerUtils ../../core/Error ../../core/object ../../core/Warning ../ClassBreaksRenderer ../DictionaryRenderer ../DotDensityRenderer ../HeatmapRenderer ../SimpleRenderer ../UniqueValueRenderer".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){function r(a,b,d){if(!a)return null;if(a&&(a.styleName||a.styleUrl)&&"uniqueValue"!==a.type)return d&&d.messages&&d.messages.push(new h("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+a.type+"'",{definition:a,context:d})),null;b=a?y[a.type]||null:null;if(b)return b=new b,b.read(a,d),b;d&&d.messages&&a&&d.messages.push(new h("renderer:unsupported","Renderers of type '"+(a.type||"unknown")+"' are not supported",{definition:a,
context:d}));return null}function n(a,b){if(!b||"web-scene"!==b.origin)return!0;switch(a.type){case "simple":case "unique-value":case "class-breaks":return!0;case "heatmap":case "dictionary":case "dot-density":return!1;default:return l.neverReached(a),!1}}function u(a,b,d){return a?n(a,d)?a.write(b,d):(d.messages&&d.messages.push(new g("renderer:unsupported","Renderer of type '"+a.declaredClass+"' are not supported in scenes.",{renderer:a,context:d})),null):null}Object.defineProperty(a,"__esModule",
{value:!0});var y={simple:d,uniqueValue:m,classBreaks:f,heatmap:b,dotDensity:p,dictionary:e};a.read=r;a.writeTarget=function(a,b,d,e){(a=u(a,{},e))&&k.setDeepValue(d,a,b)};a.write=u;a.fromJSON=function(a,b){return r(a,null,b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../vectorTiles/GeometryUtils ../../color ../../definitions ../../enums ../../number ../../TextShaping ../../collisions/Metric ../../materialKey/MaterialKey ./GlyphGroup ./util ./WGLTextTemplate".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C){function D(a){switch(a){case "above-left":return[-1,-1];case "above-center":case "above-along":return[0,-1];case "above-right":return[1,-1];case "center-left":return[-1,0];case "center-center":case "center-along":return[0,0];case "center-right":return[1,0];case "below-left":return[-1,1];case "below-center":case "below-along":return[0,1];case "below-right":return[1,1];case "always-horizontal":return[0,0];default:J("Found invalid placement type "+
a)}}Object.defineProperty(a,"__esModule",{value:!0});var B=k.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),E=d.vec2f32.create(),F=p.mat2df32.create(),H={xOffset:0,yOffset:0,width:0,height:0},J=function(a,b){void 0===b&&(b="mapview-labeling");return B.error(new g(b,a))};a.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};c=function(a){function d(b,d,e,c){e=a.call(this,b,e.font.size,e.haloSize||0,e.color&&r.premultiplyAlphaRGBA(e.color)||
0,e.haloColor&&r.premultiplyAlphaRGBA(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.id)||this;e._refTemplate=H;e.geometryType=u.WGLGeometryType.LABEL;var f=d.symbol,g;g=!!d.minScale&&c.scaleToZoom(d.minScale)||0;g=h.clamp(g,0,25.5);c=!!d.maxScale&&c.scaleToZoom(d.maxScale)||255;c=h.clamp(c,0,25.5);var k=D(d.labelPlacement),m=k[0],k=k[1];e._justify=(-1*m+1)/2;e._xAlignD=m;e._yAlignD=k;e._xPlacementD=m;e._yPlacementD=k;e._minZoom=g;e._maxZoom=
c;b=v.LabelMaterialKey.load(v.createMaterialKey(e.geometryType,b,!1,d));b.sdf=!0;e._materialKey=b.data;b=f.font.decoration.toLowerCase();"underline"===b?e._decorationTop=6:"line-through"===b&&(e._decorationTop=-5);return e}l(d,a);d.fromLabelClass=function(a,b,e){return new d(a,b,b.symbol,e)};d.prototype.bindTextInfo=function(a,b,d){a=this._computeShaping(a,this._justify).getShaping(b,d);isNaN(this._decorationTop)||w.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=
w.TextShaping.getBox(a)};d.prototype._computeShaping=function(a,b){return new w.TextShaping([a],n.TEXT_MAX_WIDTH,n.TEXT_LINE_HEIGHT,n.TEXT_SPACING,[0,0],.5,.5,b)};Object.defineProperty(d.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0});d.prototype.bindReferenceTemplate=function(a){this._refTemplate=a||H};d.prototype._placeGlyphs=function(a,b,d,e){var c=this._size,h=this._haloSize,g=this._shapedBox,k=this._shapedGlyphs,m=this._computeGlyphTransform(g);if("esriGeometryPolyline"!==
a)for(var l=0;l<d.length;l++)for(var n=d[l],p=0,t=k;p<t.length;p++){var r=t[p];n.place(r,a,b,m,this._materialKey,c,h,g,e,this._minZoom,this._maxZoom)}else for(l=0;l<d.length;l++)for(var n=d[l],p=r=n.order,t=p-(p-1)/2-1,v=t-(t-1)/2-1,w=v-(v-1)/2-1,r=-1===r?0:p%2?t%2?v%2?w%2?0:e-3.1:e-2.1:e-1.1:e-.1,p=Math.max(e+f.log2((this._shapedBox.width*this._scale+48)/n.pathLen),Math.max(r,this._minZoom)),t=0,v=k;t<v.length;t++)r=v[t],n.place(r,a,b,m,this._materialKey,c,h,g,e,p,this._maxZoom)};d.prototype.writeMesh=
function(a,b,d,e,c,f,h){var g=this,k=this._computeAnchors(d,c),m=y.i8888to32(0,0,0,this._bitset);if(k.length&&this._shapedGlyphs.length)if(this._placeGlyphs(d,c,k,f),c=v.LabelMaterialKey.load(this._materialKey),"esriGeometryPolyline"!==d){d=k[0];f=this._computeGlyphTransform(this._shapedBox);f=this._createBounds(this._shapedBox,f);var l=d.glyphs.get(0),p=l[0],r=p.anchorX,w=p.anchorY,u=Math.floor(10*p.minZoom),p=Math.floor(10*p.maxZoom),z=a.length;l.forEach(function(a){a.minZoom=25.5;a.maxZoom=25.5});
z=new t.default(e,{from:z,count:a.length-z},r,w,u);r=Math.floor(r/n.COLLISION_BUCKET_SIZE);w=Math.floor(w/n.COLLISION_BUCKET_SIZE);r>=n.COLLISION_TILE_BOX_SIZE||w>=n.COLLISION_TILE_BOX_SIZE||0>r||0>w||(this._writeVertices(a,b,e,l,m,u,p),l=Math.max(this._refTemplate.height,this._refTemplate.width),c.vvSizeFieldStops||c.vvSizeMinMaxValue||c.vvSizeScaleStops||c.vvSizeUnitValue?z.setVV(l,this._xPlacementD,this._yPlacementD):(z.offsetX=(l/2+n.COLLISION_PLACEMENT_PADDING)*this._xPlacementD,z.offsetY=(l/
2+n.COLLISION_PLACEMENT_PADDING)*this._yPlacementD),z.bounds=f,h.push(z),d.clear())}else{c=function(d){var c=k[d],f=c.x,l=c.y;d=a.length;var n=new t.default(e,{from:d,count:-1},f,l,25.5);c.glyphs.forEach(function(d){for(var h=0;h<d.length;h++){var k=d[h];k.minZoom=Math.max(c.minZoom,k.minZoom);if(k.bounds){var p=k.anchorY-l;k.bounds.center[0]+=k.anchorX-f;k.bounds.center[1]+=p;n.add(k.bounds)}}n.bounds&&g._writeHalos(a,b,e,d,m)});c.glyphs.forEach(function(d){n.bounds&&g._writeText(a,b,e,d,m)});n.range.count=
a.length-d;n.bounds&&h.push(n);c.clear()};for(d=0;d<k.length;d++)c(d);this._computedGlyphs=[]}};d.prototype._outsideTile=function(a,b){return 0>a||512<=a||0>b||512<=b};d.prototype._smoothVertices=function(a,b){if(!(0>=b)){var d=a.length;if(!(3>d)){var e=[],c=0;e.push(0);for(var f=1;f<d;f++)c+=A.dist(a[f],a[f-1]),e.push(c);b=Math.min(b,.2*c);c=[];c.push(a[0][0]);c.push(a[0][1]);var h=a[d-1][0],g=a[d-1][1],f=A.sub([0,0],a[0],a[1]);A.normalize(f);a[0][0]+=b*f[0];a[0][1]+=b*f[1];A.sub(f,a[d-1],a[d-2]);
A.normalize(f);a[d-1][0]+=b*f[0];a[d-1][1]+=b*f[1];for(f=1;f<d;f++)e[f]+=b;e[d-1]+=b;for(var k=.5*b,f=1;f<d-1;f++){for(var m=0,l=0,n=0,p=f-1;0<=p&&!(e[p+1]<e[f]-k);p--){var t=k+e[p+1]-e[f],r=e[p+1]-e[p],v=e[f]-e[p]<k?1:t/r;if(1E-6>Math.abs(v))break;var w=v*v,u=v*t-.5*w*r,y=v*r/b,z=a[p+1],G=a[p][0]-z[0],I=a[p][1]-z[1],m=m+y/u*(z[0]*v*t+.5*w*(t*G-r*z[0])-w*v*r*G/3),l=l+y/u*(z[1]*v*t+.5*w*(t*I-r*z[1])-w*v*r*I/3),n=n+y}for(p=f+1;p<d&&!(e[p-1]>e[f]+k);p++){t=k-e[p-1]+e[f];r=e[p]-e[p-1];v=e[p]-e[f]<k?1:
t/r;if(1E-6>Math.abs(v))break;w=v*v;u=v*t-.5*w*r;y=v*r/b;z=a[p-1];G=a[p][0]-z[0];I=a[p][1]-z[1];m+=y/u*(z[0]*v*t+.5*w*(t*G-r*z[0])-w*v*r*G/3);l+=y/u*(z[1]*v*t+.5*w*(t*I-r*z[1])-w*v*r*I/3);n+=y}c.push(m/n);c.push(l/n)}c.push(h);c.push(g);for(p=f=0;f<d;f++)a[f][0]=c[p++],a[f][1]=c[p++]}}};d.prototype._computeLineAnchors=function(a,b,d){b=b.paths;var e=this._scale*this._shapedBox.width;d=e/2+d;for(var e=e/2+16,c=this._shapedBox.width*this._scale,f=0;f<b.length;f++){var h=b[f],g=[];g.push(h[0]);for(var k=
1;k<h.length;k++){var m=g[k-1],l=m[0],m=m[1],l=l+h[k][0],m=m+h[k][1];g.push([l,m])}this._smoothVertices(g,c);h=[];h.push(g[0]);for(k=1;k<g.length;k++){var m=g[k-1],n=g[k],l=Math.round(n[0]-m[0]),m=Math.round(n[1]-m[1]);h.push([l,m])}b[f]=h;g=this._getPathLength(h);if(!(g<2*e))for(var k=g/2,p=0,n=h[0][0],t=h[0][1],r=1;r<h.length;r++){var l=h[r][0],m=h[r][1],v=Math.sqrt(l*l+m*m),p=p+v;if(0<=p-k){var w=p-k,u=v-w,y=u/v,G=n+l*y,I=t+m*y;this._outsideTile(G,I)||(p=new z.default(G,I,y,f,r,n,t,v,g,-1),a.push(p));
for(var A=-1,I=0,I=u-d;0<=I;I-=d){var y=I/v,G=n+l*y,H=t+m*y;A++;this._outsideTile(G,H)||(p=new z.default(G,H,y,f,r,n,t,v,g,A),a.push(p))}p=I+d;I=v-w;y=n;G=t;for(H=r-1;0!==H;H--){var D=h[H][0],F=h[H][1],C=Math.sqrt(D*D+F*F);if(p+C>=d){for(var K=p=d-p;K<C;K+=d){var J=K/C,E=y-D*J,L=G-F*J;A++;(p=K+I+e<k)&&!this._outsideTile(E,L)&&(p=new z.default(E,L,1-J,f,H,y-D,G-F,C,g,A),a.push(p))}p=C-(K-d)}else p+=C;I+=C;y-=D;G-=F}A=-1;for(I=u+d;I<=v;I+=d)y=I/v,G=n+l*y,u=t+m*y,A++,this._outsideTile(G,u)||(p=new z.default(G,
u,y,f,r,n,t,v,g,A),a.push(p));y=n+l;G=t+m;p=v-(I-d);I=w;for(H=r+1;H<h.length;H++){l=h[H][0];m=h[H][1];n=Math.sqrt(l*l+m*m);if(p+n>=d){for(t=p=d-p;t<n;t+=d)r=t/n,v=y+l*r,w=G+m*r,A++,(p=t+I+e<k)&&!this._outsideTile(v,w)&&(p=new z.default(v,w,r,f,H,y,G,n,g,A),a.push(p));p=n-(t-d)}else p+=n;I+=n;y+=l;G+=m}break}n+=l;t+=m}}return a};d.prototype._computeAnchors=function(a,b){var d=[];switch(a){case "esriGeometryPoint":return b=b.geometry,a=b.x,b=b.y,a=new z.default(a,b),d.push(a),d;case "esriGeometryPolygon":if(b.centroid)return b=
b.centroid,a=b.x,b=b.y,a=new z.default(a,b),d.push(a),d;J("Non-centroid polygon anchor placement not supported");break;case "esriGeometryPolyline":return this._computeLineAnchors(d,b.geometry,376);default:return J("Unable to handle geometryType: "+a),d}};d.prototype._getPathLength=function(a){for(var b=0,d=1;d<a.length;d++)var e=a[d][0],c=a[d][1],b=b+Math.sqrt(e*e+c*c);return b};d.prototype._computeGlyphTransform=function(a){var d=this._scale,c=this._angle*m.C_DEG_TO_RAD,f=a.width/2,h=a.height/2,
f=this._xAlignD*f*d+(this._xOffset+this._refTemplate.xOffset)+(a.x+f);a=this._yAlignD*h*d-(this._yOffset+this._refTemplate.yOffset)-(a.y+h);h=e.mat2d.identity(F);e.mat2d.translate(h,h,b.vec2.set(E,f,a));e.mat2d.scale(h,h,b.vec2.set(E,d,d));e.mat2d.rotate(h,h,c);return h};d.prototype._writeVertex=function(a,b,d,e,c,f,h,g,k){b=b.get("geometry");h=Math.min(Math.floor(Math.max(this._refTemplate.width,this._refTemplate.height)),255);var m=this._xPlacementD+1,l=this._yPlacementD+1;g=y.i8888to32(g,k,0,0);
this._refSymbolAndPlacementOffset=y.i8888to32(f.angle,h,m,l);b.push(e);b.push(d);b.push(c);b.push(f.vertexOffsetUpperLeft);b.push(f.texFontSizeUpperLeft);b.push(this._refSymbolAndPlacementOffset);b.push(g);b.push(e);b.push(d);b.push(c);b.push(f.vertexOffsetUpperRight);b.push(f.texFontSizeUpperRight);b.push(this._refSymbolAndPlacementOffset);b.push(g);b.push(e);b.push(d);b.push(c);b.push(f.vertexOffsetLowerLeft);b.push(f.texFontSizeLowerLeft);b.push(this._refSymbolAndPlacementOffset);b.push(g);b.push(e);
b.push(d);b.push(c);b.push(f.vertexOffsetLowerRight);b.push(f.texFontSizeLowerRight);b.push(this._refSymbolAndPlacementOffset);b.push(g);a.vertexCount+=4};return d}(C.default);a.default=c})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});var e=l.getLogger("esri/views/2d/engine/webgl/collisions/Metric");
c=function(){function a(a,d,e,c,f){this.id=a;this.range=d;this.boxes=null;this.minZoom=-1;this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=g.vec2f32.fromValues(e,c);this.baseZoom=f}a.prototype.add=function(a){this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):this.bounds=a};a.prototype.computeIndex=function(){var a=this.bounds,d=this.anchor[0],e=this.anchor[1],c=Math.floor(d/k.COLLISION_BUCKET_SIZE),
f=Math.floor(e/k.COLLISION_BUCKET_SIZE),h=0;if(c>k.COLLISION_TILE_BOX_SIZE||f>k.COLLISION_TILE_BOX_SIZE)f=c=k.COLLISION_TILE_BOX_SIZE,h=1;if(0>c||0>f)f=c=0,h=1;a=2*Math.max(a.halfWidth+Math.abs(a.center[0]),a.halfHeight+Math.abs(a.center[1]));d%=k.COLLISION_BUCKET_SIZE;e%=k.COLLISION_BUCKET_SIZE;this.xBucket=c;this.yBucket=f;this.xOverflow=Math.ceil(Math.abs((a-d)/k.COLLISION_BUCKET_SIZE))+h;this.yOverflow=Math.ceil(Math.abs((a-e)/k.COLLISION_BUCKET_SIZE))+h};a.prototype.findCollisionDelta=function(a){var b=
this.bounds.findCollisionDelta(a.bounds),e=this.boxes&&this.boxes.length,c=a.boxes&&a.boxes.length;return Math.abs(b)>k.COLLISION_MAX_ZOOM_DELTA||!e&&!c?b:e&&c?this._boxesToBoxes(a):e?this._boxesToBox(a):this._boxToBoxes(a)};a.prototype.computeOffset=function(a,d){d||e.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+d);var b=this.size;this.hasVV&&(a=d(a),b=isNaN(a)||null==a||Infinity===a?this.size:a);this.offsetX=this.directionX*(b/2+k.COLLISION_PLACEMENT_PADDING);
this.offsetY=this.directionY*(b/2+k.COLLISION_PLACEMENT_PADDING)};a.prototype.setVV=function(a,d,e){this.hasVV=!0;this.size=a;this.directionX=d;this.directionY=e};a.prototype.clone=function(){var b=new a(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);b.minZoom=this.minZoom;this.bounds&&(b.bounds=this.bounds.clone());this.boxes&&(b.boxes=this.boxes.map(function(a){return a.clone()}));b.xBucket=this.xBucket;b.yBucket=this.yBucket;b.xOverflow=this.xOverflow;b.yOverflow=this.yOverflow;
b.hasVV=this.hasVV;b.size=this.size;b.directionX=this.directionX;b.directionY=this.directionY;b.offsetX=this.offsetX;b.offsetY=this.offsetY;return b};a.prototype._boxToBoxes=function(a){var b=-Infinity,e=0;for(a=a.boxes;e<a.length;e++)var c=this.bounds.findCollisionDelta(a[e]),b=Math.max(c,b);return b};a.prototype._boxesToBox=function(a){for(var b=this.boxes[0].findCollisionDelta(a.bounds),e=1;e<this.boxes.length;e++)var c=this.boxes[e].findCollisionDelta(a.bounds),b=Math.max(c,b);return b};a.prototype._boxesToBoxes=
function(a){for(var b=-Infinity,e=0;e<this.boxes.length;e++)for(var c=this.boxes[e],f=0,h=a.boxes;f<h.length;f++)var g=c.findCollisionDelta(h[f]),b=Math.max(g,b);return b};a.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?1:0);a.push(this.size);a.push(this.directionX);a.push(this.directionY);a.push(this.offsetX);a.push(this.offsetY);f.serializeList(a,
this.boxes);return a};a.deserialize=function(b){var d=b.readInt32(),e=h.default.deserialize(b),c=b.readInt32(),g=b.readInt32(),k={from:c,count:g},l=b.readInt32(),p=b.readInt32(),t=b.readInt32(),c=b.readInt32(),g=b.readInt32(),v=b.readInt32(),z=b.readInt32(),A=b.readInt32(),C=b.readInt32();b=f.deserializeList(b,h.default);d=new a(d,k,l,p,t);d.bounds=e;d.boxes=b;d.computeIndex();c&&d.setVV(g,v,z);d.offsetX=A;d.offsetY=C;return d};return a}();a.default=c})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require",
"exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c,e,k){this.center=g.vec2f32.fromValues(a,c);this.centerT=g.vec2f32.create();this.halfWidth=e/2;this.halfHeight=k/2;this.width=e;this.height=k}Object.defineProperty(a.prototype,"x",{get:function(){return this.center[0]},set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blX",{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"trX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"trY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};a.prototype.findCollisionDelta=function(a){return l.log2(Math.min((a.halfWidth+this.halfWidth)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight)/Math.abs(a.centerT[1]-this.centerT[1])))};
a.prototype.extend=function(a){var c=Math.min(this.blX,a.blX),e=Math.min(this.blY,a.blY),h=Math.max(this.trY,a.trY);this.width=Math.max(this.trX,a.trX)-c;this.height=h-e;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.x=c+this.halfWidth;this.y=e+this.halfHeight};a.deserialize=function(c){var f=c.readF32(),e=c.readF32(),h=c.readInt32();c=c.readInt32();return new a(f,e,h,c)};return a}();a.default=c})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],
function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.serializeList=function(a,c){if(null===c)a.push(0);else{a.push(c.length);for(var g=0;g<c.length;g++)c[g].serialize(a);return a}};a.deserializeList=function(a,c,k){for(var h=a.readInt32(),h=Array(h),f=0;f<h.length;f++)h[f]=c.deserialize(a,k);return h}})},"esri/views/2d/engine/webgl/mesh/templates/GlyphGroup":function(){define("require exports ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../definitions ../../materialKey/MaterialKey ./ComputedGlyph ./util".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d){Object.defineProperty(a,"__esModule",{value:!0});var m=g.getLogger("esri.views.2d.engine.webgl.GlyphGroup");c=function(){function a(a,b,d,e,c,f,h,g,k,m){void 0===d&&(d=0);void 0===e&&(e=-1);void 0===c&&(c=-1);void 0===f&&(f=-1);void 0===h&&(h=-1);void 0===g&&(g=-1);void 0===k&&(k=0);void 0===m&&(m=-1);this.x=a;this.y=b;this.t=d;this.i=e;this.j=c;this.segmentPosX=f;this.segmentPosY=h;this.segmentLen=g;this.pathLen=k;this.order=m;this._glyphs=new Map;this.minZoom=0}Object.defineProperty(a.prototype,
"glyphs",{get:function(){return this._glyphs},enumerable:!0,configurable:!0});a.prototype.add=function(a,b){var d=this._glyphs.get(b);d?d.push(a):this._glyphs.set(b,[a])};a.prototype.clear=function(){this._glyphs.clear()};a.prototype.place=function(a,d,e,c,f,h,g,k,r,D,B){var n=a.x,t=a.y,v=a.codePoint,w=a.glyphMosaicItem;f=p.MaterialKeyBase.load(f);f.textureBinding=a.glyphMosaicItem.textureBinding;switch(d){case "esriGeometryPoint":case "esriGeometryPolygon":a=b.default.from(n,t,this.x,this.y,-1,D,
B,w,v,f.data,c,h,g);this.add(a,0);break;case "esriGeometryPolyline":d=e.geometry;this._placeGlyphAlongLine(a,f.data,d,c,k,h,g,r,D,B,-1);this._placeGlyphAlongLine(a,f.data,d,c,k,h,g,r,D,B,1);break;case "esriGeometryMultipoint":case "esriGeometryEnvelope":a=void 0,void 0===a&&(a="mapview-labeling"),m.error(new l(a,"Cannot place for unsupported geometryType: "+d))}};a.prototype._findLabelTheta=function(a,b,d,e){b*=e;a=Math.acos((0*b+-1*e*-a)/(1*d));0<b&&(a=2*Math.PI-a);return a};a.prototype._placeGlyphAlongLine=
function(a,c,g,m,l,p,r,A,C,D,B){g=g.paths[this.i];var n=g[this.j],t=n[0],v=n[1],n=a.x,w=a.y,u=a.glyphMosaicItem,y=a.codePoint,z=a.glyphMosaicItem.metrics,z=(a.x+z.left+z.width/2)*p/24;a=B*k.sign(z)||1;var z=Math.abs(z),L=d.len(t,v),R=this._findLabelTheta(t,v,L,B),M=(a+1)/2,L=-a*(-1*M+this.t)*L,Q=h.mat2d.rotate(f.mat2df32.create(),m,-R),N=48<l.height;l=0===L?D:Math.max(Math.max(A+k.log2(Math.abs(z/L)),0),C);N&&(l=C);D=b.default.from(n,w,this.x,this.y,R,l,D,u,y,c,Q,p,r,N||l<=A&&D>=A&&1===B);this.add(D,
this.j);if(!N)for(D=this.segmentPosX+M*t,t=this.segmentPosY+M*v,Q=l,v=this.j+a;0<v&&v<g.length;v+=a){var U=D,V=t,M=g[v];l=M[0];var M=M[1],S=d.len(l,M),N=this._findLabelTheta(l,M,S,B),N=h.mat2d.rotate(f.mat2df32.create(),m,-N),U=U+-a*l/S*L,V=V+-a*M/S*L,L=L+S,S=Q-.1,Q=0===L?S:Math.max(Math.max(A+k.log2(Math.abs(z/L)),0),C),N=b.default.from(n,w,U,V,R,Q,S,u,y,c,N,p,r,Q<=A&&S>=A&&1===B);this.add(N,v);if(Q<A-e.COLLISION_MAX_ZOOM_DELTA){this.minZoom=Math.max(Q,this.minZoom);break}D+=a*l;t+=a*M}};return a}();
a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/ComputedGlyph":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../number ../../collisions/BoundingBox".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});var e=g.vec2f32.create();c=function(){function a(a,d,e,c,f,h,g,k,l,p,z,A,C,D,B){this.anchorX=a;this.anchorY=d;this.angle=e;this.bounds=c;this.minZoom=f;this.maxZoom=
h;this.materialKey=g;this.vertexOffsetUpperLeft=k;this.vertexOffsetUpperRight=l;this.vertexOffsetLowerLeft=p;this.vertexOffsetLowerRight=z;this.texFontSizeUpperLeft=A;this.texFontSizeUpperRight=C;this.texFontSizeLowerLeft=D;this.texFontSizeLowerRight=B}a.from=function(b,d,c,g,n,p,y,w,t,v,z,A,C,D,B){void 0===D&&(D=!1);void 0===B&&(B=!1);var m=w.rect,r=w.metrics;n=-1===n?255:Math.floor(180*n/Math.PI/360*254);var u=Math.round(m.x/4),J=Math.round(m.y/4);w=u+Math.round(m.width/4);var K=J+Math.round(m.height/
4),G=-24-r.top,I=r.left,L=-r.top,R=m.width,m=m.height;t||(B||(G=0),I=4,R=r.width);b+=I;t=B?d+L:d+G;R=b+R;G=t;d=b;L=t+m;m=R;B=L;var I=d+r.width,M=L-r.height,Q=r.width*A/24,r=r.height*A/24;z&&(l.vec2.transformMat2d(e,l.vec2.set(e,b,t),z),b=e[0],t=e[1],l.vec2.transformMat2d(e,l.vec2.set(e,R,G),z),R=e[0],G=e[1],l.vec2.transformMat2d(e,l.vec2.set(e,d,L),z),d=e[0],L=e[1],l.vec2.transformMat2d(e,l.vec2.set(e,m,B),z),m=e[0],B=e[1],l.vec2.transformMat2d(e,l.vec2.set(e,I,M),z),I=e[0],M=e[1]);z=D?new f.default(I,
M,Q+k.COLLISION_BOX_PADDING,r+k.COLLISION_BOX_PADDING):null;D=h.i1616to32(8*b,8*t);r=h.i1616to32(8*R,8*G);b=h.i1616to32(8*d,8*L);d=h.i1616to32(8*m,8*B);m=h.i8888to32(u,J,A,C);J=h.i8888to32(w,J,A,C);u=h.i8888to32(u,K,A,C);A=h.i8888to32(w,K,A,C);return new a(c|0,g|0,n,z,p,y,v,D,r,b,d,m,J,u,A)};return a}();a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(b,d,c,h,m,l,p,r,C,D,B,E,F){var n=a.call(this)||this;n._xOffset=g.pt2px(B);n._yOffset=g.pt2px(E);n._decorationTop=f.getFontDecorationTop(r);n._color=h;n._haloColor=m;n._haloSize=Math.min(Math.floor(5*g.pt2px(g.toPt(c))),127);n._size=Math.min(Math.round(g.pt2px(d)),127);d=Math.min(Math.round(g.pt2px(d)),127);n._referenceSize=Math.round(Math.sqrt(256*d));n._scale=n._size/24;n._angle=D;n._justify=
k.getJustification(l||"center");n._xAlignD=k.getXAnchorDirection(l||"center");n._yAlignD=-k.getYAnchorDirection(p||"baseline");n._baseline="baseline"===(p||"baseline");n._bitset=C?1:0;b=e.MaterialKeyBase.load(e.createMaterialKey(n.geometryType,b,!1));b.sdf=!0;n._materialKey=b.data;n.symbolId=F;return n}l(b,a);b.fromText=function(a,e,c){a=new b(a,e.font.size,e.haloSize||0,e.color&&h.premultiplyAlphaRGBA(e.color)||0,e.haloColor&&h.premultiplyAlphaRGBA(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,
e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.id);e=d.bidiText(e.text);a.bindTextInfo(c,e[0],e[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};b.fromCIMText=function(a,e,c,f){a=new b(a,e.size*e.sizeRatio*c,e.outlineSize*e.sizeRatio,h.premultiplyAlphaRGBA(e.color),h.premultiplyAlphaRGBA(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*c,e.offsetY*e.sizeRatio*c,e.materialHash);e=d.bidiText(e.text);a.bindTextInfo(f,
e[0],e[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};return b}(p.default(b.default));a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../enums ../../number ../../TextShapingNew ../../WGLDisplayRecord ../../collisions/BoundingBox ../../materialKey/MaterialKey ./ComputedGlyph".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){Object.defineProperty(a,"__esModule",{value:!0});var t=k.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),v=Math.PI/180,z=f.mat2df32.create(),A=p.vec2f32.create();a.default=function(a){return function(a){function c(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];b=a.apply(this,b)||this;b.geometryType=d.WGLGeometryType.TEXT;return b}l(c,a);c.prototype.bindTextInfo=function(a,b,d){a=this._computeShaping(a,this._justify).getShaping(b,d);
isNaN(this._decorationTop)||r.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=r.TextShaping.getBox(a)};c.prototype.writeMesh=function(a,b,d,e,c){var f=this._computedGlyphs;if(f){var h=m.i8888to32(0,0,this._referenceSize,this._bitset);switch(d){case "esriGeometryPoint":c=c.geometry;d=c.x;c=c.y;for(var k=0;k<f.length;k++){var l=f[k];l.anchorX=d;l.anchorY=c}this._writeVertices(a,b,e,f,h,0,0);break;case "esriGeometryPolygon":if(c.centroid){c=c.centroid;d=c.x;c=c.y;
for(k=0;k<f.length;k++)l=f[k],l.anchorX=d,l.anchorY=c;this._writeVertices(a,b,e,f,h,0,0);break}case "esriGeometryMultipoint":for(var k=c.geometry.points,n=c=d=0;n<k.length;n++){l=k[n];d+=l[0];c+=l[1];for(var p=0,r=f;p<r.length;p++)l=r[p],l.anchorX=d,l.anchorY=c;this._writeVertices(a,b,e,f,h,0,0)}break;default:a=void 0,void 0===a&&(a="mapview-processing"),t.error(new g(a,"Unable to handle geometryType: "+d))}}};c.prototype._computeGlyphs=function(a,b){if(a&&0!==a.length){var d=Array(a.length);b=this._computeGlyphTransform(b);
for(var e=y.MaterialKeyBase.load(this._materialKey),c=0;c<a.length;c++){var f=a[c],h=f.x,g=f.y,k=f.codePoint,f=f.glyphMosaicItem;e.textureBinding=f.textureBinding;d[c]=w.default.from(h,g,0,0,-1,0,25,f,k,e.data,b,this._size,this._haloSize,!1,!0)}this._computedGlyphs=d}};c.prototype._createBounds=function(a,d){var c=a.width/2,f=a.height/2,h=d[4],g=d[5],k;if(this._angle){a=p.vec2f32.fromValues(-c,-f);k=p.vec2f32.fromValues(c,-f);var m=p.vec2f32.fromValues(-c,f),l=p.vec2f32.fromValues(c,f);e.vec2.transformMat2d(a,
a,d);e.vec2.transformMat2d(k,k,d);e.vec2.transformMat2d(m,m,d);e.vec2.transformMat2d(l,l,d);d=f=Infinity;var n=0,t=c=0;for(a=[a,k,m,l];t<a.length;t++)k=a[t],f=Math.min(k[0],f),n=Math.max(k[0],n),d=Math.min(k[1],d),c=Math.max(k[1],c);k=n-f;a=c-d}else k=a.width*this._scale,a=a.height*this._scale;return new u.default(h,g,k+b.COLLISION_BOX_PADDING,a+b.COLLISION_BOX_PADDING)};c.prototype._computeShaping=function(a,d){return new r.TextShaping([a],512,b.TEXT_LINE_HEIGHT,b.TEXT_SPACING,[0,.5*-b.TEXT_LINE_HEIGHT],
.5*(1-this._xAlignD),0,d)};c.prototype._computeGlyphTransform=function(a){var b=this._scale,d=this._angle*v,c=h.mat2d.identity(z);h.mat2d.rotate(c,c,d);h.mat2d.translate(c,c,e.vec2.set(A,this._xOffset,-this._yOffset));h.mat2d.scale(c,c,e.vec2.set(A,b,b));h.mat2d.translate(c,c,e.vec2.set(A,-4,-4-(this._baseline?25:a.y+(1-this._yAlignD)*a.height*.5)));return c};c.prototype._writeVertices=function(a,b,d,e,c,f,h){this._writeHalos(a,b,d,e,c,f,h);this._writeText(a,b,d,e,c,f,h)};c.prototype._writeHalos=
function(a,b,d,e,c,f,h){var g=b.indexVector,k=b.getVector("geometry").vertexCount,l=0;if(this._haloSize)for(var p=0;p<e.length;p++,l+=4){var t=e[p],r=m.i1616to32(2*t.anchorX+1,2*t.anchorY),v=null==f?Math.floor(10*t.minZoom):f,w=null==h?Math.floor(10*t.maxZoom):h,u=new n(d,this.geometryType,t.materialKey,v,w);u.vertexFrom=k+l;u.indexFrom=g.length;this._writeVertex(u,b,d,r,this._haloColor,t,c,v,w);this._writeIndices(u,g,k+l);a.push(u)}};c.prototype._writeText=function(a,b,d,e,c,f,h){for(var g=b.indexVector,
k=b.getVector("geometry").vertexCount,l=0,p=0;p<e.length;p++,l+=4){var t=e[p],r=m.i1616to32(2*t.anchorX,2*t.anchorY),v=null==f?Math.floor(10*t.minZoom):f,w=null==h?Math.floor(10*t.maxZoom):h,u=new n(d,this.geometryType,t.materialKey,v,w);u.vertexFrom=k+l;u.indexFrom=g.length;this._writeVertex(u,b,d,r,this._color,t,c,v,w);this._writeIndices(u,g,k+l);a.push(u)}};c.prototype._writeVertex=function(a,b,d,e,c,f,h,g,k){b=b.get("geometry");b.push(e);b.push(d);b.push(c);b.push(f.vertexOffsetUpperLeft);b.push(f.texFontSizeUpperLeft);
b.push(h);b.push(e);b.push(d);b.push(c);b.push(f.vertexOffsetUpperRight);b.push(f.texFontSizeUpperRight);b.push(h);b.push(e);b.push(d);b.push(c);b.push(f.vertexOffsetLowerLeft);b.push(f.texFontSizeLowerLeft);b.push(h);b.push(e);b.push(d);b.push(c);b.push(f.vertexOffsetLowerRight);b.push(f.texFontSizeLowerRight);b.push(h);a.vertexCount+=4};c.prototype._writeIndices=function(a,b,d){b.push(d+0);b.push(d+1);b.push(d+2);b.push(d+1);b.push(d+3);b.push(d+2);a.indexCount+=6};return c}(a)}})},"esri/views/2d/engine/webgl/TextShapingNew":function(){define(["require",
"exports","./Rect"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c,f,e,g,b,d,m){this._glyphItems=a;this._maxWidth=c;this._lineHeight=f;this._letterSpacing=e;this._offset=g;this._hAnchor=b;this._vAnchor=d;this._justify=m}a.prototype.getShaping=function(a,c){for(var f=this._letterSpacing,e=this._lineHeight,h=this._justify,b=this._maxWidth,d=[],g=0,k=0,l=0,u=0,y=-1,w=0,t=-1,v=a.length,z=0;z<v;z++){var A=a.charCodeAt(z);if(10===A){if(z!==v-1){if(y>=u){var g=
d[y],C=g.x+g.glyphMosaicItem.metrics.advance,w=Math.max(C,w);h&&this._applyJustification(d,u,y);u=d.length}k=c?k-e:k+e;g=0;++l}}else{for(var C=void 0,D=0,B=this._glyphItems;D<B.length&&!(C=B[D][A]);D++);if(C){d.push({codePoint:A,x:g,y:k,glyphMosaicItem:C});g+=C.metrics.advance+f;if(0<b&&g>b&&0<=t){D=t+1;C=d[D].x;w=Math.max(C,w);for(B=D;B<d.length;B++)d[B].y=c?d[B].y-e:d[B].y+e,d[B].x-=C;h&&this._applyJustification(d,u,t);k=c?k-e:k+e;g-=C;++l;u=D;t=-1}++y;32===A&&(t=d.length-1)}}}y>=u&&(g=d[y],w=Math.max(w,
g.x+g.glyphMosaicItem.metrics.advance),h&&this._applyJustification(d,u,y));if(0<d.length)for(a=(h-this._hAnchor)*w,f=(-this._vAnchor*(l+1)+.5)*e,c&&l&&(f+=l*e),a+=this._offset[0],f+=this._offset[1],c=0;c<d.length;c++)e=d[c],e.x+=a,e.y+=f;return d};a.prototype.getEstimatedShaping=function(a,c,f){for(var e=this._letterSpacing,h=this._lineHeight,b=this._justify,d=this._maxWidth,g=[],k=0,l=0,u=0,y=0,w=-1,t=0,v=-1,z=a.length,A=0;A<z;A++){var C=a.charCodeAt(A);if(10===C){if(A!==z-1){if(w>=y){var k=g[w],
D=k.x+k.glyphMosaicItem.metrics.advance,t=Math.max(D,t);b&&this._applyJustification(g,y,w);y=g.length}l=c?l-h:l+h;k=0;++u}}else{D=f;g.push({codePoint:C,x:k,y:l,glyphMosaicItem:D});k+=D.metrics.advance+e;if(0<d&&k>d&&0<=v){for(var B=v+1,D=g[B].x,t=Math.max(D,t),E=B;E<g.length;E++)g[E].y=c?g[E].y-h:g[E].y+h,g[E].x-=D;b&&this._applyJustification(g,y,v);l=c?l-h:l+h;k-=D;++u;y=B;v=-1}++w;32===C&&(v=g.length-1)}}w>=y&&(k=g[w],t=Math.max(t,k.x+k.glyphMosaicItem.metrics.advance),b&&this._applyJustification(g,
y,w));if(0<g.length)for(a=(b-this._hAnchor)*t,f=(-this._vAnchor*(u+1)+.5)*h,c&&u&&(f+=u*h),a+=this._offset[0],f+=this._offset[1],c=0;c<g.length;c++)h=g[c],h.x+=a,h.y+=f;return g};a.getBox=function(a){if(!a.length)return null;for(var c=Infinity,f=Infinity,e=-Infinity,g=-Infinity,b=0;b<a.length;b++)var d=a[b],k=d.glyphMosaicItem.metrics,l=d.x+k.left,d=d.y-k.top,n=l+k.width,k=d+k.height,c=Math.min(c,l),e=Math.max(e,n),f=Math.min(f,d),g=Math.max(g,k);return{x:c,y:f,width:e-c,height:g-f}};a.addDecoration=
function(a,c){var f=a.length;if(0!==f){for(var e=a[0].x+a[0].glyphMosaicItem.metrics.left,h=a[0].y,b=1;b<f;b++){var d=a[b];if(d.y!==h){var g=a[b-1].x+a[b-1].glyphMosaicItem.metrics.left+a[b-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:e,y:h,glyphMosaicItem:{sdf:!0,rect:new l.default(4,0,4,8),metrics:{width:g-e,height:2,left:0,top:c,advance:0},page:0}});h=d.y;e=d.x+d.glyphMosaicItem.metrics.left}}f=a[f-1].x+a[f-1].glyphMosaicItem.metrics.left+a[f-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,
x:e,y:h,glyphMosaicItem:{sdf:!0,rect:new l.default(4,0,4,8),metrics:{width:f-e,height:2,left:0,top:c,advance:0},page:0}})}};a.prototype._applyJustification=function(a,c,f){for(var e=a[f],e=(e.x+e.glyphMosaicItem.metrics.advance)*this._justify;c<=f;c++)a[c].x-=e};return a}();a.TextShaping=c})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(c,a,l,g){return function(){function a(a,c,e,g,b){void 0===g&&(g=0);void 0===b&&(b=0);this.id=
a;this.geometryType=c;this.materialKey=e;this.minZoom=g;this.maxZoom=b;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});a.prototype.clone=function(){return this.copy()};a.prototype.copy=function(){var c=new a(this.id,this.geometryType,this.materialKey);c.vertexFrom=this.vertexFrom;
c.vertexCount=this.vertexCount;c.indexFrom=this.indexFrom;c.indexCount=this.indexCount;c.zOrder=this.zOrder;c.symbolLevel=this.symbolLevel;c.meshData=this.meshData;c.minZoom=this.minZoom;c.maxZoom=this.maxZoom;return c};a.prototype.setMeshDataFromBuffers=function(a,c,e){var f=new l,b;for(b in c){for(var d=c[b].stride,h=c[b].data,k=[],n=g.strideToPackingFactor(d),u=0;u<d*a.vertexCount/n;++u)k[u]=h[u+d*a.vertexFrom/n];f.vertexData.set(b,k)}for(u=f.indexData.length=0;u<a.indexCount;++u)f.indexData[u]=
e[u+a.indexFrom]-a.vertexFrom;f.vertexCount=a.vertexCount;this.meshData=f};a.prototype.readMeshDataFromBuffers=function(a,c){this.meshData?this.meshData.clear():this.meshData=new l;for(var e in a){for(var f=a[e].stride,b=a[e].data,d=[],h=g.strideToPackingFactor(f),k=0;k<f*this.vertexCount/h;++k)d[k]=b[k+f*this.vertexFrom/h];this.meshData.vertexData.set(e,d)}for(k=this.meshData.indexData.length=0;k<this.indexCount;++k)this.meshData.indexData[k]=c[k+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=
this.vertexCount};a.prototype.writeMeshDataToBuffers=function(a,c,e,k){for(var b in c)for(var d=c[b].stride,f=this.meshData.vertexData.get(b),h=c[b].data,l=g.strideToPackingFactor(d),p=0;p<d*this.meshData.vertexCount/l;++p)h[p+d*a/l]=f[p];for(p=0;p<this.meshData.indexData.length;++p)k[p+e]=this.meshData.indexData[p]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=e;this.indexCount=this.meshData.indexData.length};a.writeAllMeshDataToBuffers=function(a,c,e){for(var f=0,
b=0,d=0;d<a.length;d++){var h=a[d];h.writeMeshDataToBuffers(f,c,b,e);f+=h.vertexCount;b+=h.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};
a.deserialize=function(c,f){var e=c.readInt32(),h=c.readInt32();f=new a(f.id,e,h);f.symbolLevel=c.readInt32();f.zOrder=c.readInt32();f.vertexFrom=c.readInt32();f.vertexCount=c.readInt32();f.indexFrom=c.readInt32();f.indexCount=c.readInt32();f.minZoom=c.readInt32();f.maxZoom=c.readInt32();return f};return a}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(c,a){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=
function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};a.prototype.update=function(a,c,h){for(var f in a)this.vertexData.set(f,a[f]);for(f in this.vertexData)null===a[f]&&this.vertexData.delete(f);this.vertexCount=c;this.indexData=h};return a}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){}
a.prototype.writeMesh=function(a,c,f,e,g){};a.prototype.bindFeature=function(a,c,f){};return a}();a.default=c})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","dojox/string/BidiEngine"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});var g=new l;a.bidiText=function(a){if(!g.hasBidiChar(a))return[a,!1];var c;c="rtl"===g.checkContextual(a)?"IDNNN":"ICNNN";return[g.bidiTransform(a,c,"VLYSN"),!0]}})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require",
"exports","../enums","../visualVariablesUtils"],function(c,a,l,g){function k(a,c){void 0===c&&(c=!1);var e=l.WGLVVFlag.SIZE_FIELD_STOPS|l.WGLVVFlag.SIZE_MINMAX_VALUE|l.WGLVVFlag.SIZE_SCALE_STOPS|l.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(l.WGLVVTarget.FIELD_TARGETS_OUTLINE|l.WGLVVTarget.MINMAX_TARGETS_OUTLINE|l.WGLVVTarget.SCALE_TARGETS_OUTLINE|l.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return c?e&a:e&~a}function h(a){var c=k(a,!1);return a&(l.WGLVVFlag.COLOR|l.WGLVVFlag.OPACITY|l.WGLVVFlag.ROTATION|c)}Object.defineProperty(a,
"__esModule",{value:!0});a.getVVFlags=function(a){if(!a)return l.WGLVVFlag.NONE;for(var c=0,f=0;f<a.length;f++){var b=a[f];if("size"===b.type){var d=g.getTypeOfSizeVisualVariable(b),c=c|d;"outline"===b.target&&(c|=d<<4)}else"color"===b.type?c|=l.WGLVVFlag.COLOR:"opacity"===b.type?c|=l.WGLVVFlag.OPACITY:"rotation"===b.type&&(c|=l.WGLVVFlag.ROTATION)}return c};a.getSizeFlagsMask=k;a.getMarkerVVFlags=h;a.getFillVVFlags=function(a){return a&(l.WGLVVFlag.COLOR|l.WGLVVFlag.OPACITY)};a.getLineVVFlags=function(a,
c){if(c)return c=k(a,!0),a&c;c=k(a,!1);return a&(l.WGLVVFlag.COLOR|l.WGLVVFlag.OPACITY|c)};a.getTextVVFlags=function(a){return h(a)};a.getLabelVVFlags=function(a){var c=k(a,!1);return a&c}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),function(c,a,l,g,k,h){Object.defineProperty(a,"__esModule",{value:!0});var f=g.getLogger("esri.views.2d.engine.webgl");a.getTypeOfSizeVisualVariable=
function(a){if(h.isNumber(a.minDataValue)&&h.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize)return k.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return k.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return k.WGLVVFlag.SIZE_FIELD_STOPS;
if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return k.WGLVVFlag.SIZE_UNIT_VALUE;f.error(new l("mapview-bad-type","Found invalid size VisualVariable",a));return k.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return k.WGLGeometryType.LABEL};b.prototype.drawGeometry=function(a,b,c,f,g){var d=a.context,k=a.painter,m=a.state,l=a.rendererInfo,n=c.indexCount,p=c.indexFrom;c=e.LabelMaterialKey.load(c.materialKey);var r=c.mapAligned?1:0;if(r||!(1<=Math.abs(b.key.level-Math.round(100*a.displayLevel)/
100))){var u=h.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_zoomRangeAndEmpty",count:4,type:5121}]}),B=u.bufferLayouts,u=u.attributes;g=k.materialManager.getMaterialProgram(a,
c,"materials/label",u,g);f=this._getVAO(d,B,u,f);a.context.setStencilFunction(514,0,255);d.bindProgram(g);d.bindVAO(f);this._setSharedUniforms(g,a,b);k.textureManager.bindTextures(d,g,c,4);k=1===r?m.displayViewMat3:m.displayMat3;c.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);c.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(b=l.getSizeVVFieldStops(b.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",b.values),
g.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));c.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);g.setUniform1f("u_mapRotation",Math.floor(m.rotation/360*254));g.setUniform1f("u_mapAligned",r);g.setUniformMatrix3fv("u_displayMat3",k);g.setUniform1f("u_opacity",1);g.setUniform1f("u_zoomLevel",Math.round(10*a.displayLevel));g.setUniform2fv("u_screenSize",a.state.size);d.drawElements(4,n,5125,4*p);d.bindVAO(null);d.setStencilTestEnabled(!0);
d.setBlendingEnabled(!0)}};return b}(f.default);a.default=c})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=
function(){return k.WGLGeometryType.LINE};b.prototype.drawGeometry=function(a,b,c,f,g){var d=a.context,k=a.painter,m=a.rendererInfo,l=a.requiredLevel,n=c.indexFrom,p=c.indexCount;c=e.LineMaterialKey.load(c.materialKey);var r=h.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",
count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),u=r.bufferLayouts,r=r.attributes;g=k.materialManager.getMaterialProgram(a,c,"materials/line",r,g);f=this._getVAO(d,u,r,f);u=1/a.pixelRatio;d.bindProgram(g);d.bindVAO(f);this._setSharedUniforms(g,a,b);c.textureBinding&&k.textureManager.bindTextures(d,g,c);g.setUniform1f("u_zoomFactor",Math.pow(2,l-b.key.level)/a.pixelRatio);g.setUniform1f("u_blur",
0+u);g.setUniform1f("u_antialiasing",u);c.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);c.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(a=m.getSizeVVFieldStops(b.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",a.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);c.vvColor&&(g.setUniform1fv("u_vvColorValues",
m.vvColorValues),g.setUniform4fv("u_vvColors",m.vvColors));c.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),g.setUniform1fv("u_vvOpacities",m.vvOpacities));d.setFaceCullingEnabled(!0);d.setFrontFace(2305);d.setCullFace(1029);d.drawElements(4,p,5125,4*n);d.setFaceCullingEnabled(!1);d.bindVAO(null)};return b}(f.default);a.default=c})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return h.WGLGeometryType.MARKER};b.prototype.drawGeometry=function(a,b,d,c,e){var h=a.context,g=a.painter,k=a.rendererInfo,m=a.state,l=d.indexCount,n=d.indexFrom;d=p.MarkerMaterialKey.load(d.materialKey);var r=f.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),u=r.bufferLayouts,r=r.attributes;e=g.materialManager.getMaterialProgram(a,d,"materials/icon",
r,e);c=this._getVAO(h,u,r,c);h.bindProgram(e);h.bindVAO(c);d.textureBinding&&g.textureManager.bindTextures(h,e,d,1);this._setSharedUniforms(e,a,b);e.setUniformMatrix3fv("u_displayMat3",d.vvRotation?m.displayViewMat3:m.displayMat3);d.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",k.vvSizeMinMaxValue);d.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",k.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(a=k.getSizeVVFieldStops(b.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",a.values),
e.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));d.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",k.vvSizeUnitValueToPixelsRatio);d.vvColor&&(e.setUniform1fv("u_vvColorValues",k.vvColorValues),e.setUniform4fv("u_vvColors",k.vvColors));d.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",k.vvOpacityValues),e.setUniform1fv("u_vvOpacities",k.vvOpacities));d.vvRotation&&e.setUniform1f("u_vvRotationType","geographic"===k.vvMaterialParameters.vvRotationType?0:1);h.drawElements(4,
l,5125,4*n);h.bindVAO(null)};return b}(e.default);a.default=c})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=
function(){return k.WGLGeometryType.TEXT};b.prototype.drawGeometry=function(a,b,c,f,g){var d=a.context,k=a.painter,m=a.rendererInfo,l=a.state,n=c.indexCount,p=c.indexFrom;c=e.TextMaterialKey.load(c.materialKey);var r=h.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texFontSize",count:4,
type:5121},{location:5,name:"a_aux",count:4,type:5120}]}),u=r.bufferLayouts,r=r.attributes;g=k.materialManager.getMaterialProgram(a,c,"materials/text",r,g);f=this._getVAO(d,u,r,f);d.bindProgram(g);d.bindVAO(f);this._setSharedUniforms(g,a,b);k.textureManager.bindTextures(d,g,c,4);g.setUniformMatrix3fv("u_displayMat3",l.displayMat3);c.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);c.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);c.vvSizeFieldStops&&
(a=m.getSizeVVFieldStops(b.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",a.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);c.vvColor&&(g.setUniform1fv("u_vvColorValues",m.vvColorValues),g.setUniform4fv("u_vvColors",m.vvColors));c.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),g.setUniform1fv("u_vvOpacities",m.vvOpacities));c.vvRotation&&g.setUniform1f("u_vvRotationType",
"geographic"===m.vvMaterialParameters.vvRotationType?0:1);d.drawElements(4,n,5125,4*p);d.bindVAO(null)};return b}(f.default);a.default=c})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});var e=h.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");
a.createMatcher=function(a,b,d){return g(this,void 0,void 0,function(){return l(this,function(c){switch(a.type){case "simple":case "dot-density":return[2,f.FeatureMatcher.fromBasicRenderer(a,b,d)];case "unique-value":return[2,f.MapMatcher.fromUVRenderer(a,b,d)];case "class-breaks":return[2,f.IntervalMatcher.fromCBRenderer(a,b,d)];case "dictionary":return[2,f.DictionaryMatcher.fromDictionaryRenderer(a,b,d)];default:return e.error(new k("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),
[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/support/cimSymbolUtils ../../../arcade/utils".split(" "),function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,"__esModule",{value:!0});var d=h.getLogger("esri/views/2d/engine/webgl/util/Matcher");
c=function(){function a(){this._defaultResult=null}a.fromBasicRenderer=function(b,d,c){return k(this,void 0,void 0,function(){var e,f,h;return g(this,function(g){switch(g.label){case 0:return[4,p.expandSymbols(b.getSymbols())];case 1:return e=g.sent(),f=new a,e.length?[4,d.createTemplateGroup(e[0],null,b,c)]:[3,3];case 2:h=g.sent(),f.setDefault(h),g.label=3;case 3:return[2,f]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=
function(a){this._defaultResult=a};a.prototype.match=function(a,b,d,c,e){return this.getDefault()};a.prototype.analyze=function(a,b,d,c){return k(this,void 0,void 0,function(){return g(this,function(a){return[2]})})};return a}();a.FeatureMatcher=c;h=function(a){function c(d,c,e,f){var h=a.call(this)||this;h._intervals=[];h._isMaxInclusive=c;f?h._getValue=b.callWithFeature.bind(null,f):d&&d.length?"function"===typeof d?(h._field=null,h._getValue=d):(h._field=d,h._normalizationInfo=e,h._getValue=h._getValueFromField.bind(h)):
h._field=null;return h}l(c,a);c.fromCBRenderer=function(a,b,d){return k(this,void 0,void 0,function(){var f,h,k,m,l,n,r,u,y,F,H,J,K,G,I,L,R,M,Q;return g(this,function(g){switch(g.label){case 0:return f=a.isMaxInclusive,h=a.normalizationField,k=a.normalizationTotal,m=a.normalizationType,l=a.field,n={normalizationField:h,normalizationTotal:k,normalizationType:m},(y=r=a.valueExpression)?[4,e.createRendererExpression(r,d.spatialReference,d.fields)]:[3,2];case 1:y=g.sent(),g.label=2;case 2:return u=y,
F=new c(l,f,n,u),[4,p.expandSymbol(a.backgroundFillSymbol)];case 3:H=g.sent(),J=0,K=a.classBreakInfos,g.label=4;case 4:if(!(J<K.length))return[3,8];G=K[J];return[4,p.expandSymbol(G.symbol)];case 5:return I=g.sent(),[4,b.createTemplateGroup(I,H,a,d)];case 6:L=g.sent(),R={min:G.minValue,max:G.maxValue},F.add(R,L),g.label=7;case 7:return J++,[3,4];case 8:return[4,p.expandSymbol(a.defaultSymbol)];case 9:return(M=g.sent())?[4,b.createTemplateGroup(M,H,a,d)]:[3,11];case 10:Q=g.sent(),F.setDefault(Q),g.label=
11;case 11:return[2,F]}})})};c.prototype.add=function(a,b){this._intervals.push({interval:a,result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};c.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};c.prototype.match=function(a,b,d,c,e){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:e},d,c);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++)if(c=this._intervals[b],
d=c.interval,c=c.result,e=this._isMaxInclusive?a<=d.max:a<d.max,a>=d.min&&e)return c;return this.getDefault()};c.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};c.prototype._getValueFromField=function(a){var b=a.attributes[this._field];if(!this._needsNormalization())return b;var c=this._normalizationInfo,e=c.normalizationField,f=c.normalizationTotal,c=c.normalizationType;a=!!e&&a.attributes[e];if(c)switch(c){case "field":return(a||
void 0)&&b/a;case "log":return Math.log(b)*Math.LOG10E;case "percent-of-total":return b/f*100;default:d.error("Found unknown normalization type: "+c)}else d.error("Normalization is required, but no type was set!")};return c}(c);a.IntervalMatcher=h;h=function(a){function d(d,c,e){var f=a.call(this)||this;f._nullResult=null;f._resultsMap=new Map;e?f._getValue=b.callWithFeature.bind(null,e):d&&d.length?"function"===typeof d[0]?(f._fields=null,f._getValue=d[0]):(f._fields=d,f._seperator=c||"",f._getValue=
f._getValueFromFields.bind(f)):f._fields=null;return f}l(d,a);d.fromUVRenderer=function(a,b,c){return k(this,void 0,void 0,function(){var f,h,k,m,l,n,r,u,y,F,H,J,K,G,I;return g(this,function(g){switch(g.label){case 0:return f=a.uniqueValueInfos,h=a.fieldDelimiter,k=[a.field],m=a.valueExpression,a.field2&&k.push(a.field2),a.field3&&k.push(a.field3),[4,p.expandSymbol(a.backgroundFillSymbol)];case 1:return l=g.sent(),(r=m)?[4,e.createRendererExpression(m,c.spatialReference,c.fields)]:[3,3];case 2:r=
g.sent(),g.label=3;case 3:n=r,u=new d(k,h,n),y=0,F=f,g.label=4;case 4:if(!(y<F.length))return[3,8];H=F[y];return[4,p.expandSymbol(H.symbol)];case 5:return J=g.sent(),[4,b.createTemplateGroup(J,l,a,c)];case 6:K=g.sent(),"\x3cNull\x3e"===H.value?u.setNullResult(K):u.add(H.value,K),g.label=7;case 7:return y++,[3,4];case 8:return[4,p.expandSymbol(a.defaultSymbol)];case 9:return(G=g.sent())?[4,b.createTemplateGroup(a.defaultSymbol,l,a,c)]:[3,11];case 10:I=g.sent(),u.setDefault(I),g.label=11;case 11:return[2,
u]}})})};d.prototype.setNullResult=function(a){this._nullResult=a};d.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};d.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};d.prototype.match=function(a,b,d,c,e){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:e},d,c);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?
this._resultsMap.get(a):this.getDefault()};d.prototype._getValueFromFields=function(a){for(var b=[],d=0,c=this._fields;d<c.length;d++)b.push(a.attributes[c[d]]);return b.join(this._seperator)};return d}(c);a.MapMatcher=h;c=function(a){function b(b,d,c){var e=a.call(this)||this;e._fidToAttributeHash=new Map;e._attributeHashToGroup=new Map;e._renderer=b;e._fieldMap=b.fieldMap;e._templates=d;e._info=c;return e}l(b,a);b.fromDictionaryRenderer=function(a,d,c){return k(this,void 0,void 0,function(){return g(this,
function(e){a.fetchResources({spatialReference:c.spatialReference,fields:c.fields});return[2,new b(a,d,c)]})})};b.prototype.analyze=function(a,b,d,c){return k(this,void 0,void 0,function(){var e,h,k,m,l,n,p=this;return g(this,function(g){switch(g.label){case 0:e=[];h=function(b){var f=b.attributes[a],h=k._fidToAttributeHash.get(f),g=k._hashAttributes(b);if(h===g)return"continue";k._fidToAttributeHash.set(f,g);k._attributeHashToGroup.has(g)||(b=k._renderer.getSymbolAsync(b,{scale:d&&d.scale,viewingMode:d&&
d.viewingMode,spatialReference:k._info.spatialReference,abortOptions:c,fields:k._info.fields}).then(function(a){return p._templates.createTemplateGroup(a,null,p._renderer,p._info).then(function(a){return p._attributeHashToGroup.set(g,a)})}),e.push(b))};k=this;m=0;for(l=b;m<l.length;m++)n=l[m],h(n);return[4,f.all(e)];case 1:return g.sent(),[2]}})})};b.prototype.match=function(a,b){a=this._fidToAttributeHash.get(b.attributes[a]);return this._attributeHashToGroup.get(a)};b.prototype._hashAttributes=
function(a){var b="",d;for(d in this._fieldMap)b+=". "+a.attributes[this._fieldMap[d]];return b};return b}(c);a.DictionaryMatcher=c})},"esri/views/2d/arcade/utils":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/WeakMap ../../../core/Error ../../../core/Logger ../../../geometry/support/quantizationUtils ../../../layers/graphics/featureConversionUtils".split(" "),function(c,a,l,g,k,h,f,e){function p(a,d,c,e){var f=e.transform,h=e.hasZ;e=e.hasM;m.has(a)||
m.set(a,b(c));a=m.get(a)(d.geometry,f,h,e);return l({},d,{geometry:a})}function b(a){var b={};switch(a){case "esriGeometryPoint":return function(a,d,c,e){return f.hydratePoint(d,b,a,c,e)};case "esriGeometryPolygon":return function(a,d,c,e){return f.hydratePolygon(d,b,a,c,e)};case "esriGeometryPolyline":return function(a,d,c,e){return f.hydratePolyline(d,b,a,c,e)};case "esriGeometryMultipoint":return function(a,d,c,e){return f.hydrateMultipoint(d,b,a,c,e)};default:return d.error(new k("mapview-arcade",
"Unable to handle geometryType: "+a)),function(a){return a}}}Object.defineProperty(a,"__esModule",{value:!0});var d=h.getLogger("esri.views.2d.support.arcadeOnDemand");a.callWithOptimizedFeature=function(a,b,c,f,h){var g=f.geometryType,k=f.hasZ;f=f.hasM;b=a.referencesGeometry()?h?p(a,e.convertToFeature(b,g,k,f),g,h):e.convertToFeature(b,g,k,f):b;b=a.repurposeFeature(b);try{return a.evaluate(l({},c,{$feature:b}))}catch(z){return d.warn("Feature arcade evaluation failed:",z),null}};a.callWithFeature=
function(a,b,c,e,f){b=a.referencesGeometry()&&f?p(a,b,e,f):b;b=a.repurposeFeature(b);try{return a.evaluate(l({},c,{$feature:b}))}catch(t){return d.warn("Feature arcade evaluation failed:",t),null}};var m=new g.default;a.createHydrateFactory=b})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/SpatialReference ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C){function D(a){var b=(a.attributes?Object.keys(a.attributes):[]).map(function(b){return{name:b,alias:b,type:"string"===typeof a.attributes[b]?"esriFieldTypeString":"esriFieldTypeDouble"}});return{geometryType:null!=a.centroid?"esriGeometryPolygon":m.getJsonType(a.geometry),spatialReference:d.fromJSON(a.geometry.spatialReference),fields:b}}Object.defineProperty(a,"__esModule",{value:!0});var B=e.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),
E={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};c=function(){function a(a,b,d,c,e,f){this._isDD=!1;this._labelsDebugTemplate=null;this._isDD=p.isSome(d)&&"dot-density"===d.type;this._geometryType=a;this._idField=b;this._templateStore=c;this._setLabelTemplates(e,d,f)}a.prototype.update=
function(a,b,d){this._isDD=p.isSome(b)&&"dot-density"===b.type;this._setLabelTemplates(a,b,d)};a.prototype._setLabelTemplates=function(a,b,d){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return v.default.fromLabelClass(b,a,d)}))};Object.defineProperty(a.prototype,"templates",{get:function(){return this._templateStore},enumerable:!0,configurable:!0});a.prototype.createMeshData=function(a){var b=Array(5),d=this._labelTemplates&&0<this._labelTemplates.length,c="esriGeometryPolyline"===
this._geometryType?n.HEURISTIC_GLYPHS_PER_LINE:n.HEURISTIC_GLYPHS_PER_FEATURE;b[u.WGLGeometryType.MARKER]=new t.VertexVectors(u.WGLGeometryType.MARKER,a);b[u.WGLGeometryType.FILL]=new t.VertexVectors(u.WGLGeometryType.FILL,a,this._isDD);b[u.WGLGeometryType.LINE]=new t.VertexVectors(u.WGLGeometryType.LINE,a);b[u.WGLGeometryType.TEXT]=new t.VertexVectors(u.WGLGeometryType.TEXT,a);b[u.WGLGeometryType.LABEL]=new t.VertexVectors(u.WGLGeometryType.LABEL,d?c:0);return new w.MeshData([],b)};a.prototype.analyze=
function(a,d,c,e,f,h){return k(this,void 0,void 0,function(){var k,m,l,n,t,v,r,w,u,z,y;return g(this,function(g){switch(g.label){case 0:return k=a,b.isAborted(h)?[2,[]]:p.isSome(c)?[4,c.analyze(this._idField,a,f,h)]:[3,2];case 1:g.sent(),g.label=2;case 2:m=0,l=k,g.label=3;case 3:if(!(m<l.length))return[3,10];n=l[m];t=-1;if(!d)return[3,7];v=n;if(null==v.symbol)return[3,5];r=null;"cim"===v.symbol.type&&(r=D(n));return[4,this._templateStore.createTemplateGroup(v.symbol,null,null,r)];case 4:return t=
g.sent(),[3,6];case 5:p.isSome(c)&&(t=c.match(this._idField,n,null,null,f)),g.label=6;case 6:return[3,8];case 7:p.isSome(c)&&(t=c.match(this._idField,n,this._geometryType,e,f)),g.label=8;case 8:if(C.isDynamicId(t))for(w=this._templateStore.getDynamicTemplateGroup(t),u=0,z=w;u<z.length;u++)(y=z[u])&&y.analyze&&y.analyze(this._templateStore,n,e,f);n.groupId=t;g.label=9;case 9:return m++,[3,3];case 10:return[2,this._templateStore.finalize(h).then(function(){return k})]}})})};a.prototype.write=function(a,
b,d,c,e,f,h){var g=this._templateStore.getTemplateGroup(b.groupId),k=b.localId;if(null!=k){var l=new y(k),n=!!f&&!!this._labelTemplates&&f.has(k);if(C.isDynamicId(b.groupId))for(var p=0;p<g.length;p++){var t=g[p];t.bindFeature(b,d,c)}if(g&&(b.geometry||b.centroid)){c=l.displayRecords;t=b.insertAfter;void 0!==t&&(l.insertAfter=t);(d=this._geometryType)||(d=null!=b.centroid?"esriGeometryPolygon":m.getJsonType(b.geometry));for(p=0;p<g.length;p++){var t=g[p],v=a.get(t.geometryType);t.writeMesh(c,v,d,
k,b)}n&&(g=this._getLabelReference(g),f=f.get(k),this._writeLabelMesh(l,a,k,b,h,f,g,e,d));a.pushDisplayObject(l)}}};a.prototype._hasBadLabelClass=function(a,b){var d=a.labelPlacement,c=E[b];if(!a.symbol)return B.warn("No LabelClass symbol specified."),!0;if(!c)return B.error(new h("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+b+" is not supported")),!0;c.some(function(a){return a===d})||(c=c[0],d&&B.warn("Found invalid label placement type "+d+" for "+
b+". Defaulting to "+c),a.labelPlacement=c);return!1};a.prototype._validateLabelingInfo=function(a){var b=this;return!a.some(function(a){return b._hasBadLabelClass(a,b._geometryType)})};a.prototype._getLabelReference=function(a){for(var b=0;b<a.length;b++){var d=a[b];if(d instanceof A.default)return d}return null};a.prototype._writeLabelMesh=function(a,b,d,c,e,f,h,g,k){for(var m=a.displayRecords,l=[],p=0;p<f.length;p++){var t=f[p],v=t.text,r=t.rtl,t=this._labelTemplates[t.id],w=b.get(t.geometryType),
u=e.get(t.symbolId).glyphMosaicItems;t.bindReferenceTemplate(h);t.bindTextInfo(u,v,r);t.writeMesh(m,w,k,d,c,g,l)}a.metrics=l;n.DEBUG_LABELS&&this._debugLabels(a,b)};a.prototype._debugLabels=function(a,b){var d=a.displayRecords,c=a.id,e=0;for(a=a.metrics;e<a.length;e++)for(var f=a[e],h=0,g=f.boxes?f.boxes.concat([f.bounds]):[f.bounds];h<g.length;h++){var k=g[h],k={geometry:{paths:[[[f.anchor[0]+f.offsetX+k.center[0]-k.width/2,f.anchor[1]+f.offsetY+k.center[1]+k.height/2],[0,-k.height],[k.width,0],
[0,k.height],[-k.width,0]]]},attributes:{}},m=this._getLabelDebugTemplate(),l=b.get(m.geometryType);m.writeMesh(d,l,"esriGeometryPolyline",c,k)}};a.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());return this._labelsDebugTemplate};a.prototype._createLabelsDebugTemplate=function(){var a=new r({style:"solid",width:1,color:[255,0,0,1]});return z.default.fromSimpleLine(null,!1,a,null,!1)};return a}();a.WGLMeshFactory=
c})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(c,a,l,g,k){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=[]}a.prototype.copy=function(){var c=new a(this.id);c.set(this);return c};a.prototype.clone=function(){var c=new a(this.id);c.displayRecords=this.displayRecords.map(function(a){return a.clone()});c.metrics=this.metrics.map(function(a){return a.clone()});
c.insertAfter=this.insertAfter;return c};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);k.serializeList(a,this.metrics);k.serializeList(a,this.displayRecords);return a};a.deserialize=function(c){var e=c.readInt32(),f=new a(e),e={id:e},b=k.deserializeList(c,g.default);b.length&&(f.metrics=b);f.displayRecords=k.deserializeList(c,l,e);return f};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require",
"exports","../util/serializationUtils","../util/Writer"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c){this.displayObjects=a;this.vertexVectorsMap=c}Object.defineProperty(a.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,
configurable:!0});a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};a.prototype.encode=function(a,c){var e=l.serializeList(new g.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),f={};c.push(e);for(var b=0;b<this.vertexVectorsMap.length;b++){var d=this.vertexVectorsMap[b];f[b]={};d.transfer(f[b],c)}a.displayObjects=e;a.vertexBuffersMap=f;this.destroy()};a.prototype.destroy=function(){this.displayObjects=
this.vertexVectorsMap=null};a.prototype._guessSize=function(){for(var a=this.displayObjects,c=Math.min(a.length,4),e=0,g=0;g<c;g++)e=Math.max(e,a[g].displayRecords.length);return 2*(12*a.length+a.length*e*40)};return a}();a.MeshData=c})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c){this._pos=0;c=c?this._roundToNearest(c,a.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(c);
this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});a.prototype._roundToNearest=function(a,c){a=Math.round(a);return a+(c-a%c)};a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=this._roundToNearest(1.5*(this._array.byteLength+a*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);a=new ArrayBuffer(a);var c=new this._ctor(a);c.set(this._buffer,0);this._array=a;
this._buffer=c}};a.prototype.writeF32=function(a){this._ensureSize(1);var c=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return c};a.prototype.push=function(a){this._ensureSize(1);var c=this._pos;this._buffer[this._pos++]=a;return c};a.prototype.writeRegion=function(a){this._ensureSize(a.length);var c=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return c};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.seek=
function(a){this._pos=a};a.prototype.destroy=function(){this._buffer=this._array=null};return a}();a.default=c})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});var h=function(){function a(a,c){this.data=a;this.stride=c}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});
a.prototype.transfer=function(a,c){var b=this.data.buffer();a.vertexCount=this.vertexCount;a.data=b;a.stride=this.stride;c.push(b)};return a}();a.default=h;c=function(){function a(a,c,b){void 0===b&&(b=!1);this.geometryType=a;this.indexVector=new k.default(Uint32Array,c);this.namedVectors={};a=l.getStrides(a,b);for(var d in a){b=a[d];var e=void 0;switch(b%4){case 0:case 2:e=new k.default(Uint32Array,b/4*c);break;case 1:case 3:e=new k.default(Uint8Array,b*c)}this.namedVectors[d]=new h(e,b)}}a.prototype.get=
function(a){return this.namedVectors[a].data};a.prototype.getVector=function(a){return this.namedVectors[a]};a.prototype.transfer=function(a,c){var b=this.indexVector.buffer(),d={};c.push(b);for(var e in this.namedVectors){var f=this.namedVectors[e];d[e]={};f.transfer(d[e],c)}a.geometryType=this.geometryType;a.indexBuffer=b;a.namedBuffers=d;this.destroy()};a.prototype.intoBuffers=function(){var a=g.VertexBuffers.fromVertexVectors(this);this.destroy();return a};a.prototype.destroy=function(){this.namedVectors=
this.indexVector=null};return a}();a.VertexVectors=c})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});var g=function(){function a(a,c,e){this.data=a;this.stride=c;this.vertexCount=e}a.decode=function(c){var f=l.allocateTypedArrayBufferwithData(c.data,c.stride);return new a(f,c.stride,c.vertexCount)};a.fromVertexVector=function(c){var f=l.allocateTypedArrayBufferwithData(c.data.buffer(),
c.stride);return new a(f,c.stride,c.vertexCount)};return a}();a.default=g;c=function(){function a(a,c,e){this.geometryType=a;this.indexBuffer=new Uint32Array(c);this.namedBuffers=e}a.decode=function(c){var f=c.geometryType,e=c.indexBuffer,h={},b;for(b in c.namedBuffers)h[b]=g.decode(c.namedBuffers[b]);return new a(f,e,h)};a.fromVertexVectors=function(c){var f=c.geometryType,e=c.indexVector.buffer(),h={},b;for(b in c.namedVectors)h[b]=g.fromVertexVector(c.namedVectors[b]);return new a(f,e,h)};return a}();
a.VertexBuffers=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m,r){Object.defineProperty(a,"__esModule",{value:!0});var n=g.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");
c=function(a){function c(c,e,f,h,g,k,m,l,n,p,r,u,y,G,I,L){var t=a.call(this)||this;c=b.LineMaterialKey.load(b.createMaterialKey(t.geometryType,c,y));e&&(c.sdf=e.sdf,c.pattern=!0,c.textureBinding=e.textureBinding);t._capType=h;t._joinType=g;t._miterLimitCosine=d.getLimitCosine(k);t.tessellationProperties._fillColor=m;t.tessellationProperties._tl=l;t.tessellationProperties._br=n;t._hasPattern=p;t._isDashed=r;t._joinOnUTurn=L;t._isColorLocked=u;t._isOutline=y;t._zOrder=I;t._materialKey=c.data;t.tessellationProperties._bitset=
u?1:0;t.tessellationProperties._halfWidth=.5*f;t.tessellationProperties._halfReferenceWidth=.5*G;t._initializeTessellator(!1);return t}l(c,a);c.fromCIMLine=function(a,b,d,g,m,l){var n=b.color,p=b.isDashed,t=b.cap;p&&t===h.CapType.ROUND&&(t=h.CapType.SQUARE);var v=b.join;l*=k.pt2px(b.width);var r=k.pt2px(b.referenceWidth),w=k.pt2px(b.miterLimit),n=n&&f.premultiplyAlphaRGBA(n)||0;if(!d)return new c(a,d,l,t,v,w,n,0,0,!1,p,b.colorLocked,g,r,b.zOrder,m);var u=d.rect,z=u.x+1+d.width,y=u.y+1+d.height,u=
e.i1616to32(u.x+1,u.y+1),z=e.i1616to32(z,y);return new c(a,d,l,t,v,w,n,u,z,!0,p,b.colorLocked,g,r,b.zOrder,m)};c.fromSimpleLine=function(a,b,d,h,g){var m=d.color,l="solid"!==d.style&&"none"!==d.style,n=p.getCapType(d.cap||"round",l),t=p.getJoinType(d.join||"round"),m=m&&"none"!==d.style&&f.premultiplyAlphaRGBA(m)||0;"none"===d.style&&(m=0);var v=k.pt2px(d.width);d=d.miterLimit;if(!h)return new c(a,h,v,n,t,d,m,0,0,!1,l,!1,b,v,0,g);var r=h.rect,w=r.x+1+h.width,u=r.y+1+h.height,r=e.i1616to32(r.x+1,r.y+
1),w=e.i1616to32(w,u);return new c(a,h,v,n,t,d,m,r,w,!0,l,!1,b,v,0,g)};c.fromPictureLineSymbol=function(a,b,d,c){n.error("PictureLineSymbol support does not exist!");return null};return c}(m.default(r.default));a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/has ../../../../../../core/Logger ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){Object.defineProperty(a,"__esModule",{value:!0});var r=k.getLogger("esri.views.2d.engine.webgl.WGLLineTemplateBase"),n=h.TILE_SIZE+16,u=1/3.8,y=new p.TileClipper(0,0,0,1,16);y.setExtent(h.TILE_SIZE);var w=new Uint32Array(9),t=new Uint32Array(36),v=new Uint32Array(3),z=new Uint32Array(6),A=function(a){return function(b){b.entry0=a.offset+a.vertexCount++;var d=e.i1616to32(b.distance,31*a._halfWidth),c=e.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),
Math.round(0),Math.round(-31)),f=e.i8888to32(0,0,0,a._bitset);t[0]=e.i1616to32(b.currentVertex.x,b.currentVertex.y);t[1]=a.id;t[2]=a._fillColor;t[3]=c;t[4]=d;t[5]=a._tl;t[6]=a._br;t[7]=f;t[8]=e.i1616to32(31*a._halfReferenceWidth,0);b.entry2=a.offset+a.vertexCount++;d=e.i1616to32(b.distance,31*a._halfWidth);c=e.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));f=e.i8888to32(0,0,0,a._bitset);t[9]=e.i1616to32(b.currentVertex.x,b.currentVertex.y);t[10]=
a.id;t[11]=a._fillColor;t[12]=c;t[13]=d;t[14]=a._tl;t[15]=a._br;t[16]=f;t[17]=e.i1616to32(31*a._halfReferenceWidth,0);b.exit0=a.offset+a.vertexCount++;d=e.i1616to32(b.distance,31*a._halfWidth);c=e.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));f=e.i8888to32(0,0,0,a._bitset);t[18]=e.i1616to32(b.currentVertex.x,b.currentVertex.y);t[19]=a.id;t[20]=a._fillColor;t[21]=c;t[22]=d;t[23]=a._tl;t[24]=a._br;t[25]=f;t[26]=e.i1616to32(31*a._halfReferenceWidth,
0);b.exit2=a.offset+a.vertexCount++;d=e.i1616to32(b.distance,31*a._halfWidth);c=e.i8888to32(Math.round(31*-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));f=e.i8888to32(0,0,0,a._bitset);t[27]=e.i1616to32(b.currentVertex.x,b.currentVertex.y);t[28]=a.id;t[29]=a._fillColor;t[30]=c;t[31]=d;t[32]=a._tl;t[33]=a._br;t[34]=f;t[35]=e.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(t)}},C=function(a){return function(b){z[0]=b.leftExit0;z[1]=b.rightEntry0;z[2]=b.leftExit2;
z[3]=b.rightEntry0;z[4]=b.rightEntry2;z[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(z)}},D=function(a){return function(b,d,c,f,h,g,k,m,l){l=e.i1616to32(l,31*a._halfWidth);h=e.i8888to32(Math.round(31*h),Math.round(31*g),Math.round(31*k),Math.round(31*m));c=e.i8888to32(31*c,31*f,0,a._bitset);w[0]=e.i1616to32(b,d);w[1]=a.id;w[2]=a._fillColor;w[3]=h;w[4]=l;w[5]=a._tl;w[6]=a._br;w[7]=c;w[8]=e.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(w);return a.offset+a.vertexCount++}},
B=function(a){return function(b,d,c){v[0]=b;v[1]=d;v[2]=c;a.indexCount+=3;a.indexBuf.writeRegion(v)}};a.default=function(a){return function(a){function c(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};b._tessellationOptions={};b.geometryType=f.WGLGeometryType.LINE;
return b}l(c,a);c.prototype.writeMesh=function(a,b,c,e,f){var h=b.indexVector,g=b.get("geometry"),k=new d(e,this.geometryType,this._materialKey);b=b.getVector("geometry").vertexCount;k.vertexFrom=b;k.indexFrom=h.length;switch(c){case "esriGeometryPolyline":c=this._clipLines(f.geometry.paths);if(0===c.length)break;this._write(k,h,g,b,e,c);a.push(k);break;case "esriGeometryPolygon":c=this._clipLines(f.geometry.rings);if(0===c.length)break;this._write(k,h,g,b,e,c);a.push(k);break;default:r.error("Unable to handle geometryType: "+
c)}};c.prototype._clipLines=function(a){for(var b=[],d=!1,c=0;c<a.length;){var e=[],f=a[c];y.reset(2);var h=f[0],g=h[0],h=h[1];if(d)y.moveTo(g,h);else{if(-16>g||g>n||-16>h||h>n){d=!0;continue}e.push({x:g,y:h})}for(var k=!1,m=f.length,l=1;l<m;++l)if(g+=f[l][0],h+=f[l][1],d)y.lineTo(g,h);else{if(-16>g||g>n||-16>h||h>n){k=!0;break}e.push({x:g,y:h})}if(k)d=!0;else{if(d){if(e=y.resultWithStarts())for(d=0;d<e.length;d++)b.push(e[d])}else b.push({line:e,start:0});c++;d=!1}}return b};c.prototype._write=function(a,
d,c,e,f,h){this.tessellationProperties.id=f;this.tessellationProperties.indexBuf=d;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=c;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=e;for(d=0;d<h.length;d++)c=h[d],e=c.line,2>e.length||(this._tessellationOptions.initialDistance=c.start%65535,this._tessellationCallbacks instanceof b.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=
this._joinType),b.tessellate(e,this._tessellationOptions,this._tessellationCallbacks),b.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;a.zOrder=this._zOrder};c.prototype._initializeTessellator=function(a){var d=m.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!a&&this.tessellationProperties._halfWidth<h.THIN_LINE_THRESHOLD/2&&!(d.vvSizeFieldStops||
d.vvSizeMinMaxValue||d.vvSizeScaleStops||d.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=u;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=u;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:A(this.tessellationProperties),bridge:C(this.tessellationProperties)}:
(a=new b.StandardTessellationCallbacks(D(this.tessellationProperties),B(this.tessellationProperties)),a.miterLimitCosine=this._miterLimitCosine,a.textured=this._isDashed||this._hasPattern,a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a)};return c}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function c(b,d,c,g,l,n,w,u,y,H,J,K,G,I,L,R,M,Q,N){var t=a.call(this)||this;t.height=w;t.width=n;t.xOffset=d*N;t.yOffset=c*N;d=e.vec2f32.create();c=h.mat2df32.create();J=(I===p.Alignment.MAP?1:0)|(J?1:0)<<1|(G?1:0)<<2|(K?1:0)<<3;K=L&&L.sdf;k.mat2d.translate(c,c,e.vec2f32.fromValues(t.xOffset,-t.yOffset));g&&k.mat2d.rotate(c,c,3.14159265359/180*g);b=r.MarkerMaterialKey.load(r.createMaterialKey(t.geometryType,
b,!1));b.sdf=K;b.pattern=!0;b.textureBinding=L.textureBinding;t._materialKey=b.data;t._fillColor=l;t._outlineColor=y;t._sizeOutlineWidth=m.i8888to32(Math.round(Math.sqrt(256*n)),Math.round(Math.sqrt(256*w)),Math.round(Math.sqrt(256*H)),Math.round(Math.sqrt(256*u)));l=L.rect.x;u=L.rect.y;y=l+L.rect.width;H=u+L.rect.height;R=.5-((.5+R)*L.width+1)/L.rect.width;M=.5-((.5+M)*L.height+1)/L.rect.height;b=Math.round(Math.min(64*Q,255));n*=L.rect.width/L.width*Q*N;w*=L.rect.height/L.height*Q*N;L=(R-.5)*n;
M=(M-.5)*w;t._bitestAndDistRatio=m.i8888to32(0,0,J,b);f.vec2.set(d,L,M);f.vec2.transformMat2d(d,d,c);t._offsetUpperLeft=m.i1616to32(16*d[0],16*d[1]);t._texUpperLeft=m.i1616to32(l,u);f.vec2.set(d,L+n,M);f.vec2.transformMat2d(d,d,c);t._offsetUpperRight=m.i1616to32(16*d[0],16*d[1]);t._texUpperRight=m.i1616to32(y,u);f.vec2.set(d,L,M+w);f.vec2.transformMat2d(d,d,c);t._offsetBottomLeft=m.i1616to32(16*d[0],16*d[1]);t._texBottomLeft=m.i1616to32(l,H);f.vec2.set(d,L+n,M+w);f.vec2.transformMat2d(d,d,c);t._offsetBottomRight=
m.i1616to32(16*d[0],16*d[1]);t._texBottomRight=m.i1616to32(y,H);return t}l(c,a);c.fromCIMMarker=function(a,d,e,f){var h=d.size,k=(e&&e.width||1)/(e&&e.height||1)*d.scaleX,m=d.scaleSymbolsProportionally&&d.frameHeight?h/d.frameHeight:1,l=b.premultiplyAlphaRGBA(d.color),n=b.premultiplyAlphaRGBA(d.outlineColor),t=g.pt2px(h),r=t*k,v=g.pt2px(d.offsetX||0),w=g.pt2px(d.offsetY||0),m=g.pt2px(d.outlineWidth||0)*m,u=d.alignment||p.Alignment.SCREEN,y=g.pt2px(d.referenceSize),z=d.rotation||0;d.rotateClockwise||
(z=-z);var A=0,Q=0,N=d.anchorPoint;N&&(d.isAbsoluteAnchorPoint?h&&(A=-N.x/(h*k),Q=N.y/h):(A=N.x,Q=N.y));return new c(a,v,w,z,l,r,t,y,n,m,d.colorLocked,d.scaleSymbolsProportionally,!1,u,e,A,Q,d.sizeRatio,f)};c.fromPictureMarker=function(a,b,e){var f=Math.round(g.pt2px(b.width)),h=Math.round(g.pt2px(b.height)),k=d.PICTURE_FILL_COLOR,m=Math.round(g.pt2px(b.xoffset||0)),l=Math.round(g.pt2px(b.yoffset||0));return new c(a,m,l,b.angle,k,f,h,h,0,0,!1,!1,!1,p.Alignment.SCREEN,e,0,0,1,1)};c.fromSimpleMarker=
function(a,d,e){var f=b.premultiplyAlphaRGBA(d.color),h=Math.round(g.pt2px(d.size)),k=Math.round(g.pt2px(d.xoffset||0)),m=Math.round(g.pt2px(d.yoffset||0)),l=d.style,n=d.outline,t=(n&&n.color&&b.premultiplyAlphaRGBA(n.color))|0,n=(n&&n.width&&Math.round(g.pt2px(n.width)))|0;return new c(a,k,m,d.angle,f,h,h,h,t,n,!1,!1,"cross"===l||"x"===l,p.Alignment.SCREEN,e,0,0,1.96875,1)};return c}(n.default(u.default));a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../enums ../../number ../../WGLDisplayRecord".split(" "),
function(c,a,l,g,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});var e=g.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase");a.default=function(a){return function(a){function b(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.xOffset=0;b.yOffset=0;b.width=0;b.height=0;b.geometryType=k.WGLGeometryType.MARKER;return b}l(b,a);b.prototype.writeMesh=function(a,b,d,c,h){var g=b.indexVector,k=b.get("geometry"),m=new f(c,this.geometryType,this._materialKey);
b=b.getVector("geometry").vertexCount;a.push(m);m.vertexFrom=b;m.indexFrom=g.length;switch(d){case "esriGeometryPoint":d=h.geometry;a=d.x;d=d.y;this._writeVertices(m,k,c,this._getPos(a,d));this._writeIndices(m,g,b);break;case "esriGeometryPolyline":this._writeMany(m,g,k,b,c,h.geometry.paths[0]);break;case "esriGeometryPolygon":(d=h.centroid)?(a=d.x,d=d.y,this._writeVertices(m,k,c,this._getPos(a,d)),this._writeIndices(m,g,b)):e.error("Tried to render polygon geometries as markers, but found no centroid!");
break;case "esriGeometryMultipoint":this._writeMany(m,g,k,b,c,h.geometry.points);break;default:e.error("Unable to handle geometryType: "+d)}};b.prototype._getPos=function(a,b){return h.i1616to32(a,b)};b.prototype._writeMany=function(a,b,d,c,e,f){for(var h=0,g=0,k=0,m=0;m<f.length;m++){var l=f[m],n=l[0],l=l[1],p=this._getPos(n+h,l+g);this._writeVertices(a,d,e,p);this._writeIndices(a,b,c+k);h+=n;g+=l;k+=4}};b.prototype._writeVertices=function(a,b,d,c){b.push(c);b.push(this._offsetUpperLeft);b.push(this._texUpperLeft);
b.push(this._bitestAndDistRatio);b.push(d);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(c);b.push(this._offsetUpperRight);b.push(this._texUpperRight);b.push(this._bitestAndDistRatio);b.push(d);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(c);b.push(this._offsetBottomLeft);b.push(this._texBottomLeft);b.push(this._bitestAndDistRatio);b.push(d);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);
b.push(c);b.push(this._offsetBottomRight);b.push(this._texBottomRight);b.push(this._bitestAndDistRatio);b.push(d);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);a.vertexCount+=4};b.prototype._writeIndices=function(a,b,d){b.push(d+0);b.push(d+1);b.push(d+2);b.push(d+1);b.push(d+3);b.push(d+2);a.indexCount+=6};return b}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../support/arcadeOnDemand ../../../../../../symbols/cim/cimAnalyzer ../../../../../../symbols/support/defaults ../../../../arcade/utils ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/BidiText ../../util/Lock ../../util/Result".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A){function C(a,b){var d=a.length;a.push(null);b.then(function(b){return a[d]=b});return a}function D(a){return!!(a&1)}Object.defineProperty(a,"__esModule",{value:!0});var B=h.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),E=[];a.isDynamicId=D;c=function(){function a(a,b){this._templateIdCounter=this._idCounter=0;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new z.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,b,d,c){return l(this,void 0,void 0,function(){var e,f,h;return g(this,function(g){switch(g.label){case 0:return[4,this._initErrorTemplates()];case 1:g.sent();e=JSON.stringify(a);if(this._symbolToTemplate.has(e))return[2,this._symbolToTemplate.get(e)];f=[];return b?[4,this._createMeshTemplates(f,b,d,c,!0)]:[3,3];case 2:g.sent(),g.label=3;case 3:return[4,this._createMeshTemplates(f,
a,d,c,!1)];case 4:return g.sent(),h=this._createGroupId("cim"===a.type),this._idToTemplateGroup.set(h,f),this._symbolToTemplate.set(e,h),[2,h]}})})};a.prototype.getCIMMosaicItem=function(a,b){var d=this,c=this._createTemplateId(),e=f.create(function(a){return d._idToResolver.set(c,a)});this._fetchQueue.push({symbol:a,id:c,glyphIds:b});return e};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):E};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return E;
D(a)||B.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.finalize=function(a){return this._fetchQueue.length||this._lock.isHeld()?z.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):f.resolve()};a.prototype._initErrorTemplates=function(){return l(this,void 0,void 0,function(){var a,d,c,e;return g(this,function(h){switch(h.label){case 0:if(this._errorTemplates)return[2];a=this._createMeshTemplates([],b.errorPolygonSymbol2D,
null,null,!1);d=this._createMeshTemplates([],b.errorPointSymbol2D,null,null,!1);c=this._createMeshTemplates([],b.errorPolylineSymbol2D,null,null,!1);return[4,f.all([a,d,c])];case 1:return e=h.sent(),this._errorTemplates={fill:e[0],marker:e[1],line:e[2]},[2]}})})};a.prototype._fetchAllQueuedResources=function(a){var b=this;if(!this._fetchQueue.length)return f.resolve();var d=this._fetchQueue,c=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return f.all(c).then(function(){return b._fetchResource(d,
a).then(function(a){for(var d=0;d<a.length;d++){var c=a[d],e=c.id,c=c.mosaicItem;b._idToResolver.get(e)(c);b._idToResolver.delete(e)}})}).catch(function(a){f.isAbortError(a)?b._fetchQueue=b._fetchQueue.concat(d):B.error(new k("mapview-template-store","Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._getCodepoints=function(a){a=v.bidiText(a.text)[0];
for(var b=[],d=0;d<a.length;d++)b.push(a.charCodeAt(d));return b};a.prototype._getMosaicItem=function(a){var b=this,d=this._createTemplateId(),c="text"===a.type&&this._getCodepoints(a),e=f.create(function(a){return b._idToResolver.set(d,a)});this._fetchQueue.push({symbol:a.toJSON(),id:d,glyphIds:c});return e};a.prototype._createSMS=function(a,b){return l(this,void 0,void 0,function(){var d;return g(this,function(c){switch(c.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=c.sent().spriteMosaicItem,
A.ok(d,B)?[2,w.default.fromSimpleMarker(b,a,d)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,b){return l(this,void 0,void 0,function(){var d;return g(this,function(c){switch(c.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=c.sent().spriteMosaicItem,A.ok(d,B)?[2,w.default.fromPictureMarker(b,a,d)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,b,d){return l(this,void 0,void 0,function(){var c,e;return g(this,function(f){switch(f.label){case 0:return[4,
this._getMosaicItem(a)];case 1:return c=f.sent().spriteMosaicItem,e=a,A.ok(c,B)?[2,u.default.fromSimpleFill(b,e,c,d)]:[2,this._fillError]}})})};a.prototype._createPFS=function(a,b,d){return l(this,void 0,void 0,function(){var c,e;return g(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=f.sent().spriteMosaicItem,e=a,A.ok(c,B)?[2,u.default.fromPictureFill(b,e,c,d)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,b,d){return l(this,void 0,void 0,function(){var c,
e;return g(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=f.sent().spriteMosaicItem,e=a,A.ok(c,B)?[2,y.default.fromSimpleLine(b,d,e,c,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createTS=function(a,b){return l(this,void 0,void 0,function(){var d;return g(this,function(c){switch(c.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=c.sent().glyphMosaicItems,[2,t.default.fromText(b,a,d)]}})})};a.prototype._createCIMText=function(a,
b,d){return l(this,void 0,void 0,function(){var c,e,h,k,m,l;return g(this,function(g){switch(g.label){case 0:if("function"===typeof a.materialHash||"function"===typeof d)return[2,f.resolve(n.default.fromCIMText(b,a,d))];c=[];if(e=a.text)for(h=e.length,k=0;k<h;k++)m=e.charCodeAt(k),c.push(m);a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim,c)];case 1:return l=g.sent().glyphMosaicItems,A.ok(l,B)?[2,t.default.fromCIMText(b,a,d,l)]:[2,this._textError]}})})};a.prototype._createCIMFill=
function(a,b){return l(this,void 0,void 0,function(){var d;return g(this,function(c){switch(c.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getCIMMosaicItem(a.cim)];case 1:return d=c.sent().spriteMosaicItem,A.ok(d,B)?[2,u.default.fromCIMFill(b,a,d,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,b,d){return l(this,void 0,void 0,function(){var c;return g(this,function(e){switch(e.label){case 0:if("function"===typeof a.materialHash||"function"===typeof d)return[2,
f.resolve(m.default.fromCIMLine(b,a,d))];a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return c=e.sent().spriteMosaicItem,A.ok(c,B)?[2,y.default.fromCIMLine(b,a,c,!1,this._joinOnUTurn,d)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a,b,d){return l(this,void 0,void 0,function(){var c;return g(this,function(e){switch(e.label){case 0:if("function"===typeof a.materialHash||"function"===typeof d)return[2,f.resolve(r.default.fromCIMMarker(b,a,d))];a.cim.mosaicHash=
a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return c=e.sent().spriteMosaicItem,A.ok(c,B)?[2,w.default.fromCIMMarker(b,a,c,d)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,b,d){return l(this,void 0,void 0,function(){var c,e,f=this;return g(this,function(h){c=a.templateHash;if(this._cimTemplateCache.has(c))return[2,this._cimTemplateCache.get(c)];switch(a.type){case "marker":e=this._createCIMMarker(a,b,d);break;case "line":e=this._createCIMLine(a,b,d);break;case "fill":e=
this._createCIMFill(a,b);break;case "text":e=this._createCIMText(a,b,d)}e.then(function(a){return f._cimTemplateCache.set(c,a)});return[2,e]})})};a.prototype._getCIMSymbolLayers=function(a,b,d){return l(this,void 0,void 0,function(){var c,e;return g(this,function(h){switch(h.label){case 0:return c=[],e=[],c.push(p.analyzeCIMSymbol(a.data,b,d,e)),[4,f.all(c)];case 1:return h.sent(),[2,e]}})})};a.prototype._createCIMMeshTemplates=function(a,b,c,f){return l(this,void 0,void 0,function(){var h,k,m,l,
n,p,t,v,r,w,u;return g(this,function(g){switch(g.label){case 0:k=(h=c)?h.fieldMap:null;m=b;if(!h||!h.scaleExpression)return[3,3];if(!isNaN(h.scaleExpression))return[3,2];p=h.scaleExpression;return[4,e.createRendererExpression(p,f.spatialReference,f.fields)];case 1:return t=g.sent(),l=function(a,b,c){a=d.callWithFeature(t,a,{$view:c},f.geometryType,b);return null!==a?a:1},[3,3];case 2:n=Number(h.scaleExpression),g.label=3;case 3:return[4,this._getCIMSymbolLayers(m,k,f)];case 4:v=g.sent();r=0;for(w=
v;r<w.length;r++)u=w[r],C(a,this._createCIM(u,c,n||l||1));return[2]}})})};a.prototype._createMeshTemplates=function(a,b,d,c,e){return l(this,void 0,void 0,function(){var f,h,k;return g(this,function(g){switch(g.label){case 0:if(-1!==b.type.indexOf("3d"))return B.error("3D symbols are not supported with MapView"),[2,a];f=b.type;switch(f){case "cim":return[3,1];case "simple-marker":return[3,3];case "picture-marker":return[3,4];case "simple-fill":return[3,5];case "picture-fill":return[3,6];case "simple-line":return[3,
7];case "text":return[3,8]}return[3,9];case 1:return[4,this._createCIMMeshTemplates(a,b,d,c)];case 2:return g.sent(),[2,a];case 3:return[2,C(a,this._createSMS(b,d))];case 4:return[2,C(a,this._createPMS(b,d))];case 5:return h=b,C(a,this._createSFS(h,d,e)),h.outline&&C(a,this._createSLS(h.outline,d,!0)),[2,a];case 6:return k=b,C(a,this._createPFS(k,d,e)),k.outline&&C(a,this._createSLS(k.outline,d,!0)),[2,a];case 7:return[2,C(a,this._createSLS(b,d,!1))];case 8:return[2,C(a,this._createTS(b,d))];case 9:return B.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),
[2,a]}})})};return a}();a.WGLTemplateStore=c})},"esri/symbols/cim/cimAnalyzer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../Color ../../core/Logger ../../core/promiseUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ../../views/2d/arcade/utils".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){function u(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,
b:0,a:0}}function y(a){switch(a){case "Butt":return m.CapType.BUTT;case "Square":return m.CapType.SQUARE;default:return m.CapType.ROUND}}function w(a){switch(a){case "Bevel":return m.JoinType.BEVEL;case "Miter":return m.JoinType.MITER;default:return m.JoinType.ROUND}}function t(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function v(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";
case "Bottom":return"bottom"}}function z(a){var b="normal",d="normal";a&&(a=a.toLowerCase(),-1!==a.indexOf("italic")?b="italic":-1!==a.indexOf("oblique")&&(b="oblique"),-1!==a.indexOf("bold")?d="bold":-1!==a.indexOf("light")&&(d="lighter"));return{style:b,weight:d}}function A(a,b,c,e,f,h){return g(this,void 0,void 0,function(){var g,k,n,p,t,v,r;return l(this,function(l){switch(l.label){case 0:if(!a)return[2];g=a.symbolLayers;if(!g)return[2];n=d.CIMSymbolHelper.getSize(a);"CIMPointSymbol"===a.type&&
"Map"===a.angleAlignment&&(k=m.Alignment.MAP);p=g.length;l.label=1;case 1:if(!p--)return[3,23];t=g[p];if(!t||!1===t.enable)return[3,1];v=[];d.OverrideHelper.findApplicableOverrides(t,b,v);r=t.type;switch(r){case "CIMSolidFill":return[3,2];case "CIMPictureFill":return[3,4];case "CIMHatchFill":return[3,6];case "CIMGradientFill":return[3,8];case "CIMSolidStroke":return[3,10];case "CIMPictureStroke":return[3,12];case "CIMGradientStroke":return[3,14];case "CIMCharacterMarker":return[3,16];case "CIMPictureMarker":return[3,
17];case "CIMVectorMarker":return[3,19]}return[3,21];case 2:return[4,C(t,v,e,f)];case 3:return l.sent(),[3,22];case 4:return[4,D(t,v,e,f)];case 5:return l.sent(),[3,22];case 6:return[4,B(t,v,e,f)];case 7:return l.sent(),[3,22];case 8:return[4,E(t,v,e,f)];case 9:return l.sent(),[3,22];case 10:return[4,F(t,v,e,f,"CIMPolygonSymbol"===a.type,n)];case 11:return l.sent(),[3,22];case 12:return[4,H(t,v,e,f,"CIMPolygonSymbol"===a.type,n)];case 13:return l.sent(),[3,22];case 14:return[4,J(t,v,e,f,"CIMPolygonSymbol"===
a.type,n)];case 15:return l.sent(),[3,22];case 16:return[3,22];case 17:return[4,K(t,v,e,f,k,n)];case 18:return l.sent(),[3,22];case 19:return[4,G(t,v,c,e,f,k,n,h)];case 20:return l.sent(),[3,22];case 21:X.error("Cannot analyze CIM layer",t.type),l.label=22;case 22:return[3,1];case 23:return[2]}})})}function C(a,b,d,c){return g(this,void 0,void 0,function(){var e,f,h,g,k,m;return l(this,function(l){switch(l.label){case 0:return e=a.primitiveName,f=u(a.color),h=p.numericHash(JSON.stringify(a)).toString(),
k=(g=c).push,m={type:"fill",templateHash:h,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,N(e,"Color",b,d,f,Q)];case 1:return k.apply(g,[(m.color=l.sent(),m.height=0,m.angle=0,m.offsetX=0,m.offsetY=0,m.scaleX=1,m)]),[2]}})})}function D(a,b,d,c){return g(this,void 0,void 0,function(){var e,f,h,g,k,m,n;return l(this,function(l){switch(l.label){case 0:return e=a.primitiveName,f=u(a.tintColor),h=p.numericHash(JSON.stringify(a)).toString(),g=
p.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),m=(k=c).push,n={type:"fill",templateHash:h,materialHash:0===b.length?g:function(){return g},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,N(e,"TintColor",b,d,f,Q)];case 1:return n.color=l.sent(),[4,N(e,"Height",b,d,a.height)];case 2:return n.height=l.sent(),[4,N(e,"ScaleX",b,d,a.scaleX)];case 3:return n.scaleX=l.sent(),[4,N(e,"Rotation",b,d,a.rotation)];case 4:return n.angle=l.sent(),[4,N(e,"OffsetX",b,d,a.offsetX)];
case 5:return n.offsetX=l.sent(),[4,N(e,"OffsetY",b,d,a.offsetY)];case 6:return m.apply(k,[(n.offsetY=l.sent(),n)]),[2]}})})}function B(a,b,d,c){return g(this,void 0,void 0,function(){var e,f,h,g,k,m,n,t;return l(this,function(l){switch(l.label){case 0:e=["Rotation","OffsetX","OffsetY"];f=b.filter(function(b){return b.primitiveName!==a.primitiveName&&-1===e.indexOf(b.propertyName)});h=a.primitiveName;g=p.numericHash(JSON.stringify(a)).toString();m=(k=c).push;n={type:"fill",templateHash:g};if(0!==
b.length)return[3,1];t=g;return[3,3];case 1:return[4,S(g,f,d)];case 2:t=l.sent(),l.label=3;case 3:return n.materialHash=t,n.cim=a,n.materialOverrides=f,n.colorLocked=a.colorLocked,n.color={r:128,g:128,b:128,a:1},n.height=0,n.scaleX=1,[4,N(h,"Rotation",b,d,a.rotation)];case 4:return n.angle=l.sent(),[4,N(h,"OffsetX",b,d,a.offsetX)];case 5:return n.offsetX=l.sent(),[4,N(h,"OffsetY",b,d,a.offsetY)];case 6:return m.apply(k,[(n.offsetY=l.sent(),n)]),[2]}})})}function E(a,b,d,c){return g(this,void 0,void 0,
function(){var e,f,h,g,k;return l(this,function(m){switch(m.label){case 0:e=p.numericHash(JSON.stringify(a)).toString();h=(f=c).push;g={type:"fill",templateHash:e};if(0!==b.length)return[3,1];k=e;return[3,3];case 1:return[4,S(e,b,d)];case 2:k=m.sent(),m.label=3;case 3:return h.apply(f,[(g.materialHash=k,g.cim=a,g.materialOverrides=null,g.colorLocked=a.colorLocked,g.color={r:128,g:128,b:128,a:1},g.height=0,g.angle=0,g.offsetX=0,g.offsetY=0,g.scaleX=1,g)]),[2]}})})}function F(a,b,d,c,e,f){return g(this,
void 0,void 0,function(){var h,g,k,m,n,t,v,r,z,A;return l(this,function(l){switch(l.label){case 0:return h=p.numericHash(JSON.stringify(a)).toString(),g=a.primitiveName,k=u(a.color),m=void 0!==a.width?a.width:4,n=y(a.capStyle),t=w(a.joinStyle),v=a.miterLimit,z=(r=c).push,A={type:"line",templateHash:h,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,isOutline:e,colorLocked:a.colorLocked},[4,N(g,"Color",b,d,k,Q)];case 1:return A.color=l.sent(),[4,N(g,"Width",b,d,m)];case 2:return A.width=
l.sent(),[4,N(g,"CapStyle",b,d,n)];case 3:return A.cap=l.sent(),[4,N(g,"JoinStyle",b,d,t)];case 4:return A.join=l.sent(),[4,N(g,"MiterLimit",b,d,v)];case 5:return z.apply(r,[(A.miterLimit=l.sent(),A.referenceWidth=f,A.zOrder=M(a.name),A.isDashed=!1,A)]),[2]}})})}function H(a,b,d,c,e,f){return g(this,void 0,void 0,function(){var h,g,k,m,n,t,v,r,z,A,G;return l(this,function(l){switch(l.label){case 0:return h=p.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),g=a.primitiveName,k=
u(a.tintColor),m=void 0!==a.width?a.width:4,n=y(a.capStyle),t=w(a.joinStyle),v=a.miterLimit,r=p.numericHash(JSON.stringify(a)).toString(),A=(z=c).push,G={type:"line",templateHash:r,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,isOutline:e,colorLocked:a.colorLocked},[4,N(g,"TintColor",b,d,k,Q)];case 1:return G.color=l.sent(),[4,N(g,"Width",b,d,m)];case 2:return G.width=l.sent(),[4,N(g,"CapStyle",b,d,n)];case 3:return G.cap=l.sent(),[4,N(g,"JoinStyle",b,d,t)];case 4:return G.join=
l.sent(),[4,N(g,"MiterLimit",b,d,v)];case 5:return A.apply(z,[(G.miterLimit=l.sent(),G.referenceWidth=f,G.zOrder=M(a.name),G.isDashed=!1,G)]),[2]}})})}function J(a,b,d,c,e,f){return g(this,void 0,void 0,function(){var h,g,k,m,n,t,v,r,u,z;return l(this,function(l){switch(l.label){case 0:h=a.primitiveName;g=void 0!==a.width?a.width:4;k=y(a.capStyle);m=w(a.joinStyle);n=a.miterLimit;t=p.numericHash(JSON.stringify(a)).toString();r=(v=c).push;u={type:"line",templateHash:t};if(0!==b.length)return[3,1];z=
t;return[3,3];case 1:return[4,S(t,b,d)];case 2:z=l.sent(),l.label=3;case 3:return u.materialHash=z,u.cim=a,u.materialOverrides=null,u.isOutline=e,u.colorLocked=a.colorLocked,u.color={r:128,g:128,b:128,a:1},[4,N(h,"Width",b,d,g)];case 4:return u.width=l.sent(),[4,N(h,"CapStyle",b,d,k)];case 5:return u.cap=l.sent(),[4,N(h,"JoinStyle",b,d,m)];case 6:return u.join=l.sent(),[4,N(h,"MiterLimit",b,d,n)];case 7:return r.apply(v,[(u.miterLimit=l.sent(),u.referenceWidth=f,u.zOrder=M(a.name),u.isDashed=!1,u)]),
[2]}})})}function K(a,b,d,c,e,f){return g(this,void 0,void 0,function(){var h,g,k,m,n,t,v,r,w,z,y,A,G,D,I,C;return l(this,function(l){switch(l.label){case 0:h=a.primitiveName;g=a.size;k=a.scaleX;m=a.rotation;n=a.offsetX;t=a.offsetY;v=u(a.tintColor);r=p.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString();w=!1;z="";y=0;for(A=b;y<A.length;y++)G=A[y],G.primitiveName===h&&(void 0!==G.value?z+="|"+G.primitiveName+"|"+G.propertyName+"|"+JSON.stringify(G.value):G.valueExpressionInfo&&(w=
!0));I=(D=c).push;C={type:"marker",templateHash:p.numericHash(JSON.stringify(a)+z).toString(),materialHash:w?function(){return r}:r,cim:a,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:!1,alignment:e,anchorPoint:a.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits};return[4,N(h,"Size",b,d,g)];case 1:return C.size=l.sent(),[4,N(h,"ScaleX",b,d,k)];case 2:return C.scaleX=l.sent(),[4,N(h,"Rotation",b,d,m)];case 3:return C.rotation=l.sent(),[4,N(h,"OffsetX",
b,d,n)];case 4:return C.offsetX=l.sent(),[4,N(h,"OffsetY",b,d,t)];case 5:return C.offsetY=l.sent(),[4,N(h,"TintColor",b,d,v,Q)];case 6:return I.apply(D,[(C.color=l.sent(),C.outlineColor={r:0,g:0,b:0,a:0},C.outlineWidth=0,C.frameHeight=0,C.rotateClockwise=a.rotateClockwise,C.referenceSize=f,C.sizeRatio=1,C)]),[2]}})})}function G(a,b,d,c,f,h,k,m){return g(this,void 0,void 0,function(){var g,n,p,t,v,r,w,u;return l(this,function(l){switch(l.label){case 0:g=a.markerGraphics;if(!g)return[2];n=0;a.scaleSymbolsProportionally&&
(p=a.frame)&&(n=p.ymax-p.ymin);t=[];v=0;for(r=g;v<r.length;v++)if(w=r[v])if(u=w.symbol)switch(u.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":t.push(L(a,w,b,c,f,h,k,n,m));break;case "CIMTextSymbol":t.push(I(a,w,b,d,c,f,h,k,n))}return[4,e.all(t)];case 1:return l.sent(),[2]}})})}function I(a,b,c,e,f,h,m,n,r){return g(this,void 0,void 0,function(){var g,w,y,A,G,D,I,C,F,B,H,K,E,L,J,M,R,Q,U,q,S,da,W,ea;return l(this,function(l){switch(l.label){case 0:g=[];d.OverrideHelper.findApplicableOverrides(b,
c,g);w=b.geometry;if(!("x"in w&&"y"in w))return[2];y=b.symbol;A=y.underline?"underline":y.strikethrough?"line-through":"none";G=z(y.fontStyleName);y.font=k({family:y.fontFamilyName,decoration:A},G);D=a.frame;I=w.x-.5*(D.xmin+D.xmax);C=w.y-.5*(D.ymin+D.ymax);F=a.size/r;B=a.primitiveName;H=(y.height||0)*F;K=y.angle||0;E=((y.offsetX||0)+I)*F;L=((y.offsetY||0)+C)*F;J=u(d.CIMSymbolHelper.getFillColor(y));M=u(d.CIMSymbolHelper.getStrokeColor(y));R=d.CIMSymbolHelper.getStrokeWidth(y);R||(M=u(d.CIMSymbolHelper.getFillColor(y.haloSymbol)),
R=y.haloSize*F);Q="";U=0;for(q=c;U<q.length;U++)S=q[U],S.primitiveName===B&&void 0!==S.value&&(Q+="|"+S.primitiveName+"|"+S.propertyName+"|"+JSON.stringify(S.value));W=(da=h).push;ea={type:"text",templateHash:p.numericHash(JSON.stringify(b)+Q).toString(),materialHash:function(){return p.numericHash(JSON.stringify(y.font)).toString()},cim:y,materialOverrides:null,colorLocked:a.colorLocked,alignment:m,anchorPoint:{x:a.anchorPoint?a.anchorPoint.x:0,y:a.anchorPoint?a.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==
a.anchorPointUnits,fontName:y.fontFamilyName,decoration:"none",weight:"normal",style:"normal"};return[4,N(B,"Height",c,f,H)];case 1:return ea.size=l.sent(),[4,N(B,"Rotation",c,f,K)];case 2:return ea.angle=l.sent(),[4,N(B,"OffsetX",c,f,E)];case 3:return ea.offsetX=l.sent(),[4,N(B,"OffsetY",c,f,L)];case 4:return W.apply(da,[(ea.offsetY=l.sent(),ea.horizontalAlignment=t(y.horizontalAlignment),ea.verticalAlignment=v(y.verticalAlignment),ea.text=V(e,b.textString,y.textCase),ea.color=J,ea.outlineColor=
M,ea.outlineSize=R,ea.referenceSize=n,ea.sizeRatio=1,ea)]),[2]}})})}function L(a,b,c,e,f,h,k,m,n){return g(this,void 0,void 0,function(){var g,t,v,w,y,z;return l(this,function(A){switch(A.label){case 0:g=b.symbol;t=b.geometry;if(!t)return[2];v=r.getExtent(t);if("CIMTextSymbol"===g.type)return[2];w=g.symbolLayers;if(!w)return[2];y=w.length;z=function(){var g,z,A,G,D,I,C,F,B,H,K,E,q,L,J,M,U,S,da,ea,ta,V,W,pa,Y,ma,T,X,qa;return l(this,function(l){switch(l.label){case 0:return(g=w[y])&&!1!==g.enable?
n?[4,R(a,b,c,e,f,h,k,m)]:[3,2]:[2,"continue"];case 1:return l.sent(),[2,"continue"];case 2:z=g.type;switch(z){case "CIMSolidFill":return[3,3];case "CIMSolidStroke":return[3,3]}return[3,15];case 3:A=r.getSDFMetrics(v,a.frame,a.size,a.anchorPoint,"Relative"!==a.anchorPointUnits);G=A[0];D=A[1];I=A[2];C="CIMSolidFill"===g.type;F={type:"sdf",geom:t,asFill:C};B=a.primitiveName;H=a.size;K=a.rotation;E=a.offsetX;q=a.offsetY;L=g.primitiveName;J=C?u(d.CIMSymbolHelper.getFillColor(g)):u(d.CIMSymbolHelper.getStrokeColor(g));
M=C?{r:0,g:0,b:0,a:0}:u(d.CIMSymbolHelper.getStrokeColor(g));U=d.CIMSymbolHelper.getStrokeWidth(g);if(!C&&!U)return[3,16];S=!1;da="";ea=0;for(ta=c;ea<ta.length;ea++)if(V=ta[ea],V.primitiveName===L||V.primitiveName===B)void 0!==V.value?da+="|"+V.primitiveName+"|"+V.propertyName+"|"+JSON.stringify(V.value):V.valueExpressionInfo&&(S=!0);W=p.numericHash(JSON.stringify(F)).toString();pa=p.numericHash(JSON.stringify(g)+JSON.stringify(b)+da).toString();ma=(Y=f).push;T={type:"marker",templateHash:pa,materialHash:S?
function(){return W}:W,cim:F,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:D,y:I},isAbsoluteAnchorPoint:!1};return[4,N(B,"Size",c,e,H)];case 4:return T.size=l.sent(),T.scaleX=1,[4,N(B,"Rotation",c,e,K)];case 5:return T.rotation=l.sent(),[4,N(B,"OffsetX",c,e,E)];case 6:return T.offsetX=l.sent(),[4,N(B,"OffsetY",c,e,q)];case 7:return T.offsetY=l.sent(),[4,N(L,"Color",c,e,J,Q)];case 8:T.color=l.sent();if(!C)return[3,
9];X={r:0,g:0,b:0,a:0};return[3,11];case 9:return[4,N(L,"Color",c,e,M,Q)];case 10:X=l.sent(),l.label=11;case 11:T.outlineColor=X;if(!C)return[3,12];qa=0;return[3,14];case 12:return[4,N(L,"Width",c,e,U)];case 13:qa=l.sent(),l.label=14;case 14:return ma.apply(Y,[(T.outlineWidth=qa,T.frameHeight=m,T.rotateClockwise=a.rotateClockwise,T.referenceSize=k,T.sizeRatio=G,T)]),[3,16];case 15:return R(a,b,c,e,f,h,k,m),[3,16];case 16:return[2]}})};A.label=1;case 1:return y--?[5,z()]:[3,3];case 2:return A.sent(),
[3,1];case 3:return[2]}})})}function R(a,b,c,e,f,h,k,m){return g(this,void 0,void 0,function(){var g,n,t,v,r,w,u,y,z,A,G,D,I,C,B,F;return l(this,function(l){switch(l.label){case 0:g={type:a.type,enable:!0,name:a.name,colorLocked:a.colorLocked,primitiveName:a.primitiveName,anchorPoint:a.anchorPoint,anchorPointUnits:a.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:a.rotateClockwise,rotation:0,size:a.size,billboardMode3D:a.billboardMode3D,depth3D:a.depth3D,frame:a.frame,markerGraphics:[b],scaleSymbolsProportionally:a.scaleSymbolsProportionally,
respectFrame:a.respectFrame,clippingPath:a.clippingPath};n=[];t=["Rotation","OffsetX","OffsetY"];n=c.filter(function(b){return b.primitiveName!==a.primitiveName||-1===t.indexOf(b.propertyName)});v=d.CIMSymbolHelper.getTextureAnchor(g);r=v[0];w=v[1];u=JSON.stringify(g);y=a.primitiveName;z=a.rotation;A=a.offsetX;G=a.offsetY;D=p.numericHash(JSON.stringify(g)).toString();C=(I=f).push;B={type:"marker",templateHash:D};if(0!==n.length)return[3,1];F=D;return[3,3];case 1:return[4,S(u,n,e)];case 2:F=l.sent(),
l.label=3;case 3:return B.materialHash=F,B.cim=g,B.materialOverrides=n,B.colorLocked=a.colorLocked,B.scaleSymbolsProportionally=a.scaleSymbolsProportionally,B.alignment=h,B.anchorPoint={x:r,y:w},B.isAbsoluteAnchorPoint=!1,B.size=a.size,B.scaleX=1,[4,N(y,"Rotation",c,e,z)];case 4:return B.rotation=l.sent(),[4,N(y,"OffsetX",c,e,A)];case 5:return B.offsetX=l.sent(),[4,N(y,"OffsetY",c,e,G)];case 6:return C.apply(I,[(B.offsetY=l.sent(),B.color={r:0,g:0,b:0,a:0},B.outlineColor={r:0,g:0,b:0,a:0},B.outlineWidth=
0,B.frameHeight=m,B.rotateClockwise=a.rotateClockwise,B.referenceSize=k,B.sizeRatio=1,B)]),[2]}})})}function M(a){return a&&0===a.indexOf("Level_")?parseInt(a.substr(6),10):0}function Q(a){if(!a||0===a.length)return null;a=(new h(a)).toRgba();return{r:a[0],g:a[1],b:a[2],a:a[3]}}function N(a,d,c,e,f,h){return g(this,void 0,void 0,function(){var g,k,m,p,t;return l(this,function(v){switch(v.label){case 0:if(!a)return[3,4];g=function(c){var g,k,m;return l(this,function(l){switch(l.label){case 0:if(c.primitiveName!==
a||c.propertyName!==d)return[3,2];if(void 0!==c.value)return[2,{value:h?h(c.value):c.value}];g=c.valueExpressionInfo;if(!g)return[3,2];k=g.expression;return[4,b.createRendererExpression(k,e.spatialReference,e.fields)];case 1:return m=l.sent(),[2,{value:function(a,b,d){a=n.callWithFeature(m,a,{$view:d},e.geometryType,b);null!==a&&h&&(a=h(a));return null!==a?a:f}}];case 2:return[2]}})};k=0;m=c;v.label=1;case 1:if(!(k<m.length))return[3,4];p=m[k];return[5,g(p)];case 2:t=v.sent();if("object"===typeof t)return[2,
t.value];v.label=3;case 3:return k++,[3,1];case 4:return[2,f]}})})}function U(a,b){switch(b){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function V(a,b,d){if(!a||-1===b.indexOf("["))return U(b,d);var c=function(a){for(var b=a.length;b--;)if(-1===" /-,\n".indexOf(a.charAt(b)))return!1;return!0},e=[],f=0,h=-1;do h=b.indexOf("[",f),h>=f&&(h>f&&(f=b.substr(f,h-f),e.push([f,null,c(f)])),f=h+1,h=b.indexOf("]",f),h>=f&&(h>f&&(f=b.substr(f,h-f),(f=a[f])&&
e.push([null,f,!1])),f=h+1));while(-1!==h);f<b.length-1&&(f=b.substr(f),e.push([f,null,c(f)]));return function(a){for(var b="",c=null,f=0;f<e.length;f++){var h=e[f],g=h[0],k=h[1],h=h[2];if(g)h?c=g:(c&&(b+=c,c=null),b+=g);else if(g=a.attributes[k])c&&(b+=c,c=null),b+=g}return U(b,d)}}function S(a,c,e){return g(this,void 0,void 0,function(){var f,h,g,k;return l(this,function(m){switch(m.label){case 0:f=function(a){var d,c,f;return l(this,function(h){switch(h.label){case 0:d=a.valueExpressionInfo;if(!d)return[3,
2];c=d.expression;return[4,b.createRendererExpression(c,e.spatialReference,e.fields)];case 1:f=h.sent(),a.fn=function(a,b,d){return n.callWithFeature(f,a,{$view:d},e.geometryType,b)},h.label=2;case 2:return[2]}})},h=0,g=c,m.label=1;case 1:if(!(h<g.length))return[3,4];k=g[h];return[5,f(k)];case 2:m.sent(),m.label=3;case 3:return h++,[3,1];case 4:return[2,function(b,e,f){for(var h=0;h<c.length;h++){var g=c[h];g.fn&&(g.value=g.fn(b,e,f))}return p.numericHash(a+d.OverrideHelper.buildOverrideKey(c)).toString()}]}})})}
Object.defineProperty(a,"__esModule",{value:!0});var X=f.getLogger("esri.symbols.cim.cimAnalyzer");a.analyzeCIMSymbol=function(a,b,d,c,e){return g(this,void 0,void 0,function(){var f,h,g,k;return l(this,function(m){switch(m.label){case 0:f=c?c:[];if(!a)return[2,f];"CIMSymbolReference"===a.type?(h=a.symbol,g=a.primitiveOverrides):(h=a,g=null);k=h.type;switch(k){case "CIMPointSymbol":return[3,1];case "CIMLineSymbol":return[3,1];case "CIMPolygonSymbol":return[3,1];case "CIMTextSymbol":return[3,3]}return[3,
4];case 1:return[4,A(h,g,b,d,f,e)];case 2:return m.sent(),[3,4];case 3:return[3,4];case 4:return[2,f]}})})};a.analyzeCIMResource=function(a,b){if(!b||0===b.length)return a;a=JSON.parse(JSON.stringify(a));d.OverrideHelper.applyOverrides(a,b);return a}})},"esri/symbols/support/defaults":function(){define("require exports ../../core/compilerUtils ../../core/maybe ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../TextSymbol ./defaultsJSON".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,
"__esModule",{value:!0});a.defaultPointSymbol2D=f.fromJSON(p.defaultPointSymbolJSON);a.defaultPolylineSymbol2D=h.fromJSON(p.defaultPolylineSymbolJSON);a.defaultPolygonSymbol2D=k.fromJSON(p.defaultPolygonSymbolJSON);a.defaultTextSymbol2D=e.fromJSON(p.defaultTextSymbolJSON);a.getDefaultSymbol2D=function(b){if(g.isNone(b))return null;switch(b.type){case "mesh":break;case "point":case "multipoint":return a.defaultPointSymbol2D;case "polyline":return a.defaultPolylineSymbol2D;case "polygon":case "extent":return a.defaultPolygonSymbol2D;
default:l.neverReached(b)}return null};a.errorPointSymbol2D=f.fromJSON(p.errorPointSymbolJSON);a.errorPolylineSymbol2D=h.fromJSON(p.errorPolylineSymbolJSON);a.errorPolygonSymbol2D=k.fromJSON(p.errorPolygonSymbolJSON)})},"esri/symbols/support/defaultsJSON":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.defaultColor=[252,146,31,255];a.defaultOutlineColor=[153,153,153,255];a.defaultPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",size:6,
color:a.defaultColor,outline:{width:.75,color:[153,153,153,255]}};a.defaultPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",width:.75,color:a.defaultColor};a.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{width:.75,color:[255,255,255,191]}};a.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",
xoffset:0,yoffset:0,angle:0};a.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};a.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};a.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(b,d,c){var f=a.call(this,d)||this;f._cimLineLayer=d;var m=0;p.isFunction(d.width)||(m=.5*g.pt2px(d.width));f._dynamicPropertyMap.set("_halfWidth",function(a,b,c){return p.isFunction(d.width)?.5*g.pt2px(d.width(a,b,c)):m});var l=k.CapType.ROUND;p.isFunction(d.cap)||(l=d.cap);f._dynamicPropertyMap.set("_capType",function(a,b,c){return p.isFunction(d.cap)?d.cap(a,b,c):l});var n;p.isFunction(d.join)||
(n=d.join);f._dynamicPropertyMap.set("_joinType",function(a,b,c){return p.isFunction(d.join)?d.join(a,b,c):n});var r;if(!p.isFunction(d.color)){var w=d.color;r=w&&h.premultiplyAlphaRGBA(w)||0}f._dynamicPropertyMap.set("_fillColor",function(a,b,c){return p.isFunction(d.color)?(a=d.color(a,b,c))&&h.premultiplyAlphaRGBA(a)||0:r});var u;p.isFunction(d.miterLimit)||(u=p.getLimitCosine(d.miterLimit));f._dynamicPropertyMap.set("_miterLimitCosine",function(a,b,c){return p.isFunction(d.miterLimit)?p.getLimitCosine(d.miterLimit(a,
b,c)):u});var y=1;p.isFunction(c)||(y=c);f._dynamicPropertyMap.set("_scaleFactor",function(a,b,d){return p.isFunction(c)?c(a,b,d):y});f._isDashed=d.isDashed;f.tessellationProperties._bitset=d.colorLocked?1:0;f._materialKey=e.createMaterialKey(f.geometryType,b,d.isOutline);f._initializeTessellator(!0);return f}l(b,a);b.fromCIMLine=function(a,d,c){return new b(a,d,c)};b.prototype.bindFeature=function(a,b,d){var c=this,h=this._dynamicPropertyMap;h&&h.forEach(function(e,f){c[f]=e(a,b,d)});this._halfWidth*=
this._scaleFactor;var h=this._materialCache,g=this._cimLineLayer.materialHash,g=g(a,b,d),g=h.get(g),h=null;g&&m.ok(g.spriteMosaicItem)&&(h=g.spriteMosaicItem);if(h){this._hasPattern=!0;var g=h.rect,k=g.x+1+h.width,l=g.y+1+h.height;this.tessellationProperties._tl=f.i1616to32(g.x+1,g.y+1);this.tessellationProperties._br=f.i1616to32(k,l)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;
g=e.LineMaterialKey.load(this._materialKey);h&&(g.sdf=h.sdf,g.pattern=!0,g.textureBinding=h.textureBinding);this._materialKey=g.data};return b}(b.default(d.default));a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),function(c,a,l,g,k,h,f){Object.defineProperty(a,
"__esModule",{value:!0});var e=g.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");c=function(a){function b(b){var d=a.call(this)||this;d._ongoingMaterialRequestMap=new Map;d._materialCache=new Map;d._dynamicPropertyMap=new Map;d._cimLayer=b;return d}l(b,a);b.prototype.analyze=function(a,b,c,f){var d=this,g=this._materialCache,m=this._cimLayer.materialHash;if(!m)return e.error("A Dynamic mesh template must have a material hash value or function!"),k.reject(null);var l="function"===typeof m?
m(b,c,f):m;if(g.has(l))return a=g.get(l),k.resolve(a);if(this._ongoingMaterialRequestMap.has(l))return this._ongoingMaterialRequestMap.get(l);b=h.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);b.mosaicHash=l;a=a.getCIMMosaicItem(b).then(function(a){d._ongoingMaterialRequestMap.delete(l);g.set(l,a);return a}).catch(function(a){d._ongoingMaterialRequestMap.delete(l);e.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(l,a);return a};return b}(f.default);
a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t){Object.defineProperty(a,"__esModule",{value:!0});var v=3.14159265359/180,z=b.vec2f32.create(),A=e.mat2df32.create(),C=k.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");c=function(a){function c(b,c,e){var f=a.call(this,c)||this;f._cimMarkerLayer=c;var g=0;u.isFunction(c.color)||(g=m.premultiplyAlphaRGBA(c.color));f._dynamicPropertyMap.set("_fillColor",function(a,b,d){return u.isFunction(c.color)?m.premultiplyAlphaRGBA(c.color(a,b,d)):g});
var k=0;u.isFunction(c.outlineColor)||(k=m.premultiplyAlphaRGBA(c.outlineColor));f._dynamicPropertyMap.set("_outlineColor",function(a,b,d){return u.isFunction(c.outlineColor)?m.premultiplyAlphaRGBA(c.outlineColor(a,b,d)):k});var l;u.isFunction(c.size)||(l=h.pt2px(c.size));f._dynamicPropertyMap.set("_size",function(a,b,d){return u.isFunction(c.size)?h.pt2px(c.size(a,b,d)):l});var p;u.isFunction(c.scaleX)||(p=c.scaleX);f._dynamicPropertyMap.set("_scaleX",function(a,b,d){return u.isFunction(c.scaleX)?
c.scaleX(a,b,d):p});var t;u.isFunction(c.offsetX)||(t=h.pt2px(c.offsetX));f._dynamicPropertyMap.set("xOffset",function(a,b,d){return u.isFunction(c.offsetX)?h.pt2px(c.offsetX(a,b,d)):t});var v;u.isFunction(c.offsetY)||(v=h.pt2px(c.offsetY));f._dynamicPropertyMap.set("yOffset",function(a,b,d){return u.isFunction(c.offsetY)?h.pt2px(c.offsetY(a,b,d)):v});var r;u.isFunction(c.outlineWidth)||(r=h.pt2px(c.outlineWidth));f._dynamicPropertyMap.set("_outlineWidth",function(a,b,d){return u.isFunction(c.outlineWidth)?
h.pt2px(c.outlineWidth(a,b,d)):r});var w;u.isFunction(c.rotation)||(w=c.rotation);f._dynamicPropertyMap.set("_angle",function(a,b,d){return u.isFunction(c.rotation)?c.rotation(a,b,d):w});var y=1;u.isFunction(e)||(y=e);f._dynamicPropertyMap.set("_scaleFactor",function(a,b,d){return u.isFunction(e)?e(a,b,d):y});f._bitSet=(c.alignment===d.Alignment.MAP?1:0)|(c.colorLocked?1:0)<<1|(c.scaleSymbolsProportionally?1:0)<<3;f._materialKey=n.createMaterialKey(f.geometryType,b,!1);return f}l(c,a);c.fromCIMMarker=
function(a,b,d){return new c(a,b,d)};c.prototype.bindFeature=function(a,d,c){var e=this,k=this._dynamicPropertyMap;k&&k.forEach(function(b,f){e[f]=b(a,d,c)});k=this._cimMarkerLayer.materialHash;k="function"===typeof k?k(a,d,c):k;if((k=this._materialCache.get(k))&&t.ok(k.spriteMosaicItem)&&k.spriteMosaicItem){var k=k.spriteMosaicItem,m=this._cimMarkerLayer.sizeRatio,l=k.width/k.height*this._scaleX,w=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,u=this._size,y=u*l,D=this.xOffset*this._scaleFactor,
B=this.yOffset*this._scaleFactor,H=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/h.pt2px(this._cimMarkerLayer.frameHeight):1,F=this._outlineWidth*H,E=h.pt2px(this._cimMarkerLayer.referenceSize),X=0,H=0,W=this._cimMarkerLayer.anchorPoint;W&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(X=-W.x/(this._size*l),H=W.y/this._size):(X=W.x,H=W.y));this._sizeOutlineWidth=r.i8888to32(Math.round(Math.sqrt(256*y)),Math.round(Math.sqrt(256*u)),Math.round(Math.sqrt(256*
F)),Math.round(Math.sqrt(256*E)));f.mat2d.identity(A);f.mat2d.translate(A,A,b.vec2f32.fromValues(D,-B));w&&f.mat2d.rotate(A,A,v*w);l=k.rect.x;w=k.rect.y;D=l+k.rect.width;B=w+k.rect.height;X=.5-((.5+X)*k.width+1)/k.rect.width;H=.5-((.5+H)*k.height+1)/k.rect.height;y=y*m*this._scaleFactor;u=u*m*this._scaleFactor;m=Math.round(64*m);y*=k.rect.width/k.width;u*=k.rect.height/k.height;X=(X-.5)*y;H=(H-.5)*u;this._bitestAndDistRatio=r.i8888to32(0,0,this._bitSet,m);p.vec2.set(z,X,H);p.vec2.transformMat2d(z,
z,A);this._offsetUpperLeft=r.i1616to32(16*z[0],16*z[1]);this._texUpperLeft=r.i1616to32(l,w);p.vec2.set(z,X+y,H);p.vec2.transformMat2d(z,z,A);this._offsetUpperRight=r.i1616to32(16*z[0],16*z[1]);this._texUpperRight=r.i1616to32(D,w);p.vec2.set(z,X,H+u);p.vec2.transformMat2d(z,z,A);this._offsetBottomLeft=r.i1616to32(16*z[0],16*z[1]);this._texBottomLeft=r.i1616to32(l,B);p.vec2.set(z,X+y,H+u);p.vec2.transformMat2d(z,z,A);this._offsetBottomRight=r.i1616to32(16*z[0],16*z[1]);this._texBottomRight=r.i1616to32(D,
B);u=n.MarkerMaterialKey.load(this._materialKey);u.sdf=k.sdf;u.pattern=!0;u.textureBinding=k.textureBinding;this._materialKey=u.data}else C.error(new g("mapview-cim","Encountered an error when binding feature"))};return c}(y.default(w.default));a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../util/BidiText".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){Object.defineProperty(a,"__esModule",{value:!0});var r=new Set;c=function(a){function b(b,d,c){var k=a.call(this,d)||this;k._horizontalAlignment="center";k._verticalAlignment="middle";k._glyphs=[];k._cimTextLayer=d;var m=0;p.isFunction(d.color)||(m=h.premultiplyAlphaRGBA(d.color));k._dynamicPropertyMap.set("_color",function(a,b,c){return p.isFunction(d.color)?h.premultiplyAlphaRGBA(d.color(a,b,c)):m});var l=0;p.isFunction(d.color)||(l=h.premultiplyAlphaRGBA(d.outlineColor));
k._dynamicPropertyMap.set("_haloColor",function(a,b,c){return p.isFunction(d.outlineColor)?h.premultiplyAlphaRGBA(d.outlineColor(a,b,c)):l});var n;p.isFunction(d.size)||(n=Math.min(Math.round(g.pt2px(d.size*d.sizeRatio)),127));k._dynamicPropertyMap.set("_size",function(a,b,c){return p.isFunction(d.size)?Math.min(Math.round(g.pt2px(d.size(a,b,c)*d.sizeRatio)),127):n});var t;p.isFunction(d.outlineSize)||(t=Math.min(Math.floor(5*g.pt2px(d.outlineSize*d.sizeRatio)),127));k._dynamicPropertyMap.set("_haloSize",
function(a,b,c){return p.isFunction(d.outlineSize)?Math.min(Math.floor(5*g.pt2px(d.outlineSize(a,b,c)*d.sizeRatio)),127):t});var r;p.isFunction(d.offsetX)||(r=Math.round(g.pt2px(d.offsetX*d.sizeRatio)));k._dynamicPropertyMap.set("_xOffset",function(a,b,c){return p.isFunction(d.offsetX)?Math.round(g.pt2px(d.offsetX(a,b,c)*d.sizeRatio)):r});var w;p.isFunction(d.offsetY)||(w=Math.round(g.pt2px(d.offsetY*d.sizeRatio)));k._dynamicPropertyMap.set("_yOffset",function(a,b,c){return p.isFunction(d.offsetY)?
Math.round(g.pt2px(d.offsetY(a,b,c)*d.sizeRatio)):w});var u;p.isFunction(d.decoration)||(u=f.getFontDecorationTop(d.decoration));k._dynamicPropertyMap.set("_decorationTop",function(a,b,c){return p.isFunction(d.decoration)?f.getFontDecorationTop(d.decoration(a,b,c)):u});var y;p.isFunction(d.angle)||(y=d.angle);k._dynamicPropertyMap.set("_angle",function(a,b,c){return p.isFunction(d.angle)?d.angle(a,b,c):y});var J;p.isFunction(d.horizontalAlignment)||(J=d.horizontalAlignment);k._dynamicPropertyMap.set("_horizontalAlignment",
function(a,b,c){return p.isFunction(d.horizontalAlignment)?d.horizontalAlignment(a,b,c):J});var K;p.isFunction(d.verticalAlignment)||(K=d.verticalAlignment);k._dynamicPropertyMap.set("_verticalAlignment",function(a,b,c){return p.isFunction(d.verticalAlignment)?d.verticalAlignment(a,b,c):K});k._dynamicPropertyMap.set("_scaleFactor",function(a,b,d){return p.isFunction(c)?c(a,b,d):c});var G;p.isFunction(d.text)||(G=d.text);k._dynamicPropertyMap.set("_text",function(a,b,c){return p.isFunction(d.text)?
d.text(a,b,c):G});var I=Math.min(Math.round(g.pt2px(d.referenceSize*d.sizeRatio)),127);k._referenceSize=Math.round(Math.sqrt(256*I));k._materialKey=e.createMaterialKey(k.geometryType,b,!1);b=e.TextMaterialKey.load(k._materialKey);b.sdf=!0;k._bitset=d.colorLocked?1:0;k._materialKey=b.data;return k}l(b,a);b.fromCIMText=function(a,d,c){return new b(a,d,c)};b.prototype.analyze=function(a,b,d,c){var e=this._cimTextLayer;b="string"===typeof e.text?e.text:"function"===typeof e.text?e.text(b,d,c):"";var f=
this._glyphs;r.clear();for(d=0;d<b.length;d++)r.add(b.charCodeAt(d));var h=[];r.forEach(function(a){if(f.length<a||void 0===f[a])h[a]=a});return a.getCIMMosaicItem(e.cim,h).then(function(a){if(a.glyphMosaicItems&&0<a.glyphMosaicItems.length)for(var b=a.glyphMosaicItems,d=0;d<b.length;d++)void 0!==b[d]&&(f[d]=b[d]);return a})};b.prototype.bindFeature=function(a,b,d){var c=this,e=this._dynamicPropertyMap;e&&e.forEach(function(e,f){c[f]=e(a,b,d)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;
this._scale=this._size/24;this._xOffset*=this._scaleFactor;this._yOffset*=this._scaleFactor;this._justify=k.getJustification(this._horizontalAlignment||"center");this._xAlignD=k.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=-k.getYAnchorDirection(this._verticalAlignment||"baseline");this._baseline="baseline"===(this._verticalAlignment||"baseline");for(var e=this._glyphs,f=m.bidiText(this._text),h=f[0],f=f[1],g=[],l=0;l<h.length;l++)g[h.charCodeAt(l)]=e[h.charCodeAt(l)];this.bindTextInfo(g,
h,f);this._computeGlyphs(this._shapedGlyphs,this._shapedBox)}else this._shapedBox=this._shapedGlyphs=this._computedGlyphs=null};return b}(b.default(d.default));a.default=c})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator ./WGLMeshTemplate".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y){Object.defineProperty(a,"__esModule",{value:!0});var w=g.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),t=[],v=[];c=function(a){function c(d,c,e,f,h,g,k,l,t){var r=a.call(this)||this;r.fillColor=e;r.tl=f;r.br=h;r.aux1=g;r.aux2=k;r.aux3=l;r.isBFS=t;r.geometryType=b.WGLGeometryType.FILL;r.forceLibtess=!1;d=n.FillMaterialKey.load(n.createMaterialKey(r.geometryType,d,!1));c&&(d.sdf=c.sdf,d.pattern=!0,d.textureBinding=c.textureBinding);
r._materialKey=d.data;r._tesselator=new u.default;r._tileClipper=new m.TileClipper(0,0,0,1,8);r._tileClipper.setExtent(p.TILE_SIZE);return r}l(c,a);c.fromCIMFill=function(a,b,f,g){void 0===g&&(g=!1);var m=b.color,m=m&&e.premultiplyAlphaRGBA(m)||0,l=d.i8888to32(0,0,0,b.colorLocked?1:0);if(!f)return new c(a,null,m,0,0,0,0,l,g);var l=f.rect,n=f.width,p=f.height,t=l.x+1,r=l.y+1,v=t+n,w=r+p,l=k.nextHighestPowerOfTwo(h.pt2px(b.height||0));255<l?l=255:0>=l&&(l=k.nextHighestPowerOfTwo(w-r));n=k.nextHighestPowerOfTwo(h.pt2px(b.height/
p*n||0));255<n?n=255:0>=n&&(n=k.nextHighestPowerOfTwo(v-t));p=h.pt2px(b.offsetX||0)+128;255<p&&(p=255);var u=h.pt2px(-b.offsetY||0)+128;255<u&&(u=255);b=b.scaleX||1;t=d.i1616to32(t,r);v=d.i1616to32(v,w);l=d.i8888to32(n,l,p,u);b=d.i1616to32(128*b,128);return new c(a,f,m,t,v,l,b,0,g)};c.fromSimpleFill=function(a,b,f,h){void 0===h&&(h=!1);var g=b.color;b=g&&"none"!==b.style&&e.premultiplyAlphaRGBA(g)||0;g=d.i8888to32(0,0,0,h?255:0);if(!f)return new c(a,null,b,0,0,0,0,g,h);var m=f.rect,l=m.x+1,n=m.y+
1,p=m.x+1+f.width,t=m.y+1+f.height,m=d.i1616to32(l,n),r=d.i1616to32(p,t),l=d.i8888to32(k.nextHighestPowerOfTwo(p-l),k.nextHighestPowerOfTwo(t-n),0,0),n=d.i1616to32(128,128);return new c(a,f,b,m,r,l,n,g,h)};c.fromPictureFill=function(a,b,e,f){void 0===f&&(f=!1);var g=p.PICTURE_FILL_COLOR,m=e.rect,l=m.x+1,n=m.y+1,m=l+e.width,t=n+e.height,l=d.i1616to32(l,n),m=d.i1616to32(m,t),t=k.nextHighestPowerOfTwo(h.pt2px(b.width));255<t&&(t=255);n=k.nextHighestPowerOfTwo(h.pt2px(b.height));255<n&&(n=255);var r=
h.pt2px(b.xoffset)+128;255<r&&(r=255);var v=h.pt2px(-b.yoffset)+128;255<v&&(v=255);t=d.i8888to32(t,n,r,v);b=d.i1616to32(128*b.xscale,128*b.yscale);n=d.i8888to32(0,0,0,f?255:0);return new c(a,e,g,l,m,t,b,n,f)};c.prototype.writeMesh=function(a,b,d,c,e){t.length=0;if("esriGeometryPolygon"!==d)"esriGeometryPolyline"!==d&&w.error("Unable to handle geometryType: "+d);else{var f=e.geometry;d=n.FillMaterialKey.load(this._materialKey);var h=(e=this._isClippingRequired(f))?this._clip(f,!1):f.rings;if(d.dotDensity){for(var f=
f.rings,g=0,k=0;k<f.length;k++)for(var m=f[k],l=m[0],p=l[0],l=l[1],r=1;r<m.length;r++)var v=m[r],u=p+v[0],v=l+v[1],g=g-(u-p)*(v+l)/2,p=u,l=v;f=g}else f=0;this.forceLibtess?this._writeMeshLibtess(a,b,c,h,e,d,f):this._writeMeshEarcut(a,b,c,h,e,d,f)||this._writeMeshLibtess(a,b,c,h,e,d,f)}};c.prototype._isClippingRequired=function(a){var b=p.TILE_SIZE+8,d=0;for(a=a.rings;d<a.length;d++){var c=a[d],e=c.length;if(!(3>e)){var f=c[0][0],h=c[0][1];if(-8>f||f>b||-8>h||h>b)return!0;for(var g=1;g<e;++g)if(f+=
c[g][0],h+=c[g][1],-8>f||f>b||-8>h||h>b)return!0}}return!1};c.prototype._clip=function(a,b){var d;this._tileClipper.reset(3);for(var c=0,e=a.rings;c<e.length;c++){var f=e[c],h=f.length;if(!(3>h)){a=f[0][0];d=f[0][1];this._tileClipper.moveTo(a,d);for(var g=1;g<h;++g)a+=f[g][0],d+=f[g][1],this._tileClipper.lineTo(a,d);this._tileClipper.close()}}return this._tileClipper.result(b)};c.prototype._writeMeshLibtess=function(a,b,d,c,e,f,h){if(c&&c.length){var g=[],k=b.indexVector;b=b.getVector("geometry");
var m=new r(d,this.geometryType,this._materialKey),l=b.vertexCount;m.vertexFrom=l;m.indexFrom=k.length;this._tesselator.beginPolygon(t,g);for(var n=0;n<c.length;n++){var p=c[n];if(!(3>p.length)){this._tesselator.beginContour();var v=void 0,w=void 0;e?(v=p[0].x,w=p[0].y):(v=p[0][0],w=p[0][1]);var u=[v,w,0];this._tesselator.addVertex(u,u);for(u=1;u<p.length-1;u++){var y=void 0,z=void 0;e?(v=p[u].x,w=p[u].y):(y=p[u][0],z=p[u][1],v+=y,w+=z);y=[v,w,0];this._tesselator.addVertex(y,y)}this._tesselator.endContour()}}this._tesselator.endPolygon();
this._writeVerticesLibTess(m,b,d,t,f,h);this._writeIndicesLibTess(m,k,l,g);0<m.indexCount&&a.push(m)}};c.prototype._writeMeshEarcut=function(a,b,d,c,e,f,h){if(c&&c.length){var g=b.indexVector;b=b.getVector("geometry");var k=new r(d,this.geometryType,this._materialKey),m=g.length,l=b.data.length;k.vertexFrom=b.vertexCount;k.indexFrom=g.length;for(var n=0,p=0,w=0;w<c.length;w++){var u=c[w],y=p,z=void 0,A=void 0;e?(z=u[0].x,A=u[0].y):(z=u[0][0],A=u[0][1]);t[p++]=z;t[p++]=A;for(var D=0,C=1;C<u.length;++C){var B=
void 0,F=void 0;e?(B=z,F=A,z=u[C].x,A=u[C].y,B=z-B,F=A-F):(B=u[C][0],F=u[C][1],z+=B,A+=F);D-=B*(A+A-F);t[p++]=z;t[p++]=A}if(0<D){if(0<y-n){if(!this._write(k,g,b,d,t,v,n,y,f,h))return g.seek(m),b.data.seek(l),t.length=v.length=0,!1;n=y}v.length=0}else 0>D?0<y-n?v.push(.5*(y-n)):p=y:p=y}if(0<p-n&&!this._write(k,g,b,d,t,v,n,p,f,h))return g.seek(m),b.data.seek(l),t.length=v.length=0,!1;t.length=v.length=0;a.push(k);return!0}};c.prototype._write=function(a,b,d,c,e,h,g,k,m,l){e=e.slice(g,k);g=f(e,h,2);
if(f.deviation(e,h,2,g))return!1;if(g.length)return h=d.vertexCount,this._writeVertices(a,d,c,e,m,l),this._writeIndices(a,b,h,g),!0};c.prototype._writeVertices=function(a,b,c,e,f,h){for(var g=0;g<e.length;g+=2){var k=d.i1616to32(e[g],e[g+1]);b.data.push(k);b.data.push(c);f.dotDensity?b.data.writeF32(1/h):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};c.prototype._writeIndices=function(a,
b,d,c){for(var e=0;e<c.length;e+=3)b.push(d+c[e]),b.push(d+c[e+1]),b.push(d+c[e+2]),a.indexCount+=3};c.prototype._writeVerticesLibTess=function(a,b,c,e,f,h){for(var g=0;g<e.length;g+=2){var k=d.i1616to32(e[g],e[g+1]);b.data.push(k);b.data.push(c);f.dotDensity?b.data.writeF32(1/h):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};c.prototype._writeIndicesLibTess=function(a,b,d,c){for(var e=
0;e<c.length;e++)b.push(d+c[e]),a.indexCount++};return c}(y.default);a.default=c})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});var k=l.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");c=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new g.GluTesselator;
this.glu.gluTessCallback(g.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));
this.glu.gluTessProperty(g.gluEnum.GLU_TESS_WINDING_RULE,g.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,c){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=c};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};
a.prototype.addVertex=function(a,c){this.glu.gluTessVertex(a,c)};a.prototype._vertexCallback=function(a,c){c[c.length]=a[0];c[c.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){k.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();a.default=c})},"esri/core/libs/libtess/libtess":function(){define([],function(){var c={DEBUG:!1,assert:function(a,l){if(c.DEBUG&&!a)throw Error("Assertion failed"+
(l?": "+l:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,
GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,
GLU_INVALID_VALUE:100901},geom:{}};c.geom.vertEq=function(a,c){return a.s===c.s&&a.t===c.t};c.geom.vertLeq=function(a,c){return a.s<c.s||a.s===c.s&&a.t<=c.t};c.geom.edgeEval=function(a,l,g){c.assert(c.geom.vertLeq(a,l)&&c.geom.vertLeq(l,g));var k=l.s-a.s,h=g.s-l.s;return 0<k+h?k<h?l.t-a.t+k/(k+h)*(a.t-g.t):l.t-g.t+h/(k+h)*(g.t-a.t):0};c.geom.edgeSign=function(a,l,g){c.assert(c.geom.vertLeq(a,l)&&c.geom.vertLeq(l,g));var k=l.s-a.s,h=g.s-l.s;return 0<k+h?(l.t-g.t)*k+(l.t-a.t)*h:0};c.geom.transLeq=function(a,
c){return a.t<c.t||a.t===c.t&&a.s<=c.s};c.geom.transEval=function(a,l,g){c.assert(c.geom.transLeq(a,l)&&c.geom.transLeq(l,g));var k=l.t-a.t,h=g.t-l.t;return 0<k+h?k<h?l.s-a.s+k/(k+h)*(a.s-g.s):l.s-g.s+h/(k+h)*(g.s-a.s):0};c.geom.transSign=function(a,l,g){c.assert(c.geom.transLeq(a,l)&&c.geom.transLeq(l,g));var k=l.t-a.t,h=g.t-l.t;return 0<k+h?(l.s-g.s)*k+(l.s-a.s)*h:0};c.geom.edgeGoesLeft=function(a){return c.geom.vertLeq(a.dst(),a.org)};c.geom.edgeGoesRight=function(a){return c.geom.vertLeq(a.org,
a.dst())};c.geom.vertL1dist=function(a,c){return Math.abs(a.s-c.s)+Math.abs(a.t-c.t)};c.geom.vertCCW=function(a,c,g){return 0<=a.s*(c.t-g.t)+c.s*(g.t-a.t)+g.s*(a.t-c.t)};c.geom.interpolate_=function(a,c,g,k){a=0>a?0:a;g=0>g?0:g;return a<=g?0===g?(c+k)/2:c+a/(a+g)*(k-c):k+g/(a+g)*(c-k)};c.geom.edgeIntersect=function(a,l,g,k,h){var f,e;c.geom.vertLeq(a,l)||(f=a,a=l,l=f);c.geom.vertLeq(g,k)||(f=g,g=k,k=f);c.geom.vertLeq(a,g)||(f=a,a=g,g=f,f=l,l=k,k=f);c.geom.vertLeq(g,l)?c.geom.vertLeq(l,k)?(f=c.geom.edgeEval(a,
g,l),e=c.geom.edgeEval(g,l,k),0>f+e&&(f=-f,e=-e),h.s=c.geom.interpolate_(f,g.s,e,l.s)):(f=c.geom.edgeSign(a,g,l),e=-c.geom.edgeSign(a,k,l),0>f+e&&(f=-f,e=-e),h.s=c.geom.interpolate_(f,g.s,e,k.s)):h.s=(g.s+l.s)/2;c.geom.transLeq(a,l)||(f=a,a=l,l=f);c.geom.transLeq(g,k)||(f=g,g=k,k=f);c.geom.transLeq(a,g)||(f=a,a=g,g=f,f=l,l=k,k=f);c.geom.transLeq(g,l)?c.geom.transLeq(l,k)?(f=c.geom.transEval(a,g,l),e=c.geom.transEval(g,l,k),0>f+e&&(f=-f,e=-e),h.t=c.geom.interpolate_(f,g.t,e,l.t)):(f=c.geom.transSign(a,
g,l),e=-c.geom.transSign(a,k,l),0>f+e&&(f=-f,e=-e),h.t=c.geom.interpolate_(f,g.t,e,k.t)):h.t=(g.t+l.t)/2};c.mesh={};c.mesh.makeEdge=function(a){var l=c.mesh.makeEdgePair_(a.eHead);c.mesh.makeVertex_(l,a.vHead);c.mesh.makeVertex_(l.sym,a.vHead);c.mesh.makeFace_(l,a.fHead);return l};c.mesh.meshSplice=function(a,l){var g=!1,k=!1;a!==l&&(l.org!==a.org&&(k=!0,c.mesh.killVertex_(l.org,a.org)),l.lFace!==a.lFace&&(g=!0,c.mesh.killFace_(l.lFace,a.lFace)),c.mesh.splice_(l,a),k||(c.mesh.makeVertex_(l,a.org),
a.org.anEdge=a),g||(c.mesh.makeFace_(l,a.lFace),a.lFace.anEdge=a))};c.mesh.deleteEdge=function(a){var l=a.sym,g=!1;a.lFace!==a.rFace()&&(g=!0,c.mesh.killFace_(a.lFace,a.rFace()));a.oNext===a?c.mesh.killVertex_(a.org,null):(a.rFace().anEdge=a.oPrev(),a.org.anEdge=a.oNext,c.mesh.splice_(a,a.oPrev()),g||c.mesh.makeFace_(a,a.lFace));l.oNext===l?(c.mesh.killVertex_(l.org,null),c.mesh.killFace_(l.lFace,null)):(a.lFace.anEdge=l.oPrev(),l.org.anEdge=l.oNext,c.mesh.splice_(l,l.oPrev()));c.mesh.killEdge_(a)};
c.mesh.addEdgeVertex=function(a){var l=c.mesh.makeEdgePair_(a),g=l.sym;c.mesh.splice_(l,a.lNext);l.org=a.dst();c.mesh.makeVertex_(g,l.org);l.lFace=g.lFace=a.lFace;return l};c.mesh.splitEdge=function(a){var l=c.mesh.addEdgeVertex(a).sym;c.mesh.splice_(a.sym,a.sym.oPrev());c.mesh.splice_(a.sym,l);a.sym.org=l.org;l.dst().anEdge=l.sym;l.sym.lFace=a.rFace();l.winding=a.winding;l.sym.winding=a.sym.winding;return l};c.mesh.connect=function(a,l){var g=!1,k=c.mesh.makeEdgePair_(a),h=k.sym;l.lFace!==a.lFace&&
(g=!0,c.mesh.killFace_(l.lFace,a.lFace));c.mesh.splice_(k,a.lNext);c.mesh.splice_(h,l);k.org=a.dst();h.org=l.org;k.lFace=h.lFace=a.lFace;a.lFace.anEdge=h;g||c.mesh.makeFace_(k,a.lFace);return k};c.mesh.zapFace=function(a){var l=a.anEdge,g=l.lNext,k;do if(k=g,g=k.lNext,k.lFace=null,null===k.rFace()){k.oNext===k?c.mesh.killVertex_(k.org,null):(k.org.anEdge=k.oNext,c.mesh.splice_(k,k.oPrev()));var h=k.sym;h.oNext===h?c.mesh.killVertex_(h.org,null):(h.org.anEdge=h.oNext,c.mesh.splice_(h,h.oPrev()));c.mesh.killEdge_(k)}while(k!==
l);l=a.prev;a=a.next;a.prev=l;l.next=a};c.mesh.meshUnion=function(a,c){var g=a.fHead,k=a.vHead,h=a.eHead,f=c.fHead,e=c.vHead;c=c.eHead;f.next!==f&&(g.prev.next=f.next,f.next.prev=g.prev,f.prev.next=g,g.prev=f.prev);e.next!==e&&(k.prev.next=e.next,e.next.prev=k.prev,e.prev.next=k,k.prev=e.prev);c.next!==c&&(h.sym.next.sym.next=c.next,c.next.sym.next=h.sym.next,c.sym.next.sym.next=h,h.sym.next=c.sym.next);return a};c.mesh.deleteMesh=function(a){};c.mesh.makeEdgePair_=function(a){var l=new c.GluHalfEdge,
g=new c.GluHalfEdge,k=a.sym.next;g.next=k;k.sym.next=l;l.next=a;a.sym.next=g;l.sym=g;l.oNext=l;l.lNext=g;g.sym=l;g.oNext=g;return g.lNext=l};c.mesh.splice_=function(a,c){var g=a.oNext,k=c.oNext;g.sym.lNext=c;k.sym.lNext=a;a.oNext=k;c.oNext=g};c.mesh.makeVertex_=function(a,l){var g=l.prev,k=new c.GluVertex(l,g);g.next=k;l.prev=k;l=k.anEdge=a;do l.org=k,l=l.oNext;while(l!==a)};c.mesh.makeFace_=function(a,l){var g=l.prev,k=new c.GluFace(l,g);g.next=k;l.prev=k;k.anEdge=a;k.inside=l.inside;l=a;do l.lFace=
k,l=l.lNext;while(l!==a)};c.mesh.killEdge_=function(a){var c=a.next;a=a.sym.next;c.sym.next=a;a.sym.next=c};c.mesh.killVertex_=function(a,c){var g=a.anEdge,k=g;do k.org=c,k=k.oNext;while(k!==g);c=a.prev;a=a.next;a.prev=c;c.next=a};c.mesh.killFace_=function(a,c){var g=a.anEdge,k=g;do k.lFace=c,k=k.lNext;while(k!==g);c=a.prev;a=a.next;a.prev=c;c.next=a};c.normal={};c.normal.S_UNIT_X_=1;c.normal.S_UNIT_Y_=0;c.normal.projectPolygon=function(a,l,g,k){var h=!1,f=[l,g,k];0===l&&0===g&&0===k&&(c.normal.computeNormal_(a,
f),h=!0);g=c.normal.longAxis_(f);l=a.mesh.vHead;if(c.TRUE_PROJECT){c.normal.normalize_(f);k=[0,0,0];var e=[0,0,0];k[g]=0;k[(g+1)%3]=c.normal.S_UNIT_X_;k[(g+2)%3]=c.normal.S_UNIT_Y_;g=c.normal.dot_(k,f);k[0]-=g*f[0];k[1]-=g*f[1];k[2]-=g*f[2];c.normal.normalize_(k);e[0]=f[1]*k[2]-f[2]*k[1];e[1]=f[2]*k[0]-f[0]*k[2];e[2]=f[0]*k[1]-f[1]*k[0];c.normal.normalize_(e);for(f=l.next;f!==l;f=f.next)f.s=c.normal.dot_(f.coords,k),f.t=c.normal.dot_(f.coords,e)}else for(k=(g+1)%3,e=(g+2)%3,g=0<f[g]?1:-1,f=l.next;f!==
l;f=f.next)f.s=f.coords[k],f.t=g*f.coords[e];h&&c.normal.checkOrientation_(a)};c.normal.dot_=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]};c.normal.normalize_=function(a){var l=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];c.assert(0<l);l=Math.sqrt(l);a[0]/=l;a[1]/=l;a[2]/=l};c.normal.longAxis_=function(a){var c=0;Math.abs(a[1])>Math.abs(a[0])&&(c=1);Math.abs(a[2])>Math.abs(a[c])&&(c=2);return c};c.normal.computeNormal_=function(a,l){var g=[-2*c.GLU_TESS_MAX_COORD,-2*c.GLU_TESS_MAX_COORD,-2*c.GLU_TESS_MAX_COORD],
k=[2*c.GLU_TESS_MAX_COORD,2*c.GLU_TESS_MAX_COORD,2*c.GLU_TESS_MAX_COORD],h=[],f=[],e;a=a.mesh.vHead;for(e=a.next;e!==a;e=e.next)for(var p=0;3>p;++p){var b=e.coords[p];b<k[p]&&(k[p]=b,f[p]=e);b>g[p]&&(g[p]=b,h[p]=e)}e=0;g[1]-k[1]>g[0]-k[0]&&(e=1);g[2]-k[2]>g[e]-k[e]&&(e=2);if(k[e]>=g[e])l[0]=0,l[1]=0,l[2]=1;else{g=0;k=f[e];h=h[e];f=[0,0,0];k=[k.coords[0]-h.coords[0],k.coords[1]-h.coords[1],k.coords[2]-h.coords[2]];p=[0,0,0];for(e=a.next;e!==a;e=e.next)p[0]=e.coords[0]-h.coords[0],p[1]=e.coords[1]-
h.coords[1],p[2]=e.coords[2]-h.coords[2],f[0]=k[1]*p[2]-k[2]*p[1],f[1]=k[2]*p[0]-k[0]*p[2],f[2]=k[0]*p[1]-k[1]*p[0],b=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],b>g&&(g=b,l[0]=f[0],l[1]=f[1],l[2]=f[2]);0>=g&&(l[0]=l[1]=l[2]=0,l[c.normal.longAxis_(k)]=1)}};c.normal.checkOrientation_=function(a){for(var c=0,g=a.mesh.fHead,k=g.next;k!==g;k=k.next){var h=k.anEdge;if(!(0>=h.winding)){do c+=(h.org.s-h.dst().s)*(h.org.t+h.dst().t),h=h.lNext;while(h!==k.anEdge)}}if(0>c)for(a=a.mesh.vHead,c=a.next;c!==a;c=c.next)c.t=-c.t};
c.render={};c.render.renderMesh=function(a,l,g){for(var k=!1,h=-1,f=l.fHead.prev;f!==l.fHead;f=f.prev)if(f.inside){k||(a.callBeginCallback(c.primitiveType.GL_TRIANGLES),k=!0);var e=f.anEdge;c.assert(e.lNext.lNext.lNext===e,"renderMesh called with non-triangulated mesh");do{if(g){var p=e.rFace().inside?0:1;h!==p&&(h=p,a.callEdgeFlagCallback(!!h))}a.callVertexCallback(e.org.data);e=e.lNext}while(e!==f.anEdge)}k&&a.callEndCallback()};c.render.renderBoundary=function(a,l){for(var g=l.fHead.next;g!==l.fHead;g=
g.next)if(g.inside){a.callBeginCallback(c.primitiveType.GL_LINE_LOOP);var k=g.anEdge;do a.callVertexCallback(k.org.data),k=k.lNext;while(k!==g.anEdge);a.callEndCallback()}};c.sweep={};c.sweep.SENTINEL_COORD_=4*c.GLU_TESS_MAX_COORD;c.sweep.TOLERANCE_NONZERO_=!1;c.sweep.computeInterior=function(a){a.fatalError=!1;c.sweep.removeDegenerateEdges_(a);c.sweep.initPriorityQ_(a);c.sweep.initEdgeDict_(a);for(var l;null!==(l=a.pq.extractMin());){for(;;){var g=a.pq.minimum();if(null===g||!c.geom.vertEq(g,l))break;
g=a.pq.extractMin();c.sweep.spliceMergeVertices_(a,l.anEdge,g.anEdge)}c.sweep.sweepEvent_(a,l)}l=a.dict.getMin().getKey();a.event=l.eUp.org;c.sweep.doneEdgeDict_(a);c.sweep.donePriorityQ_(a);c.sweep.removeDegenerateFaces_(a.mesh);a.mesh.checkMesh()};c.sweep.addWinding_=function(a,c){a.winding+=c.winding;a.sym.winding+=c.sym.winding};c.sweep.edgeLeq_=function(a,l,g){a=a.event;l=l.eUp;g=g.eUp;if(l.dst()===a)return g.dst()===a?c.geom.vertLeq(l.org,g.org)?0>=c.geom.edgeSign(g.dst(),l.org,g.org):0<=c.geom.edgeSign(l.dst(),
g.org,l.org):0>=c.geom.edgeSign(g.dst(),a,g.org);if(g.dst()===a)return 0<=c.geom.edgeSign(l.dst(),a,l.org);l=c.geom.edgeEval(l.dst(),a,l.org);a=c.geom.edgeEval(g.dst(),a,g.org);return l>=a};c.sweep.deleteRegion_=function(a,l){l.fixUpperEdge&&c.assert(0===l.eUp.winding);l.eUp.activeRegion=null;a.dict.deleteNode(l.nodeUp);l.nodeUp=null};c.sweep.fixUpperEdge_=function(a,l){c.assert(a.fixUpperEdge);c.mesh.deleteEdge(a.eUp);a.fixUpperEdge=!1;a.eUp=l;l.activeRegion=a};c.sweep.topLeftRegion_=function(a){var l=
a.eUp.org;do a=a.regionAbove();while(a.eUp.org===l);a.fixUpperEdge&&(l=c.mesh.connect(a.regionBelow().eUp.sym,a.eUp.lNext),c.sweep.fixUpperEdge_(a,l),a=a.regionAbove());return a};c.sweep.topRightRegion_=function(a){var c=a.eUp.dst();do a=a.regionAbove();while(a.eUp.dst()===c);return a};c.sweep.addRegionBelow_=function(a,l,g){var k=new c.ActiveRegion;k.eUp=g;k.nodeUp=a.dict.insertBefore(l.nodeUp,k);return g.activeRegion=k};c.sweep.isWindingInside_=function(a,l){switch(a.windingRule){case c.windingRule.GLU_TESS_WINDING_ODD:return 0!==
(l&1);case c.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==l;case c.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<l;case c.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>l;case c.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=l||-2>=l}c.assert(!1);return!1};c.sweep.computeWinding_=function(a,l){l.windingNumber=l.regionAbove().windingNumber+l.eUp.winding;l.inside=c.sweep.isWindingInside_(a,l.windingNumber)};c.sweep.finishRegion_=function(a,l){var g=l.eUp,k=g.lFace;k.inside=l.inside;k.anEdge=
g;c.sweep.deleteRegion_(a,l)};c.sweep.finishLeftRegions_=function(a,l,g){var k=l;for(l=l.eUp;k!==g;){k.fixUpperEdge=!1;var h=k.regionBelow(),f=h.eUp;if(f.org!==l.org){if(!h.fixUpperEdge){c.sweep.finishRegion_(a,k);break}f=c.mesh.connect(l.lPrev(),f.sym);c.sweep.fixUpperEdge_(h,f)}l.oNext!==f&&(c.mesh.meshSplice(f.oPrev(),f),c.mesh.meshSplice(l,f));c.sweep.finishRegion_(a,k);l=h.eUp;k=h}return l};c.sweep.addRightEdges_=function(a,l,g,k,h,f){var e=!0;do c.assert(c.geom.vertLeq(g.org,g.dst())),c.sweep.addRegionBelow_(a,
l,g.sym),g=g.oNext;while(g!==k);for(null===h&&(h=l.regionBelow().eUp.rPrev());;){k=l.regionBelow();g=k.eUp.sym;if(g.org!==h.org)break;g.oNext!==h&&(c.mesh.meshSplice(g.oPrev(),g),c.mesh.meshSplice(h.oPrev(),g));k.windingNumber=l.windingNumber-g.winding;k.inside=c.sweep.isWindingInside_(a,k.windingNumber);l.dirty=!0;!e&&c.sweep.checkForRightSplice_(a,l)&&(c.sweep.addWinding_(g,h),c.sweep.deleteRegion_(a,l),c.mesh.deleteEdge(h));e=!1;l=k;h=g}l.dirty=!0;c.assert(l.windingNumber-g.winding===k.windingNumber);
f&&c.sweep.walkDirtyRegions_(a,l)};c.sweep.callCombine_=function(a,l,g,k,h){var f=[l.coords[0],l.coords[1],l.coords[2]];l.data=null;l.data=a.callCombineCallback(f,g,k);null===l.data&&(h?a.fatalError||(a.callErrorCallback(c.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),a.fatalError=!0):l.data=g[0])};c.sweep.spliceMergeVertices_=function(a,l,g){var k=[null,null,null,null];k[0]=l.org.data;k[1]=g.org.data;c.sweep.callCombine_(a,l.org,k,[.5,.5,0,0],!1);c.mesh.meshSplice(l,g)};c.sweep.vertexWeights_=function(a,
l,g,k,h){var f=c.geom.vertL1dist(l,a),e=c.geom.vertL1dist(g,a),p=h+1;k[h]=.5*e/(f+e);k[p]=.5*f/(f+e);a.coords[0]+=k[h]*l.coords[0]+k[p]*g.coords[0];a.coords[1]+=k[h]*l.coords[1]+k[p]*g.coords[1];a.coords[2]+=k[h]*l.coords[2]+k[p]*g.coords[2]};c.sweep.getIntersectData_=function(a,l,g,k,h,f){var e=[0,0,0,0],p=[g.data,k.data,h.data,f.data];l.coords[0]=l.coords[1]=l.coords[2]=0;c.sweep.vertexWeights_(l,g,k,e,0);c.sweep.vertexWeights_(l,h,f,e,2);c.sweep.callCombine_(a,l,p,e,!0)};c.sweep.checkForRightSplice_=
function(a,l){var g=l.regionBelow(),k=l.eUp,h=g.eUp;if(c.geom.vertLeq(k.org,h.org)){if(0<c.geom.edgeSign(h.dst(),k.org,h.org))return!1;c.geom.vertEq(k.org,h.org)?k.org!==h.org&&(a.pq.remove(k.org.pqHandle),c.sweep.spliceMergeVertices_(a,h.oPrev(),k)):(c.mesh.splitEdge(h.sym),c.mesh.meshSplice(k,h.oPrev()),l.dirty=g.dirty=!0)}else{if(0>c.geom.edgeSign(k.dst(),h.org,k.org))return!1;l.regionAbove().dirty=l.dirty=!0;c.mesh.splitEdge(k.sym);c.mesh.meshSplice(h.oPrev(),k)}return!0};c.sweep.checkForLeftSplice_=
function(a,l){var g=l.regionBelow();a=l.eUp;var k=g.eUp;c.assert(!c.geom.vertEq(a.dst(),k.dst()));if(c.geom.vertLeq(a.dst(),k.dst())){if(0>c.geom.edgeSign(a.dst(),k.dst(),a.org))return!1;l.regionAbove().dirty=l.dirty=!0;g=c.mesh.splitEdge(a);c.mesh.meshSplice(k.sym,g);g.lFace.inside=l.inside}else{if(0<c.geom.edgeSign(k.dst(),a.dst(),k.org))return!1;l.dirty=g.dirty=!0;g=c.mesh.splitEdge(k);c.mesh.meshSplice(a.lNext,k.sym);g.rFace().inside=l.inside}return!0};c.sweep.checkForIntersect_=function(a,l){var g=
l.regionBelow(),k=l.eUp,h=g.eUp,f=k.org,e=h.org,p=k.dst(),b=h.dst(),d=new c.GluVertex;c.assert(!c.geom.vertEq(b,p));c.assert(0>=c.geom.edgeSign(p,a.event,f));c.assert(0<=c.geom.edgeSign(b,a.event,e));c.assert(f!==a.event&&e!==a.event);c.assert(!l.fixUpperEdge&&!g.fixUpperEdge);if(f===e||Math.min(f.t,p.t)>Math.max(e.t,b.t))return!1;if(c.geom.vertLeq(f,e)){if(0<c.geom.edgeSign(b,f,e))return!1}else if(0>c.geom.edgeSign(p,e,f))return!1;c.geom.edgeIntersect(p,f,b,e,d);c.assert(Math.min(f.t,p.t)<=d.t);
c.assert(d.t<=Math.max(e.t,b.t));c.assert(Math.min(b.s,p.s)<=d.s);c.assert(d.s<=Math.max(e.s,f.s));c.geom.vertLeq(d,a.event)&&(d.s=a.event.s,d.t=a.event.t);var m=c.geom.vertLeq(f,e)?f:e;c.geom.vertLeq(m,d)&&(d.s=m.s,d.t=m.t);if(c.geom.vertEq(d,f)||c.geom.vertEq(d,e))return c.sweep.checkForRightSplice_(a,l),!1;if(!c.geom.vertEq(p,a.event)&&0<=c.geom.edgeSign(p,a.event,d)||!c.geom.vertEq(b,a.event)&&0>=c.geom.edgeSign(b,a.event,d)){if(b===a.event)return c.mesh.splitEdge(k.sym),c.mesh.meshSplice(h.sym,
k),l=c.sweep.topLeftRegion_(l),k=l.regionBelow().eUp,c.sweep.finishLeftRegions_(a,l.regionBelow(),g),c.sweep.addRightEdges_(a,l,k.oPrev(),k,k,!0),!0;if(p===a.event)return c.mesh.splitEdge(h.sym),c.mesh.meshSplice(k.lNext,h.oPrev()),g=l,l=c.sweep.topRightRegion_(l),f=l.regionBelow().eUp.rPrev(),g.eUp=h.oPrev(),h=c.sweep.finishLeftRegions_(a,g,null),c.sweep.addRightEdges_(a,l,h.oNext,k.rPrev(),f,!0),!0;0<=c.geom.edgeSign(p,a.event,d)&&(l.regionAbove().dirty=l.dirty=!0,c.mesh.splitEdge(k.sym),k.org.s=
a.event.s,k.org.t=a.event.t);0>=c.geom.edgeSign(b,a.event,d)&&(l.dirty=g.dirty=!0,c.mesh.splitEdge(h.sym),h.org.s=a.event.s,h.org.t=a.event.t);return!1}c.mesh.splitEdge(k.sym);c.mesh.splitEdge(h.sym);c.mesh.meshSplice(h.oPrev(),k);k.org.s=d.s;k.org.t=d.t;k.org.pqHandle=a.pq.insert(k.org);c.sweep.getIntersectData_(a,k.org,f,p,e,b);l.regionAbove().dirty=l.dirty=g.dirty=!0;return!1};c.sweep.walkDirtyRegions_=function(a,l){for(var g=l.regionBelow();;){for(;g.dirty;)l=g,g=g.regionBelow();if(!l.dirty&&
(g=l,l=l.regionAbove(),null===l||!l.dirty))break;l.dirty=!1;var k=l.eUp,h=g.eUp;k.dst()!==h.dst()&&c.sweep.checkForLeftSplice_(a,l)&&(g.fixUpperEdge?(c.sweep.deleteRegion_(a,g),c.mesh.deleteEdge(h),g=l.regionBelow(),h=g.eUp):l.fixUpperEdge&&(c.sweep.deleteRegion_(a,l),c.mesh.deleteEdge(k),l=g.regionAbove(),k=l.eUp));if(k.org!==h.org)if(k.dst()===h.dst()||l.fixUpperEdge||g.fixUpperEdge||k.dst()!==a.event&&h.dst()!==a.event)c.sweep.checkForRightSplice_(a,l);else if(c.sweep.checkForIntersect_(a,l))break;
k.org===h.org&&k.dst()===h.dst()&&(c.sweep.addWinding_(h,k),c.sweep.deleteRegion_(a,l),c.mesh.deleteEdge(k),l=g.regionAbove())}};c.sweep.connectRightVertex_=function(a,l,g){var k=g.oNext,h=l.regionBelow(),f=l.eUp,e=h.eUp,p=!1;f.dst()!==e.dst()&&c.sweep.checkForIntersect_(a,l);c.geom.vertEq(f.org,a.event)&&(c.mesh.meshSplice(k.oPrev(),f),l=c.sweep.topLeftRegion_(l),k=l.regionBelow().eUp,c.sweep.finishLeftRegions_(a,l.regionBelow(),h),p=!0);c.geom.vertEq(e.org,a.event)&&(c.mesh.meshSplice(g,e.oPrev()),
g=c.sweep.finishLeftRegions_(a,h,null),p=!0);p?c.sweep.addRightEdges_(a,l,g.oNext,k,k,!0):(k=c.geom.vertLeq(e.org,f.org)?e.oPrev():f,k=c.mesh.connect(g.lPrev(),k),c.sweep.addRightEdges_(a,l,k,k.oNext,k.oNext,!1),k.sym.activeRegion.fixUpperEdge=!0,c.sweep.walkDirtyRegions_(a,l))};c.sweep.connectLeftDegenerate_=function(a,l,g){var k=l.eUp;if(c.geom.vertEq(k.org,g))c.assert(c.sweep.TOLERANCE_NONZERO_),c.sweep.TOLERANCE_NONZERO_&&c.sweep.spliceMergeVertices_(a,k,g.anEdge);else if(c.geom.vertEq(k.dst(),
g)){if(c.assert(c.sweep.TOLERANCE_NONZERO_),c.sweep.TOLERANCE_NONZERO_){l=c.sweep.topRightRegion_(l);var k=l.regionBelow(),h=k.eUp.sym,f=h.oNext,e=f;k.fixUpperEdge&&(c.assert(f!==h),c.sweep.deleteRegion_(a,k),c.mesh.deleteEdge(h),h=f.oPrev());c.mesh.meshSplice(g.anEdge,h);c.geom.edgeGoesLeft(f)||(f=null);c.sweep.addRightEdges_(a,l,h.oNext,e,f,!0)}}else c.mesh.splitEdge(k.sym),l.fixUpperEdge&&(c.mesh.deleteEdge(k.oNext),l.fixUpperEdge=!1),c.mesh.meshSplice(g.anEdge,k),c.sweep.sweepEvent_(a,g)};c.sweep.connectLeftVertex_=
function(a,l){var g=new c.ActiveRegion;g.eUp=l.anEdge.sym;var g=a.dict.search(g).getKey(),k=g.regionBelow(),h=g.eUp,f=k.eUp;0===c.geom.edgeSign(h.dst(),l,h.org)?c.sweep.connectLeftDegenerate_(a,g,l):(k=c.geom.vertLeq(f.dst(),h.dst())?g:k,g.inside||k.fixUpperEdge?(h=k===g?c.mesh.connect(l.anEdge.sym,h.lNext):c.mesh.connect(f.dNext(),l.anEdge).sym,k.fixUpperEdge?c.sweep.fixUpperEdge_(k,h):c.sweep.computeWinding_(a,c.sweep.addRegionBelow_(a,g,h)),c.sweep.sweepEvent_(a,l)):c.sweep.addRightEdges_(a,g,
l.anEdge,l.anEdge,null,!0))};c.sweep.sweepEvent_=function(a,l){a.event=l;for(var g=l.anEdge;null===g.activeRegion;)if(g=g.oNext,g===l.anEdge){c.sweep.connectLeftVertex_(a,l);return}l=c.sweep.topLeftRegion_(g.activeRegion);var k=l.regionBelow(),g=k.eUp,k=c.sweep.finishLeftRegions_(a,k,null);k.oNext===g?c.sweep.connectRightVertex_(a,l,k):c.sweep.addRightEdges_(a,l,k.oNext,g,g,!0)};c.sweep.addSentinel_=function(a,l){var g=new c.ActiveRegion,k=c.mesh.makeEdge(a.mesh);k.org.s=c.sweep.SENTINEL_COORD_;k.org.t=
l;k.dst().s=-c.sweep.SENTINEL_COORD_;k.dst().t=l;a.event=k.dst();g.eUp=k;g.windingNumber=0;g.inside=!1;g.fixUpperEdge=!1;g.sentinel=!0;g.dirty=!1;g.nodeUp=a.dict.insert(g)};c.sweep.initEdgeDict_=function(a){a.dict=new c.Dict(a,c.sweep.edgeLeq_);c.sweep.addSentinel_(a,-c.sweep.SENTINEL_COORD_);c.sweep.addSentinel_(a,c.sweep.SENTINEL_COORD_)};c.sweep.doneEdgeDict_=function(a){for(var l=0,g;null!==(g=a.dict.getMin().getKey());)g.sentinel||(c.assert(g.fixUpperEdge),c.assert(1===++l)),c.assert(0===g.windingNumber),
c.sweep.deleteRegion_(a,g);a.dict=null};c.sweep.removeDegenerateEdges_=function(a){for(var l=a.mesh.eHead,g,k=l.next;k!==l;k=g){g=k.next;var h=k.lNext;c.geom.vertEq(k.org,k.dst())&&k.lNext.lNext!==k&&(c.sweep.spliceMergeVertices_(a,h,k),c.mesh.deleteEdge(k),k=h,h=k.lNext);if(h.lNext===k){if(h!==k){if(h===g||h===g.sym)g=g.next;c.mesh.deleteEdge(h)}if(k===g||k===g.sym)g=g.next;c.mesh.deleteEdge(k)}}};c.sweep.initPriorityQ_=function(a){var l=new c.PriorityQ;a.pq=l;a=a.mesh.vHead;var g;for(g=a.next;g!==
a;g=g.next)g.pqHandle=l.insert(g);l.init()};c.sweep.donePriorityQ_=function(a){a.pq.deleteQ();a.pq=null};c.sweep.removeDegenerateFaces_=function(a){for(var l,g=a.fHead.next;g!==a.fHead;g=l)l=g.next,g=g.anEdge,c.assert(g.lNext!==g),g.lNext.lNext===g&&(c.sweep.addWinding_(g.oNext,g),c.mesh.deleteEdge(g))};c.tessmono={};c.tessmono.tessellateMonoRegion_=function(a){a=a.anEdge;for(c.assert(a.lNext!==a&&a.lNext.lNext!==a);c.geom.vertLeq(a.dst(),a.org);a=a.lPrev());for(;c.geom.vertLeq(a.org,a.dst());a=a.lNext);
for(var l=a.lPrev(),g;a.lNext!==l;)if(c.geom.vertLeq(a.dst(),l.org)){for(;l.lNext!==a&&(c.geom.edgeGoesLeft(l.lNext)||0>=c.geom.edgeSign(l.org,l.dst(),l.lNext.dst()));)g=c.mesh.connect(l.lNext,l),l=g.sym;l=l.lPrev()}else{for(;l.lNext!==a&&(c.geom.edgeGoesRight(a.lPrev())||0<=c.geom.edgeSign(a.dst(),a.org,a.lPrev().org));)g=c.mesh.connect(a,a.lPrev()),a=g.sym;a=a.lNext}for(c.assert(l.lNext!==a);l.lNext.lNext!==a;)g=c.mesh.connect(l.lNext,l),l=g.sym};c.tessmono.tessellateInterior=function(a){for(var l,
g=a.fHead.next;g!==a.fHead;g=l)l=g.next,g.inside&&c.tessmono.tessellateMonoRegion_(g)};c.tessmono.discardExterior=function(a){for(var l,g=a.fHead.next;g!==a.fHead;g=l)l=g.next,g.inside||c.mesh.zapFace(g)};c.tessmono.setWindingNumber=function(a,l,g){for(var k,h=a.eHead.next;h!==a.eHead;h=k)k=h.next,h.rFace().inside!==h.lFace.inside?h.winding=h.lFace.inside?l:-l:g?c.mesh.deleteEdge(h):h.winding=0};c.Dict=function(a,l){this.head_=new c.DictNode;this.frame_=a;this.leq_=l};c.Dict.prototype.deleteDict_=
function(){};c.Dict.prototype.insertBefore=function(a,l){do a=a.prev;while(null!==a.key&&!this.leq_(this.frame_,a.key,l));l=new c.DictNode(l,a.next,a);a.next.prev=l;return a.next=l};c.Dict.prototype.insert=function(a){return this.insertBefore(this.head_,a)};c.Dict.prototype.deleteNode=function(a){a.next.prev=a.prev;a.prev.next=a.next};c.Dict.prototype.search=function(a){var c=this.head_;do c=c.next;while(null!==c.key&&!this.leq_(this.frame_,a,c.key));return c};c.Dict.prototype.getMin=function(){return this.head_.next};
c.Dict.prototype.getMax=function(){return this.head_.prev};c.DictNode=function(a,c,g){this.key=a||null;this.next=c||this;this.prev=g||this};c.DictNode.prototype.getKey=function(){return this.key};c.DictNode.prototype.getSuccessor=function(){return this.next};c.DictNode.prototype.getPredecessor=function(){return this.prev};c.GluTesselator=function(){this.state_=c.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=c.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};c.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};c.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(c.GluTesselator.tessState_.T_DORMANT)};c.GluTesselator.prototype.gluTessProperty=function(a,l){switch(a){case c.gluEnum.GLU_TESS_TOLERANCE:return;
case c.gluEnum.GLU_TESS_WINDING_RULE:switch(l){case c.windingRule.GLU_TESS_WINDING_ODD:case c.windingRule.GLU_TESS_WINDING_NONZERO:case c.windingRule.GLU_TESS_WINDING_POSITIVE:case c.windingRule.GLU_TESS_WINDING_NEGATIVE:case c.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=l;return}break;case c.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!l;return;default:this.callErrorCallback(c.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(c.gluEnum.GLU_INVALID_VALUE)};c.GluTesselator.prototype.gluGetTessProperty=
function(a){switch(a){case c.gluEnum.GLU_TESS_TOLERANCE:return 0;case c.gluEnum.GLU_TESS_WINDING_RULE:return a=this.windingRule,c.assert(a===c.windingRule.GLU_TESS_WINDING_ODD||a===c.windingRule.GLU_TESS_WINDING_NONZERO||a===c.windingRule.GLU_TESS_WINDING_POSITIVE||a===c.windingRule.GLU_TESS_WINDING_NEGATIVE||a===c.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),a;case c.gluEnum.GLU_TESS_BOUNDARY_ONLY:return c.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(c.gluEnum.GLU_INVALID_ENUM)}return!1};
c.GluTesselator.prototype.gluTessNormal=function(a,c,g){this.normal_[0]=a;this.normal_[1]=c;this.normal_[2]=g};c.GluTesselator.prototype.gluTessCallback=function(a,l){l=l?l:null;switch(a){case c.gluEnum.GLU_TESS_BEGIN:case c.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=l;break;case c.gluEnum.GLU_TESS_EDGE_FLAG:case c.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=l;break;case c.gluEnum.GLU_TESS_VERTEX:case c.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=l;break;case c.gluEnum.GLU_TESS_END:case c.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
l;break;case c.gluEnum.GLU_TESS_ERROR:case c.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=l;break;case c.gluEnum.GLU_TESS_COMBINE:case c.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=l;break;case c.gluEnum.GLU_TESS_MESH:this.meshCallback_=l;break;default:this.callErrorCallback(c.gluEnum.GLU_INVALID_ENUM)}};c.GluTesselator.prototype.gluTessVertex=function(a,l){var g=!1,k=[0,0,0];this.requireState_(c.GluTesselator.tessState_.T_IN_CONTOUR);for(var h=0;3>h;++h){var f=a[h];f<-c.GLU_TESS_MAX_COORD&&
(f=-c.GLU_TESS_MAX_COORD,g=!0);f>c.GLU_TESS_MAX_COORD&&(f=c.GLU_TESS_MAX_COORD,g=!0);k[h]=f}g&&this.callErrorCallback(c.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(k,l)};c.GluTesselator.prototype.gluTessBeginPolygon=function(a){this.requireState_(c.GluTesselator.tessState_.T_DORMANT);this.state_=c.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new c.GluMesh;this.polygonData_=a};c.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(c.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=c.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};c.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(c.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=c.GluTesselator.tessState_.T_IN_POLYGON};c.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(c.GluTesselator.tessState_.T_IN_POLYGON);this.state_=c.GluTesselator.tessState_.T_DORMANT;c.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);c.sweep.computeInterior(this);
if(!this.fatalError){var a=this.mesh;this.boundaryOnly_?c.tessmono.setWindingNumber(a,1,!0):c.tessmono.tessellateInterior(a);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?c.render.renderBoundary(this,this.mesh):c.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){c.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}c.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};c.GluTesselator.prototype.requireState_=function(a){this.state_!==a&&this.gotoState_(a)};c.GluTesselator.prototype.gotoState_=function(a){for(;this.state_!==a;)if(this.state_<a)switch(this.state_){case c.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(c.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case c.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(c.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case c.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(c.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case c.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(c.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};c.GluTesselator.prototype.addVertex_=function(a,l){var g=this.lastEdge_;null===g?(g=c.mesh.makeEdge(this.mesh),c.mesh.meshSplice(g,g.sym)):(c.mesh.splitEdge(g),g=g.lNext);g.org.data=l;g.org.coords[0]=a[0];g.org.coords[1]=a[1];g.org.coords[2]=a[2];g.winding=1;g.sym.winding=-1;this.lastEdge_=g};c.GluTesselator.prototype.callBeginCallback=
function(a){this.beginCallback_&&this.beginCallback_(a,this.polygonData_)};c.GluTesselator.prototype.callVertexCallback=function(a){this.vertexCallback_&&this.vertexCallback_(a,this.polygonData_)};c.GluTesselator.prototype.callEdgeFlagCallback=function(a){this.edgeFlagCallback_&&this.edgeFlagCallback_(a,this.polygonData_)};c.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};c.GluTesselator.prototype.callCombineCallback=function(a,c,g){return this.combineCallback_?
this.combineCallback_(a,c,g,this.polygonData_)||null:null};c.GluTesselator.prototype.callErrorCallback=function(a){this.errorCallback_&&this.errorCallback_(a,this.polygonData_)};c.GluFace=function(a,c){this.next=a||this;this.prev=c||this;this.anEdge=null;this.inside=!1};c.GluHalfEdge=function(a){this.next=a||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};c.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};c.GluHalfEdge.prototype.dst=function(){return this.sym.org};
c.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};c.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};c.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};c.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};c.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};c.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};c.GluMesh=function(){this.vHead=new c.GluVertex;this.fHead=new c.GluFace;this.eHead=new c.GluHalfEdge;this.eHeadSym=
new c.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};c.GluMesh.prototype.checkMesh=function(){if(c.DEBUG){var a=this.fHead,l=this.vHead,g=this.eHead,k,h;for(k=k=a;(h=k.next)!==a;k=h){c.assert(h.prev===k);k=h.anEdge;do c.assert(k.sym!==k),c.assert(k.sym.sym===k),c.assert(k.lNext.oNext.sym===k),c.assert(k.oNext.sym.lNext===k),c.assert(k.lFace===h),k=k.lNext;while(k!==h.anEdge)}c.assert(h.prev===k&&null===h.anEdge);for(k=k=l;(a=k.next)!==l;k=a){c.assert(a.prev===k);k=a.anEdge;
do c.assert(k.sym!==k),c.assert(k.sym.sym===k),c.assert(k.lNext.oNext.sym===k),c.assert(k.oNext.sym.lNext===k),c.assert(k.org===a),k=k.oNext;while(k!==a.anEdge)}c.assert(a.prev===k&&null===a.anEdge&&null===a.data);for(l=l=g;(k=l.next)!==g;l=k)c.assert(k.sym.next===l.sym),c.assert(k.sym!==k),c.assert(k.sym.sym===k),c.assert(null!==k.org),c.assert(null!==k.dst()),c.assert(k.lNext.oNext.sym===k),c.assert(k.oNext.sym.lNext===k);c.assert(k.sym.next===l.sym&&k.sym===this.eHeadSym&&k.sym.sym===k&&null===
k.org&&null===k.dst()&&null===k.lFace&&null===k.rFace())}};c.GluVertex=function(a,c){this.next=a||this;this.prev=c||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};c.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new c.PriorityQHeap};c.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};c.PriorityQ.prototype.init=function(){this.order_=[];for(var a=0;a<this.size_;a++)this.order_[a]=a;
a=function(a){return function(g,h){return c.geom.vertLeq(a[g],a[h])?1:-1}}(this.verts_);this.order_.sort(a);this.initialized_=!0;this.heap_.init();if(c.DEBUG)for(var l=0+this.size_-1,a=0;a<l;++a)c.assert(c.geom.vertLeq(this.verts_[this.order_[a+1]],this.verts_[this.order_[a]]))};c.PriorityQ.prototype.insert=function(a){if(this.initialized_)return this.heap_.insert(a);var c=this.size_++;this.verts_[c]=a;return-(c+1)};c.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var l=this.heap_.minimum();if(c.geom.vertLeq(l,a))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return a};c.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var l=this.heap_.minimum();if(c.geom.vertLeq(l,a))return l}return a};c.PriorityQ.prototype.remove=function(a){if(0<=
a)this.heap_.remove(a);else for(a=-(a+1),c.assert(a<this.verts_.length&&null!==this.verts_[a]),this.verts_[a]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};c.PriorityQHeap=function(){this.heap_=c.PriorityQHeap.reallocNumeric_([0],c.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=c.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};c.PriorityQHeap.INIT_SIZE_=32;c.PriorityQHeap.reallocNumeric_=
function(a,c){for(var g=Array(c),k=0;k<a.length;k++)g[k]=a[k];for(;k<c;k++)g[k]=0;return g};c.PriorityQHeap.prototype.init=function(){for(var a=this.size_;1<=a;--a)this.floatDown_(a);this.initialized_=!0};c.PriorityQHeap.prototype.insert=function(a){var l=++this.size_;2*l>this.max_&&(this.max_*=2,this.handles_=c.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var g;0===this.freeList_?g=l:(g=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[g]=a;this.handles_[g]=l;
this.heap_[l]=g;this.initialized_&&this.floatUp_(l);return g};c.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};c.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};c.PriorityQHeap.prototype.extractMin=function(){var a=this.heap_,c=this.verts_,g=this.handles_,k=a[1],h=c[k];0<this.size_&&(a[1]=a[this.size_],g[a[1]]=1,c[k]=null,g[k]=this.freeList_,this.freeList_=k,0<--this.size_&&this.floatDown_(1));return h};c.PriorityQHeap.prototype.remove=function(a){var l=
this.heap_,g=this.verts_,k=this.handles_;c.assert(1<=a&&a<=this.max_&&null!==g[a]);var h=k[a];l[h]=l[this.size_];k[l[h]]=h;h<=--this.size_&&(1>=h?this.floatDown_(h):c.geom.vertLeq(g[l[h>>1]],g[l[h]])?this.floatDown_(h):this.floatUp_(h));g[a]=null;k[a]=this.freeList_;this.freeList_=a};c.PriorityQHeap.prototype.floatDown_=function(a){for(var l=this.heap_,g=this.verts_,k=this.handles_,h=l[a];;){var f=a<<1;f<this.size_&&c.geom.vertLeq(g[l[f+1]],g[l[f]])&&(f+=1);c.assert(f<=this.max_);var e=l[f];if(f>
this.size_||c.geom.vertLeq(g[h],g[e])){l[a]=h;k[h]=a;break}l[a]=e;k[e]=a;a=f}};c.PriorityQHeap.prototype.floatUp_=function(a){for(var l=this.heap_,g=this.verts_,k=this.handles_,h=l[a];;){var f=a>>1,e=l[f];if(0===f||c.geom.vertLeq(g[e],g[h])){l[a]=h;k[h]=a;break}l[a]=e;k[e]=a;a=f}};c.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};c.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
c.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return c})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._resolver=null}a.prototype.isHeld=function(){return!!this._resolver};a.prototype.acquire=function(){var a=this;return this._resolver?this._resolver.promise.then(function(){return a.acquire()}):
(this._resolver=l.createResolver(),l.resolve())};a.prototype.release=function(){var a=this._resolver;this._resolver=null;a.resolve()};return a}();a.default=c;a.withLock=function(a,c,h){return a.acquire().then(function(){return c(h)}).then(function(){return a.release()}).catch(function(c){a.release();throw c;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r){Object.defineProperty(a,"__esModule",{value:!0});var n=new l.default,u=new l.default;c=function(){function a(){this.tileBufferData=this.tileDisplayData=null}a.prototype.reshuffle=function(){n.reset();for(var b=k.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),d=0;d<b.length;d++)for(var c=b[d],e=0,m=c;e<m.length;e++){var l=m[e];l&&n.needMore(l.geometryType,l.meshData?l.meshData.vertexCount:l.vertexCount,l.meshData?l.meshData.indexData.length:l.indexCount)}e=
b.length;d=new g;for(m=0;m<e;++m){d.geometries[m].indexBuffer=new Uint32Array(Math.round(1.15*n.indicesFor(m)));var l=[],p;for(p in this.tileBufferData.geometries[m].vertexBuffer)l.push(this.tileBufferData.geometries[m].vertexBuffer[p].stride);var l=a._computeVertexAlignment(l),c=Math.round(1.15*n.verticesFor(m)),l=a._align(c,l),r;for(r in this.tileBufferData.geometries[m].vertexBuffer)c=this.tileBufferData.geometries[m].vertexBuffer[r].stride,d.geometries[m].vertexBuffer[r]={stride:c,data:f.allocateTypedArrayBuffer(l,
c)}}u.reset();this.tileDisplayData.displayList.clear();for(m=0;m<e;++m){c=b[m];p=0;for(r=c;p<r.length;p++){l=r[p];if(l.meshData)l.writeMeshDataToBuffers(u.verticesFor(m),d.geometries[m].vertexBuffer,u.indicesFor(m),d.geometries[m].indexBuffer),l.meshData=null;else{var y=this.tileBufferData.geometries[m].vertexBuffer,F=this.tileBufferData.geometries[m].indexBuffer,H=d.geometries[m].vertexBuffer,J=d.geometries[m].indexBuffer,K=u.verticesFor(m),G=u.indicesFor(m);h.copyMeshData(K,G,H,J,l,y,F);l.vertexFrom=
K;l.indexFrom=G}u.needMore(m,l.vertexCount,l.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(c)}if(this.tileDisplayData.displayList.unified)for(b=0,e=this.tileDisplayData.displayObjects;b<e.length;b++)this.tileDisplayData.displayList.addToList(e[b].displayRecords);this.tileBufferData=d};a.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var d=this.tileBufferData.geometries[b];a[b]={};for(var c in d.vertexBuffer)a[b][c]=
d.vertexBuffer[c].stride}return a};a.prototype.clone=function(){var b=new a;b.tileBufferData=this.tileBufferData.clone();b.tileDisplayData=this.tileDisplayData.clone();return b};a.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),d=0,c=0;c<b;c++)d=Math.max(d,a[c].displayRecords.length);return 2*(12*a.length+a.length*d*40)};a.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),d=this.tileDisplayData.serialize(new r.default(Int32Array,
this._guessSize())).buffer();b.push(d);return{result:{displayData:d,bufferData:a},transferList:b}};a.decode=function(c){var f=m.deserializeList(new d.default(c.displayObjects),e),h={},g;for(g in c.vertexBuffersMap)h[g]=b.VertexBuffers.decode(c.vertexBuffersMap[g]);return a.fromMeshData({displayObjects:f,vertexBuffersMap:h})};a.fromMeshData=function(b){var d=new a,c=new k.default,e=new g;c.displayObjects=b.displayObjects;for(var f in b.vertexBuffersMap){var h=b.vertexBuffersMap[f];e.geometries[f].indexBuffer=
h.indexBuffer;e.geometries[f].vertexBuffer=h.namedBuffers}d.tileDisplayData=c;d.tileBufferData=e;return d};a.bind=function(b,d){var c=new a;c.tileDisplayData=b;c.tileBufferData=d;return c};a.create=function(b,d){var c=new a;c.tileDisplayData=new k.default;c.tileDisplayData.displayObjects=b;for(var e=[0,0,0,0,0],h=[0,0,0,0,0],m=[[],[],[],[],[]],l=0;l<b.length;l++)for(var n=0,t=b[l].displayRecords;n<t.length;n++){var r=t[n];m[r.geometryType].push(r);e[r.geometryType]+=r.meshData.vertexCount;h[r.geometryType]+=
r.meshData.indexData.length}b=new g;d=[d.fill||{},d.line||{},d.icon||{},d.text||{},d.label||{}];for(l=0;5>l;l++){var n=new Uint32Array(h[l]),t=d[l],r=e[l],w={},u=void 0;for(u in t){var y={data:f.allocateTypedArrayBuffer(r,t[u]),stride:t[u]};w[u]=y}t=w;p.writeAllMeshDataToBuffers(m[l],t,n);b.geometries[l]={indexBuffer:n,vertexBuffer:t}}c.tileBufferData=b;return c};a._align=function(a,b){var d=a%b;return 0===d?a:a+(b-d)};a._computeVertexAlignment=function(a){for(var b=!1,d=!1,c=0;c<a.length;c++){var e=
a[c];2===e%4?b=!0:0!==e%4&&(d=!0)}return d?4:b?2:1};return a}();a.TileData=c})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._byGeometryType=null}Object.defineProperty(a.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._byGeometryType=null};a.prototype.verticesFor=function(a){return this._byGeometryType?
this._byGeometryType[a].vertices:0};a.prototype.indicesFor=function(a){return this._byGeometryType?this._byGeometryType[a].indices:0};a.prototype.needMore=function(a,c,h){if(c||h)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),a=this._byGeometryType[a],a.vertices+=c,a.indices+=h};return a}();a.default=c})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(c,a,l){return function(){function a(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.prototype.clone=function(){for(var c=new a,h=0;h<this.geometries.length;h++){var f=this.geometries[h],e=c.geometries[h];e.indexBuffer=f.indexBuffer.slice();e.vertexBuffer={};for(var g in f.vertexBuffer){var b=f.vertexBuffer[g],d=b.stride;
e.vertexBuffer[g]={data:b.data.slice(),stride:d}}}return c};a.deserialize=function(c){for(var h=new a,f=0;5>f;++f){h.geometries[f].indexBuffer=new Uint32Array(c.geometries[f].indexBuffer);h.geometries[f].vertexBuffer={};for(var e in c.geometries[f].vertexBuffer)h.geometries[f].vertexBuffer[e]={data:l.allocateTypedArrayBufferwithData(c.geometries[f].vertexBuffer[e].data,c.geometries[f].vertexBuffer[e].stride),stride:c.geometries[f].vertexBuffer[e].stride}}return h};a.prototype.serialize=function(){for(var a=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},c=0;5>c;++c)for(var f in this.geometries[c].vertexBuffer)a.geometries[c].vertexBuffer[f]={data:this.geometries[c].vertexBuffer[f].data.buffer,stride:this.geometries[c].vertexBuffer[f].stride};
return a};a.prototype.getBuffers=function(){for(var a=[],c=0;5>c;++c){a.push(this.geometries[c].indexBuffer.buffer);for(var f in this.geometries[c].vertexBuffer)a.push(this.geometries[c].vertexBuffer[f].data.buffer)}return a};return a}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(c,a,l,g,k){function h(a){for(var c=[[],[],[],[],[]],f=0;f<a.length;f++)for(var b=0,d=a[f].displayRecords;b<
d.length;b++){var h=d[b];c[h.geometryType].push(h)}return c}Object.defineProperty(a,"__esModule",{value:!0});a.groupRecordsByGeometryType=h;c=function(){function a(){}Object.defineProperty(a.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,c=this.displayObjects;a<c.length;a++){var b=c[a];this._displayObjectRegistry.set(b.id,b)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});a.prototype.computeDisplayList=function(a){this._displayList=new l(a);if(a){a=0;for(var c=this.displayObjects;a<c.length;a++)for(var b=0,d=c[a].displayRecords;b<d.length;b++)this._displayList.addToList(d[b])}else for(a=h(this.displayObjects),c=a.length,b=0;b<c;++b)this._displayList.addToList(a[b])};a.prototype.clone=function(){var c=new a;this.displayObjects&&(c.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return c};a.prototype.serialize=function(a){k.serializeList(a,this.displayObjects);return a};a.prototype._deserializeObjects=function(a){for(var c=a.readInt32(),c=Array(c),b=new Map,d=0;d<c.length;++d){var e=g.deserialize(a);c[d]=e;b.set(e.id,e)}this.displayObjects=c;this._displayList=null;this._displayObjectRegistry=b};a.deserialize=function(c){var e=new a;e._deserializeObjects(c);return e};return a}();a.default=c})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"../../../../core/tsSupport/generatorHelper","../../../../core/Logger","./enums"],function(c,a,l,g,k){function h(a,b,c){for(var d=[],e=3;e<arguments.length;e++)d[e-3]=arguments[e];b<a.length?a.splice.apply(a,[b,c].concat(d)):a.push.apply(a,d)}var f=g.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");c=new Map;c.set(k.WGLDrawPhase.MAP,[k.WGLGeometryType.FILL,k.WGLGeometryType.LINE,k.WGLGeometryType.MARKER,k.WGLGeometryType.TEXT]);c.set(k.WGLDrawPhase.LABEL,[k.WGLGeometryType.LABEL]);c.set(k.WGLDrawPhase.LABEL_ALPHA,
[k.WGLGeometryType.LABEL]);c=function(){function a(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}a.prototype.replay=function(a,b,c){if(this.unified)for(var d=0,e=this.symbolLevels;d<e.length;d++)for(var f=0,h=e[d].zLevels;f<h.length;f++){var g=h[f].geometryDPInfo,k;for(k in g)if(g[k])for(var m=0,l=g[k];m<l.length;m++){var n=l[m],p=a.painter.getGeometryBrush(n.geometryType),r=b.getGeometry(n.geometryType);p.prepareState(a,b);p.drawGeometry(a,b,n,r,c)}}};Object.defineProperty(a.prototype,
"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.symbolLevels.length=0};a.prototype.addToList=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._addToList(a[c],b);else this._addToList(a,b)};a.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var b=null,c=0;c<a.length;c++)b=this._removeFromList(a[c]);return b};a.prototype.byType=function(a,b){for(var c=0,d=this.symbolLevels;c<
d.length;c++)for(var e=0,f=d[c].zLevels;e<f.length;e++){var h=f[e].geometryDPInfo,g=this.getDPInfoType(a);if(h[g])for(var k=0,h=h[g];k<h.length;k++)b(h[k])}};a.prototype.clone=function(){for(var b=new a(this.unified),c=0,d=this.symbolLevels;c<d.length;c++)b.symbolLevels.push(d[c].clone());return b};a.prototype.splitAfter=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,d=a.indexFrom+a.indexCount,f=0;f<c;++f){var h=b[f];if(h.geometryType===a.geometryType&&
d>h.indexFrom&&d<=h.indexFrom+h.indexCount)return d<h.indexFrom+h.indexCount&&(a=new e,a.geometryType=h.geometryType,a.materialKey=h.materialKey,a.indexFrom=d,a.indexCount=h.indexFrom+h.indexCount-d,b.splice(f+1,0,a),h.indexCount=d-h.indexFrom),f}};a.prototype._addToList=function(a,b){var c=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType);b=null!=b?b:c.length-1;var d=0<=b&&b<c.length?c[b]:null;null===d||d.materialKey!==a.materialKey||d.indexFrom+d.indexCount!==a.indexFrom||this.unified&&
d.geometryType!==a.geometryType?(d=new e,d.indexFrom=a.indexFrom,d.indexCount=a.indexCount,d.materialKey=a.materialKey,d.geometryType=a.geometryType,h(c,b+1,0,d)):d.indexCount+=a.indexCount};a.prototype._removeFromList=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,d=void 0,f=0;f<c;++f){var g=b[f];if(a.indexFrom+a.indexCount>g.indexFrom&&a.indexFrom<g.indexFrom+g.indexCount&&(!this.unified||g.geometryType===a.geometryType)){d=f;break}}if(void 0!==d){g=
b[d];if(a.indexFrom===g.indexFrom)return g.indexCount-=a.indexCount,g.indexFrom+=a.indexCount,0===g.indexCount&&h(b,d,1),d-1;if(a.indexFrom+a.indexCount===g.indexFrom+g.indexCount)return g.indexCount-=a.indexCount,0===g.indexCount?(h(b,d,1),d-1):d;var c=g.indexFrom,f=a.indexFrom-g.indexFrom,k=a.indexCount;a=g.indexFrom+g.indexCount-(a.indexFrom+a.indexCount);g.indexCount=f;var m=new e;m.geometryType=g.geometryType;m.materialKey=g.materialKey;m.indexFrom=c+f+k;m.indexCount=a;h(b,d+1,0,m);return d}return null};
a.prototype._getDisplayList=function(a,c,e){for(var f,h=this.symbolLevels.length,g=0;g<h;g++)if(this.symbolLevels[g].symbolLevel===a){f=this.symbolLevels[g];break}f||(f=new d,f.symbolLevel=a,this.symbolLevels.push(f));var m;a=f.zLevels.length;for(h=0;h<a;h++)if(f.zLevels[h].zLevel===c){m=f.zLevels[h];break}m||(m=new b,m.geometryDPInfo=new p,m.zLevel=c,f.zLevels.push(m));var l;if(this.unified)m.geometryDPInfo.unified||(m.geometryDPInfo.unified=[]),l=m.geometryDPInfo.unified;else switch(e){case k.WGLGeometryType.FILL:m.geometryDPInfo.fill||
(m.geometryDPInfo.fill=[]);l=m.geometryDPInfo.fill;break;case k.WGLGeometryType.LINE:m.geometryDPInfo.line||(m.geometryDPInfo.line=[]);l=m.geometryDPInfo.line;break;case k.WGLGeometryType.MARKER:m.geometryDPInfo.marker||(m.geometryDPInfo.marker=[]);l=m.geometryDPInfo.marker;break;case k.WGLGeometryType.TEXT:m.geometryDPInfo.text||(m.geometryDPInfo.text=[]);l=m.geometryDPInfo.text;break;case k.WGLGeometryType.LABEL:m.geometryDPInfo.label||(m.geometryDPInfo.label=[]);l=m.geometryDPInfo.label;break;
default:console.error("Trying to add a record with geometry type '"+e+"'.")}return l};a.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case k.WGLGeometryType.FILL:return"fill";case k.WGLGeometryType.LINE:return"line";case k.WGLGeometryType.MARKER:return"marker";case k.WGLGeometryType.TEXT:return"text";case k.WGLGeometryType.LABEL:return"label";default:f.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return a}();var e=function(){function a(){this.materialKey=
null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var b=new a;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return a}(),p=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var b=new a;b.fill=this.fill&&this.fill.map(function(a){return a.clone()});b.line=this.line&&this.line.map(function(a){return a.clone()});b.marker=this.marker&&
this.marker.map(function(a){return a.clone()});b.text=this.text&&this.text.map(function(a){return a.clone()});b.label=this.label&&this.label.map(function(a){return a.clone()});b.unified=this.unified&&this.unified.map(function(a){return a.clone()});return b};return a}(),b=function(){function a(){this.geometryDPInfo=new p}a.prototype.clone=function(){var b=new a;b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return a}(),d=function(){function a(){this.zLevels=[]}a.prototype.clone=
function(){var b=new a;b.symbolLevel=this.symbolLevel;for(var c=0,d=this.zLevels;c<d.length;c++)b.zLevels.push(d[c].clone());return b};return a}();return c})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};
a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();a.default=c})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),function(c,a,l,g,k,h,f,e,p,b,d,m){function r(a,b){var c=b.length;
if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}function n(a,b,c){void 0===c&&(c=0);if(h.isNone(b))a[c+0]=0,a[c+1]=0,a[c+2]=0,a[c+3]=0;else{var d=b.g,e=b.b,f=b.a;a[c+0]=b.r*f/255;a[c+1]=d*f/255;a[c+2]=e*f/255;a[c+3]=f}}Object.defineProperty(a,"__esModule",{value:!0});var u=function(a,b,c){for(var d=c*=16,e=0;d<Math.min(c+16,a.length);d++,e++)a[d]=b[e]},y=p.mat4f32.create();
c=function(){function a(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*d.MAX_FILTERS);this.insideOpacity=1;this.outsideEffect=new Float32Array(16*d.MAX_FILTERS);this.outsideOpacity=
1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<d.MAX_FILTERS;a++)u(this.insideEffect,y,a),u(this.outsideEffect,y,a)}Object.defineProperty(a.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});a.prototype.getSizeVVFieldStops=function(a){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return h.unwrapOr(b.levels[a],function(){var c=Infinity,d=0,e;for(e in b.levels){var f=parseFloat(e),g=Math.abs(a-f);g<c&&(c=g,d=f)}if(Infinity===c)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};
c=Math.pow(2,(a-d)/2);d=h.expect(b.levels[d]);e=new Float32Array(d.values);e[2]*=c;e[3]*=c;return{sizes:h.unwrap(d.sizes),values:e}})}};Object.defineProperty(a.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});a.prototype.update=function(a){h.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,a)};a.prototype.setInfo=function(a,b,c){var d=this;h.isSome(c)?(c.forEach(function(a,b){return d._updateEffects(b,a)}),this.effectCount=
c.length):this.effectCount=0;this._vvInfo=b;switch(a.type){case "dot-density":this._updateDotDensityInfo(a)}};a.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:k("esri-webgl-texture-float")}};a.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};a.prototype._updateEffects=function(a,b){a+=1;if(h.isSome(b)&&b.filter&&
b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var c=b.parsedIncludedEffect;b=b.parsedExcludedEffect;h.isSome(c)?(u(this.insideEffect,c.getColorMatrix(),a),this.insideOpacity=c.getOpacity()):(u(this.insideEffect,y,a),this.insideOpacity=1);h.isSome(b)?(u(this.outsideEffect,b.getColorMatrix(),a),this.outsideOpacity=b.getOpacity()):(u(this.outsideEffect,y,a),this.outsideOpacity=1)}else u(this.insideEffect,y,a),u(this.outsideEffect,y,a),this.outsideOpacity=this.insideOpacity=1};a.prototype._updateVisualVariables=
function(a,c){var d=this._vvMaterialParameters;d.vvOpacityEnabled=!1;d.vvSizeEnabled=!1;d.vvColorEnabled=!1;d.vvRotationEnabled=!1;if(a){var h=a.size;if(h){d.vvSizeEnabled=!0;if(h.minMaxValue){var g=h.minMaxValue,k=void 0,l=void 0;m.isDefined(g.minSize)&&m.isDefined(g.maxSize)&&(m.isNumber(g.minSize)&&m.isNumber(g.maxSize)?(k=f.pt2px(g.minSize),l=f.pt2px(g.maxSize)):(l=c.scale,k=f.pt2px(r(l,g.minSize.stops)),l=f.pt2px(r(l,g.maxSize.stops))));this.vvSizeMinMaxValue.set([g.minDataValue,g.maxDataValue,
k,l])}h.scaleStops&&(this.vvSizeScaleStopsValue=f.pt2px(r(c.scale,h.scaleStops.stops)));h.unitValue&&(this.vvSizeUnitValueToPixelsRatio=e.getMetersPerUnitForSR(c.spatialReference)/b.meterIn[h.unitValue.unit]/c.resolution);h.fieldStops&&(this._vvSizeFieldStops=h.fieldStops)}if(c=a.color)d.vvColorEnabled=!0,this.vvColorValues.set(c.values),this.vvColors.set(c.colors);if(c=a.opacity)d.vvOpacityEnabled=!0,this.vvOpacityValues.set(c.values),this.vvOpacities.set(c.opacities);if(a=a.rotation)d.vvRotationEnabled=
!0,d.vvRotationType=a.type}};a.prototype._updateDotDensityInfo=function(a){var b=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var c=0;c<d.DOT_DENSITY_MAX_FIELDS;c++){var e=c>=b.length?new g([0,0,0,0]):b[c].color;n(this.ddColors,e,4*c)}for(c=0;8>c;c++)this.ddActiveDots[c]=c<a.attributes.length?1:0;n(this.ddBackgroundColor,a.backgroundColor)};return a}();a.WGLRendererInfo=c})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require",
"exports","./factories/mat4f32"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f32=l})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require","exports"],function(c,a){function l(){var a=new Float32Array(16);a[0]=1;a[5]=1;a[10]=1;a[15]=1;return a}Object.defineProperty(a,"__esModule",{value:!0});a.create=l;a.clone=function(a){var c=new Float32Array(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=
a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.fromValues=function(a,c,h,f,e,l,b,d,m,r,n,u,y,w,t,v){var g=new Float32Array(16);g[0]=a;g[1]=c;g[2]=h;g[3]=f;g[4]=e;g[5]=l;g[6]=b;g[7]=d;g[8]=m;g[9]=r;g[10]=n;g[11]=u;g[12]=y;g[13]=w;g[14]=t;g[15]=v;return g};a.createView=function(a,c){return new Float32Array(a,c,16)};a.IDENTITY=l()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r){Object.defineProperty(a,"__esModule",{value:!0});var n=new Set;c=function(a){function c(b,c,f){void 0===f&&(f=!1);b=a.call(this,b,c,[e.TILE_SIZE,e.TILE_SIZE])||this;b._data=null;b._displayList=null;b._wglBuffers=null;b._dirtyMap=new p.default;b._labelIndex=null;b._dirty=!0;b.fader=new d.default;b._ensureCorrectZOrder=f;b.transforms.labelMat2d=k.mat2df32.create();return b}l(c,a);c.prototype.destroy=function(){this.clear()};Object.defineProperty(c.prototype,"displayObjects",
{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});c.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};c.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(c.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});c.prototype.setTransform=function(b,c){a.prototype.setTransform.call(this,
b,c);var d=this.transforms.labelMat2d;c=b.getScreenTransform(d,c);var e=f.vec2f32.create();h.vec2.transformMat2d(e,this.coords,c);g.mat2d.identity(d);g.mat2d.translate(d,d,e);g.mat2d.multiply(d,b.viewMat2d,d)};c.prototype.setData=function(a,c,d){var e=a.addOrUpdate,f=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:e,remove:f},c,d):(e.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new p.default,
this._dispRecStore=b.default.fromTileData(e,this._dirtyMap),this._data=e,this._readyTileIfNoLabels(c,d),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=e.tileDisplayData.displayList.clone())):(this.clear(),this.ready());this.emit("change")};c.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new r.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();
this._dirtyMap.markAllClean()};c.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};c.prototype.attach=function(){return!0};c.prototype._readyTileIfNoLabels=function(a,b){a&&this._rebuildLabelIndex();this.isDirty=a&&b?!0:!1};c.prototype._doPatchData=function(a,c,d){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=b.default.fromTileData(this._data,this._dirtyMap));
this._readyTileIfNoLabels(c,d);this.requestRender()};c.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,b=this.displayObjects;a<b.length;a++)for(var c=0,d=b[a].metrics;c<d.length;c++)this._insertIntoLabelIndex(d[c])};c.prototype._insertIntoLabelIndex=function(a){-1!==a.xBucket&&this.labelIndex[a.yBucket][a.xBucket].push(a)};c.prototype._initLabelIndex=function(){for(var a=[],b=0;b<e.TILE_SIZE/e.COLLISION_BUCKET_SIZE;b++){a.push([]);for(var c=0;c<e.TILE_SIZE/
e.COLLISION_BUCKET_SIZE;c++)a[b].push([])}return a};c.prototype._patchData=function(a){for(var b=!0,c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],d=(a.remove||[]).slice(),e=0;e<c.length;e++){var f=c[e];null!=f.insertAfter&&d.push(f.id)}for(f=0;f<d.length;f++){var h=d[f];if(e=this._data.tileDisplayData.displayObjectRegistry.get(h)){this._data.tileDisplayData.displayList.removeFromList(e.displayRecords);for(var g=0,k=e.displayRecords;g<k.length;g++)this._dispRecStore.delete(k[g]);
this._data.tileDisplayData.displayObjectRegistry.delete(h);e=this._data.tileDisplayData.displayObjects.indexOf(e);this._data.tileDisplayData.displayObjects.splice(e,1)}}for(d=0;d<c.length;d++){f=c[d];e=this._data.tileDisplayData.displayObjectRegistry.get(f.id);h=void 0;if(e){g=e.displayRecords;e.set(f);e.displayRecords=g;g=e.displayRecords.length;for(k=0;k<g;++k){var m=e.displayRecords[k],l=f.displayRecords[k];if(k>=f.displayRecords.length||m.geometryType!==l.geometryType||m.symbolLevel!==l.symbolLevel||
m.zOrder!==l.zOrder||m.materialKey!==l.materialKey)this._dispRecStore.delete(e.displayRecords[k]),k<f.displayRecords.length&&(e.displayRecords[k]=void 0)}e.displayRecords.length=f.displayRecords.length;e.metrics=f.metrics}else if(e=f.copy(),e.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(f.id,e),k=void 0,m=this._data.tileDisplayData.displayObjects,null!=e.insertAfter?(h={},0<=e.insertAfter?(g=this._data.tileDisplayData.displayObjectRegistry.get(e.insertAfter))?(k=m.indexOf(g)+
1,k<m.length?m.splice(k,0,e):(m.push(e),k=m.length)):(m.push(e),k=m.length):(m.unshift(e),k=0)):(m.push(e),k=m.length),h){l=void 0;if(this._data.tileDisplayData.displayList.unified)l=0<f.displayRecords.length?1:0;else{n.clear();for(var l=0,p=f.displayRecords;l<p.length;l++)g=this._data.tileDisplayData.displayList.getDPInfoType(p[l].geometryType),n.add(g);l=n.size}p=0;for(--k;0<=k&&p<l;--k)for(var r=m[k].displayRecords.length-1;0<=r&&p<l;--r){var u=m[k].displayRecords[r],g=this._data.tileDisplayData.displayList.getDPInfoType(u.geometryType);
h[g]||(h[g]=u,++p)}}p=f.displayRecords.length;for(k=0;k<p;++k){l=f.displayRecords[k];(m=e.displayRecords[k])?(m.meshData=l.meshData,m.materialKey=l.materialKey):(m=l.copy(),m.vertexFrom=void 0,m.indexFrom=void 0,e.displayRecords[k]=m);var r=l.geometryType,g=this._data.tileDisplayData.displayList.getDPInfoType(r),u=a.addOrUpdate.tileBufferData.geometries[r],r=u.vertexBuffer,u=u.indexBuffer,w=void 0;h&&(w=h[g]?this._data.tileDisplayData.displayList.splitAfter(h[g]):-1);b=this._dispRecStore.setMeshData(m,
l,r,u,w)&&b;h&&null!=m.indexFrom&&null!=m.indexFrom&&(h[g]=m)}}return b};return c}(m.TiledDisplayObject);a.WGLTile=c})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(c,a,l){function g(a,c,f){if(!a.allDirty)if(null!=a.from&&null!=a.count){var e=Math.min(a.from,c);c=Math.max(a.from+a.count,c+f)-e;a.from=e;a.count=c}else a.from=c,a.count=f}Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._dirties=l.createGeometryData(function(){return{indices:{from:null,
count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}a.prototype.hasDirty=function(){for(var a=0,c=this._dirties;a<c.length;a++){var e=c[a];if(null!==e.data.indices.count||e.data.indices.allDirty)return!0}return!1};a.prototype.markAllClean=function(){for(var a=0,c=this._dirties;a<c.length;a++){var e=c[a];e.data.indices.from=null;e.data.indices.count=null;e.data.indices.allDirty=!1;for(var g in e.buffers)e.buffers[g].data.vertices.from=null,e.buffers[g].data.vertices.count=
null,e.buffers[g].data.vertices.allDirty=!1}};a.prototype.markAllDirty=function(){for(var a=0,c=this._dirties;a<c.length;a++){var e=c[a];e.data.indices.allDirty=!0;for(var g in e.buffers)e.buffers[g].data.vertices.allDirty=!0}};a.prototype.forEach=function(a){for(var c=0;c<this._dirties.length;++c){var e=this._dirties[c],h={},b;for(b in e.buffers){var d=e.buffers[b].data.vertices;if(d.allDirty||null!=d.from&&null!=d.count&&0<d.count)h[b]=d}e=e.data.indices;d=void 0;d=e.allDirty||null!=e.from&&null!=
e.count&&0<e.count?{indices:e,vertices:h}:{indices:null,vertices:h};(d.indices||0<Object.keys(d).length)&&a(d,c)}};a.prototype.markDirtyIndices=function(a,c,e){g(this._dirties[a].data.indices,c,e)};a.prototype.markDirtyVertices=function(a,c,e,k){g(this._dirties[a].buffers[c].data.vertices,e,k)};return a}();a.default=c})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(c,a,l,g,k){function h(a){a=a.getStrides();
for(var c={},b=0;b<a.length;b++)c[f[b]]=a[b];return c}Object.defineProperty(a,"__esModule",{value:!0});var f=["FILL","LINE","MARKER","TEXT","LABEL"];c=function(){function a(a,b,c,e){this._strides=a;this._displayList=b;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=c;for(var d in a){this._freeListsAndStorage[d]={vtxFreeList:e?new g.FreeList(e):null,idxFreeList:e?new g.FreeList(e):null,vertexBuffers:{},indexBuffer:e?new Uint32Array(e):null};for(var f in a[d])this._freeListsAndStorage[d].vertexBuffers[f]=
{data:e?k.allocateTypedArrayBuffer(e,a[d][f]):null,stride:a[d][f]}}}a.fromTileData=function(c,b){var d=h(c),e=[0,0,0,0,0],l=[0,0,0,0,0],n=[];c.tileDisplayData.displayObjectRegistry.forEach(function(a){n.push(a)});for(var p=0;p<n.length;p++)for(var y=0,w=n[p].displayRecords;y<w.length;y++){var t=w[y];e[t.geometryType]=Math.max(e[t.geometryType],t.vertexFrom+t.vertexCount);l[t.geometryType]=Math.max(l[t.geometryType],t.indexFrom+t.indexCount)}b=new a(d,c.tileDisplayData.displayList,b,null);for(d=0;d<
c.tileBufferData.geometries.length;++d){var p=e[d],w=l[d],t=c.tileBufferData.geometries[d],y=b._storageFor(f[d]),v=c.tileBufferData.geometries[d].indexBuffer;y.indexBuffer=v;y.idxFreeList=new g.FreeList(v.length);y.idxFreeList.allocate(w);var w=void 0,z;for(z in t.vertexBuffer)t=c.tileBufferData.geometries[d].vertexBuffer[z],y.vertexBuffers[z].data=t.data,y.vertexBuffers[z].stride=t.stride,v=k.strideToPackingFactor(t.stride),t=t.data.length*v/t.stride,w||(w=t);y.vtxFreeList=new g.FreeList(w);y.vtxFreeList.allocate(p)}return b};
a.prototype.delete=function(a){var b=f[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};a.prototype.setMeshData=function(a,b,c,e,h){var d=f[a.geometryType];a.meshData=null;var g=void 0,m=void 0;void 0===a.vertexFrom?(m=b.vertexCount,g=this._allocateVertices(d,m)):b.vertexCount>a.vertexCount?(this._freeVertices(d,a.vertexFrom,a.vertexCount),m=b.vertexCount,g=this._allocateVertices(d,
m)):b.vertexCount===a.vertexCount?(g=a.vertexFrom,m=a.vertexCount):(this._freeVertices(d,a.vertexFrom+b.vertexCount,a.vertexCount-b.vertexCount),g=a.vertexFrom,m=b.vertexCount);var l=!0,p=void 0,r=void 0,z=void 0;void 0===a.indexFrom?(p=h,z=b.indexCount,r=this._allocateIndices(d,z)):b.indexCount>a.indexCount?(p=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom,a.indexCount),z=b.indexCount,r=this._allocateIndices(d,z)):b.indexCount===a.indexCount?(l=!1,r=a.indexFrom,z=a.indexCount):
(p=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom+b.indexCount,a.indexCount-b.indexCount),r=a.indexFrom,z=b.indexCount);if(-1!==g&&-1!==r){h=this._storageFor(d);k.copyMeshData(g,r,h.vertexBuffers,h.indexBuffer,b,c,e);a.vertexFrom=g;a.indexFrom=r;a.vertexCount=b.vertexCount;a.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var A in c)this._dirtyMap.markDirtyVertices(a.geometryType,A,a.vertexFrom,a.vertexCount)}l&&
this._displayList.addToList(a,p);return!0}-1!==g&&this._freeVertices(d,g,m);-1!==r&&this._freeIndices(d,r,z);a.setMeshDataFromBuffers(b,c,e);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};a.prototype._allocateVertices=function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};a.prototype._freeVertices=function(a,b,c){this._storageFor(a).vtxFreeList.free(b,c)};a.prototype._freeIndices=function(a,b,c){this._storageFor(a).idxFreeList.free(b,
c)};a.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:b};a.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};a.prototype._stridesFor=function(a,b){return this._strides[a][b]};return a}();a.default=c})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});var l=function(){function a(a){this._largestRange=
null;this._parent=a;this._updateLargestRange()}Object.defineProperty(a.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});a.prototype.rangeCreated=function(a){if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.rangeResized=function(a,c){if(a===this._largestRange)a.count<c&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.findBestRange=function(a){for(var c=
this._parent._freeHead,f=null;null!==c;)c.count>=a&&(!f||c.count-a<f.count-a)&&(f=c),c=c.next;return f};a.prototype.findAdjacentRanges=function(a,c){for(var f=!0,e=!1,h=null,b=this._parent._freeHead;f&&!e;){var d=null!==b?b.from:this._parent._size;a>=(null!==h?h.from+h.count:0)&&a+c<=d?(f=!1,e=!0):null!==b?(h=b,b=b.next):f=!1}return[h,b]};a.prototype._updateLargestRange=function(){for(var a=null,c=this._parent._freeHead;null!==c;){if(!a||c.count>a.count)a=c;c=c.next}this._largestRange=a};return a}();
c=function(){function a(a,c){this._allocated=0;this._size=a;this._freeHead=0<a?{from:0,count:a,prev:null,next:null}:null;this._bookKeeper=c||new l(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}a.prototype.allocate=function(c){var h=this._bookKeeper.findBestRange(c);if(null===h)return-1;var f=h.from,e=h.count;h.from+=c;h.count-=c;this._bookKeeper.rangeResized(h,f,e);this._allocated+=c;0===h.count&&(c=null!==h.prev?this._freeHead:h.next,a._removeRange(h),this._freeHead=c);return f};
a.prototype.free=function(c,h){var f=this._bookKeeper.findAdjacentRanges(c,h),e=f[0],f=f[1];c={from:c,count:h,prev:e,next:f};null!==e&&(e.next=c);null!==f&&(f.prev=c);this._bookKeeper.rangeCreated(c);this._allocated-=h;if(null!==f&&c.from+c.count===f.from){h=c.from;var g=c.count;a._fuse(c,f);a._removeRange(f);this._bookKeeper.rangeResized(c,h,g);this._bookKeeper.rangeResized(f,void 0,0)}null!==e&&e.from+e.count===c.from&&(h=e.from,g=e.count,a._fuse(e,c),a._removeRange(c),this._bookKeeper.rangeResized(e,
h,g),this._bookKeeper.rangeResized(c,void 0,0));this._freeHead=null!==c.prev?this._freeHead:c};Object.defineProperty(a.prototype,"fragmentation",{get:function(){var a=this._size-this._allocated;return 0===a?0:1-this._bookKeeper.largestRange.count/a},enumerable:!0,configurable:!0});a._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};a._fuse=function(a,c){a.count+=c.count;a.next=c.next;c.from+=c.count;c.count=
0;null!==c.next&&(c.next.prev=a)};return a}();a.FreeList=c})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){void 0===a&&(a=400);this.duration=a;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(a.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._value=this._elapsed=this._lastTime=
0};a.prototype.step=function(){var a=performance.now();if(0===this._lastTime)return this._lastTime=a,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=a-this._lastTime;this._lastTime=a;this._value=Math.min(this._elapsed/this.duration,1);return!1};return a}();a.default=c})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this.geometryMap=
g.createGeometryData(function(){return{indexBuffer:l.BufferObject.createIndex(a,35044),vao:null}},function(c,e){return{vertexBuffer:l.BufferObject.createVertex(a,g.C_VBO_INFO[e])}})}a.prototype.dispose=function(){for(var a=0;5>a;a++){var c=this.geometryMap[a];if(c){c.data.vao&&c.data.vao.dispose(!1);c.data.indexBuffer&&c.data.indexBuffer.dispose();for(var e in c.buffers)c.buffers[e]&&c.buffers[e].data.vertexBuffer.dispose()}}};a.prototype.get=function(a){var c=this.geometryMap[a];a={};for(var e in c.buffers)a[e]=
c.buffers[e].data.vertexBuffer;return{indexBuffer:c.data.indexBuffer,get vao(){return c.data.vao},set vao(a){c.data.vao=a},vertexBufferMap:a}};a.prototype.has=function(a){return null!=this.geometryMap[a]};a.prototype.upload=function(a,c){var e=this;c.forEach(function(c,b){e._upload(c,b,a)})};a.prototype._upload=function(a,c,e){a.indices&&(a.indices.allDirty?this._uploadIndices(e,c):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(e,c,a.indices.from,a.indices.count));if(a.vertices){a=
a.vertices;for(var f in a){var b=a[f];b.allDirty?this._uploadVertices(e,c,f):null!=b.from&&null!=b.count&&this._uploadVertices(e,c,f,b.from,b.count)}}};a.prototype._uploadVertices=function(a,c,e,g,b){var d=this.geometryMap[c];d&&(c=a.geometries[c].vertexBuffer[e])&&(a=c.stride,c=c.data.buffer,d.buffers[e]&&0<c.byteLength&&(null!=g&&null!=b?d.buffers[e].data.vertexBuffer.setSubData(c,g*a,g*a,(g+b)*a):d.buffers[e].data.vertexBuffer.setData(c)))};a.prototype._uploadIndices=function(a,c,e,g){var b=this.geometryMap[c];
b&&(a=a.geometries[c].indexBuffer.buffer,b.data.indexBuffer&&0<a.byteLength&&(null!=e&&null!=g?b.data.indexBuffer.setSubData(a,4*e,4*e,4*(e+g)):b.data.indexBuffer.setData(a)))};return a}();a.default=c})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.magnifier={name:"magnifier",shaders:{vertexShader:g.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:g.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};a.createMagnifierProgram=function(c){return l.createProgram(c,a.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,"__esModule",{value:!0});
c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(k.create(),a);return new f.BitmapTile(a,b,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var c=this,d=b.registerRenderPass({name:"bitmap (tile)",brushes:[h.brushes.Bitmap],target:function(){return c.children.map(function(a){return a.bitmap})},drawPhase:e.WGLDrawPhase.MAP});return a.prototype.prepareRenderPasses.call(this,
b).concat([d])};b.prototype.doRender=function(b){this.visible&&b.drawPhase===e.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,b)};return b}(p.default);a.BitmapTileContainer=c})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g(b,a);c=b;b.prototype.writeLevels=function(a,b,c){for(var d in a){b.stops=this.levels[d];break}};b.prototype.clone=function(){return new c({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:e.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:e.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:k.clone(this.levels)})};var c;l([h.property()],b.prototype,"levels",void 0);l([h.writer("levels")],
b.prototype,"writeLevels",null);return b=c=l([h.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],b)}(h.declared(f));a.LevelDependentSizeVariable=c})},"esri/views/2d/layers/features/controllers/BaseController":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../layers/graphics/data/attributeSupport ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../../../../../renderers/support/jsonUtils ../../../../../tasks/support/QuantizationParameters ../../../../../tasks/support/Query ../../../engine ../support/AttributeStore ../support/ClusterStore ../support/pixelBuffering".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B){function E(a){var b=a&&a.getSymbols();return"backgroundFillSymbol"in a&&null!=a.backgroundFillSymbol&&"outline"in a.backgroundFillSymbol&&null!=a.backgroundFillSymbol.outline||b.some(function(a){return"outline"in a&&null!=a.outline})}function F(a,b,c){function d(a){if(!a)return!1;a=a.type;return"simple-marker"===a||"picture-marker"===a||"text"===a||"web-style"===a||"cim"===a}if("esriGeometryPolygon"===b&&a.labelingInfo)return!0;if("esriGeometryPolygon"!==
b)return!1;switch(c.type){case "simple":return d(c.symbol);case "unique-value":return d(c.defaultSymbol)||c.uniqueValueInfos.some(function(a){return d(a.symbol)});case "class-breaks":return d(c.defaultSymbol)||c.classBreakInfos.some(function(a){return d(a.symbol)});case "dot-density":return!1;default:return!0}}Object.defineProperty(a,"__esModule",{value:!0});var H=d.getLogger("esri.views.2d.layers.features.controllers.BaseController");c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||
this;b._availableFields=[];b._pixelBuffer=0;b.config=null;b.filters=Array(A.definitions.MAX_FILTERS);b.processor=null;b.remoteClient=null;b.service=null;b.tileStore=null;return b}h(b,a);b.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._initAttributeStore()};b.prototype.startup=function(){return k(this,void 0,void 0,function(){return g(this,function(a){switch(a.label){case 0:return this._initAttributeStore(),[4,this.attributeStore.setAttributeBindings(this.renderer,
this.arcadeInfo)];case 1:return a.sent(),[4,r.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return a.sent(),[2]}})})};b.prototype.destroy=function(){this.attributeStore&&this.attributeStore.destroy()};Object.defineProperty(b.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"featureReduction",{get:function(){return this.config.featureReduction},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"fieldsIndex",{get:function(){return new w(this.service.fields)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||F(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"returnOutline",{get:function(){var a;a:{switch(this.service.geometryType){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryMultipoint":a=!0;break a;case "esriGeometryPolygon":a=E(this.renderer);break a}a=void 0}return a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"queryInfo",{get:function(){return{returnCentroid:this.returnCentroid,returnGeometry:!0,outFields:this.availableFields,definitionExpression:this.config.definitionExpression,
gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"renderer",{get:function(){return this.config?t.fromJSON(this.config.renderer):(H.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"availableFields",{get:function(){var a=this,b=this.config.availableFields.filter(function(b){return-1===a._availableFields.indexOf(b)});
return this._availableFields=this._availableFields.concat(b)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||1}},enumerable:!0,configurable:!0});b.prototype.getObjectId=function(a){return this.attributeStore.getFeatureId(a)};b.prototype.getAggregate=
function(a){return null};b.prototype.getAggregateValueRanges=function(){return{}};b.prototype.getLocalId=function(a){return this.attributeStore.getLocalId(a)};b.prototype.mapValidLocalIds=function(a){var b=this;return a.map(function(a){return b.attributeStore.getLocalId(a)}).filter(function(a){return null!=a})};b.prototype.setViewState=function(a){this._set("viewState",a)};b.prototype.updatePixelBuffer=function(){return k(this,void 0,void 0,function(){var a;return g(this,function(b){switch(b.label){case 0:return[4,
B.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return a=b.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,a),[2]}})})};b.prototype.setHighlight=function(a){return k(this,void 0,void 0,function(){return g(this,function(b){return[2,this.attributeStore.setHighlight(a)]})})};b.prototype.validateConfig=function(a){var b=0;for(a=a.filters;b<a.length;b++){var c=a[b];if(m.isSome(c)&&c.where)try{u.validateWhere(this.fieldsIndex,c.where)}catch(R){throw new e("mapview-bad-filter",R.message,
{filter:c,missingFields:R.details});}}};b.prototype.onFeatureAdd=function(a){a.localId=this.attributeStore.createLocalId(a.objectId);this.attributeStore.setAttributeData(a.localId,a,this.geometryInfo,this.viewParams)};b.prototype.onFeatureRemove=function(a){this.attributeStore.freeLocalId(a.objectId)};b.prototype.enableEvent=function(a){};b.prototype._initAttributeStore=function(){var a=this;this.attributeStore?this.attributeStore.invalidateResources():this.attributeStore=new C.default({type:"remote",
initialize:function(b,c){return a.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",b,{signal:c})},update:function(b,c){return a.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",b,{signal:c})},render:function(){return a.remoteClient.invoke("tileRenderer.featuresView.requestRender")}})};b.prototype._createQueryEngine=function(a){return new y.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,
objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:a,timeInfo:this.service.timeInfo})};b.prototype._createTempQueryEngine=function(a){void 0===a&&(a=this._createFeatureStore());return this._createQueryEngine(a)};b.prototype._createFeatureStore=function(){return new D.ClusterStore({geometryType:this.service.geometryType,hasM:!1,hasZ:!1},this.spatialReference,this.attributeStore,this.featureReduction)};b.prototype._createDefaultQuery=
function(a){var b=new z,c=a.outFields,d=this.config,e=d.gdbVersion,f=d.historicMoment,d=d.definitionExpression,c=.75<=c.length/this.service.fields.length?["*"]:c;b.gdbVersion=e;b.historicMoment=null!=f?new Date(f):null;b.num=a.num;b.outFields=c;b.outSpatialReference=this.spatialReference;b.returnGeometry=a.returnGeometry;b.returnCentroid=a.returnCentroid;b.start=a.resultOffset;b.where=d||"1\x3d1";return b};b.prototype._createQuery=function(a,b,c,d,e,f){var h=this.service.geometryType;d=this._createDefaultQuery(d);
d.maxRecordCountFactor=e;d.returnExceededLimitFeatures=f;d.resultType="tile";d.geometry=a;if(this.service.capabilities.query.supportsQuantization)d.quantizationParameters=new v.default({mode:"view",originPosition:"upper-left",tolerance:c,extent:b}),"esriGeometryPolyline"===h&&(d.maxAllowableOffset=c);else if("esriGeometryPolyline"===h||"esriGeometryPolygon"===h)d.maxAllowableOffset=c;return d};b.prototype.hasGeometryFilter=function(){return this.filters.some(function(a){return m.isSome(a)&&!!a.geometry})};
l([n.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],b.prototype,"arcadeInfo",null);l([n.property()],b.prototype,"config",void 0);l([n.property({readOnly:!0,dependsOn:["config"]})],b.prototype,"featureReduction",null);l([n.property({readOnly:!0,dependsOn:["service"]})],b.prototype,"fieldsIndex",null);l([n.property()],b.prototype,"filters",void 0);l([n.property({readOnly:!0,dependsOn:["service"]})],b.prototype,"geometryInfo",null);l([n.property({readOnly:!0,dependsOn:["config"]})],
b.prototype,"returnCentroid",null);l([n.property({readOnly:!0,dependsOn:["service","config"]})],b.prototype,"returnOutline",null);l([n.property({readOnly:!0,dependsOn:["config","availableFields"]})],b.prototype,"queryInfo",null);l([n.property({dependsOn:["config"],readOnly:!0})],b.prototype,"renderer",null);l([n.property()],b.prototype,"processor",void 0);l([n.property({readOnly:!0,dependsOn:["config"]})],b.prototype,"availableFields",null);l([n.property({constructOnly:!0})],b.prototype,"remoteClient",
void 0);l([n.property({constructOnly:!0})],b.prototype,"service",void 0);l([n.property({dependsOn:["tileStore"]})],b.prototype,"spatialReference",null);l([n.property({constructOnly:!0})],b.prototype,"tileInfo",void 0);l([n.property({constructOnly:!0})],b.prototype,"tileStore",void 0);l([n.property({readOnly:!0})],b.prototype,"viewState",void 0);l([n.property({readOnly:!0,dependsOn:["viewState"]})],b.prototype,"viewParams",null);return b=l([n.subclass("esri.views.2d.layers.features.controllers.BaseController")],
b)}(n.declared(p.HandleOwner));a.default=c})},"esri/core/HandleOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./Handles ./accessorSupport/decorators ../views/support/WatchUpdatingTracking".split(" "),function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});a.HandleOwnerMixin=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.destroy=function(){this.destroyed||
(this.handles.destroy(),this.updatingHandles.destroy())};Object.defineProperty(b.prototype,"handles",{get:function(){return this._get("handles")||new h},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"updatingHandles",{get:function(){return this._get("updatingHandles")||new e.WatchUpdatingTracking},enumerable:!0,configurable:!0});g([f.property({readOnly:!0})],b.prototype,"handles",null);g([f.property({readOnly:!0})],b.prototype,"updatingHandles",null);return b=g([f.subclass("esri.core.HandleOwner")],
b)}(f.declared(a))};c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);return b=g([f.subclass("esri.core.HandleOwner")],b)}(f.declared(a.HandleOwnerMixin(k)));a.HandleOwner=c})},"esri/core/Handles":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./Collection ./accessorSupport/decorators".split(" "),function(c,a,l,g,k,h,f){return function(a){function c(b){b=a.call(this,b)||this;b._groups=new Map;return b}
l(c,a);c.prototype.destroy=function(){this.removeAll()};Object.defineProperty(c.prototype,"size",{get:function(){var a=0;this._groups.forEach(function(b){a+=b.length});return a},enumerable:!0,configurable:!0});c.prototype.add=function(a,c){var b=this;if(!this._isHandle(a)&&!Array.isArray(a)&&!h.isCollection(a))return this;var d=this._getOrCreateGroup(c);Array.isArray(a)||h.isCollection(a)?a.forEach(function(a){return b._isHandle(a)&&d.push(a)}):d.push(a);this.notifyChange("size");return this};c.prototype.forEach=
function(a,c){if("function"===typeof a)this._groups.forEach(function(b){return b.forEach(a)});else{var b=this._getGroup(a);b&&b.forEach(c)}};c.prototype.has=function(a){return this._groups.has(this._ensureGroupKey(a))};c.prototype.remove=function(a){if(Array.isArray(a)||h.isCollection(a))return a.forEach(this.remove,this),this;if(!this.has(a))return this;for(var b=this._getGroup(a),c=0;c<b.length;c++)b[c].remove();this._deleteGroup(a);this.notifyChange("size");return this};c.prototype.removeAll=function(){this._groups.forEach(function(a){for(var b=
0;b<a.length;b++)a[b].remove()});this._groups.clear();this.notifyChange("size");return this};c.prototype._isHandle=function(a){return a&&!!a.remove};c.prototype._getOrCreateGroup=function(a){if(this.has(a))return this._getGroup(a);var b=[];this._groups.set(this._ensureGroupKey(a),b);return b};c.prototype._getGroup=function(a){return this._groups.get(this._ensureGroupKey(a))};c.prototype._deleteGroup=function(a){return this._groups.delete(this._ensureGroupKey(a))};c.prototype._ensureGroupKey=function(a){return a||
"_default_"};g([f.property({readOnly:!0})],c.prototype,"size",null);return c=g([f.subclass("esri.core.Handles")],c)}(f.declared(k))})},"esri/views/support/WatchUpdatingTracking":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/Accessor ../../core/Handles ../../core/scheduling ../../core/watchUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/wire".split(" "),function(c,a,l,g,k,h,f,e,p,b){Object.defineProperty(a,
"__esModule",{value:!0});c=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.updating=!1;b.handleId=0;b.handles=new h;b.scheduleHandleId=0;b.pendingPromises=new Set;return b}g(c,a);c.prototype.destroy=function(){this.removeAll();this.handles.destroy()};c.prototype.add=function(a,b,c,d){var f=this;void 0===d&&(d=0);var h=0!==(d&1),g=++this.handleId;h||this.installSyncUpdatingWatch(a,b,g);a=0!==(d&2)?e.init(a,b,c,h):a.watch(b,c,h);this.handles.add(a,g);return{remove:function(){f.handles.remove(g)}}};
c.prototype.addOnCollectionPropertyChange=function(a,b,c,d){var f=this;void 0===d&&(d=0);d=0!==(d&2);var h=++this.handleId;this.handles.add([e.on(a,b,"after-changes",this.createSyncUpdatingCallback()),e.on(a,b,"change",c,d?function(a){c({added:a.items,removed:[],moved:[],target:a})}:null)],h);return{remove:function(){f.handles.remove(h)}}};c.prototype.addOnCollectionChange=function(a,b,c){var d=this;void 0===c&&(c=0);c=0!==(c&2);var e=++this.handleId;this.handles.add([a.on("after-changes",this.createSyncUpdatingCallback()),
a.on("change",b)],e);c&&b({added:a.items,removed:[],moved:[],target:a});return{remove:function(){d.handles.remove(e)}}};c.prototype.addPromise=function(a){var b=this;if(!a)return a;var c=++this.handleId;this.handles.add({remove:function(){b.pendingPromises.delete(a)&&(0!==b.pendingPromises.size||b.handles.has(d)||b._set("updating",!1))}},c);this.pendingPromises.add(a);this._set("updating",!0);var e=function(){return b.handles.remove(c)};a.then(e,e);return a};c.prototype.removeAll=function(){this.pendingPromises.clear();
this.handles.removeAll();this._set("updating",!1)};c.prototype.installSyncUpdatingWatch=function(a,c,d){a=b.default(a,c,this.createSyncUpdatingCallback());this.handles.add(a,d);return a};c.prototype.createSyncUpdatingCallback=function(){var a=this;return function(){a.handles.remove(d);++a.scheduleHandleId;var b=a.scheduleHandleId;a._get("updating")||a._set("updating",!0);a.handles.add(f.schedule(function(){b===a.scheduleHandleId&&(a._set("updating",0<a.pendingPromises.size),a.handles.remove(d))}),
d)}};l([p.property({readOnly:!0})],c.prototype,"updating",void 0);return c=l([p.subclass("esri.views.support.WatchUpdatingTracking")],c)}(p.declared(k));a.WatchUpdatingTracking=c;var d=-42})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/iteratorUtils ../../../core/sql/WhereClauseCache".split(" "),function(c,a,l,g,k,h){function f(a,c){return a?b.get(a,c):null}function e(a,b,c,d){void 0===d&&(d=
!0);for(var h=[],k=0;k<b.length;k++){var m=b[k];if("*"!==m&&!a.has(m))if(d){var l=p(m);try{var n=f(l,a);if(!n)throw new g("feature-store:unsupported-query","invalid SQL expression",{where:l});if(!n.isStandardized)throw new g("feature-store:unsupported-query","expression is not standard",{clause:n});e(a,n.fieldNames,"expression contains missing fields")}catch(A){if((l=A&&A.details)&&(l.clause||l.where))throw A;l&&l.missingFields?h.push.apply(h,l.missingFields):h.push(m)}}else h.push(m)}if(h.length)throw new g("feature-store:unsupported-query",
c,{missingFields:h});}function p(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var b=new h.WhereClauseCache(50,500),d=k.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,c){if(!c)return!0;var d=b.get(c,a);if(!d)throw new g("feature-store:unsupported-query","invalid SQL expression",{where:c});if(!d.isStandardized)throw new g("feature-store:unsupported-query",
"where clause is not standard",{where:c});e(a,d.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,c,d){if(!c)return!0;var f=b.get(c,a);if(!f)throw new g("feature-store:unsupported-query","invalid SQL expression",{having:c});if(!f.isAggregate)throw new g("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:c});e(a,f.fieldNames,"having contains missing fields");if(!f.getExpressions().every(function(b){var c=b.aggregateType;
b=b.field;var e=a.has(b)&&a.get(b).name;return d.some(function(b){var d=b.onStatisticField;b=b.statisticType;return(a.has(d)&&a.get(d).name)===e&&b.toLowerCase().trim()===c})}))throw new g("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:c});return!0};a.getWhereClause=f;a.validateFields=e;a.getExpressionFromFieldName=p;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!d.has(a.type):
!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c){this._cache=new l(a);this._invalidCache=new l(c)}a.prototype.get=function(a,c){var e=c.uid+":"+a,f=this._cache.get(e);if(f)return f;if(void 0!==this._invalidCache.get(e))return null;try{var b=g.WhereClause.create(a,c);this._cache.put(e,b);return b}catch(d){return this._invalidCache.put(e,null),
null}};return a}();a.WhereClauseCache=c})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(c,a,l){return function(){function a(a,c){this._storage=new l.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=
function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../iteratorUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(c,a,l,g,k,h,f){function e(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function p(a,b,c,d,f,h,g,k,m){void 0===c&&(c="0");void 0===d&&(d="0");void 0===f&&(f="0");void 0===h&&(h="0");void 0===g&&(g="");void 0===k&&(k="0");void 0===m&&(m="0");return"+"===g||"-"===g?
(a=e(parseInt(a,10),4)+"-"+e(parseInt(b,10),2)+"-"+e(parseInt(c,10),2),b="",10>parseFloat(h)&&(b="0"),d=e(parseInt(d,10),2)+":"+e(parseInt(f,10),2)+":"+(b+parseFloat(h).toString()),g=""+g+e(parseInt(k,10),2)+":"+e(parseInt(m,10),2),new Date(a+"T"+d+g)):new Date(parseInt(a,10),parseInt(b,10),parseInt(c,10),parseInt(d,10),parseInt(f,10),parseFloat(h))}function b(a){var b=B.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],e=b[4],f=b[5],h=b[6];return p(a,c,d,e,f,h)}b=E.exec(a);if(null!==b){a=b[1];var c=
b[2],d=b[3],e=b[4],f=b[5],h=b[6],g=b[7],k=b[8],b=b[9];return p(a,c,d,e,f,h,g,k,b)}b=F.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],f=b[5],g=b[6],k=b[7],b=b[8],p(a,c,d,e,f,"0",g,k,b);b=H.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],f=b[5],p(a,c,d,e,f);b=D.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],p(a,c,d);throw Error("SQL Invalid Timestamp");}function d(a){a=D.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,
10)-1,parseInt(c,10))}function m(a){return Array.isArray(a)?a:[a]}function r(a){return null!==a?!0!==a:null}function n(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function u(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function y(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var e=b[d];if(null==e)c=null;else if(a===e){c=!0;break}}return c}function w(a,b,c){if(null==a)return null;for(var d="",e=0,f=0;f<b.length;f++){var h=b.charAt(f);switch(e){case 0:h===
c?e=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(h)?d+("\\"+h):"%"===h?d+".*":"_"===h?d+".":d+h;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(h)?d+("\\"+h):d+h,e=0}}return(new RegExp("^"+d+"$")).test(a)}function t(a){return a instanceof Date?a.valueOf():a}function v(a,b,c){if(null==b||null==c)return null;b=t(b);c=t(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function z(a){for(var b=
[],c={},d=0;d<a.length;d++){var e=a[d],f=e.toLowerCase();void 0===c[f]&&(b.push(e),c[f]=1)}return b}function A(a,b,c){if(b instanceof h.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+c.getTime());case "-":return b.valueInMilliseconds()-c.getTime();case "*":return b.valueInMilliseconds()*c.getTime();case "/":return b.valueInMilliseconds()/c.getTime()}else if(c instanceof h.SqlInterval)switch(a){case "+":return h.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+
c.valueInMilliseconds());case "-":return h.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-c.valueInMilliseconds());case "*":return b.valueInMilliseconds()*c.valueInMilliseconds();case "/":return b.valueInMilliseconds()/c.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(c instanceof h.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+b.getTime());case "-":return new Date(b.getTime()-c.valueInMilliseconds());case "*":return b.getTime()*
c.valueInMilliseconds();case "/":return b.getTime()/c.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof c)switch(c*=864E5,b=b.getTime(),a){case "+":return new Date(b+c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}else if(c instanceof Date&&"number"===typeof b)switch(b*=864E5,c=c.getTime(),a){case "+":return new Date(b+c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/
c)}switch(a){case "+":return b+c;case "-":return b-c;case "*":return b*c;case "/":return b/c}}function C(a,b,c,d){a=d.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var D=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,B=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,
H=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,J=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,d){return C(a,b,c,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return w(a,b,c)};a.ensureArray=function(a){return m(a)};a.applyIn=function(a,b){return y(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=function(a,b,c){return h.SqlInterval.createFromValueAndQualifer(a,b,c)};a.convertInterval=
function(a){return a instanceof h.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return v(a,b,c)};a.calculate=function(a,b,c){return A(a,b,c)};a.makeComparable=function(a){return t(a)};a.evaluateFunction=function(a,b){return h.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==
b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return r(a)};a.ternaryAnd=function(a,b){return n(a,b)};a.ternaryOr=function(a,b){return u(a,b)};return a}();c=function(){function c(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=f.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;this.isStandardized=b;this.isAggregate=c}c.create=function(a,b){return new c(a,b)};Object.defineProperty(c.prototype,
"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});c.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var d={},e=function(a){d[a]=b.map(function(b){return c.getAttribute(b,a)})},f=0,h=this.fieldNames;f<h.length;f++)e(h[f]);return!!this.evaluateNode(this.parseTree,{attributes:d},a.defaultAttributeAdapter)};c.prototype.calculateValue=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,c);
return b instanceof h.SqlInterval?b.valueInMilliseconds()/864E5:b};c.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(l("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};c.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);
return!!this.evaluateNode(this.parseTree,b,c)};c.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(void 0===this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(l("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};c.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===
b.type&&a.push(b.name.toLowerCase())});return z(a)};c.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var d=c+"-"+b;a.has(d)||a.set(d,{aggregateType:c,field:b})}}});return g.valuesOfMap(a)};c.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return z(a)};c.prototype.compileMe=
function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(J)};c.prototype.extractExpressionInfo=function(a){var b=this,c=[],d=!0,e=!0;this.visitAll(this.parseTree,function(f){switch(f.type){case "column_ref":var g=f.column.toUpperCase();if("CURRENT_DATE"!==g&&"CURRENT_TIMESTAMP"!==g){var m=(g=a.get(f.column))&&g.name;!g||"date"!==g.type&&"esriFieldTypeDate"!==
g.type||(b.datefields[g.name]=1);void 0!==m?(c.push(m),f.column=m):c.push(f.column)}break;case "function":g=f.name,f=f.args.value.length,d&&(d=h.isStandardized(g,f)),e&&(e=k.isAggregate(g,f))}});return{referencedFieldNames:z(c),isStandardized:d,isAggregate:e}};c.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];this.visitAll(e,b)}"simple"===
a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],this.visitAll(e,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};c.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+
","+JSON.stringify(a.op)+")";case "case_expression":var c="";if("simple"===a.format)for(var e="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",c="( ",f=0;f<a.clauses.length;f++)c+=" ("+e+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";else for(c="( ",f=0;f<a.clauses.length;f++)c+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";c=null!==a.else?c+this.evaluateNodeToJavaScript(a.else):c+"null";return c+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":c="[";e=0;for(a=a.value;e<a.length;e++)f=a[e],"["!==c&&(c+=","),c+=this.evaluateNodeToJavaScript(f);return c+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+d(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+b(a.value).getTime().toString()+"))";case "column_ref":return"CURRENT_DATE"===
a.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===a.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};c.prototype.evaluateNode=function(a,c,e){switch(a.type){case "interval":return c=this.evaluateNode(a.value,c,e),h.SqlInterval.createFromValueAndQualifer(c,
a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var f=t(this.evaluateNode(a.operand,c,e)),g=0;g<a.clauses.length;g++){if(f===t(this.evaluateNode(a.clauses[g].operand,c,e)))return this.evaluateNode(a.clauses[g].value,c,e)}else for(g=0;g<a.clauses.length;g++)if(!0===this.evaluateNode(a.clauses[g].operand,c,e))return this.evaluateNode(a.clauses[g].value,c,e);return null!==a.else?this.evaluateNode(a.else,c,e):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":f=
[];g=0;for(a=a.value;g<a.length;g++){var l=a[g];f.push(this.evaluateNode(l,c,e))}return f;case "unary_expr":return r(this.evaluateNode(a.expr,c,e));case "binary_expr":switch(a.operator){case "AND":return n(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "OR":return u(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,c,e);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,c,e);case "IN":return f=m(this.evaluateNode(a.right,c,e)),y(this.evaluateNode(a.left,c,e),f);case "NOT IN":return f=m(this.evaluateNode(a.right,c,e)),r(y(this.evaluateNode(a.left,c,e),f));case "BETWEEN":return f=this.evaluateNode(a.left,c,e),a=this.evaluateNode(a.right,c,e),null==f||null==a[0]||null==a[1]?null:f>=t(a[0])&&f<=t(a[1]);case "NOTBETWEEN":return f=this.evaluateNode(a.left,c,e),a=this.evaluateNode(a.right,c,e),null==f||null==a[0]||null==a[1]?null:
f<t(a[0])||f>t(a[1]);case "LIKE":return w(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e),a.escape);case "NOT LIKE":return r(w(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return v(a.operator,this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "-":case "+":case "*":case "/":return A(a.operator,this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return d(a.value);case "timestamp":return b(a.value);case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(l=new Date,l.setHours(0,0,0,0),l):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:C(c,a.column,this.datefields,e);case "function":return c=this.evaluateNode(a.args,c,e),this.isAggregate?k.aggregateFunction(a.name,c):h.evaluateFunction(a.name,c)}throw Error("Unsupported sql syntax "+a.type);
};return c}();a.WhereClause=c;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(c,a){function l(a){for(var c=0,e=0;e<a.length;e++)c+=a[e];return c/a.length}function g(a){for(var c=l(a),e=a.length,h=0,b=0;b<a.length;b++)h+=Math.pow(a[b]-c,2);return 1<e?h/(e-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,c){var e=
k[a.toLowerCase()];if(null==e)throw Error("Function Not Recognised");if(c.length<e.minParams||c.length>e.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return e.evaluate(c)};a.isAggregate=function(a,c){a=k[a.toLowerCase()];return null!=a&&c>=a.minParams&&c<=a.maxParams};var k={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,
a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:l(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var c=0,e=0;e<a.length;e++)c+=a[e];a=c}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(g(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:g(a[0])}}}})},
"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(c){var f=new a;f.second=c/1E3;return f};a.createFromValueAndQualifer=
function(c,f,e){var h=null,b=new a;b.op="-"===e?"-":"+";if("interval-period"===f.type){a.fixDefaults(f);if("year"===f.period||"month"===f.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(c))b[f.period]=parseFloat(c);else throw Error("Illegal Interval");}else{a.fixDefaults(f.start);a.fixDefaults(f.end);if("year"===f.start.period||"month"===f.start.period)throw Error("Year-Month Intervals not supported");if("year"===f.end.period||"month"===f.end.period)throw Error("Year-Month Intervals not supported");
switch(f.start.period){case "day":switch(f.end.period){case "hour":h=/^[0-9]{1,} [0-9]{1,}$/;if(h.test(c))b[f.start.period]=parseFloat(c.split(" ")[0]),b[f.end.period]=parseFloat(c.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":h=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(h.test(c))b[f.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),b.hour=parseFloat(c[0]),b.minute=parseFloat(c[1]);else throw Error("Illegal Interval");break;case "second":h=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(h.test(c))b[f.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),b.hour=parseFloat(c[0]),b.minute=parseFloat(c[1]),b.second=parseFloat(c[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(f.end.period){case "minute":h=/^[0-9]{1,}:[0-9]{1,}$/;if(h.test(c))b.hour=parseFloat(c.split(":")[0]),b.minute=parseFloat(c.split(":")[1]);else throw Error("Illegal Interval");break;case "second":h=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(h.test(c))c=c.split(":"),b.hour=parseFloat(c[0]),b.minute=parseFloat(c[1]),b.second=parseFloat(c[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(f.end.period){case "second":h=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(h.test(c))c=c.split(":"),b.minute=parseFloat(c[0]),b.second=parseFloat(c[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return b};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=c;a.evaluateFunction=function(a,c){var f=g[a.toLowerCase()];if(null==f)throw Error("Function Not Recognised");if(c.length<f.minParams||c.length>f.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return f.evaluate(c)};a.isStandardized=function(a,c){a=g[a.toLowerCase()];return null!=a&&c>=a.minParams&&
c<=a.maxParams};var g={extract:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(c.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var c=
a[0],f=a[1];return null==c||null==f?null:c.toString().substring(f-1)}if(3===a.length)return c=a[0],f=a[1],a=a[2],null==c||null==f||null==a?null:0>=a?"":c.toString().substring(f-1,f+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];return null==c||null==a?null:a.indexOf(c)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var c=3===a.length,f=c?a[1]:" ",c=c?a[2]:a[1];if(null==f||null==c)return null;f="("+l.escapeRegExpString(f)+")";switch(a[0]){case "BOTH":return c.replace(new RegExp("^"+
f+"*|"+f+"*$","g"),"");case "LEADING":return c.replace(new RegExp("^"+f+"*","g"),"");case "TRAILING":return c.replace(new RegExp(f+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var c=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==c?null:Math.round(c*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var c="",f=0;f<
a.length;f++){if(null==a[f])return null;c+=a[f].toString()}return c}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){}a.parse=function(a){return l.parse(a)};
return a}();a.WhereGrammar=c})},"esri/core/sql/sql92grammar":function(){define([],function(){function c(a,l,g,k){this.message=a;this.expected=l;this.found=g;this.location=k;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,c)}(function(a,c){function g(){this.constructor=a}g.prototype=c.prototype;a.prototype=new g})(c,Error);c.buildMessage=function(a,c){function g(a){return a.charCodeAt(0).toString(16).toUpperCase()}function k(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+g(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+g(a)})}function h(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+g(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+g(a)})}var f={literal:function(a){return'"'+k(a.text)+'"'},"class":function(a){var c="",b;for(b=0;b<a.parts.length;b++)c+=a.parts[b]instanceof Array?h(a.parts[b][0])+"-"+h(a.parts[b][1]):h(a.parts[b]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var c=Array(a.length),b;for(b=0;b<a.length;b++){var d=b,e;e=a[b];e=f[e.type](e);c[d]=e}c.sort();
if(0<c.length){for(a=b=1;b<c.length;b++)c[b-1]!==c[b]&&(c[a]=c[b],a++);c.length=a}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(a)+" but "+(c?'"'+k(c)+'"':"end of input")+" found."};return{SyntaxError:c,parse:function(a,l){function g(a,b){return{type:"literal",text:a,ignoreCase:b}}function k(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function h(b){var c=Sa[b],d;if(!c){for(d=b-1;!Sa[d];)d--;c=Sa[d];
for(c={line:c.line,column:c.column};d<b;)10===a.charCodeAt(d)?(c.line++,c.column=1):c.column++,d++;Sa[b]=c}return c}function f(a,b){var c=h(a),d=h(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function e(a){x<Aa||(x>Aa&&(Aa=x,Ta=[]),Ta.push(a))}function p(){var a,b,c;a=x;b=P();b!==q?(b=d(),b!==q?(c=P(),c!==q?a=b:(x=a,a=q)):(x=a,a=q)):(x=a,a=q);return a}function b(){var a,b,c,e,f,g,h,k;a=x;b=d();if(b!==q){c=[];e=x;f=P();f!==q?(g=va(),g!==q?(h=P(),
h!==q?(k=d(),k!==q?e=f=[f,g,h,k]:(x=e,e=q)):(x=e,e=q)):(x=e,e=q)):(x=e,e=q);for(;e!==q;)c.push(e),e=x,f=P(),f!==q?(g=va(),g!==q?(h=P(),h!==q?(k=d(),k!==q?e=f=[f,g,h,k]:(x=e,e=q)):(x=e,e=q)):(x=e,e=q)):(x=e,e=q);if(c!==q){a={type:"expr_list"};b=[b];for(e=0;e<c.length;e++)b.push(c[e][3]);a.value=b}else x=a,a=q}else x=a,a=q;return a}function d(){var a,b,c,d,e,f,g,h;a=x;b=m();if(b!==q){c=[];d=x;e=P();e!==q?(f=da(),f!==q?(g=P(),g!==q?(h=m(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);
for(;d!==q;)c.push(d),d=x,e=P(),e!==q?(f=da(),f!==q?(g=P(),g!==q?(h=m(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);c!==q?a=b=La(b,c):(x=a,a=q)}else x=a,a=q;return a}function m(){var a,b,c,d,e,f,g,h;a=x;b=r();if(b!==q){c=[];d=x;e=P();e!==q?(f=ba(),f!==q?(g=P(),g!==q?(h=r(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);for(;d!==q;)c.push(d),d=x,e=P(),e!==q?(f=ba(),f!==q?(g=P(),g!==q?(h=r(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);c!==q?a=b=
La(b,c):(x=a,a=q)}else x=a,a=q;return a}function r(){var c,d,f,g,h;c=x;d=aa();d===q&&(d=x,33===a.charCodeAt(x)?(f=$c,x++):(f=q,0===O&&e(ad)),f!==q?(g=x,O++,61===a.charCodeAt(x)?(h=mb,x++):(h=q,0===O&&e(nb)),O--,h===q?g=void 0:(x=g,g=q),g!==q?d=f=[f,g]:(x=d,d=q)):(x=d,d=q));d!==q?(f=P(),f!==q?(g=r(),g!==q?c=d={type:"unary_expr",operator:"NOT",expr:g}:(x=c,c=q)):(x=c,c=q)):(x=c,c=q);if(c===q)if(c=x,d=w(),d!==q)if(f=P(),f!==q){var k,m,l;f=[];g=x;h=P();h!==q?(k=n(),k!==q?(m=P(),m!==q?(l=w(),l!==q?g=h=
[h,k,m,l]:(x=g,g=q)):(x=g,g=q)):(x=g,g=q)):(x=g,g=q);if(g!==q)for(;g!==q;)f.push(g),g=x,h=P(),h!==q?(k=n(),k!==q?(m=P(),m!==q?(l=w(),l!==q?g=h=[h,k,m,l]:(x=g,g=q)):(x=g,g=q)):(x=g,g=q)):(x=g,g=q);else f=q;f!==q&&(f={type:"arithmetic",tail:f});f===q&&(f=x,g=y(),g!==q?(h=P(),h!==q?(h=na(),h!==q?(h=P(),h!==q?(h=b(),h!==q?(k=P(),k!==q?(k=sa(),k!==q?f=g={op:g,right:h}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q),f===q&&(f=x,g=y(),g!==q?(h=P(),h!==q?(h=na(),h!==q?(h=P(),h!==
q?(h=sa(),h!==q?f=g={op:g,right:{type:"expr_list",value:[]}}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q),f===q&&(f=x,g=y(),g!==q?(h=P(),h!==q?(h=F(),h!==q?f=g={op:g,right:h}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q))),f===q&&(f=x,h=aa(),h!==q?(g=P(),g!==q?(g=pa(),g!==q?(k=P(),k!==q?(k=w(),k!==q?(m=P(),m!==q?(m=ba(),m!==q?(h=P(),h!==q?(h=w(),h!==q?f=h={op:"NOT"+g,right:{type:"expr_list",value:[k,h]}}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q),
f===q&&(f=x,h=pa(),h!==q?(g=P(),g!==q?(g=w(),g!==q?(k=P(),k!==q?(k=ba(),k!==q?(m=P(),m!==q?(m=w(),m!==q?f=h={op:h,right:{type:"expr_list",value:[g,m]}}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)),f===q&&(f=x,g=T(),g!==q?(h=P(),h!==q?(h=aa(),h!==q?(h=P(),h!==q?(h=w(),h!==q?f=g={op:g+"NOT",right:h}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q),f===q&&(f=x,g=T(),g!==q?(h=P(),h!==q?(h=w(),h!==q?f=g={op:g,right:h}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q)),f===q&&(f=x,g=
u(),g!==q?(h=P(),h!==q?(h=L(),h!==q?(k=P(),k!==q?(k=x,a.substr(x,6).toLowerCase()===id?(m=a.substr(x,6),x+=6):(m=q,0===O&&e(jd)),m!==q?(m=x,O++,l=B(),O--,l===q?m=void 0:(x=m,m=q),m!==q?k="ESCAPE":(x=k,k=q)):(x=k,k=q),k!==q?(k=P(),k!==q?(k=R(),k!==q?f=g={op:g,right:h,escape:k.value}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q)):(x=f,f=q),f===q&&(f=x,g=u(),g!==q?(h=P(),h!==q?(h=L(),h!==q?f=g={op:g,right:h,escape:""}:(x=f,f=q)):(x=f,f=q)):(x=f,f=q))))));f===q&&(f=null);f!==q?(c=d,
d=f,""==d||void 0==d||null==d?d=c:(f=null,d=f="arithmetic"==d.type?La(c,d.tail):Ja(d.op,c,d.right,d.escape)),c=d):(x=c,c=q)}else x=c,c=q;else x=c,c=q;return c}function n(){var b;a.substr(x,2)===ob?(b=ob,x+=2):(b=q,0===O&&e(bd));b===q&&(62===a.charCodeAt(x)?(b=cd,x++):(b=q,0===O&&e(dd)),b===q&&(a.substr(x,2)===pb?(b=pb,x+=2):(b=q,0===O&&e(ed)),b===q&&(a.substr(x,2)===qb?(b=qb,x+=2):(b=q,0===O&&e(fd)),b===q&&(60===a.charCodeAt(x)?(b=gd,x++):(b=q,0===O&&e(hd)),b===q&&(61===a.charCodeAt(x)?(b=mb,x++):
(b=q,0===O&&e(nb)),b===q&&(a.substr(x,2)===rb?(b=rb,x+=2):(b=q,0===O&&e(kd))))))));return b}function u(){var a,b,c,d;a=a=x;b=aa();b!==q?(c=P(),c!==q?(d=ja(),d!==q?a=b=[b,c,d]:(x=a,a=q)):(x=a,a=q)):(x=a,a=q);a!==q&&(a=a[0]+" "+a[2]);a===q&&(a=ja());return a}function y(){var a,b,c,d;a=a=x;b=aa();b!==q?(c=P(),c!==q?(d=Y(),d!==q?a=b=[b,c,d]:(x=a,a=q)):(x=a,a=q)):(x=a,a=q);a!==q&&(a=a[0]+" "+a[2]);a===q&&(a=Y());return a}function w(){var a,b,c,d,e,f,g,h;a=x;b=v();if(b!==q){c=[];d=x;e=P();e!==q?(f=t(),
f!==q?(g=P(),g!==q?(h=v(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);for(;d!==q;)c.push(d),d=x,e=P(),e!==q?(f=t(),f!==q?(g=P(),g!==q?(h=v(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);c!==q?a=b=La(b,c):(x=a,a=q)}else x=a,a=q;return a}function t(){var b;43===a.charCodeAt(x)?(b=gc,x++):(b=q,0===O&&e(hc));b===q&&(45===a.charCodeAt(x)?(b=ic,x++):(b=q,0===O&&e(jc)));return b}function v(){var a,b,c,d,e,f,g,h;a=x;b=A();if(b!==q){c=[];d=x;e=P();e!==q?(f=z(),f!==q?(g=
P(),g!==q?(h=A(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);for(;d!==q;)c.push(d),d=x,e=P(),e!==q?(f=z(),f!==q?(g=P(),g!==q?(h=A(),h!==q?d=e=[e,f,g,h]:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q);c!==q?a=b=La(b,c):(x=a,a=q)}else x=a,a=q;return a}function z(){var b;42===a.charCodeAt(x)?(b=ld,x++):(b=q,0===O&&e(md));b===q&&(47===a.charCodeAt(x)?(b=nd,x++):(b=q,0===O&&e(od)));return b}function A(){var c,f,g,h,k,m,l;l=R();if(l===q){var n,p,t,r;n=x;var v,u,w,y;v=x;u=U();u!==q?(w=V(),
w!==q?(y=S(),y!==q?v=u=parseFloat(u+w+y):(x=v,v=q)):(x=v,v=q)):(x=v,v=q);v===q&&(v=x,u=U(),u!==q?(w=V(),w!==q?v=u=parseFloat(u+w):(x=v,v=q)):(x=v,v=q),v===q&&(v=x,u=U(),u!==q?(w=S(),w!==q?v=u=parseFloat(u+w):(x=v,v=q)):(x=v,v=q),v===q&&(v=x,u=U(),u!==q&&(u=parseFloat(u)),v=u)));p=v;p!==q?(t=x,O++,r=D(),O--,r===q?t=void 0:(x=t,t=q),t!==q?n=p={type:"number",value:p}:(x=n,n=q)):(x=n,n=q);l=n;if(l===q){var z,A;z=x;var I,G,K,da;I=x;a.substr(x,4).toLowerCase()===pd?(G=a.substr(x,4),x+=4):(G=q,0===O&&e(qd));
G!==q?(K=x,O++,da=B(),O--,da===q?K=void 0:(x=K,K=q),K!==q?I=G=[G,K]:(x=I,I=q)):(x=I,I=q);A=I;A!==q&&(A={type:"bool",value:!0});z=A;if(z===q){z=x;var pa,W,T,X;pa=x;a.substr(x,5).toLowerCase()===rd?(W=a.substr(x,5),x+=5):(W=q,0===O&&e(sd));W!==q?(T=x,O++,X=B(),O--,X===q?T=void 0:(x=T,T=q),T!==q?pa=W=[W,T]:(x=pa,pa=q)):(x=pa,pa=q);A=pa;A!==q&&(A={type:"bool",value:!1});z=A}l=z;if(l===q){var ja,aa,ba,fa,va;aa=x;a.substr(x,4).toLowerCase()===td?(ba=a.substr(x,4),x+=4):(ba=q,0===O&&e(ud));ba!==q?(fa=x,
O++,va=B(),O--,va===q?fa=void 0:(x=fa,fa=q),fa!==q?aa=ba=[ba,fa]:(x=aa,aa=q)):(x=aa,aa=q);ja=aa;ja!==q&&(ja={type:"null",value:null});l=ja;if(l===q){var ra,Aa,Ka,Ja;ra=x;var Ua,La,sb,Sa;Ua=x;a.substr(x,4).toLowerCase()===vd?(La=a.substr(x,4),x+=4):(La=q,0===O&&e(wd));La!==q?(sb=x,O++,Sa=B(),O--,Sa===q?sb=void 0:(x=sb,sb=q),sb!==q?Ua=La="DATE":(x=Ua,Ua=q)):(x=Ua,Ua=q);Aa=Ua;Aa!==q?(Ka=P(),Ka!==q?(Ja=L(),Ja!==q?ra=Aa={type:"date",value:Ja.value}:(x=ra,ra=q)):(x=ra,ra=q)):(x=ra,ra=q);l=ra;if(l===q){var Oa,
Ra,ab,Ta;Oa=x;var Va,Lb,tb,kb;Va=x;a.substr(x,9).toLowerCase()===xd?(Lb=a.substr(x,9),x+=9):(Lb=q,0===O&&e(yd));Lb!==q?(tb=x,O++,kb=B(),O--,kb===q?tb=void 0:(x=tb,tb=q),tb!==q?Va=Lb="TIMESTAMP":(x=Va,Va=q)):(x=Va,Va=q);Ra=Va;Ra!==q?(ab=P(),ab!==q?(Ta=L(),Ta!==q?Oa=Ra={type:"timestamp",value:Ta.value}:(x=Oa,Oa=q)):(x=Oa,Oa=q)):(x=Oa,Oa=q);l=Oa;if(l===q){var ga,bb,Mb,Ma,Nb,cb,lb,kc;ga=x;bb=qa();bb!==q?(Mb=P(),Mb!==q?(45===a.charCodeAt(x)?(Ma=ic,x++):(Ma=q,0===O&&e(jc)),Ma===q&&(43===a.charCodeAt(x)?
(Ma=gc,x++):(Ma=q,0===O&&e(hc))),Ma!==q?(Nb=P(),Nb!==q?(cb=L(),cb!==q?(lb=P(),lb!==q?(kc=J(),kc!==q?ga=bb={type:"interval",value:cb,qualifier:kc,op:Ma}:(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q);ga===q&&(ga=x,bb=qa(),bb!==q?(Mb=P(),Mb!==q?(Ma=L(),Ma!==q?(Nb=P(),Nb!==q?(cb=J(),cb!==q?ga=bb={type:"interval",value:Ma,qualifier:cb,op:""}:(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q)):(x=ga,ga=q));l=ga}}}}}}c=l;if(c===q){var ka,lc,mb,nb,ob,mc,pb,qb,rb,
nc,Db,Eb;ka=x;var Wa,Ob,ub,Fb;Wa=x;a.substr(x,7).toLowerCase()===zd?(Ob=a.substr(x,7),x+=7):(Ob=q,0===O&&e(Ad));Ob!==q?(ub=x,O++,Fb=B(),O--,Fb===q?ub=void 0:(x=ub,ub=q),ub!==q?Wa=Ob="EXTRACT":(x=Wa,Wa=q)):(x=Wa,Wa=q);lc=Wa;if(lc!==q)if(mb=P(),mb!==q)if(nb=na(),nb!==q)if(ob=P(),ob!==q){var Ea;Ea=ma();Ea===q&&(Ea=oa(),Ea===q&&(Ea=Ba(),Ea===q&&(Ea=ua(),Ea===q&&(Ea=Da(),Ea===q&&(Ea=xa())))));mc=Ea;mc!==q?(pb=P(),pb!==q?(qb=ea(),qb!==q?(rb=P(),rb!==q?(nc=d(),nc!==q?(Db=P(),Db!==q?(Eb=sa(),Eb!==q?ka=lc=
{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:mc},nc]}}:(x=ka,ka=q)):(x=ka,ka=q)):(x=ka,ka=q)):(x=ka,ka=q)):(x=ka,ka=q)):(x=ka,ka=q)):(x=ka,ka=q)}else x=ka,ka=q;else x=ka,ka=q;else x=ka,ka=q;else x=ka,ka=q;c=ka;if(c===q){var ia,oc,Gb,Hb,Ib,Pb,Jb,Kb,xc,Qb,yc,ya,db,pc,qc,rc;ia=x;var Xa,Rb,vb,zc;Xa=x;a.substr(x,9).toLowerCase()===Bd?(Rb=a.substr(x,9),x+=9):(Rb=q,0===O&&e(Cd));Rb!==q?(vb=x,O++,zc=B(),O--,zc===q?vb=void 0:(x=vb,vb=q),vb!==q?Xa=Rb="SUBSTRING":(x=Xa,
Xa=q)):(x=Xa,Xa=q);oc=Xa;if(oc!==q)if(Gb=P(),Gb!==q)if(Hb=na(),Hb!==q)if(Ib=P(),Ib!==q)if(Pb=d(),Pb!==q)if(Jb=P(),Jb!==q)if(Kb=ea(),Kb!==q)if(xc=P(),xc!==q)if(Qb=d(),Qb!==q)if(yc=P(),yc!==q){ya=x;var Ya,Sb,wb,Ac;Ya=x;a.substr(x,3).toLowerCase()===Dd?(Sb=a.substr(x,3),x+=3):(Sb=q,0===O&&e(Ed));Sb!==q?(wb=x,O++,Ac=B(),O--,Ac===q?wb=void 0:(x=wb,wb=q),wb!==q?Ya=Sb="FOR":(x=Ya,Ya=q)):(x=Ya,Ya=q);db=Ya;db!==q?(pc=P(),pc!==q?(qc=d(),qc!==q?(rc=P(),rc!==q?ya=db=[db,pc,qc,rc]:(x=ya,ya=q)):(x=ya,ya=q)):(x=
ya,ya=q)):(x=ya,ya=q);ya===q&&(ya=null);ya!==q?(db=sa(),db!==q?ia=oc={type:"function",name:"substring",args:{type:"expr_list",value:ya?[Pb,Qb,ya[2]]:[Pb,Qb]}}:(x=ia,ia=q)):(x=ia,ia=q)}else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;else x=ia,ia=q;c=ia;if(c===q){var Z,eb,Tb,Ub,Vb,Fa,Wb,fb,Xb,Yb,Bc,sc,Cc,Dc;Z=x;eb=ta();eb!==q?(Tb=P(),Tb!==q?(Ub=na(),Ub!==q?(Vb=P(),Vb!==q?(Fa=H(),Fa===q&&(Fa=null),Fa!==q?(Wb=P(),Wb!==
q?(fb=d(),fb!==q?(Xb=P(),Xb!==q?(Yb=ea(),Yb!==q?(Bc=P(),Bc!==q?(sc=d(),sc!==q?(Cc=P(),Cc!==q?(Dc=sa(),Dc!==q?Z=eb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Fa?"BOTH":Fa},fb,sc]}}:(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q);Z===q&&(Z=x,eb=ta(),eb!==q?(Tb=P(),Tb!==q?(Ub=na(),Ub!==q?(Vb=P(),Vb!==q?(Fa=H(),Fa===q&&(Fa=null),Fa!==q?(Wb=P(),Wb!==q?(fb=d(),fb!==q?
(Xb=P(),Xb!==q?(Yb=sa(),Yb!==q?Z=eb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Fa?"BOTH":Fa},fb]}}:(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q)):(x=Z,Z=q));c=Z;if(c===q){var la,tc,Ec,Fc,Gc,uc,Hc,Ic,Jc,vc,Kc,Lc;la=x;var Za,Zb,xb,Mc;Za=x;a.substr(x,8).toLowerCase()===Fd?(Zb=a.substr(x,8),x+=8):(Zb=q,0===O&&e(Gd));Zb!==q?(xb=x,O++,Mc=B(),O--,Mc===q?xb=void 0:(x=xb,xb=q),xb!==q?Za=Zb="POSITION":(x=Za,Za=q)):(x=Za,Za=
q);tc=Za;tc!==q?(Ec=P(),Ec!==q?(Fc=na(),Fc!==q?(Gc=P(),Gc!==q?(uc=d(),uc!==q?(Hc=P(),Hc!==q?(Ic=Y(),Ic!==q?(Jc=P(),Jc!==q?(vc=d(),vc!==q?(Kc=P(),Kc!==q?(Lc=sa(),Lc!==q?la=tc={type:"function",name:"position",args:{type:"expr_list",value:[uc,vc]}}:(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q)):(x=la,la=q);c=la;if(c===q){var wa,$b,Nc,Oc,Pc,gb,Qc,Rc;wa=x;var Ga,yb,zb,Na;Ga=x;Ga=yb=C();if(Ga===q)if(Ga=x,96===a.charCodeAt(x)?
(yb=Sc,x++):(yb=q,0===O&&e(Tc)),yb!==q){zb=[];Uc.test(a.charAt(x))?(Na=a.charAt(x),x++):(Na=q,0===O&&e(Vc));if(Na!==q)for(;Na!==q;)zb.push(Na),Uc.test(a.charAt(x))?(Na=a.charAt(x),x++):(Na=q,0===O&&e(Vc));else zb=q;zb!==q?(96===a.charCodeAt(x)?(Na=Sc,x++):(Na=q,0===O&&e(Tc)),Na!==q?Ga=yb=zb.join(""):(x=Ga,Ga=q)):(x=Ga,Ga=q)}else x=Ga,Ga=q;$b=Ga;$b!==q?(Nc=P(),Nc!==q?(Oc=na(),Oc!==q?(Pc=P(),Pc!==q?(gb=b(),gb===q&&(gb=null),gb!==q?(Qc=P(),Qc!==q?(Rc=sa(),Rc!==q?wa=$b={type:"function",name:$b,args:gb?
gb:{type:"expr_list",value:[]}}:(x=wa,wa=q)):(x=wa,wa=q)):(x=wa,wa=q)):(x=wa,wa=q)):(x=wa,wa=q)):(x=wa,wa=q)):(x=wa,wa=q);c=wa;if(c===q){var ac,ca,hb,bc,ib,cc,Pa,Ha,Ab,Wc,Xc;ca=x;hb=Ca();if(hb!==q)if(bc=P(),bc!==q)if(ib=d(),ib!==q)if(cc=P(),cc!==q){Pa=[];for(Ha=Q();Ha!==q;)Pa.push(Ha),Ha=Q();Pa!==q?(Ha=P(),Ha!==q?(Ab=za(),Ab!==q?ca=hb={type:"case_expression",format:"simple",operand:ib,clauses:Pa,else:null}:(x=ca,ca=q)):(x=ca,ca=q)):(x=ca,ca=q)}else x=ca,ca=q;else x=ca,ca=q;else x=ca,ca=q;else x=ca,
ca=q;if(ca===q)if(ca=x,hb=Ca(),hb!==q)if(bc=P(),bc!==q)if(ib=d(),ib!==q)if(cc=P(),cc!==q){Pa=[];for(Ha=Q();Ha!==q;)Pa.push(Ha),Ha=Q();Pa!==q?(Ha=P(),Ha!==q?(Ab=N(),Ab!==q?(Wc=P(),Wc!==q?(Xc=za(),Xc!==q?ca=hb={type:"case_expression",format:"simple",operand:ib,clauses:Pa,else:Ab.value}:(x=ca,ca=q)):(x=ca,ca=q)):(x=ca,ca=q)):(x=ca,ca=q)):(x=ca,ca=q)}else x=ca,ca=q;else x=ca,ca=q;else x=ca,ca=q;else x=ca,ca=q;ac=ca;if(ac===q){var ha,jb,dc,Qa,Ia,Bb,Yc,Zc;ha=x;jb=Ca();if(jb!==q)if(dc=P(),dc!==q){Qa=[];
for(Ia=M();Ia!==q;)Qa.push(Ia),Ia=M();Qa!==q?(Ia=P(),Ia!==q?(Bb=za(),Bb!==q?ha=jb={type:"case_expression",format:"searched",clauses:Qa,else:null}:(x=ha,ha=q)):(x=ha,ha=q)):(x=ha,ha=q)}else x=ha,ha=q;else x=ha,ha=q;if(ha===q)if(ha=x,jb=Ca(),jb!==q)if(dc=P(),dc!==q){Qa=[];for(Ia=M();Ia!==q;)Qa.push(Ia),Ia=M();Qa!==q?(Ia=P(),Ia!==q?(Bb=N(),Bb!==q?(Yc=P(),Yc!==q?(Zc=za(),Zc!==q?ha=jb={type:"case_expression",format:"searched",clauses:Qa,else:Bb.value}:(x=ha,ha=q)):(x=ha,ha=q)):(x=ha,ha=q)):(x=ha,ha=q)):
(x=ha,ha=q)}else x=ha,ha=q;else x=ha,ha=q;ac=ha}c=ac;if(c===q){var Cb,$a,wc,ec,fc;$a=x;wc=D();if(wc!==q){ec=[];for(fc=E();fc!==q;)ec.push(fc),fc=E();ec!==q?$a=wc+=ec.join(""):(x=$a,$a=q)}else x=$a,$a=q;Cb=$a;Cb!==q&&(Cb={type:"column_ref",table:"",column:Cb});c=Cb;c===q&&(c=F(),c===q&&(c=x,f=na(),f!==q?(g=P(),g!==q?(h=d(),h!==q?(k=P(),k!==q?(m=sa(),m!==q?(h.paren=!0,c=f=h):(x=c,c=q)):(x=c,c=q)):(x=c,c=q)):(x=c,c=q)):(x=c,c=q)))}}}}}}}return c}function C(){var a,b,c,d;a=x;b=D();if(b!==q){c=[];for(d=
B();d!==q;)c.push(d),d=B();c!==q?a=b+=c.join(""):(x=a,a=q)}else x=a,a=q;return a}function D(){var b;Hd.test(a.charAt(x))?(b=a.charAt(x),x++):(b=q,0===O&&e(Id));return b}function B(){var b;Jd.test(a.charAt(x))?(b=a.charAt(x),x++):(b=q,0===O&&e(Kd));return b}function E(){var b;Ld.test(a.charAt(x))?(b=a.charAt(x),x++):(b=q,0===O&&e(Md));return b}function F(){var b,c,d;b=x;64===a.charCodeAt(x)?(c=Nd,x++):(c=q,0===O&&e(Od));c!==q?(d=C(),d!==q?b=c=[c,d]:(x=b,b=q)):(x=b,b=q);b!==q&&(b={type:"param",value:b[1]});
return b}function H(){var b,c,d;b=x;a.substr(x,7).toLowerCase()===Pd?(c=a.substr(x,7),x+=7):(c=q,0===O&&e(Qd));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="LEADING":(x=b,b=q)):(x=b,b=q);b===q&&(b=x,a.substr(x,8).toLowerCase()===Rd?(c=a.substr(x,8),x+=8):(c=q,0===O&&e(Sd)),c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="TRAILING":(x=b,b=q)):(x=b,b=q),b===q&&(b=x,a.substr(x,4).toLowerCase()===Td?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(Ud)),c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:
(x=c,c=q),c!==q?b="BOTH":(x=b,b=q)):(x=b,b=q)));return b}function J(){var b,c,d;b=x;var f,g;c=x;d=K();d!==q?(f=P(),f!==q?(f=na(),f!==q?(f=P(),f!==q?(f=I(),f!==q?(g=P(),g!==q?(g=sa(),g!==q?c=d={type:"interval-period",period:d.value,precision:f,secondary:null}:(x=c,c=q)):(x=c,c=q)):(x=c,c=q)):(x=c,c=q)):(x=c,c=q)):(x=c,c=q)):(x=c,c=q);c===q&&(c=x,d=K(),d!==q&&(d=Db(d)),c=d);if(c!==q)if(d=P(),d!==q)if(d=x,a.substr(x,2).toLowerCase()===Vd?(f=a.substr(x,2),x+=2):(f=q,0===O&&e(Wd)),f!==q?(f=x,O++,g=B(),
O--,g===q?f=void 0:(x=f,f=q),f!==q?d="TO":(x=d,d=q)):(x=d,d=q),d!==q)if(d=P(),d!==q){var h;d=x;f=K();f!==q&&(f={type:"interval-period",period:f.value,precision:null,secondary:null});d=f;d===q&&(d=x,f=xa(),f!==q?(f=P(),f!==q?(f=na(),f!==q?(f=P(),f!==q?(f=I(),f!==q?(g=P(),g!==q?(g=va(),g!==q?(g=P(),g!==q?(g=G(),g!==q?(h=P(),h!==q?(h=sa(),h!==q?d=f=Eb(f,g):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q),d===q&&(d=x,f=xa(),f!==q?
(f=P(),f!==q?(f=na(),f!==q?(f=P(),f!==q?(f=I(),f!==q?(g=P(),g!==q?(g=sa(),g!==q?d=f={type:"interval-period",period:"second",precision:f,secondary:null}:(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q)):(x=d,d=q),d===q&&(d=x,f=xa(),f!==q&&(f={type:"interval-period",period:"second",precision:null,secondary:null}),d=f)));d!==q?b=c={type:"interval-qualifier",start:c,end:d}:(x=b,b=q)}else x=b,b=q;else x=b,b=q;else x=b,b=q;else x=b,b=q;b===q&&(b=x,d=K(),d!==q?(c=P(),c!==q?(c=na(),c!==q?
(c=P(),c!==q?(c=G(),c!==q?(f=P(),f!==q?(f=sa(),f!==q?b=d={type:"interval-period",period:d.value,precision:c,secondary:null}:(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q),b===q&&(b=x,d=K(),d!==q&&(d=Db(d)),b=d,b===q&&(b=x,d=xa(),d!==q?(c=P(),c!==q?(c=na(),c!==q?(c=P(),c!==q?(c=I(),c!==q?(f=P(),f!==q?(f=va(),f!==q?(d=P(),d!==q?(d=G(),d!==q?(f=P(),f!==q?(f=sa(),f!==q?b=d=Eb(c,d):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,
b=q)):(x=b,b=q)):(x=b,b=q),b===q&&(b=x,d=xa(),d!==q?(c=P(),c!==q?(c=na(),c!==q?(c=P(),c!==q?(c=G(),c!==q?(f=P(),f!==q?(f=sa(),f!==q?b=d={type:"interval-period",period:"second",precision:c,secondary:null}:(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q)):(x=b,b=q),b===q&&(b=x,d=xa(),d!==q&&(d={type:"interval-period",period:"second",precision:null,secondary:null}),b=d)))));return b}function K(){var a;a=x;a=Ba();a!==q&&(a={type:"string",value:"day"});a===q&&(a=x,a=ua(),a!==q&&(a={type:"string",
value:"hour"}),a===q&&(a=x,a=Da(),a!==q&&(a={type:"string",value:"minute"}),a===q&&(a=x,a=oa(),a!==q&&(a={type:"string",value:"month"}),a===q&&(a=x,a=ma(),a!==q&&(a={type:"string",value:"year"})))));return a}function G(){var a;a=X();a!==q&&(a=parseFloat(a));return a}function I(){var a;a=X();a!==q&&(a=parseFloat(a));return a}function L(){var a;a=R();a===q&&(a=F());return a}function R(){var b,c,d;b=x;39===a.charCodeAt(x)?(c=Fb,x++):(c=q,0===O&&e(Gb));c===q&&(a.substr(x,2)===Hb?(c=Hb,x+=2):(c=q,0===
O&&e(Xd)));if(c!==q){c=[];d=x;a.substr(x,2)===Ra?(d=Ra,x+=2):(d=q,0===O&&e(Ib));d!==q&&(d="'");d===q&&(Jb.test(a.charAt(x))?(d=a.charAt(x),x++):(d=q,0===O&&e(Kb)));for(;d!==q;)c.push(d),d=x,a.substr(x,2)===Ra?(d=Ra,x+=2):(d=q,0===O&&e(Ib)),d!==q&&(d="'"),d===q&&(Jb.test(a.charAt(x))?(d=a.charAt(x),x++):(d=q,0===O&&e(Kb)));c!==q?(39===a.charCodeAt(x)?(d=Fb,x++):(d=q,0===O&&e(Gb)),d!==q?b=c={type:"string",value:c.join("")}:(x=b,b=q)):(x=b,b=q)}else x=b,b=q;return b}function M(){var a,b,c;a=x;b=ra();
b!==q?(b=P(),b!==q?(b=d(),b!==q?(c=P(),c!==q?(c=fa(),c!==q?(c=P(),c!==q?(c=d(),c!==q?a=b={type:"when_clause",operand:b,value:c}:(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q);return a}function Q(){var a,b,c;a=x;b=ra();b!==q?(b=P(),b!==q?(b=d(),b!==q?(c=P(),c!==q?(c=fa(),c!==q?(c=P(),c!==q?(c=d(),c!==q?a=b={type:"when_clause",operand:b,value:c}:(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q)):(x=a,a=q);return a}function N(){var b,c;b=x;var f,g;c=x;a.substr(x,
4).toLowerCase()===Yd?(f=a.substr(x,4),x+=4):(f=q,0===O&&e(Zd));f!==q?(f=x,O++,g=B(),O--,g===q?f=void 0:(x=f,f=q),f!==q?c="ELSE":(x=c,c=q)):(x=c,c=q);c!==q?(c=P(),c!==q?(c=d(),c!==q?b={type:"else_clause",value:c}:(x=b,b=q)):(x=b,b=q)):(x=b,b=q);return b}function U(){var b,c,d;b=X();b===q&&(b=x,45===a.charCodeAt(x)?(c=ic,x++):(c=q,0===O&&e(jc)),c===q&&(43===a.charCodeAt(x)?(c=gc,x++):(c=q,0===O&&e(hc))),c!==q?(d=X(),d!==q?b=c=c[0]+d:(x=b,b=q)):(x=b,b=q));return b}function V(){var b,c;b=x;46===a.charCodeAt(x)?
(c=$d,x++):(c=q,0===O&&e(ae));c!==q?(c=X(),c===q&&(c=null),c!==q?b="."+(null!=c?c:""):(x=b,b=q)):(x=b,b=q);return b}function S(){var b,c,d;c=b=x;be.test(a.charAt(x))?(d=a.charAt(x),x++):(d=q,0===O&&e(ce));d!==q?(de.test(a.charAt(x))?(d=a.charAt(x),x++):(d=q,0===O&&e(ee)),d===q&&(d=null),d!==q?c="e"+(null===d?"":d):(x=c,c=q)):(x=c,c=q);c!==q?(d=X(),d!==q?b=c+d:(x=b,b=q)):(x=b,b=q);return b}function X(){var a,b;a=[];b=W();if(b!==q)for(;b!==q;)a.push(b),b=W();else a=q;a!==q&&(a=a.join(""));return a}
function W(){var b;fe.test(a.charAt(x))?(b=a.charAt(x),x++):(b=q,0===O&&e(ge));return b}function Y(){var b,c,d;b=x;a.substr(x,2).toLowerCase()===he?(c=a.substr(x,2),x+=2):(c=q,0===O&&e(ie));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="IN":(x=b,b=q)):(x=b,b=q);return b}function T(){var b,c,d;b=x;a.substr(x,2).toLowerCase()===je?(c=a.substr(x,2),x+=2):(c=q,0===O&&e(ke));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="IS":(x=b,b=q)):(x=b,b=q);return b}function ja(){var b,c,d;
b=x;a.substr(x,4).toLowerCase()===le?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(me));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="LIKE":(x=b,b=q)):(x=b,b=q);return b}function aa(){var b,c,d;b=x;a.substr(x,3).toLowerCase()===ne?(c=a.substr(x,3),x+=3):(c=q,0===O&&e(oe));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="NOT":(x=b,b=q)):(x=b,b=q);return b}function ba(){var b,c,d;b=x;a.substr(x,3).toLowerCase()===pe?(c=a.substr(x,3),x+=3):(c=q,0===O&&e(qe));c!==q?(c=x,O++,d=B(),O--,d===
q?c=void 0:(x=c,c=q),c!==q?b="AND":(x=b,b=q)):(x=b,b=q);return b}function da(){var b,c,d;b=x;a.substr(x,2).toLowerCase()===re?(c=a.substr(x,2),x+=2):(c=q,0===O&&e(se));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="OR":(x=b,b=q)):(x=b,b=q);return b}function pa(){var b,c,d;b=x;a.substr(x,7).toLowerCase()===te?(c=a.substr(x,7),x+=7):(c=q,0===O&&e(ue));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="BETWEEN":(x=b,b=q)):(x=b,b=q);return b}function ea(){var b,c,d;b=x;a.substr(x,
4).toLowerCase()===ve?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(we));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="FROM":(x=b,b=q)):(x=b,b=q);return b}function ta(){var b,c,d;b=x;a.substr(x,4).toLowerCase()===xe?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(ye));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="TRIM":(x=b,b=q)):(x=b,b=q);return b}function qa(){var b,c,d;b=x;a.substr(x,8).toLowerCase()===ze?(c=a.substr(x,8),x+=8):(c=q,0===O&&e(Ae));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=
c,c=q),c!==q?b="INTERVAL":(x=b,b=q)):(x=b,b=q);return b}function ma(){var b,c,d;b=x;a.substr(x,4).toLowerCase()===Be?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(Ce));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="YEAR":(x=b,b=q)):(x=b,b=q);return b}function oa(){var b,c,d;b=x;a.substr(x,5).toLowerCase()===De?(c=a.substr(x,5),x+=5):(c=q,0===O&&e(Ee));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="MONTH":(x=b,b=q)):(x=b,b=q);return b}function Ba(){var b,c,d;b=x;a.substr(x,3).toLowerCase()===
Fe?(c=a.substr(x,3),x+=3):(c=q,0===O&&e(Ge));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="DAY":(x=b,b=q)):(x=b,b=q);return b}function ua(){var b,c,d;b=x;a.substr(x,4).toLowerCase()===He?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(Ie));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="HOUR":(x=b,b=q)):(x=b,b=q);return b}function Da(){var b,c,d;b=x;a.substr(x,6).toLowerCase()===Je?(c=a.substr(x,6),x+=6):(c=q,0===O&&e(Ke));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="MINUTE":
(x=b,b=q)):(x=b,b=q);return b}function xa(){var b,c,d;b=x;a.substr(x,6).toLowerCase()===Le?(c=a.substr(x,6),x+=6):(c=q,0===O&&e(Me));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="SECOND":(x=b,b=q)):(x=b,b=q);return b}function Ca(){var b,c,d;b=x;a.substr(x,4).toLowerCase()===Ne?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(Oe));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="CASE":(x=b,b=q)):(x=b,b=q);return b}function za(){var b,c,d;b=x;a.substr(x,3).toLowerCase()===Pe?(c=a.substr(x,
3),x+=3):(c=q,0===O&&e(Qe));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="END":(x=b,b=q)):(x=b,b=q);return b}function ra(){var b,c,d;b=x;a.substr(x,4).toLowerCase()===Re?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(Se));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="WHEN":(x=b,b=q)):(x=b,b=q);return b}function fa(){var b,c,d;b=x;a.substr(x,4).toLowerCase()===Te?(c=a.substr(x,4),x+=4):(c=q,0===O&&e(Ue));c!==q?(c=x,O++,d=B(),O--,d===q?c=void 0:(x=c,c=q),c!==q?b="THEN":(x=b,b=q)):(x=
b,b=q);return b}function va(){var b;44===a.charCodeAt(x)?(b=Ve,x++):(b=q,0===O&&e(We));return b}function na(){var b;40===a.charCodeAt(x)?(b=Xe,x++):(b=q,0===O&&e(Ye));return b}function sa(){var b;41===a.charCodeAt(x)?(b=Ze,x++):(b=q,0===O&&e($e));return b}function P(){var a,b;a=[];for(b=Ka();b!==q;)a.push(b),b=Ka();return a}function Ka(){var b;af.test(a.charAt(x))?(b=a.charAt(x),x++):(b=q,0===O&&e(bf));return b}function Ja(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=
d);return a}function La(a,b){for(var c=0;c<b.length;c++)a=Ja(b[c][1],a,b[c][3]);return a}l=void 0!==l?l:{};var q={},kb={start:p},lb=p,$c="!",ad=g("!",!1),mb="\x3d",nb=g("\x3d",!1),ob="\x3e\x3d",bd=g("\x3e\x3d",!1),cd="\x3e",dd=g("\x3e",!1),pb="\x3c\x3d",ed=g("\x3c\x3d",!1),qb="\x3c\x3e",fd=g("\x3c\x3e",!1),gd="\x3c",hd=g("\x3c",!1),rb="!\x3d",kd=g("!\x3d",!1),gc="+",hc=g("+",!1),ic="-",jc=g("-",!1),ld="*",md=g("*",!1),nd="/",od=g("/",!1),Hd=/^[A-Za-z_\x80-\uFFFF]/,Id=k([["A","Z"],["a","z"],"_",["\u0080",
"\uffff"]],!1,!1),Jd=/^[A-Za-z0-9_]/,Kd=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ld=/^[A-Za-z0-9_.\x80-\uFFFF]/,Md=k([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Nd="@",Od=g("@",!1),Db=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},Eb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},Fb="'",Gb=g("'",!1),Hb="N'",Xd=g("N'",!1),Ra="''",Ib=g("''",!1),Jb=/^[^']/,Kb=k(["'"],!0,!1),$d=".",ae=g(".",!1),
fe=/^[0-9]/,ge=k([["0","9"]],!1,!1),be=/^[eE]/,ce=k(["e","E"],!1,!1),de=/^[+\-]/,ee=k(["+","-"],!1,!1),td="null",ud=g("NULL",!0),pd="true",qd=g("TRUE",!0),rd="false",sd=g("FALSE",!0),he="in",ie=g("IN",!0),je="is",ke=g("IS",!0),le="like",me=g("LIKE",!0),id="escape",jd=g("ESCAPE",!0),ne="not",oe=g("NOT",!0),pe="and",qe=g("AND",!0),re="or",se=g("OR",!0),te="between",ue=g("BETWEEN",!0),ve="from",we=g("FROM",!0),Dd="for",Ed=g("FOR",!0),Bd="substring",Cd=g("SUBSTRING",!0),zd="extract",Ad=g("EXTRACT",!0),
xe="trim",ye=g("TRIM",!0),Fd="position",Gd=g("POSITION",!0),xd="timestamp",yd=g("TIMESTAMP",!0),vd="date",wd=g("DATE",!0),Pd="leading",Qd=g("LEADING",!0),Rd="trailing",Sd=g("TRAILING",!0),Td="both",Ud=g("BOTH",!0),Vd="to",Wd=g("TO",!0),ze="interval",Ae=g("INTERVAL",!0),Be="year",Ce=g("YEAR",!0),De="month",Ee=g("MONTH",!0),Fe="day",Ge=g("DAY",!0),He="hour",Ie=g("HOUR",!0),Je="minute",Ke=g("MINUTE",!0),Le="second",Me=g("SECOND",!0),Ne="case",Oe=g("CASE",!0),Pe="end",Qe=g("END",!0),Re="when",Se=g("WHEN",
!0),Te="then",Ue=g("THEN",!0),Yd="else",Zd=g("ELSE",!0),Ve=",",We=g(",",!1),Xe="(",Ye=g("(",!1),Ze=")",$e=g(")",!1),af=/^[ \t\n\r]/,bf=k([" ","\t","\n","\r"],!1,!1),Sc="`",Tc=g("`",!1),Uc=/^[^`]/,Vc=k(["`"],!0,!1),x=0,Sa=[{line:1,column:1}],Aa=0,Ta=[],O=0,ab;if("startRule"in l){if(!(l.startRule in kb))throw Error("Can't start parsing from rule \""+l.startRule+'".');lb=kb[l.startRule]}ab=lb();if(ab!==q&&x===a.length)return ab;ab!==q&&x<a.length&&e({type:"end"});throw function(a,b,d){return new c(c.buildMessage(a,
b),a,b,d)}(Ta,Aa<a.length?a.charAt(Aa):null,Aa<a.length?f(Aa,Aa+1):f(Aa,Aa));}}})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/iteratorUtils ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D,B,E,F){Object.defineProperty(a,"__esModule",{value:!0});var H=p.getLogger("esri.layers.graphics.data.QueryEngine");c=function(){return function(a,b,c,d,e){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=d;this.filterFlags=e;this.groupId=-1;this.localId=b}}();a.Feature=c;var J=new Set,K=new b.MemCacheStorage(2E6),G=0;c=function(){function a(a){var c=this;this.capabilities={query:z.queryCapabilities};this.geometryType=a.geometryType;
this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return c.clearCache()});this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new b.MemCache(G++ +"$$",K));this.fieldsIndex=new E(a.fields);a.scheduler&&a.task&&(this._frameQueue=
new F.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.task,function(a){return c._update(a)},function(){return 0<c._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,
"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=D.getTimeExtent(this.timeInfo,
this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return k(this,void 0,void 0,function(){var b,c,d;return g(this,function(f){switch(f.label){case 0:b=e.clone(a),f.label=1;case 1:return f.trys.push([1,14,,15]),[4,this._schedule()];case 2:return f.sent(),[4,B.normalizeQuery(b,this.definitionExpression,this.spatialReference)];
case 3:return b=f.sent(),[4,this._reschedule()];case 4:return f.sent(),[4,this._checkQuerySupport(b)];case 5:return b=f.sent(),[4,this._reschedule()];case 6:return f.sent(),[4,this._executeGeometryQuery(b)];case 7:return c=f.sent(),[4,this._reschedule()];case 8:return f.sent(),[4,c.executeObjectIdsQuery(b)];case 9:return c=f.sent(),[4,this._reschedule()];case 10:return f.sent(),[4,c.executeTimeQuery(b)];case 11:return c=f.sent(),[4,this._reschedule()];case 12:return f.sent(),[4,c.executeAttributesQuery(b)];
case 13:return c=f.sent(),[3,15];case 14:d=f.sent();if(d!==B.QUERY_ENGINE_EMPTY_RESULT)throw d;c=new A.default([],null,this);return[3,15];case 15:return[2,c.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return k(this,void 0,void 0,function(){var b,c,d;return g(this,function(f){switch(f.label){case 0:b=e.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,f.label=1;case 1:return f.trys.push([1,14,,15]),[4,this._schedule()];case 2:return f.sent(),
[4,B.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=f.sent(),[4,this._reschedule()];case 4:return f.sent(),[4,this._checkQuerySupport(b)];case 5:return b=f.sent(),[4,this._reschedule()];case 6:return f.sent(),[4,this._executeGeometryQuery(b)];case 7:return c=f.sent(),[4,this._reschedule()];case 8:return f.sent(),[4,c.executeObjectIdsQuery(b)];case 9:return c=f.sent(),[4,this._reschedule()];case 10:return f.sent(),[4,c.executeTimeQuery(b)];case 11:return c=f.sent(),
[4,this._reschedule()];case 12:return f.sent(),[4,c.executeAttributesQuery(b)];case 13:return c=f.sent(),[2,c.size];case 14:d=f.sent();if(d!==B.QUERY_ENGINE_EMPTY_RESULT)throw d;return[2,0];case 15:return[2]}})})};a.prototype.executeQueryForExtent=function(a,b){void 0===a&&(a={});return k(this,void 0,void 0,function(){var b,c,d,f,h,k,l,n;return g(this,function(g){switch(g.label){case 0:b=e.clone(a),d=b.outSR,g.label=1;case 1:return g.trys.push([1,14,,15]),[4,this._schedule()];case 2:return g.sent(),
[4,B.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=g.sent(),[4,this._reschedule()];case 4:return g.sent(),[4,this._checkQuerySupport(b)];case 5:return b=g.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule()];case 6:return g.sent(),[4,this._executeGeometryQuery(b)];case 7:return c=g.sent(),[4,this._reschedule()];case 8:return g.sent(),[4,c.executeObjectIdsQuery(b)];case 9:return c=g.sent(),[4,this._reschedule()];case 10:return g.sent(),
[4,c.executeTimeQuery(b)];case 11:return c=g.sent(),[4,this._reschedule()];case 12:return g.sent(),[4,c.executeAttributesQuery(b)];case 13:c=g.sent();f=c.size;if(!f)return[2,{count:f,extent:null}];r.set(L,r.NEGATIVE_INFINITY);this.featureStore.forEachBounds(c.items,function(a){return r.expand(L,a)},I);h={xmin:L[0],ymin:L[1],xmax:L[3],ymax:L[4],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(L[2])&&isFinite(L[5])&&(h.zmin=L[2],h.zmax=L[5]);k=v.project(h,c.spatialReference,
d);k.spatialReference=B.cleanFromGeometryEngine(d||this.spatialReference);0===k.xmax-k.xmin&&(l=m.getMetersPerUnitForSR(k.spatialReference),k.xmin-=l,k.xmax+=l);0===k.ymax-k.ymin&&(l=m.getMetersPerUnitForSR(k.spatialReference),k.ymin-=l,k.ymax+=l);this.hasZ&&null!=k.zmin&&null!=k.zmax&&0===k.zmax-k.zmin&&(l=m.getMetersPerUnitForSR(k.spatialReference),k.zmin-=l,k.zmax+=l);return[2,{count:f,extent:k}];case 14:n=g.sent();if(n===B.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw n;case 15:return[2]}})})};
a.prototype.executeQueryForIds=function(a,b){void 0===a&&(a={});return k(this,void 0,void 0,function(){return g(this,function(c){return[2,this.executeQueryForIdSet(a,b).then(function(a){return f.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return k(this,void 0,void 0,function(){var b,c,d,f,h,k,m,l;return g(this,function(g){switch(g.label){case 0:b=e.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,g.label=1;case 1:return g.trys.push([1,13,,
14]),[4,this._schedule()];case 2:return g.sent(),[4,B.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=g.sent(),[4,this._reschedule()];case 4:return g.sent(),[4,this._executeGeometryQuery(b)];case 5:return c=g.sent(),[4,this._reschedule()];case 6:return g.sent(),[4,c.executeObjectIdsQuery(b)];case 7:return c=g.sent(),[4,this._reschedule()];case 8:return g.sent(),[4,c.executeTimeQuery(b)];case 9:return c=g.sent(),[4,this._reschedule()];case 10:return g.sent(),[4,c.executeAttributesQuery(b)];
case 11:return c=g.sent(),[4,this._reschedule()];case 12:g.sent();d=c.items;f=new Set;h=0;for(k=d;h<k.length;h++)m=k[h],f.add(c.featureAdapter.getObjectId(m));return[2,f];case 13:l=g.sent();if(l===B.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw l;case 14:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){var c=this;if(this.timeInfo)return this.executeQuery(a,b).then(function(a){return c._filterLatest(a,c.timeInfo)});H.error(new h("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};
a.prototype._schedule=function(a){return k(this,void 0,void 0,function(){return g(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a).then(function(a){return a})]:[2,a]})})};a.prototype._reschedule=function(a){return k(this,void 0,void 0,function(){return g(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a).then(function(a){return a})]:[2,a]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();
this._budget=null};a.prototype._filterLatest=function(a,b){var c=b.trackIdField,d=b.startTimeField;b=b.endTimeField||d;for(var d=new Map,e=[],f=0,g=a.features;f<g.length;f++){var h=g[f],k=h.attributes[c],m=h.attributes[b];(!d.has(k)||d.get(k).attributes[b]<m)&&d.set(k,h)}d.forEach(function(a){return e.push(a)});return l({},a,{features:e})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new A.default(a,null,this)}return this._allItems};
a.prototype._executeGeometryQuery=function(a){return k(this,void 0,void 0,function(){var b,c,d,e,f,h,m,l,n,p,t,r,v,u,y,z,D,B,H,F,I,J,E,L,G=this;return g(this,function(K){switch(K.label){case 0:b=a.geometry;c=a.outSR;d=a.spatialRel;e=w.isValid(c)&&!w.equals(this.spatialReference,c);if(f=this.cacheSpatialQueries?e?JSON.stringify({geometry:b,spatialRelationship:d,outSpatialReference:c}):JSON.stringify({geometry:b,spatialRelationship:d}):null)if(h=this._geometryQueryCache.get(f),void 0!==h)return[2,h];
m=function(b){return k(G,void 0,void 0,function(){var d;return g(this,function(g){switch(g.label){case 0:return e&&(a.returnGeometry||a.returnCentroid)?[4,b.project(c)]:[3,2];case 1:return d=g.sent(),f&&this._geometryQueryCache.put(f,d,d.size||1),[2,d];case 2:return f&&this._geometryQueryCache.put(f,b,b.size||1),[2,b]}})})};if(!b)return[2,m(this._getAll())];l=this.featureAdapter;if("esriSpatialRelDisjoint"!==d)return[3,5];n=this._searchFeatures(this._getQueryBBoxes(b));if(!n.length)return[2,m(this._getAll())];
r=new Set;v=0;for(u=n;v<u.length;v++)y=u[v],r.add(l.getObjectId(y));return[4,this._reschedule(r)];case 1:return r=K.sent(),z=0,p=Array(r.size),this.featureStore.forEach(function(a){return p[z++]=a}),t=r,[4,this._reschedule()];case 2:return K.sent(),[4,C.getSpatialQueryOperator(d,b,this)];case 3:return D=K.sent(),B=function(a){return!t.has(l.getObjectId(a))||D(l.getGeometry(a))},F=A.default.bind,[4,this._runSpatialFilter(p,B)];case 4:return H=new (F.apply(A.default,[void 0,K.sent(),b,this])),[2,m(H)];
case 5:return I=this._searchFeatures(this._getQueryBBoxes(b)),I.length?(J=this._canExecuteSoloPass(b,a))?[2,m(new A.default(I,b,this))]:[4,C.getSpatialQueryOperator(d,b,this)]:(H=new A.default([],b,this),f&&this._geometryQueryCache.put(f,H,H.size||1),[2,H]);case 6:return E=K.sent(),[4,this._runSpatialFilter(I,function(a){return E(l.getGeometry(a))})];case 7:return L=K.sent(),[2,m(new A.default(L,b,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return k(this,void 0,void 0,function(){var c,
d,e,f=this;return g(this,function(h){if(!b)return[2,a];if(!this._budget)return[2,a.filter(function(a){return b(a)})];c=0;d=[];e=function(){return k(f,void 0,void 0,function(){var f;return g(this,function(g){switch(g.label){case 0:if(!(c<a.length))return[3,3];f=a[c];b(f)&&d.push(f);return this._budget.done?[4,this._reschedule()]:[3,2];case 1:return g.sent(),[2,e()];case 2:return++c,[3,0];case 3:return[2]}})})};return[2,this._reschedule().then(function(){return e()}).then(function(){return d})]})})};
a.prototype._canExecuteSoloPass=function(a,b){var c=this.geometryType;b=b.spatialRel;return C.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(C.canQueryWithRBush(a)){if(y.isExtent(a))return[n.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(y.isPolygon(a))return a.rings.map(function(a){return n.fromValues(Math.min(a[0][0],a[2][0]),
Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[u.getBoundsXY(n.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){J.add(a)});var c=Array(J.size),d=0;J.forEach(function(a){return c[d++]=a});J.clear();return c};a.prototype._checkQuerySupport=function(a){return k(this,void 0,void 0,function(){return g(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||
a.pixelSize||a.relationParam||a.text)throw new h("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,d.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),C.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),v.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,d=a.returnDistinctValues;c&&0<c.length&&
(c=c.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),t.validateFields(this.fieldsIndex,c,"orderByFields contains missing fields"));if(b&&0<b.length)t.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(d)throw new h("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});t.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return k(this,
void 0,void 0,function(){var b,c,d,e,f,k,m,l,n,p,r,v;return g(this,function(g){b=a.outStatistics;c=a.groupByFieldsForStatistics;d=a.having;e=c&&c.length;f=b&&b.length;if(d){if(!e||!f)throw new h("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});t.validateHaving(this.fieldsIndex,d,b)}if(f){if(k=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];m=b.map(function(a){return a.onStatisticField});t.validateFields(this.fieldsIndex,
m,"onStatisticFields contains missing fields");e&&t.validateFields(this.fieldsIndex,c,"groupByFieldsForStatistics contains missing fields");l=0;for(n=b;l<n.length;l++)if(p=n[l],r=p.onStatisticField,v=p.statisticType,(!e||"count"!==v)&&r&&t.hasInvalidFieldType(r,this.fieldsIndex))throw new h("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:p,query:a});}return[2]})})};return a}();a.default=c;var I=r.create(),L=r.create()})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(c,a,l,g,k,h,f,e,p){function b(a,b){var c;if(!b)return null;if("x"in b){var e={x:0,y:0};a=a(b.x,b.y,n);e.x=a[0];e.y=a[1];null!=b.z&&(e.z=b.z);null!=b.m&&(e.m=b.m);return e}if("xmin"in b)return e={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,n),e.xmin=c[0],e.ymin=c[1],a=a(b.xmax,b.ymax,n),e.xmax=a[0],e.ymax=a[1],b.hasZ&&(e.zmin=b.zmin,e.zmax=b.zmax,e.hasZ=!0),b.hasM&&(e.mmin=b.mmin,e.mmax=b.mmax,e.hasM=!0),e;if("rings"in b)return{rings:d(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:d(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:m(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function d(a,b){for(var c=[],d=0;d<a.length;d++)c.push(m(a[d],b));return c}function m(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=b(e[0],e[1],[0,0]);c.push(f);2<e.length&&f.push(e[2]);3<e.length&&f.push(e[3])}return c}function r(a,b){return!e.isValid(a)||!e.isValid(b)||e.equals(a,b)||p.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var n=[0,0];a.doesBrowserSupportProjection=
function(a,b){return r(a,b)?f.isSupported():!0};a.checkProjectionSupport=function(a,b){return g(this,void 0,void 0,function(){var c,d,e;return l(this,function(g){if(!b)return[2];if(Array.isArray(a)){c=0;for(d=a;c<d.length;c++)if(e=d[c],r(e.geometry&&e.geometry.spatialReference,b)){if(f.isSupported())return[2,f.load()];throw new k("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});}return[2]}if(!r(a,b))return[2];if(f.isSupported())return[2,f.load()];
throw new k("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});})})};var u=b.bind(null,p.lngLatToXY),y=b.bind(null,p.xyToLngLat);a.project=function(a,b,c){if(!a)return a;c||(c=b,b=a.spatialReference);return e.isValid(b)&&e.isValid(c)&&!e.equals(b,c)?p.canProject(b,c)?e.isWebMercator(c)?u(a):y(a):f.projectMany([a],b,c,null,!0)[0]:a};var w=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,b,c){return g(this,void 0,void 0,function(){var d,f=this;return l(this,function(g){a&&a.length&&b&&c&&!e.equals(b,c)||h.resolve(a);d={geometries:a,inSpatialReference:b,outSpatialReference:c,resolve:null};this._jobs.push(d);return[2,h.create(function(a){d.resolve=a;null===f._timer&&(f._timer=setTimeout(f._process,10))},function(){var a=f._jobs.indexOf(d);-1<a&&f._jobs.splice(a,1)})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,c=
a.inSpatialReference,d=a.outSpatialReference,a=a.resolve;p.canProject(c,d)?e.isWebMercator(d)?a(b.map(u)):a(b.map(y)):a(f.projectMany(b,c,d,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return g(this,void 0,void 0,function(){return l(this,function(d){return[2,w.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),
function(c,a,l,g,k,h){function f(a,b,c,f,g){void 0===f&&(f=null);void 0===g&&(g=!1);if(null===f){var m=h.cacheKey(b,c);void 0!==d[m]?f=d[m]:(f=e(b,c,null),null===f&&(f=new h),d[m]=f)}return p._project(a,b,c instanceof k||!1===g?c:new k(c),f,g)}function e(a,b,c){void 0===c&&(c=null);a=p._getTransformation(a,b,c);return null!==a?h.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var p=null;a.isLoaded=function(){return!!p&&g.isLoaded()};a.isSupported=function(){return g.isSupported()};
var b=null;a.load=function(){return b?b:b=l.create(function(a,b){var d=g.load();c(["./geometryEngine"],function(c){p=c;d.then(function(){p._enableProjection(g);a()},function(a){b(a)})})})};a.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:f(a,a[0].spatialReference,b,c):f([a],a.spatialReference,b,c)[0]};var d={};a.projectMany=f;a.getTransformation=e;a.getTransformations=function(a,b,c){void 0===c&&(c=null);a=p._getTransformationBySuitability(a,b,c);if(null!==
a){b=[];for(c=0;c<a.length;c++)b.push(h.fromGE(a[c]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(c,a,l,g,k){function h(c){function d(a,b,c){a[b]=c(a[b])}a._pe=c;m.init();r.init();n.init();u.init();y.init();a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}l(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var e=
0,f=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];e<f.length;e++)c=f[e],d(c.prototype,"getName",function(a){return function(){return a.call(this,Array(m.PE_NAME_MAX))}});e=0;for(f=[a._pe.PeGeogtran,a._pe.PeProjcs];e<f.length;e++)c=f[e],d(c.prototype,"getParameters",function(b){return function(){for(var c=Array(m.PE_PARM_MAX),d=b.call(this),e=0;e<c.length;e++){var f=a._pe.getValue(d,"*");c[e]=f?a._pe.wrapPointer(f,
a._pe.PeParameter):null;d+=Int32Array.BYTES_PER_ELEMENT}return c}});d(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var c=this.getSize();if(!c)return null;var d=[],e=a.call(this);b(d,c,e);return d}});d(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var d=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],f=this.getSteps();if(1<f)for(var e=a._pe.getPointer(e),g=1;g<f;g++)d.push(a._pe.wrapPointer(e+
c*g,a._pe.PeGTlistExtendedGTs))}return d}});var g=a._pe._pe_getPeHorizonSize();c=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var d=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],f=e.getNump();if(1<f)for(var e=a._pe.getPointer(e),h=1;h<f;h++)d.push(a._pe.wrapPointer(e+g*h,a._pe.PeHorizon))}c.set(b,d);return d}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",c);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",c);a._pe.PeObject.prototype.toString=
function(b){void 0===b&&(b=m.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),d=a._pe.ensureInt8(Array(m.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,d))}}function f(b){if(b){var c=a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function e(b,c){var d=[];c=Array(c);for(var e=0;e<b;e++)d.push(a._pe.ensureInt8(c));return d}function p(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):
b=a;return b}function b(b,c,d,e){void 0===e&&(e=!1);if(e)for(e=0;e<2*c;e++)b[e]=a._pe.getValue(d+e*Float64Array.BYTES_PER_ELEMENT,"double");else{var f=0===b.length;for(e=0;e<c;e++)f&&(b[e]=Array(2)),b[e][0]=a._pe.getValue(d,"double"),b[e][1]=a._pe.getValue(d+Float64Array.BYTES_PER_ELEMENT,"double"),d+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var d;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!g("esri-wasm")};a.load=function(){return d?
d:d=k.create(function(a,b){c(["./support/pe-wasm"],function(d){d({locateFile:function(a){return c.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){h(b);a()})})})};(function(c){function d(c,d,e){a._pe.ensureCache.prepare();var f=p(e),g=e===f,f=a._pe.ensureFloat64(f);(c=a._pe._pe_geog_to_proj(a._pe.getPointer(c),d,f))&&b(e,d,f,g);return c}function e(a,b,c){return f(a,b,c,0)}function f(c,d,e,f){a._pe.ensureCache.prepare();var g=p(e),h=e===g,g=a._pe.ensureFloat64(g);(c=a._pe._pe_proj_to_geog_center(a._pe.getPointer(c),
d,g,f))&&b(e,d,g,h);return c}c.geogToProj=d;c.projGeog=function(a,b,c,f){switch(f){case m.PE_TRANSFORM_P_TO_G:return e(a,b,c);case m.PE_TRANSFORM_G_TO_P:return d(a,b,c)}return 0};c.projToGeog=e;c.projToGeogCenter=f})(a.PeCSTransformations||(a.PeCSTransformations={}));var m;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(m=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var f=null,g=e[b];g||(g={},e[b]=g);g.hasOwnProperty(String(c))?f=g[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,
c),a._pe.compare(b,a._pe.NULL)||(f=b,g[c]=f));return f=d(f)}function d(b){if(b){var c=b.getType();switch(c){case m.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case m.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case m.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&m.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var e={},f={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(m.PE_TYPE_COORDSYS,
a)};b.factoryByType=c;b.fromString=function(b,c){var e=null,g=f[b];g||(g={},f[b]=g);g.hasOwnProperty(c)?e=g[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,g[c]=e));return e=d(e)};b.geogcs=function(a){return c(m.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(m.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(m.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(m.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var r;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,d,e,f,g,h){var k=null,m=new a._pe.PeInteger(h);try{var l=a._pe.PeGTlistExtended.prototype.getGTlist(b,d,e,f,g,m);if(h=m.val)if(k=[l],1<h){var n=a._pe.getPointer(l);for(b=1;b<h;b++)k.push(a._pe.wrapPointer(n+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(m)}return k}})(r=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var d=b[c];f(d);d.getEntries().forEach(function(a){f(a);a=a.getGeogtran();f(a);a.getParameters().forEach(f);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){f(a);var b=a.getDatum();f(b);f(b.getSpheroid());f(a.getPrimem());f(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(c){c.geogToGeog=function(c,d,e,f,
g){a._pe.ensureCache.prepare();var h=p(e),k=e===h,h=a._pe.ensureFloat64(h),m=0;f&&(m=a._pe.ensureFloat64(f));(c=a._pe._pe_geog_to_geog(a._pe.getPointer(c),d,h,m,g))&&b(e,d,h,k);return c}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(c){function d(b,c,d,f,g,h){a._pe.ensureCache.prepare();var k,l;switch(b){case "dd":k=a._pe._pe_geog_to_dd;l=m.PE_DD_MAX;break;case "ddm":k=a._pe._pe_geog_to_ddm;l=m.PE_DDM_MAX;break;case "dms":k=a._pe._pe_geog_to_dms,l=m.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));
c=p(f);c=a._pe.ensureFloat64(c);l=e(d,l);f=a._pe.ensureInt32(l);if(g=k(b,d,c,g,f))for(k=0;k<d;k++)h[k]=a._pe.UTF8ToString(l[k]);return g}function f(c,d,e,f,g){a._pe.ensureCache.prepare();var h;switch(c){case "dd":h=a._pe._pe_dd_to_geog;break;case "ddm":h=a._pe._pe_ddm_to_geog;break;case "dms":h=a._pe._pe_dms_to_geog}c=0;d&&(c=a._pe.getPointer(d));d=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(d);d=a._pe.ensureFloat64(Array(2*e));(h=h(c,e,f,d))&&b(g,e,d);return h}c.geog_to_dms=
function(a,b,c,e,f){return d("dms",a,b,c,e,f)};c.dms_to_geog=function(a,b,c,d){return f("dms",a,b,c,d)};c.geog_to_ddm=function(a,b,c,e,f){return d("ddm",a,b,c,e,f)};c.ddm_to_geog=function(a,b,c,d){return f("ddm",a,b,c,d)};c.geog_to_dd=function(a,b,c,e,f){return d("dd",a,b,c,e,f)};c.dd_to_geog=function(a,b,c,d){return f("dd",a,b,c,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var n;(function(c){c.init=function(){c.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;c.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;c.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;c.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;c.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};c.geog_to_mgrs_extended=function(b,c,d,f,g,h,k){a._pe.ensureCache.prepare();var l=0;b&&(l=a._pe.getPointer(b));b=p(d);d=a._pe.ensureFloat64(b);b=e(c,m.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(f=a._pe._pe_geog_to_mgrs_extended(l,
c,d,f,g,h,n))for(g=0;g<c;g++)k[g]=a._pe.UTF8ToString(b[g]);return f};c.mgrs_to_geog_extended=function(c,d,e,f,g){a._pe.ensureCache.prepare();var h=0;c&&(h=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(f=a._pe._pe_mgrs_to_geog_extended(h,d,e,f,c))&&b(g,d,c);return f}})(n=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(c){c.geog_to_usng=function(b,c,d,f,g,h,k){a._pe.ensureCache.prepare();var l=0;b&&(l=a._pe.getPointer(b));
b=p(d);d=a._pe.ensureFloat64(b);b=e(c,m.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(f=a._pe._pe_geog_to_usng(l,c,d,f,g,h,n))for(g=0;g<c;g++)k[g]=a._pe.UTF8ToString(b[g]);return f};c.usng_to_geog=function(c,d,e,f){a._pe.ensureCache.prepare();var g=0;c&&(g=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(g=a._pe._pe_usng_to_geog(g,d,e,c))&&b(f,d,c);return g}})(a.PeNotationUsng||(a.PeNotationUsng={}));var u;(function(c){c.init=
function(){c.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;c.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;c.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};c.geog_to_utm=function(b,c,d,f,g){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=p(d);d=a._pe.ensureFloat64(b);b=e(c,m.PE_UTM_MAX);var k=a._pe.ensureInt32(b);if(f=a._pe._pe_geog_to_utm(h,c,d,f,k))for(h=0;h<c;h++)g[h]=a._pe.UTF8ToString(b[h]);return f};c.utm_to_geog=
function(c,d,e,f,g){a._pe.ensureCache.prepare();var h=0;c&&(h=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(f=a._pe._pe_utm_to_geog(h,d,e,f,c))&&b(g,d,c);return f}})(u=a.PeNotationUtm||(a.PeNotationUtm={}));var y;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(d,e){void 0===e&&(e=b.PE_PCSINFO_OPTION_DOMAIN);var f,g;c.has(d)&&(g=c.get(d),g[e]&&(f=g[e]));f||(f=a._pe.PePCSInfo.prototype.generate(d,e),g||(g=[],c.set(d,g)),g[e]=f);return f}})(y=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=h})},"esri/geometry/support/GeographicTransformation":function(){define(["require",
"exports","./GeographicTransformationStep"],function(c,a,l){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var c=0;for(a=a.steps;c<a.length;c++){var f=a[c];f instanceof l?this.steps.push(f):this.steps.push(new l({wkid:f.wkid,wkt:f.wkt,isInverse:f.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?
c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(c){var g=new a,f="",e=0;for(c=c.steps;e<c.length;e++){var k=l.fromGE(c[e]);g.steps.push(k);f+=k.uid.toString()+","}g._cached_projection={};g._gtlistentry=null;g._chain=f;return g};a.prototype.getInverse=function(){var c=new a;c.steps=[];for(var g=this.steps.length-1;0<=g;g--)c.steps.push(this.steps[g].getInverse());return c};a.prototype.getGTListEntry=function(){for(var a="",c=0,f=this.steps;c<f.length;c++)a+=
f[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(c,g,f){this._cached_projection[a.cacheKey(c,g)]=f};a.prototype.getCachedGeTransformation=function(c,g){for(var f="",e=0,h=this.steps;e<h.length;e++)f+=h[e].uid.toString()+",";f!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=f);c=this._cached_projection[a.cacheKey(c,g)];return void 0===c?null:c};return a}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(c,a){var l=0;return function(){function a(a){void 0===a&&(a=null);this.uid=l++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(c){var g=new a;g._wkt=c.wkt;g._wkid=c.wkid;g._isInverse=c.isInverse;return g};Object.defineProperty(a.prototype,"wkt",
{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=l++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=l++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=l++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var c=new a;c._wkt=this.wkt;c._wkid=this._wkid;
c._isInverse=!this.isInverse;return c};return a}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,
supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/iteratorUtils ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var c;c=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(b.isValid(a.outSR)&&!b.equals(this.queryGeometry.spatialReference,a.outSR)?c.queryGeometry=y.cleanFromGeometryEngine(l({spatialReference:a.outSR},n.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):c.queryGeometry=y.cleanFromGeometryEngine(l({spatialReference:a.outSR},this.queryGeometry)));return c};a.prototype.executeAttributesQuery=function(b){var c=r.getWhereClause(b.where,this.fieldsIndex);if(!c)return e.resolve(this);if(c.isStandardized){for(var d=0,f=[],g=0,h=this.items;g<h.length;g++){var k=h[g];c.testFeature(k,this.featureAdapter)&&(f[d++]=k)}c=new a(f,this.queryGeometry,this);c.definitionExpression=b.where;return e.resolve(c)}return e.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return e.resolve(this);var c=h.createSetFromValues(b.objectIds),d=this.featureAdapter.getObjectId;return e.resolve(new a(this.items.filter(function(a){return c.has(d(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=u.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!f.isSome(b))return e.resolve(this);b=this.items.filter(b);return e.resolve(new a(b,this.queryGeometry,this))};
a.prototype.project=function(c){return k(this,void 0,void 0,function(){var e,f,h,k=this;return g(this,function(g){switch(g.label){case 0:if(!c||b.equals(this.spatialReference,c))return[2,this];e=this.featureAdapter;return[4,n.projectMany(this.items.map(function(a){return y.getGeometry(k,e.getGeometry(a))}),this.spatialReference,c)];case 1:return f=g.sent(),h=f.map(function(a,b){return e.cloneWithGeometry(k.items[b],d.convertFromGeometry(a,k.hasZ,k.hasM))}),[2,new a(h,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,d=this.geometryType,e=this.hasM,f=this.hasZ,g=this.objectIdField,h=this.spatialReference,k=a.outFields,m=a.outSR,l=a.quantizationParameters,n=a.resultRecordCount,r=a.resultOffset,t=a.returnZ,u=a.returnM,w=!1;null!=n&&
null!=r&&(n=r+n,w=c.length>n,c=c.slice(r,Math.min(c.length,n)));return{exceededTransferLimit:w,features:this._createFeatures(a,c),fields:k&&k.map(function(a){return b.fieldsIndex.get(a)}),geometryType:d,hasM:e&&u,hasZ:f&&t,objectIdFieldName:g,spatialReference:y.cleanFromGeometryEngine(m?m:h),transform:l&&p.toQuantizationTransform(l)||null}};a.prototype._createFeatures=function(a,b){var c=new m.default(a,this.featureAdapter,this.fieldsIndex),d=a.orderByFields,e=a.quantizationParameters,f=a.returnGeometry,
g=a.returnCentroid,h=a.maxAllowableOffset,k=a.returnZ;a=a.returnM;var l=this.hasZ&&(void 0===k?!1:k),n=this.hasM&&(void 0===a?!1:a),k=[];a=0;if(b.length&&d&&d.length){var d=d[0].split(" "),r=d[0],t=this.fieldsIndex.get(r),u="DESC"===d[1];b.sort(function(a,b){a=c.getFieldValue(a,r,t);b=c.getFieldValue(b,r,t);if("number"===typeof a&&"number"===typeof b)return u?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(u?a>b:a<b)?-1:(u?a<b:a>b)?1:0})}if(f||g)if(e=
p.toQuantizationTransform(e),f&&!g)for(g=0;g<b.length;g++)f=b[g],k[a++]={attributes:c.getAttributes(f),geometry:y.getGeometry(this,this.featureAdapter.getGeometry(f),h,e,l,n)};else if(!f&&g)for(h=0;h<b.length;h++)f=b[h],k[a++]={attributes:c.getAttributes(f),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(f,this),e)};else for(g=0;g<b.length;g++)f=b[g],k[a++]={attributes:c.getAttributes(f),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(f,this),e),geometry:y.getGeometry(this,
this.featureAdapter.getGeometry(f),h,e,l,n)};else for(h=0;h<b.length;h++)f=b[h],(l=c.getAttributes(f))&&(k[a++]={attributes:l});return k};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=0;for(a=a.outStatistics;e<a.length;e++){var f=a[e];if("exceedslimit"===f.statisticType){c=null!=f.maxPointCount?f.maxPointCount:Number.POSITIVE_INFINITY;d=null!=f.maxRecordCount?f.maxRecordCount:Number.POSITIVE_INFINITY;
b=null!=f.maxVertexCount?f.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,g=this.featureAdapter,b=this.items.reduce(function(a,b){b=g.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};
a.prototype._createStatisticsQueryResponse=function(a){var b=new m.default(a,this.featureAdapter,this.fieldsIndex),c=a.outStatistics,d=[],e=[],f=a.groupByFieldsForStatistics;a=a.having;for(var g=f&&f.length,f=g&&f[0],h=this.fieldsIndex.get(f),k=!h,l={},n={},p={},r={attributes:{}},t=0;t<c.length;t++){var u=c[t],w=u.outStatisticFieldName,y=u.statisticType,u="exceedslimit"!==y?u.onStatisticField:void 0,Q=this.fieldsIndex.get(u),N=g&&(u===f||k)&&"count"===y;if(g){l[u]||(l[u]=this._calculateUniqueValues(b,
f,h));var U=l[u],V;for(V in U){var S=U[V],X=S.count,W=S.data,Y=S.items;if(!a||b.validateItems(Y,a)){var S=n[W]||{attributes:{}},T=null;N?T=X:(X=this._calculateStatistics(Y,b,u,Q),Y="var"===y?"variance":y,T=X[Y]);S.attributes[w]=T;S.attributes[k?"EXPR_1":f]=W;n[W]=S}}}else p[u]||(p[u]=this._calculateStatistics(this.items,b,u,Q)),X=p[u],Y="var"===y?"variance":y,r.attributes[w]=X[Y];e.push({name:w,alias:w,type:"esriFieldTypeDouble"})}if(g)for(var ja in n)d.push(n[ja]);else d.push(r);return{fields:e,
features:d}};a.prototype._calculateStatistics=function(a,b,c,d){for(var e=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,g=null,h=null,k=null,m=null,l=[],n=0,p=0;p<a.length;p++){var r=b.getFieldValue(a[p],c,d);"string"===typeof r?n++:null==r||isNaN(r)||(g+=r,e=Math.min(e,r),f=Math.max(f,r),l.push(r),n++)}if(n){h=g/n;for(b=a=0;b<l.length;b++)r=l[b],a+=Math.pow(r-h,2);m=1<n?a/(n-1):0;k=Math.sqrt(m)}else f=e=null;return{avg:h,count:n,max:f,min:e,stddev:k,sum:g,variance:m}};a.prototype._calculateUniqueValues=
function(a,b,c){for(var d={},e=0,f=this.items;e<f.length;e++){var g=f[e],h=a.getFieldValue(g,b,c);if(null==h||"string"===typeof h&&""===h.trim())h=null;null==d[h]?d[h]={count:1,data:h,items:[g]}:(d[h].count++,d[h].items.push(g))}return d};return a}();a.default=c})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a,c,e){this._fieldDataCache=
new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=e;this.featureAdapter=c;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var f=c=0;f<a.length;f++){var b=a[f],d=g.getExpressionFromFieldName(b),h=this.fieldsIndex.get(d),d=h?null:g.getWhereClause(d,e),h=h?h.name:g.getAliasFromFieldName(b)||"FIELD_EXP_"+c++;this._fieldDataCache.set(b,{alias:h,clause:d})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);
return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,c,e){var f=e?e.name:c,b=null;this._fieldDataCache.has(f)?b=this._fieldDataCache.get(f).clause:e||(b=g.getWhereClause(c,this.fieldsIndex),this._fieldDataCache.set(f,{alias:f,clause:b}));return e?this.featureAdapter.getAttribute(a,f):b.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:g.getWhereClause(c,this.fieldsIndex)});
return this._fieldDataCache.get(c).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:g.getWhereClause(c,this.fieldsIndex)});return this._fieldDataCache.get(c).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var c=this.outFields;if(!c||!c.length)return this.featureAdapter.getAttributes(a);for(var e={},g=0;g<c.length;g++){var b=this._fieldDataCache.get(c[g]),
d=b.alias,b=b.clause;e[d]=b?b.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,d)}return e};a.prototype._processAttributesForDistinctValues=function(a){if(l.isNone(a)||!this.returnDistinctValues)return a;var c=this.outFields,e=[];if(c)for(var g=0;g<c.length;g++){var b=this._fieldDataCache.get(c[g]).alias;e.push(a[b])}else for(b in a)e.push(a[b]);c=(c||["*"]).join(",")+"\x3d"+e.join(",");e=this._returnDistinctMap.get(c)||0;this._returnDistinctMap.set(c,++e);return 1<e?null:
a};return a}();a.default=c})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(c,a){function l(a,c,f,e,g){if(null!=e&&null!=g&&e===g)return function(b){return e>=a.getAttribute(b,c)&&e<=a.getAttribute(b,f)};if(null!=e&&null!=g)return function(b){var d=a.getAttribute(b,c);b=a.getAttribute(b,f);return!(d>g||b<e)};if(null!=e)return function(b){return!(a.getAttribute(b,f)<e)};if(null!=g)return function(b){return!(a.getAttribute(b,c)>g)}}function g(a,c,f,e){if(null!=
f&&null!=e&&f===e)return function(e){return a.getAttribute(e,c)===f};if(null!=f&&null!=e)return function(g){return a.getAttribute(g,c)>=f&&a.getAttribute(g,c)<=e};if(null!=f)return function(e){return a.getAttribute(e,c)>=f};if(null!=e)return function(f){return a.getAttribute(f,c)<=e}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var f=c.featureAdapter,e=a.startTimeField,g=a.endTimeField,b=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;if(e&&
g)c.forEach(function(a){var c=f.getAttribute(a,e);a=f.getAttribute(a,g);null==c||isNaN(c)||(b=Math.min(b,c));null==a||isNaN(a)||(d=Math.max(d,a))});else{var h=e||g;c.forEach(function(a){a=f.getAttribute(a,h);null==a||isNaN(a)||(b=Math.min(b,a),d=Math.max(d,a))})}return{start:b,end:d}};a.getTimeOperator=function(a,c,f){if(!c||!a)return null;var e=a.startTimeField;a=a.endTimeField;if(!e&&!a)return null;var h=c.start;c=c.end;return null==h&&null==c?null:e&&a?l(f,e,a,h,c):g(f,e||a,h,c)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){function t(a,b,c,d,e){void 0===d&&(d=a.hasZ);void 0===e&&(e=a.hasM);var f=a.hasZ&&d,g=a.hasM&&e;return c?(a=n.quantizeOptimizedGeometry(B,b,a.hasZ,a.hasM,"esriGeometryPoint",c,d,e),n.convertToPoint(a,f,g)):n.convertToPoint(b,f,g)}function v(c,e,f){return g(this,void 0,void 0,function(){var g,k,m,n,r,t;return l(this,function(l){switch(l.label){case 0:if(!c)return[2,null];g=c.where;c.where=g=g&&g.trim();if(!g||/^1 *= *1$/.test(g)||e&&e===g)c.where=null;return c.geometry?
[4,z(c)]:[2,c];case 1:return k=l.sent(),c.distance=0,c.units=null,"esriSpatialRelEnvelopeIntersects"===c.spatialRel&&(m=c.geometry.spatialReference,k=p.getGeometryExtent(k),k.spatialReference=m),c.geometry=k,[4,y.checkProjectionSupport(k.spatialReference,f)];case 2:return l.sent(),[4,d.normalizeCentralMeridian(b.fromJSON(k))];case 3:n=l.sent()[0];if(h.isNone(n))throw a.QUERY_ENGINE_EMPTY_RESULT;r=n.toJSON();return[4,y.project(r,r.spatialReference,f)];case 4:t=l.sent();if(!t)throw a.QUERY_ENGINE_EMPTY_RESULT;
t.spatialReference=f;c.geometry=t;return[2,c]}})})}function z(a){return g(this,void 0,void 0,function(){var b,c,d,g,h,k,n,p,r,t;return l(this,function(l){switch(l.label){case 0:b=a.geometry;c=a.distance;d=a.units;if(null==c)return[2,f.resolve(b)];g=b.spatialReference;h=d&&A.fromJSON(d)||e.getUnitString(g);k=g&&(m.isGeographic(g)||m.isWebMercator(g));if(!k)return[3,1];p=b;return[3,3];case 1:return[4,y.checkProjectionSupport(g,m.WGS84).then(function(){return y.project(b,m.WGS84)})];case 2:p=l.sent(),
l.label=3;case 3:return n=p,[4,w.getGeodesicBufferOperator()];case 4:return r=l.sent(),t=r(n,c,h),[2,t?t.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var A=new k.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var C=new u.default,D=new u.default,B=new u.default,E={esriGeometryPoint:n.convertToPoint,
esriGeometryPolyline:n.convertToPolyline,esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};a.transformCentroid=t;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=r.getCentroidOptimizedGeometry(new u.default,b.geometry,a.hasZ,a.hasM));return t(a,b.centroid,c)};a.getGeometry=function(a,b,c,d,e,f){void 0===e&&(e=a.hasZ);void 0===f&&(f=a.hasM);var g=a.hasZ&&e,h=a.hasM&&f;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(c)return c=n.generalizeOptimizedGeometry(D,b,a.hasZ,a.hasM,a.geometryType,c,e,f),d&&(c=n.quantizeOptimizedGeometry(B,c,g,h,a.geometryType,d)),E[a.geometryType](c,g,h);if(d)return c=n.quantizeOptimizedGeometry(B,b,a.hasZ,a.hasM,a.geometryType,d,e,f),E[a.geometryType](c,g,h);n.removeZMValues(C,b,a.hasZ,a.hasM,e,f);return E[a.geometryType](C,g,h)};a.normalizeQuery=function(a,b,c){return g(this,void 0,void 0,function(){var d,e,f,g,h;return l(this,function(k){d=
a.outFields;e=a.orderByFields;f=a.groupByFieldsForStatistics;g=a.outStatistics;if(d)for(h=0;h<d.length;h++)d[h]=d[h].trim();if(e)for(h=0;h<e.length;h++)e[h]=e[h].trim();if(f)for(h=0;h<f.length;h++)f[h]=f[h].trim();if(g)for(h=0;h<g.length;h++)g[h].onStatisticField&&(g[h].onStatisticField=g[h].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,v(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return g(this,void 0,void 0,function(){return l(this,function(d){return[2,
v(a,b,c)]})})};a.normalizeQueryLike=v;a.cleanFromGeometryEngine=function(a){return a&&F in a?JSON.parse(JSON.stringify(a,H)):a};var F="_geVersion",H=function(a,b){return a!==F?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(c,a){function l(a,c,f,e,g,b){b=g?b?4:3:b?3:2;var d=f,h=f+b,k=0,l=0,p=f=0,y=0,w=0;for(--e;w<e;w++,d+=b,h+=b){var t=c[d],v=c[d+1],z=c[d+2],A=c[h],C=c[h+1],D=c[h+2],B=t*C-A*v,p=p+B,k=k+(t+A)*B,l=l+(v+C)*B;g&&(B=t*D-A*z,f+=(z+D)*B,y+=B);
t<a[0]&&(a[0]=t);t>a[1]&&(a[1]=t);v<a[2]&&(a[2]=v);v>a[3]&&(a[3]=v);g&&(z<a[4]&&(a[4]=z),z>a[5]&&(a[5]=z))}0<p&&(p*=-1);0<y&&(y*=-1);if(!p)return null;a=[k,l,.5*p];g&&(a[3]=f,a[4]=.5*y);return a}function g(a,c,f,e,g){g=e?g?4:3:g?3:2;for(var b=c,d=c+g,h=0,k=0,l=0,p=0,y=0,w=f-1;y<w;y++,b+=g,d+=g){var t=a[b],v=a[b+1],z=a[b+2],A=a[d],C=a[d+1],D=a[d+2],B;if(e){B=A-t;var E=C-v,F=D-z;B=Math.sqrt(B*B+E*E+F*F)}else B=A-t,E=C-v,B=Math.sqrt(B*B+E*E);B&&(h+=B,e?(t=[t+.5*(A-t),v+.5*(C-v),z+.5*(D-z)],k+=B*t[0],
l+=B*t[1],p+=B*t[2]):(t=[t+.5*(A-t),v+.5*(C-v)],k+=B*t[0],l+=B*t[1]))}return 0<h?e?[k/h,l/h,p/h]:[k/h,l/h]:0<f?e?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,c,f,e){if(!c||!c.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var h=a.coords,b=[],d=f?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],k=c.lengths,r=c.coords,n=f?e?4:3:e?3:2,u=0,y=0;y<k.length;y++){var w=k[y],t=l(d,r,u,w,f,e);t&&b.push(t);u+=w*n}b.sort(function(a,b){var c=a[2]-b[2];0===c&&f&&(c=a[4]-b[4]);return c});b.length&&(n=6*b[0][2],h[0]=b[0][0]/n,h[1]=b[0][1]/n,f&&(n=6*b[0][4],h[2]=0!==n?b[0][3]/n:0),h[0]<d[0]||h[0]>d[1]||h[1]<d[2]||h[1]>d[3]||f&&(h[2]<d[4]||h[2]>d[5]))&&(h.length=0);if(!h.length)if(c=
c.lengths[0]?g(r,0,k[0],f,e):null)h[0]=c[0],h[1]=c[1],f&&2<c.length&&(h[2]=c[2]);else return null;return a};a.lineCentroid=g})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u){function y(){return h.create(function(a){return c(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var w={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},t={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},v={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},z={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=y;a.getGeodesicBufferOperator=function(){return y().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,c){if(p.isPolygon(b)&&"esriGeometryPoint"===c.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var g=m.convertFromPolygon(new r.default,b,!1,!1);return h.resolve(function(a){return d.polygonContainsPoint(g,!1,!1,a)})}if(p.isPolygon(b)&&"esriGeometryMultipoint"===c.geometryType){var k=
m.convertFromPolygon(new r.default,b,!1,!1);if("esriSpatialRelContains"===a)return h.resolve(function(a){return d.polygonContainsMultipoint(k,!1,!1,a,c.hasZ,c.hasM)})}if(p.isExtent(b)&&"esriGeometryPoint"===c.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return h.resolve(function(a){return f.extentContainsPoint(b,u.getGeometry(c,a))});if(p.isExtent(b)&&"esriGeometryMultipoint"===c.geometryType&&"esriSpatialRelContains"===a)return h.resolve(function(a){return f.extentContainsMultipoint(b,
u.getGeometry(c,a))});if(p.isExtent(b)&&"esriSpatialRelIntersects"===a){var l=e.getExtentIntersector(c.geometryType);return h.resolve(function(a){return l(b,u.getGeometry(c,a))})}return y().then(function(d){var e=d[w[a]].bind(null,b);return function(a){return e(u.getGeometry(c,a))}})};a.checkSpatialQuerySupport=function(a,c,d){return g(this,void 0,void 0,function(){var e,f;return l(this,function(g){e=a.spatialRel;f=a.geometry;if(!f)return[2];if(!0!==t[e])throw new k("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!b.isValid(f.spatialReference)||!b.isValid(d))return[2];if(!0!==v[p.getJsonType(f)])throw new k("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==z[c])throw new k("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,n.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(p.isExtent(a))return!0;if(p.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(c,a){function l(a,c,h,f,e){if(!a)return!1;c=c?h?4:3:h?3:2;h=a.coords;var g=!1,b=0,d=0;for(a=a.lengths;d<a.length;d++){for(var k=a[d],l=b,n=b,u=b+k*c;n<u;n+=c){l=n+c;l===u&&(l=b);var y=h[n],w=h[n+1],t=h[l],l=h[l+1];(w<
e&&l>=e||l<e&&w>=e)&&y+(e-w)/(l-w)*(t-y)<f&&(g=!g)}b+=k*c}return g}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,c,h,f){return l(a,c,h,f.coords[0],f.coords[1])};a.polygonContainsMultipoint=function(a,c,h,f,e,p){e=e?p?4:3:p?3:2;p=f.coords;f=f.lengths;if(!f)return!1;for(var b=0,d=0;b<f.length;b++,d+=e)if(!l(a,c,h,p[d],p[d+1]))return!1;return!0};a.polygonContainsCoords=l})},"esri/layers/support/FieldsIndex":function(){define(["require","exports","../../core/tsSupport/extendsHelper"],
function(c,a,l){return function(){function a(a){this.fields=a;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this.dateFields=[];if(a){for(var c=[],f=0;f<a.length;f++){var e=a[f],g=e&&e.name;if(g){var b=g.toLowerCase().trim();this._fieldsMap.set(g,e);this._fieldsMap.set(b,e);c.push(b);if("date"===e.type||"esriFieldTypeDate"===e.type)this.dateFields.push(e),this._dateFieldsSet.add(e)}}c.sort();this.uid=c.join(",")}}a.prototype.destroy=function(){this._fieldsMap.clear()};a.prototype.has=function(a){return null!=
this.get(a)};a.prototype.get=function(a){return null!=a?this._fieldsMap.get(a)||this._fieldsMap.get(a.toLowerCase().trim()):void 0};a.prototype.isDateField=function(a){return this._dateFieldsSet.has(this.get(a))};a.prototype.normalizeFieldName=function(a){if(a=this.get(a))return a.name};return a}()})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._deferreds=
[];this._values=[]}a.prototype.push=function(a){var c=this;return l.create(function(f,e){c._deferreds.push({resolve:f,reject:e});c._values.push(a)})};a.prototype.unshift=function(a){var c=this;return l.create(function(f,e){c._deferreds.unshift({resolve:f,reject:e});c._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0});a.prototype.process=function(){if(0===this.length)return!1;this._deferreds.shift().resolve(this._values.shift());
return!0};a.prototype.cancelAll=function(){for(var a=l.createAbortError(),c=0,f=this._deferreds;c<f.length;c++)f[c].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=c})},"esri/tasks/support/Query":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../geometry ../../symbols ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../symbols/support/jsonUtils ./QuantizationParameters ./StatisticDefinition".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){var t=new p.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),v=new p.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function b(b){b=a.call(this,b)||this;b.cacheHint=!1;b.datumTransformation=null;b.distance=void 0;b.gdbVersion=null;b.geometry=null;b.geometryPrecision=void 0;b.groupByFieldsForStatistics=null;b.having=null;b.historicMoment=null;b.maxAllowableOffset=void 0;b.maxRecordCountFactor=1;b.multipatchOption=null;b.num=void 0;b.objectIds=null;b.orderByFields=
null;b.outFields=null;b.outSpatialReference=null;b.outStatistics=null;b.parameterValues=null;b.pixelSize=null;b.quantizationParameters=null;b.rangeValues=null;b.relationParameter=null;b.resultType=null;b.returnCentroid=!1;b.returnDistinctValues=!1;b.returnExceededLimitFeatures=!0;b.returnGeometry=!1;b.returnQueryGeometry=!1;b.returnM=void 0;b.returnZ=void 0;b.source=null;b.spatialRelationship="intersects";b.start=void 0;b.sqlFormat=null;b.text=null;b.timeExtent=null;b.units=null;b.where=null;return b}
l(b,a);c=b;b.from=function(a){return r.ensureClass(c,a)};b.prototype.castDatumTransformation=function(a){return"number"===typeof a||"object"===typeof a?a:null};b.prototype.writeHistoricMoment=function(a,b){b.historicMoment=a&&a.getTime()};b.prototype.writeParameterValues=function(a,b){if(a){var c={},d;for(d in a){var e=a[d];Array.isArray(e)?c[d]=e.map(function(a){return a instanceof Date?a.getTime():a}):c[d]=e instanceof Date?e.getTime():e}b.parameterValues=c}};b.prototype.writeStart=function(a,b){b.resultOffset=
this.start;b.resultRecordCount=this.num||10;b.where="1\x3d1"};b.prototype.writeWhere=function(a,b){b.where=a||"1\x3d1"};b.prototype.clone=function(){return new c(d.clone({cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment?new Date(this.historicMoment.getTime()):
null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,
returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,source:this.source,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))};var c;b.MAX_MAX_RECORD_COUNT_FACTOR=5;g([m.property({type:Boolean,
json:{write:!0,default:!1}})],b.prototype,"cacheHint",void 0);g([m.property({json:{write:!0}})],b.prototype,"datumTransformation",void 0);g([m.cast("datumTransformation")],b.prototype,"castDatumTransformation",null);g([m.property({type:Number,json:{write:{overridePolicy:function(a){return{enabled:0<a}}}}})],b.prototype,"distance",void 0);g([m.property({type:String,json:{write:!0}})],b.prototype,"gdbVersion",void 0);g([m.property({types:h.geometryTypes,json:{read:n.fromJSON,write:!0}})],b.prototype,
"geometry",void 0);g([m.property({type:Number,json:{write:!0}})],b.prototype,"geometryPrecision",void 0);g([m.property({type:[String],json:{write:!0}})],b.prototype,"groupByFieldsForStatistics",void 0);g([m.property({type:String,json:{write:!0}})],b.prototype,"having",void 0);g([m.property({type:Date})],b.prototype,"historicMoment",void 0);g([m.writer("historicMoment")],b.prototype,"writeHistoricMoment",null);g([m.property({type:Number,json:{write:!0}})],b.prototype,"maxAllowableOffset",void 0);g([m.property({type:Number,
cast:function(a){return 1>a?1:a>c.MAX_MAX_RECORD_COUNT_FACTOR?c.MAX_MAX_RECORD_COUNT_FACTOR:a},json:{write:{overridePolicy:function(a){return{enabled:1<a}}}}})],b.prototype,"maxRecordCountFactor",void 0);g([m.property({type:String,json:{write:!0}})],b.prototype,"multipatchOption",void 0);g([m.property({type:Number,json:{read:{source:"resultRecordCount"}}})],b.prototype,"num",void 0);g([m.property({type:[Number],json:{write:!0}})],b.prototype,"objectIds",void 0);g([m.property({type:[String],json:{write:!0}})],
b.prototype,"orderByFields",void 0);g([m.property({type:[String],json:{write:!0}})],b.prototype,"outFields",void 0);g([m.property({type:k.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],b.prototype,"outSpatialReference",void 0);g([m.property({type:[w],json:{write:!0}})],b.prototype,"outStatistics",void 0);g([m.property({json:{write:!0}})],b.prototype,"parameterValues",void 0);g([m.writer("parameterValues")],b.prototype,"writeParameterValues",null);g([m.property({types:f.symbolTypes,
json:{read:u.read,write:!0}})],b.prototype,"pixelSize",void 0);g([m.property({type:y.default,json:{write:!0}})],b.prototype,"quantizationParameters",void 0);g([m.property({type:[Object],json:{write:!0}})],b.prototype,"rangeValues",void 0);g([m.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(){return{enabled:"relation"===this.spatialRelationship}}}}})],b.prototype,"relationParameter",void 0);g([m.property({type:String,json:{write:!0}})],
b.prototype,"resultType",void 0);g([m.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnCentroid",void 0);g([m.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnDistinctValues",void 0);g([m.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:!a}}}}})],b.prototype,"returnExceededLimitFeatures",void 0);g([m.property({type:Boolean,json:{write:!0}})],b.prototype,"returnGeometry",
void 0);g([m.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnQueryGeometry",void 0);g([m.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnM",void 0);g([m.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnZ",void 0);g([m.property({json:{write:!0}})],b.prototype,"source",void 0);g([m.property({type:String,json:{read:{source:"spatialRel",
reader:t.read},write:{target:"spatialRel",writer:t.write}}})],b.prototype,"spatialRelationship",void 0);g([m.property({type:Number,json:{read:{source:"resultOffset"}}})],b.prototype,"start",void 0);g([m.writer("start"),m.writer("num")],b.prototype,"writeStart",null);g([m.property({type:String,json:{write:!0}})],b.prototype,"sqlFormat",void 0);g([m.property({type:String,json:{write:!0}})],b.prototype,"text",void 0);g([m.property({type:e,json:{write:!0}})],b.prototype,"timeExtent",void 0);g([m.property({type:String,
json:{read:v.read,write:{writer:v.write,overridePolicy:function(a){return{enabled:a&&0<this.distance}}}}})],b.prototype,"units",void 0);g([m.property({type:String,json:{write:{overridePolicy:function(a){return{enabled:null!=a||0<this.start}}}}})],b.prototype,"where",void 0);g([m.writer("where")],b.prototype,"writeWhere",null);return b=c=g([m.subclass("esri.tasks.support.Query")],b)}(m.declared(b.JSONSupport))})},"esri/TimeExtent":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/JSONSupport ./core/accessorSupport/decorators ./layers/support/timeUtils".split(" "),
function(c,a,l,g,k,h,f){return function(a){function c(b){b=a.call(this,b)||this;b.end=null;b.start=null;return b}l(c,a);b=c;c.prototype.readEnd=function(a,b){return null!=b.end?new Date(b.end):null};c.prototype.writeEnd=function(a,b,c){b.end=a?a.getTime():null};c.prototype.readStart=function(a,b){return null!=b.start?new Date(b.start):null};c.prototype.writeStart=function(a,b,c){b.start=a?a.getTime():null};c.prototype.clone=function(){return new b({end:this.end,start:this.start})};c.prototype.intersection=
function(a){if(!a)return null;var c=this.start?this.start.getTime():-Infinity,d=this.end?this.end.getTime():Infinity,e=a.start?a.start.getTime():-Infinity;a=a.end?a.end.getTime():Infinity;var f,g;e>=c&&e<=d?f=e:c>=e&&c<=a&&(f=c);d>=e&&d<=a?g=d:a>=c&&a<=d&&(g=a);return isNaN(f)||isNaN(g)?null:(c=new b,c.start=-Infinity===f?null:new Date(f),c.end=Infinity===g?null:new Date(g),c)};c.prototype.offset=function(a,c){var d=new b,e=this.start,g=this.end;e&&(d.start=f.offsetDate(e,a,c));g&&(d.end=f.offsetDate(g,
a,c));return d};c.prototype.equals=function(a){if(!a)return!1;var b=this.start?this.start.getTime():null,c=this.end?this.end.getTime():null,d=a.start?a.start.getTime():null;a=a.end?a.end.getTime():null;return b===d&&c===a};var b;g([h.property({type:Date,json:{write:{allowNull:!0}}})],c.prototype,"end",void 0);g([h.reader("end")],c.prototype,"readEnd",null);g([h.writer("end")],c.prototype,"writeEnd",null);g([h.property({type:Date,json:{write:{allowNull:!0}}})],c.prototype,"start",void 0);g([h.reader("start")],
c.prototype,"readStart",null);g([h.writer("start")],c.prototype,"writeStart",null);return c=b=g([h.subclass("esri.TimeExtent")],c)}(h.declared(k.JSONSupport))})},"esri/layers/support/timeUtils":function(){define(["require","exports","../../TimeExtent","../../core/compilerUtils","../../core/jsonMap"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});a.Milliseconds=function(a){return a};var h={milliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},seconds:{getter:"getUTCSeconds",
setter:"setUTCSeconds",multiplier:1},minutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},hours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},days:{getter:"getUTCDate",setter:"setUTCDate",multiplier:1},weeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},months:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},years:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},decades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},centuries:{getter:"getUTCFullYear",
setter:"setUTCFullYear",multiplier:100}};a.timeUnitKebabDictionary=k.strict()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:null});a.offsetDate=function(a,c,g){a=new Date(a.getTime());if(c&&g){g=h[g];var b=g.multiplier;a[g.setter](a[g.getter]()+
c*b)}return a};a.combinedViewLayerTimeExtentProperty={type:l,dependsOn:"view.timeExtent layer.timeExtent layer.timeInfo layer.timeOffset layer.timeOffset.value layer.timeOffset.unit layer.useViewTime".split(" "),readOnly:!0,get:function(){if(!this.layer||!this.layer.timeInfo)return null;var a=this.view?this.view.timeExtent:null,a=this.layer.useViewTime?a:this.layer.timeExtent;if(!a)return null;var c=this.layer.timeOffset,a=c?a.offset(-c.value,c.unit):a,c=this._get("timeExtent");return a.equals(c)?
c:a}};a.millisecondsPerTimeUnit={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};a.truncateDate=function(a,c){switch(c){case "milliseconds":return new Date(a.getTime());case "seconds":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());case "minutes":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes());case "hours":return new Date(a.getFullYear(),
a.getMonth(),a.getDate(),a.getHours());case "days":return new Date(a.getFullYear(),a.getMonth(),a.getDate());case "weeks":return new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay());case "months":return new Date(a.getFullYear(),a.getMonth(),1);case "years":return new Date(a.getFullYear(),0,1);case "decades":return new Date(a.getFullYear()-a.getFullYear()%10,0,1);case "centuries":return new Date(a.getFullYear()-a.getFullYear()%100,0,1);default:return g.neverReached(c),null}}})},"esri/tasks/support/StatisticDefinition":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h){return function(a){function c(b){b=a.call(this,b)||this;b.maxPointCount=void 0;b.maxRecordCount=void 0;b.maxVertexCount=void 0;b.onStatisticField=null;b.outStatisticFieldName=null;b.statisticType=null;return b}l(c,a);f=c;c.prototype.clone=function(){return new f({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType})};
var f;g([h.property({type:Number,json:{write:!0}})],c.prototype,"maxPointCount",void 0);g([h.property({type:Number,json:{write:!0}})],c.prototype,"maxRecordCount",void 0);g([h.property({type:Number,json:{write:!0}})],c.prototype,"maxVertexCount",void 0);g([h.property({type:String,json:{write:!0}})],c.prototype,"onStatisticField",void 0);g([h.property({type:String,json:{write:!0}})],c.prototype,"outStatisticFieldName",void 0);g([h.property({type:String,json:{write:!0}})],c.prototype,"statisticType",
void 0);return c=f=g([h.subclass("esri.tasks.support.StatisticDefinition")],c)}(h.declared(k.JSONSupport))})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../layers/support/FieldsIndex ../../../../../support/arcadeOnDemand ../../../../webgl ../../../engine ../../../arcade/utils ../../../engine/webgl/definitions ../tileRenderers/support/visualVariablesUtils @dojo/framework/shim/Promise".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){Object.defineProperty(a,"__esModule",{value:!0});var t=f.getLogger("esri.views.layers.2d.features.support.AttributeStore"),v=n.debug.createDebugLogger(n.debug.DEBUG_ATTR_UPDATES,t),z=function(a,b){return function(c,d,e){var f;try{f=b(c,d,e)}catch(L){f=NaN}return(null===f||isNaN(f)||Infinity===f)&&a||f}},A=h("esri-shared-array-buffer"),C=h("esri-webgl-texture-float"),D=h("esri-webgl-max-texture-size"),B=h("esri-atomics"),E=function(){function a(a,b,c,d){this.texelSize=
4;var e=d.pixelType,f=d.layout;this.textureOnly=(d=d.textureOnly)||!1;this.pixelType=e;this._ctype=b;this.layout=f;this._resetRange();this._shared=a;d||(this.data=this._initData(e,c,a,b))}Object.defineProperty(a.prototype,"buffer",{get:function(){return p.andThen(this.data,function(a){return a.buffer})},enumerable:!0,configurable:!0});a.prototype.getData=function(a,b){a&=2147483647;return p.expect(this.data)[a*this.texelSize+b]};a.prototype.setData=function(a,b,c){a&=2147483647;0===(this.layout&1<<
b)?t.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[a*this.texelSize+b]=c,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.lock=function(){5121===this.pixelType&&this._shared&&B&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};a.prototype.unlock=function(){5121===this.pixelType&&this._shared&&B&&"local"!==this._ctype&&Atomics.store(this.data,0,0)};a.prototype.expand=function(a){if(!this.textureOnly){a=
this._initData(this.pixelType,a,this._shared,this._ctype);var b=p.expect(this.data);a.set(b);this.data=a}};a.prototype.toMessage=function(){var a=this.dirtyStart,b=this.dirtyEnd,c=this.texelSize;if(a>b)return null;this._resetRange();var d=!this._shared&&"local"!==this._ctype,e=this.pixelType,f=this.layout,g=p.expect(this.data);if(!g.slice){if(!d)return{start:a,end:b,data:null,pixelType:e,layout:f};c=new (n.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,a*c,(b+1)*c));
return{start:a,end:b,data:c,pixelType:e,layout:f}}c=d&&g.slice(a*c,(b+1)*c)||null;return{start:a,end:b,data:c,pixelType:e,layout:f}};a.prototype._initData=function(a,b,c,d){c=c&&"local"!==d?SharedArrayBuffer:ArrayBuffer;a=n.Utils.getPixelArrayCtor(a);b=new a(new c(b*b*4*a.BYTES_PER_ELEMENT));for(a=0;a<b.length;a+=4)b[a+1]=255;return b};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};return a}();h=function(){function a(a){this._attributeComputeMap=new Map;this._blocks=
[];this._idMap=new Map;this._localToObjectId=new Map;this._filters=Array(n.definitions.MAX_FILTERS);this._freeTexelsList=[];this._abortController=b.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idCounter=1;this._idsToHighlight=new Set;var c=C?5126:5121;v("Creating AttributeStore "+(A?"with":"without")+" shared memory");this._client=a;this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:c,layout:15},{pixelType:c,layout:15}];this._blocks=
this._blockDescriptors.map(function(){return null})}a.prototype.destroy=function(){this._abortController.abort()};Object.defineProperty(a.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0});a.prototype.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=b.createAbortController()};
a.prototype.createLocalId=function(a,b){void 0===b&&(b=!1);if(!this._idMap.has(a)){var c=this._getFreeTexel();b=((b?2147483648:0)|c)>>>0;this._idMap.set(a,-1===b?0:b);this._localToObjectId.set(b,a)}return this._idMap.get(a)};a.prototype.addLocalId=function(a){this._getBlock(0).setData(a,0,0);this._freeTexelsList.push(a&2147483647)};a.prototype.removeLocalId=function(a){var b=this._idMap.get(a);this._idMap.delete(a);this._localToObjectId.delete(b);return b};a.prototype.freeLocalId=function(a){var b=
this._idMap.get(a);this._getBlock(0).setData(b,0,0);this._idMap.delete(a);this._localToObjectId.delete(b);this._freeTexelsList.push(b&2147483647)};a.prototype.getFeatureId=function(a){return this._localToObjectId.get(a)};a.prototype.getLocalId=function(a){return this._idMap.has(a)?this._idMap.get(a):null};a.prototype.setHighlight=function(a){return g(this,void 0,void 0,function(){var b,c,d,e,f,g,h=this;return l(this,function(k){switch(k.label){case 0:this._getBlock(0).lock();this._idsToHighlight.forEach(function(a){if(a=
h.getLocalId(a)){var b=h._getBlock(0).getData(a,0);h._getBlock(0).setData(a,0,b&-2)}});this._idsToHighlight.clear();b=0;for(c=a;b<c.length;b++)d=c[b],this._idsToHighlight.add(d);for(e=0;e<a.length;e++)f=this.getLocalId(a[e]),null!=f&&(g=this._getBlock(0).getData(f,0),this._getBlock(0).setData(f,0,g|1));this._getBlock(0).unlock();return[4,this.sendUpdates()];case 1:return k.sent(),[2]}})})};a.prototype.addHighlight=function(){return g(this,void 0,void 0,function(){return l(this,function(a){return[2]})})};
a.prototype.removeHighlight=function(){return g(this,void 0,void 0,function(){return l(this,function(a){return[2]})})};a.prototype.updateFilters=function(a){return g(this,void 0,void 0,function(){var c,d,e,f,g,h=this;return l(this,function(k){switch(k.label){case 0:return c=a.config,d=a.service,e=a.spatialReference,f=c.filters,g=f.map(function(b,c){return h._updateFilter(a,b,c,d,e)}),[4,b.all(g)];case 1:return k.sent(),[2]}})})};a.prototype.setAttributeBindings=function(a,b){return g(this,void 0,
void 0,function(){return l(this,function(c){this._hasScaleExpr=!1;switch(a.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":return[2,this._bindVVEvaluators(a.visualVariables,b)];case "dot-density":return[2,this._bindDDEvaluators(a.attributes,b)];case "heatmap":break;default:t.error(new k("attribute-store","Found invalid renderer type: "+a))}return[2]})})};a.prototype.setData=function(a,b,c,d){this._getBlock(b).setData(a,c,d)};a.prototype.getData=function(a,b,c){return this._getBlock(b).getData(a,
c)};a.prototype.getHighlightFlag=function(a){return this._idsToHighlight.has(a)?y.HIGHLIGHT_FLAG:0};a.prototype.setAttributeData=function(a,b,c,d){var f=this;this._getBlock(0).setData(a,0,this.getFilterFlags(b));var g=C?1:2;this._attributeComputeMap.forEach(function(h,k){var l=k*g%4;k=f._getBlock(Math.floor(k*g/4)+y.ATTRIBUTE_DATA_VV);h=h(b,{$view:d},c);if(C)k.setData(a,l,h);else if(h===n.definitions.NAN_MAGIC_NUMBER)k.setData(a,l,255),k.setData(a,l+1,255);else{h=e.clamp(Math.round(h),-32767,32766)+
32768;var m=(h&65280)>>8;k.setData(a,l,h&255);k.setData(a,l+1,m)}})};a.prototype.sendUpdates=function(){var a=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=b.createResolver(),this._nextUpdate.promise;var c={blocks:this._blocks.map(function(a){return p.isSome(a)?a.toMessage():null})};return this._currUpdate=this._createResources().then(function(){var b=function(){a._currUpdate=null;if(a._nextUpdate){var b=a._nextUpdate;a._nextUpdate=null;a.sendUpdates().then(function(){return b.resolve()})}},
b=a._client.update(c,a._signal).then(b).catch(b);a._client.render();return b}).catch(function(c){if(b.isAbortError(c))return a._createResourcesPromise=null,a._createResources();t.error(new k("mapview-attribute-store","Encountered an error during client update",c));return b.resolve()})};a.prototype._createResources=function(){var a=this;if(p.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(y.ATTRIBUTE_DATA_ANIMATION);v("Initializing AttributeStore");var c={shared:A&&
"local"!==this._client.type,size:this._size,blocks:p.mapMany(this._blocks,function(a){return{textureOnly:a.textureOnly,buffer:a.buffer,pixelType:a.pixelType}})};this._createResourcesPromise=c=this._client.initialize(c,this._signal).catch(function(c){b.isAbortError(c)&&(a._createResourcesPromise=null);t.error(new k("mapview-attribute-store","Encountered an error during client initialization",c))});c.then(function(){return p.isNone(a._createResourcesPromise)?a._createResources():void 0});return c};
a.prototype._getBlock=function(a){var b=this._blocks[a];if(p.isSome(b))return b;v("Initializing AttributeBlock at index "+a);b=new E(A,this._client.type,this._size,this._blockDescriptors[a]);this._blocks[a]=b;this._createResourcesPromise=null;return b};a.prototype._expand=function(){if(this._size<D){var a=this._size<<=1;v("Expanding block size to",a,this._blocks);p.forEachSome(this._blocks,function(b){return b.expand(a)});this._createResourcesPromise=null;this._size=a;return 0}t.error(new k("mapview-limitations",
"Maximum number of onscreen features exceeded."));return-1};a.prototype._getFreeTexel=function(){return this._freeTexelsList.length?this._freeTexelsList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++};a.prototype._updateFilter=function(a,b,c,d,e){return g(this,void 0,void 0,function(){var f,g,h,k,m,n,r,t,u,v=this;return l(this,function(l){switch(l.label){case 0:f=this._filters[c];g=p.isSome(f)&&f.hash;if(g===JSON.stringify(b))return[2];h=1<<c+1;return p.isNone(b)?
(this._filters[c]=null,this._idMap.forEach(function(a){var b=v._getBlock(0).getData(a,0);v._getBlock(0).setData(a,0,b|h)}),[2]):[4,a.queryObjectIds(b)];case 1:return k=l.sent(),b.hiddenIds&&b.hiddenIds.length&&(k=k.filter(function(a){return-1===b.hiddenIds.indexOf(a)})),m=k.map(function(a){return v._idMap.get(a)}),[4,this._getFilter(c,d)];case 2:n=l.sent();n.update(b,e);this._getBlock(0).lock();this._idMap.forEach(function(a){if(1!==(a&2147483648)>>>31){var b=v._getBlock(0).getData(a,0);v._getBlock(0).setData(a,
0,b&~h)}});for(r=0;r<m.length;r++)t=m[r],null!=t&&(u=this._getBlock(0).getData(t,0),this._getBlock(0).setData(t,0,u|h));this._getBlock(0).unlock();return[2]}})})};a.prototype._getFilter=function(a,b){return g(this,void 0,void 0,function(){var e,f,g;return l(this,function(h){switch(h.label){case 0:return e=this._filters[a],p.isSome(e)?[2,e]:[4,new Promise(function(a,b){c(["../../../../../layers/graphics/data/FeatureFilter"],a,b)})];case 1:return f=h.sent().default,g=new f({geometryType:b.geometryType,
hasM:!1,hasZ:!1,timeInfo:b.timeInfo,fieldsIndex:new d(b.fields)}),this._filters[a]=g,[2,g]}})})};a.prototype.isVisible=function(a){return!!(this._getBlock(0).getData(a.localId,0)&2)};a.prototype.getFilterFlags=function(a){for(var b=0,c=1===(a.localId&2147483648)>>>31?254:255,d=0;d<this._filters.length;d++)var e=this._filters[d],e=!(c&1<<d)||p.isNone(e)||e.check(a),b=b|(e?1:0)<<d;a=this.getFeatureId(a.localId);return b<<1|this.getHighlightFlag(a)};a.prototype._bindVVEvaluators=function(a,c){return g(this,
void 0,void 0,function(){var d,e=this;return l(this,function(f){switch(f.label){case 0:this._attributeComputeMap.clear();if(!p.isSome(a))return[3,2];d=b.all(a.map(function(a){return g(e,void 0,void 0,function(){var b,d;return l(this,function(e){switch(e.label){case 0:return b=n.Utils.getVVType(a.type),[4,this._createGetValueFunction(a,c)];case 1:return d=e.sent(),p.isSome(d)&&this._attributeComputeMap.set(b,d),[2]}})})}));return[4,d];case 1:f.sent(),f.label=2;case 2:return[2]}})})};a.prototype._bindDDEvaluators=
function(a,c){return g(this,void 0,void 0,function(){var d,e,f,g=this;return l(this,function(h){switch(h.label){case 0:return this._attributeComputeMap.clear(),a.length>n.definitions.DOT_DENSITY_MAX_FIELDS&&t.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+n.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+a.length),[4,b.all(a.map(function(a){return g._createNormalizedFunction(a,c)}))];case 1:d=h.sent().map(function(a){return z(0,a)});for(e=0;e<n.definitions.DOT_DENSITY_MAX_FIELDS;e++)(f=
e<a.length&&d[e])?this._attributeComputeMap.set(e,f):this._attributeComputeMap.has(e)&&this._attributeComputeMap.delete(e);return[2]}})})};a.prototype._createGetValueFunction=function(a,b){return g(this,void 0,void 0,function(){var c,d,e,f,g,h,k;return l(this,function(l){switch(l.label){case 0:if("size"!==a.type)return[3,2];c=n.getTypeOfSizeVisualVariable(a);if(c===n.enums.WGLVVFlag.SIZE_SCALE_STOPS)return[2,null];e=(d=c===n.enums.WGLVVFlag.SIZE_UNIT_VALUE)&&function(b){return w.getVisualVariableSizeValueRepresentationRatio(b,
a.valueRepresentation)};f=z;g=[n.definitions.NAN_MAGIC_NUMBER];return[4,this._createNormalizedFunction(a,b,e)];case 1:return[2,f.apply(void 0,g.concat([l.sent()]))];case 2:return h=z,k=[n.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(a,b)];case 3:return[2,h.apply(void 0,k.concat([l.sent()]))]}})})};a.prototype._createNormalizedFunction=function(a,b,c){return g(this,void 0,void 0,function(){var d,e,f;return l(this,function(g){switch(g.label){case 0:if(d=a.field){if("string"===typeof d)return(e=
a.normalizationField)?[2,function(a){if(a.attributes[d]&&a.attributes[e])return a=a.attributes[d]/a.attributes[e],c?c(a):a}]:[2,c?function(a){return c(a.attributes[d])}:function(a){return a.attributes[d]}];t.error(new k("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof d));return[2,function(){}]}if(!a.valueExpression)return[3,2];this._hasScaleExpr=this._hasScaleExpr||-1!==a.valueExpression.indexOf("scale");return[4,m.createVVExpression(a.valueExpression,
b.spatialReference,b.fields)];case 1:return f=g.sent(),[2,u.callWithOptimizedFeature.bind(null,f)];case 2:return t.error("Unable to create a normalized function for visual variable: "+a),[2,function(){}]}})})};return a}();a.default=h})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("require exports ../../../../../../core/tsSupport/assignHelper ../../../../../../core/screenUtils ../../../../engine ../../../../engine/webgl/definitions ../../../../../3d/layers/support/FastSymbolUpdates".split(" "),
function(c,a,l,g,k,h,f){function e(a){return{value:a.value,size:g.toPt(a.size)}}function p(a){return a.map(function(a){return e(a)})}function b(a){return"string"===typeof a||"number"===typeof a?g.toPt(a):{type:"size",expression:a.expression,stops:p(a.stops)}}function d(a){var b={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(k.Utils.isString(a.field))if(a.stops){if(8<a.stops.length)return null;var c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.values[a]=d.value;b.opacities[a]=
d.opacity}}else return null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].opacity,a=0;8>a;a++)b.values[a]=Infinity,b.opacities[a]=c;else return null;return b}Object.defineProperty(a,"__esModule",{value:!0});var m=k.enums.WGLVVFlag;a.getVisualVariableSizeValueRepresentationRatio=function(a,b){if(!a||!b)return a;switch(b){case "radius":case "distance":return 2*a;case "area":return Math.sqrt(a)}return a};a.stopToSizeStop=e;a.normalizeSizeStops=p;a.normalizeSizeElement=
b;a.getVisualVariablesFields=function(a){var b=a&&0<a.length?{}:null;b&&a.forEach(function(a){var c=a.type;a.field&&(b[c]=a.field)});return b};var r=function(a){var b=[],c=[];a=p(a);for(var d=a.length,e=0;6>e;e++){var f=a[Math.min(e,d-1)];b.push(f.value);c.push(null==f.size?h.NAN_MAGIC_NUMBER:g.pt2px(f.size))}return{values:new Float32Array(b),sizes:new Float32Array(c)}};a.convertVisualVariables=function(a){var c=a&&0<a.length?{}:null,e=c?{}:null;if(!c)return{vvFields:c,vvRanges:e};for(var g=0;g<a.length;g++){var h=
a[g],n=h.type;h.field&&(c[n]=h.field);if("size"===n)switch(e.size||(e.size={}),k.getTypeOfSizeVisualVariable(h)){case m.SIZE_MINMAX_VALUE:e.size.minMaxValue={minDataValue:h.minDataValue,maxDataValue:h.maxDataValue,minSize:b(h.minSize),maxSize:b(h.maxSize)};break;case m.SIZE_SCALE_STOPS:e.size.scaleStops={stops:p(h.stops)};break;case m.SIZE_FIELD_STOPS:if(h.levels){var n={},z;for(z in h.levels)n[z]=r(h.levels[z]);e.size.fieldStops={type:"level-dependent",levels:n}}else e.size.fieldStops=l({type:"static"},
r(h.stops));break;case m.SIZE_UNIT_VALUE:e.size.unitValue={unit:h.valueUnit,valueRepresentation:h.valueRepresentation}}else if("color"===n)for(h=f.convertVisualVariables([h],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}),e.color=h.color,h=0;32>h;h+=4)k.color.premultiplyAlpha(e.color.colors,h,!0);else"opacity"===n?e.opacity=d(h):"rotation"===n&&(e.rotation={type:h.rotationType})}return{vvFields:c,vvRanges:e}}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){function r(a){return null!==a&&void 0!==a}function n(a){return"number"===typeof a}function u(a){return"string"===typeof a}function y(a,b){a&&a.push(b)}function w(a,b,c,e,f){var g=a.minSize,h=a.maxSize;if(a.expression)return y(f,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=e.symbolSize[c],b.minSize[c]=a,b.maxSize[c]=a,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(r(a.field)){if(r(a.stops)){if(2===a.stops.length&&
n(a.stops[0].size)&&n(a.stops[1].size))return t(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,b,c),b.type[c]=1,!0;y(f,"Could not convert size info: stops only supported with 2 elements");return!1}if(n(g)&&n(h)&&r(a.minDataValue)&&r(a.maxDataValue))return t(g,h,a.minDataValue,a.maxDataValue,b,c),b.type[c]=1,!0;if(null!=d.meterIn[a.valueUnit])return b.minSize[c]=-Infinity,b.maxSize[c]=Infinity,b.offset[c]=0,b.factor[c]=1/d.meterIn[a.valueUnit],b.type[c]=1,!0;if("unknown"===a.valueUnit)return y(f,
"Could not convert size info: proportional size not supported"),!1;y(f,"Could not convert size info: scale-dependent size not supported");return!1}if(!r(a.field)){if(a.stops&&a.stops[0]&&n(a.stops[0].size))return b.minSize[c]=a.stops[0].size,b.maxSize[c]=a.stops[0].size,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(n(g))return b.minSize[c]=g,b.maxSize[c]=g,b.offset[c]=g,b.factor[c]=0,b.type[c]=1,!0}y(f,"Could not convert size info: unsupported variant of sizeInfo");return!1}function t(a,
b,c,d,e,f){d=0<Math.abs(d-c)?(b-a)/(d-c):0;e.minSize[f]=0<d?a:b;e.maxSize[f]=0<d?b:a;e.offset[f]=a-c*d;e.factor[f]=d}function v(a,b,c,d){if(a.normalizationField||a.valueRepresentation)return y(d,"Could not convert size info: unsupported property"),null;var e=a.field;if(null!=e&&!u(e))return y(d,"Could not convert size info: field is not a string"),null;if(!b.size)b.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=
a.field;else if(a.field!==b.size.field)return y(d,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(e=w(a,b.size,0,c,d))?b:null;case "height":return(e=w(a,b.size,2,c,d))?b:null;case "depth":return(e=w(a,b.size,1,c,d))?b:null;case "width-and-depth":return(e=w(a,b.size,0,c,d))&&w(a,b.size,1,c,d),e?b:null;case null:case void 0:case "all":return(e=(e=(e=w(a,b.size,0,c,d))&&w(a,b.size,1,c,d))&&w(a,b.size,2,c,d))?b:null;default:return y(d,'Could not convert size info: unknown axis "'+
a.axis+'""'),null}}function z(a,b,c){for(var d=0;3>d;++d){var e=b.unitInMeters;1===a.type[d]&&(e*=b.modelSize[d],a.type[d]=2);a.minSize[d]/=e;a.maxSize[d]/=e;a.offset[d]/=e;a.factor[d]/=e}if(0!==a.type[0])b=0;else if(0!==a.type[1])b=1;else if(0!==a.type[2])b=2;else return y(c,"No size axis contains a valid size or scale"),!1;for(d=0;3>d;++d)0===a.type[d]&&(a.minSize[d]=a.minSize[b],a.maxSize[d]=a.maxSize[b],a.offset[d]=a.offset[b],a.factor[d]=a.factor[b],a.type[d]=a.type[b]);return!0}function A(a,
b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function C(a,b,c){if(a.normalizationField)return y(c,"Could not convert color info: unsupported property"),null;if(u(a.field))if(a.stops){if(8<a.stops.length)return y(c,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.color.values[a]=d.value;
A(b.color.colors,a,d.color)}}else return y(c,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].color,b.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.color.values[a]=Infinity,A(b.color.colors,a,c);else return y(c,"Could not convert color info: no field and no colors/stops"),null;return b}function D(a,b,c){if(a.normalizationField)return y(c,
"Could not convert opacity info: unsupported property"),null;if(u(a.field))if(a.stops){if(8<a.stops.length)return y(c,"Could not convert opacity info: too many opacity stops"),null;b.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.opacity.values[a]=d.value;b.opacity.opacityValues[a]=d.opacity}}else return y(c,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(c=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,b.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.opacity.values[a]=Infinity,b.opacity.opacityValues[a]=c;else return y(c,"Could not convert opacity info: no field and no opacities/stops"),null;return b}function B(a,b,c){a=2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function E(a,b,c){if(!u(a.field))return y(c,"Could not convert rotation info: field is not a string"),
null;if(!b.rotation)b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!b.rotation.field)b.rotation.field=a.field;else if(a.field!==b.rotation.field)return y(c,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return B(a,b.rotation,0),b;case "roll":return B(a,b.rotation,1),b;case null:case void 0:case "heading":return B(a,b.rotation,2),b;default:return y(c,'Could not convert rotation info: unknown axis "'+a.axis+'""'),
null}}function F(a,b,c){if(!a)return null;var d=!b.supportedTypes||!!b.supportedTypes.size,e=!b.supportedTypes||!!b.supportedTypes.color,f=!b.supportedTypes||!!b.supportedTypes.rotation,g=!!b.supportedTypes&&!!b.supportedTypes.opacity,h=a.reduce(function(a,h){if(!a)return a;if(h.valueExpression)return y(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(h.type){case "size":return d?v(h,a,b,c):a;case "color":return e?C(h,a,c):a;case "opacity":return g?D(h,a,c):null;
case "rotation":return f?E(h,a,c):a;default:return l.neverReached(h),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&h&&!h.size&&!h.color&&!h.opacity&&!h.rotation||h&&h.size&&!z(h.size,b,c)?null:h}function H(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function J(a,b){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},d=a&&null!=a.size;a&&a.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=a.size.minSize,c.vvSizeMaxSize=a.size.maxSize,c.vvSizeOffset=a.size.offset,c.vvSizeFactor=a.size.factor):a&&d&&(c.vvSizeValue=b.transformation.scale);if(a&&d){c.vvSymbolAnchor=b.transformation.anchor;c.vvSymbolRotationMatrix=h.mat3f64.create();
f.mat4.identity(G);var g=b.transformation.rotation[2],d=b.transformation.rotation[0],l=b.transformation.rotation[1];b=G;void 0===b&&(b=e.mat4f64.create());g=g||0;d=d||0;l=l||0;0!==g&&f.mat4.rotateZ(b,b,-g/180*Math.PI);0!==d&&f.mat4.rotateX(b,b,d/180*Math.PI);0!==l&&f.mat4.rotateY(b,b,l/180*Math.PI);k.mat3.fromMat4(c.vvSymbolRotationMatrix,G)}a&&a.color&&(c.vvColorEnabled=!0,c.vvColorValues=a.color.values,c.vvColorColors=a.color.colors);a&&a.opacity&&(c.vvOpacityEnabled=!0,c.vvOpacityValues=a.opacity.values,
c.vvOpacityOpacities=a.opacity.opacityValues);return c}Object.defineProperty(a,"__esModule",{value:!0});a.convertVisualVariables=F;a.initFastSymbolUpdatesState=function(a,b){return!a||m.DISABLE_FAST_UPDATES?{enabled:!1}:(a=F(a.visualVariables,b))?{enabled:!0,visualVariables:a,materialParameters:J(a,b),requiresShaderTransformation:a&&null!=a.size}:{enabled:!1}};a.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var d=a.visualVariables;b=F(b.visualVariables,c);if(!(b&&H(d.size,
b.size,"size")&&H(d.color,b.color,"color")&&H(d.rotation,b.rotation,"rotation")&&H(d.opacity,b.opacity,"opacity")))return!1;a.visualVariables=b;a.materialParameters=J(b,c);a.requiresShaderTransformation=b&&null!=b.size;return!0};a.getMaterialParams=J;var K;(function(a){var c=e.mat4f64.create(),d=b.vec3f64.create();a.evaluateModelTransform=function(a,b,e){if(!a.vvSizeEnabled)return e;f.mat4.copy(c,e);e=a.vvSymbolRotationMatrix;f.mat4.set(G,e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1);
f.mat4.multiply(c,c,G);for(e=0;3>e;++e)d[e]=g.clamp(a.vvSizeOffset[e]+b[0]*a.vvSizeFactor[e],a.vvSizeMinSize[e],a.vvSizeMaxSize[e]);f.mat4.scale(c,c,d);f.mat4.translate(c,c,a.vvSymbolAnchor);return c};a.evaluateModelTransformScale=function(a,b,c){if(!b.vvSizeEnabled)return p.vec3.set(a,1,1,1);for(var d=0;3>d;++d)a[d]=g.clamp(b.vvSizeOffset[d]+c[0]*b.vvSizeFactor[d],b.vvSizeMinSize[d],b.vvSizeMaxSize[d]);return a}})(K||(K={}));var G=e.mat4f64.create();a.evaluateModelTransform=K.evaluateModelTransform;
a.evaluateModelTransformScale=K.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f64=l})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,0,1,0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],
a[7],a[8]]};a.fromValues=function(a,c,k,h,f,e,p,b,d){return[a,c,k,h,f,e,p,b,d]};a.createView=function(a,c){return new Float64Array(a,c,9)}})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat4=l})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(c,a,l,g){function k(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;
a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function h(a,c,e){var b=c[0],d=c[1],f=c[2],g=c[3],h=c[4],k=c[5],l=c[6],m=c[7],p=c[8],C=c[9],D=c[10],B=c[11],E=c[12],F=c[13],H=c[14];c=c[15];var J=e[0],K=e[1],G=e[2],I=e[3];a[0]=J*b+K*h+G*p+I*E;a[1]=J*d+K*k+G*C+I*F;a[2]=J*f+K*l+G*D+I*H;a[3]=J*g+K*m+G*B+I*c;J=e[4];K=e[5];G=e[6];I=e[7];a[4]=J*b+K*h+G*p+I*E;a[5]=J*d+K*k+G*C+I*F;a[6]=J*f+K*l+G*D+I*H;a[7]=J*g+K*m+G*B+I*c;J=e[8];K=e[9];G=e[10];I=e[11];a[8]=J*b+K*h+G*p+I*E;a[9]=
J*d+K*k+G*C+I*F;a[10]=J*f+K*l+G*D+I*H;a[11]=J*g+K*m+G*B+I*c;J=e[12];K=e[13];G=e[14];I=e[15];a[12]=J*b+K*h+G*p+I*E;a[13]=J*d+K*k+G*C+I*F;a[14]=J*f+K*l+G*D+I*H;a[15]=J*g+K*m+G*B+I*c;return a}function f(a,c,e){var b=c[0],d=c[1],f=c[2],g=c[3],h=b+b,k=d+d,l=f+f;c=b*h;var m=b*k,b=b*l,p=d*k,d=d*l,f=f*l,h=g*h,k=g*k,g=g*l;a[0]=1-(p+f);a[1]=m+g;a[2]=b-k;a[3]=0;a[4]=m-g;a[5]=1-(c+f);a[6]=d+h;a[7]=0;a[8]=b+k;a[9]=d-h;a[10]=1-(c+p);a[11]=0;a[12]=e[0];a[13]=e[1];a[14]=e[2];a[15]=1;return a}function e(a,c,e){a[0]=
c[0]-e[0];a[1]=c[1]-e[1];a[2]=c[2]-e[2];a[3]=c[3]-e[3];a[4]=c[4]-e[4];a[5]=c[5]-e[5];a[6]=c[6]-e[6];a[7]=c[7]-e[7];a[8]=c[8]-e[8];a[9]=c[9]-e[9];a[10]=c[10]-e[10];a[11]=c[11]-e[11];a[12]=c[12]-e[12];a[13]=c[13]-e[13];a[14]=c[14]-e[14];a[15]=c[15]-e[15];return a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];a[9]=c[9];a[10]=c[10];a[11]=c[11];a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];
return a};a.set=function(a,c,e,f,g,h,k,l,p,v,z,A,C,D,B,E,F){a[0]=c;a[1]=e;a[2]=f;a[3]=g;a[4]=h;a[5]=k;a[6]=l;a[7]=p;a[8]=v;a[9]=z;a[10]=A;a[11]=C;a[12]=D;a[13]=B;a[14]=E;a[15]=F;return a};a.identity=k;a.transpose=function(a,c){if(a===c){var b=c[1],d=c[2],e=c[3],f=c[6],g=c[7],h=c[11];a[1]=c[4];a[2]=c[8];a[3]=c[12];a[4]=b;a[6]=c[9];a[7]=c[13];a[8]=d;a[9]=f;a[11]=c[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=c[0],a[1]=c[4],a[2]=c[8],a[3]=c[12],a[4]=c[1],a[5]=c[5],a[6]=c[9],a[7]=c[13],a[8]=c[2],a[9]=c[6],a[10]=
c[10],a[11]=c[14],a[12]=c[3],a[13]=c[7],a[14]=c[11],a[15]=c[15];return a};a.invert=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],l=c[7],p=c[8],A=c[9],C=c[10],D=c[11],B=c[12],E=c[13],F=c[14];c=c[15];var H=b*h-d*g,J=b*k-e*g,K=b*l-f*g,G=d*k-e*h,I=d*l-f*h,L=e*l-f*k,R=p*E-A*B,M=p*F-C*B,Q=p*c-D*B,N=A*F-C*E,U=A*c-D*E,V=C*c-D*F,S=H*V-J*U+K*N+G*Q-I*M+L*R;if(!S)return null;S=1/S;a[0]=(h*V-k*U+l*N)*S;a[1]=(e*U-d*V-f*N)*S;a[2]=(E*L-F*I+c*G)*S;a[3]=(C*I-A*L-D*G)*S;a[4]=(k*Q-g*V-l*M)*S;a[5]=
(b*V-e*Q+f*M)*S;a[6]=(F*K-B*L-c*J)*S;a[7]=(p*L-C*K+D*J)*S;a[8]=(g*U-h*Q+l*R)*S;a[9]=(d*Q-b*U-f*R)*S;a[10]=(B*I-E*K+c*H)*S;a[11]=(A*K-p*I-D*H)*S;a[12]=(h*M-g*N-k*R)*S;a[13]=(b*N-d*M+e*R)*S;a[14]=(E*J-B*G-F*H)*S;a[15]=(p*G-A*J+C*H)*S;return a};a.adjoint=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],l=c[7],p=c[8],A=c[9],C=c[10],D=c[11],B=c[12],E=c[13],F=c[14];c=c[15];a[0]=h*(C*c-D*F)-A*(k*c-l*F)+E*(k*D-l*C);a[1]=-(d*(C*c-D*F)-A*(e*c-f*F)+E*(e*D-f*C));a[2]=d*(k*c-l*F)-h*(e*c-f*F)+
E*(e*l-f*k);a[3]=-(d*(k*D-l*C)-h*(e*D-f*C)+A*(e*l-f*k));a[4]=-(g*(C*c-D*F)-p*(k*c-l*F)+B*(k*D-l*C));a[5]=b*(C*c-D*F)-p*(e*c-f*F)+B*(e*D-f*C);a[6]=-(b*(k*c-l*F)-g*(e*c-f*F)+B*(e*l-f*k));a[7]=b*(k*D-l*C)-g*(e*D-f*C)+p*(e*l-f*k);a[8]=g*(A*c-D*E)-p*(h*c-l*E)+B*(h*D-l*A);a[9]=-(b*(A*c-D*E)-p*(d*c-f*E)+B*(d*D-f*A));a[10]=b*(h*c-l*E)-g*(d*c-f*E)+B*(d*l-f*h);a[11]=-(b*(h*D-l*A)-g*(d*D-f*A)+p*(d*l-f*h));a[12]=-(g*(A*F-C*E)-p*(h*F-k*E)+B*(h*C-k*A));a[13]=b*(A*F-C*E)-p*(d*F-e*E)+B*(d*C-e*A);a[14]=-(b*(h*F-k*
E)-g*(d*F-e*E)+B*(d*k-e*h));a[15]=b*(h*C-k*A)-g*(d*C-e*A)+p*(d*k-e*h);return a};a.determinant=function(a){var b=a[0],c=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],p=a[8],z=a[9],A=a[10],C=a[11],D=a[12],B=a[13],E=a[14];a=a[15];return(b*h-c*g)*(A*a-C*E)-(b*k-e*g)*(z*a-C*B)+(b*l-f*g)*(z*E-A*B)+(c*k-e*h)*(p*a-C*D)-(c*l-f*h)*(p*E-A*D)+(e*l-f*k)*(p*B-z*D)};a.multiply=h;a.translate=function(a,c,e){var b=e[0],d=e[1];e=e[2];var f=void 0,g=void 0,h=void 0,k=void 0,l=void 0,m=void 0,p=void 0,C=void 0,D=void 0,
B=void 0,E=void 0,F=void 0;c===a?(a[12]=c[0]*b+c[4]*d+c[8]*e+c[12],a[13]=c[1]*b+c[5]*d+c[9]*e+c[13],a[14]=c[2]*b+c[6]*d+c[10]*e+c[14],a[15]=c[3]*b+c[7]*d+c[11]*e+c[15]):(f=c[0],g=c[1],h=c[2],k=c[3],l=c[4],m=c[5],p=c[6],C=c[7],D=c[8],B=c[9],E=c[10],F=c[11],a[0]=f,a[1]=g,a[2]=h,a[3]=k,a[4]=l,a[5]=m,a[6]=p,a[7]=C,a[8]=D,a[9]=B,a[10]=E,a[11]=F,a[12]=f*b+l*d+D*e+c[12],a[13]=g*b+m*d+B*e+c[13],a[14]=h*b+p*d+E*e+c[14],a[15]=k*b+C*d+F*e+c[15]);return a};a.scale=function(a,c,e){var b=e[0],d=e[1];e=e[2];a[0]=
c[0]*b;a[1]=c[1]*b;a[2]=c[2]*b;a[3]=c[3]*b;a[4]=c[4]*d;a[5]=c[5]*d;a[6]=c[6]*d;a[7]=c[7]*d;a[8]=c[8]*e;a[9]=c[9]*e;a[10]=c[10]*e;a[11]=c[11]*e;a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a};a.rotate=function(a,c,e,f){var b=f[0],d=f[1];f=f[2];var h=Math.sqrt(b*b+d*d+f*f),k=void 0,l=void 0,m=void 0,p=void 0,r=void 0,C=void 0,D=void 0,B=void 0,E=void 0,F=void 0,H=void 0,J=void 0,K=void 0,G=void 0,I=void 0,L=void 0,R=void 0,M=void 0,Q=void 0,N=void 0,U=void 0,V=void 0,l=k=void 0;if(h<g.EPSILON)return null;
h=1/h;b*=h;d*=h;f*=h;k=Math.sin(e);l=Math.cos(e);m=1-l;p=c[0];r=c[1];C=c[2];D=c[3];B=c[4];E=c[5];F=c[6];H=c[7];J=c[8];K=c[9];G=c[10];I=c[11];L=b*b*m+l;R=d*b*m+f*k;M=f*b*m-d*k;Q=b*d*m-f*k;N=d*d*m+l;U=f*d*m+b*k;V=b*f*m+d*k;k=d*f*m-b*k;l=f*f*m+l;a[0]=p*L+B*R+J*M;a[1]=r*L+E*R+K*M;a[2]=C*L+F*R+G*M;a[3]=D*L+H*R+I*M;a[4]=p*Q+B*N+J*U;a[5]=r*Q+E*N+K*U;a[6]=C*Q+F*N+G*U;a[7]=D*Q+H*N+I*U;a[8]=p*V+B*k+J*l;a[9]=r*V+E*k+K*l;a[10]=C*V+F*k+G*l;a[11]=D*V+H*k+I*l;c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);
return a};a.rotateX=function(a,c,e){var b=Math.sin(e);e=Math.cos(e);var d=c[4],f=c[5],g=c[6],h=c[7],k=c[8],l=c[9],m=c[10],p=c[11];c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[4]=d*e+k*b;a[5]=f*e+l*b;a[6]=g*e+m*b;a[7]=h*e+p*b;a[8]=k*e-d*b;a[9]=l*e-f*b;a[10]=m*e-g*b;a[11]=p*e-h*b;return a};a.rotateY=function(a,c,e){var b=Math.sin(e);e=Math.cos(e);var d=c[0],f=c[1],g=c[2],h=c[3],k=c[8],l=c[9],m=c[10],p=c[11];c!==a&&(a[4]=c[4],a[5]=c[5],a[6]=c[6],
a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=d*e-k*b;a[1]=f*e-l*b;a[2]=g*e-m*b;a[3]=h*e-p*b;a[8]=d*b+k*e;a[9]=f*b+l*e;a[10]=g*b+m*e;a[11]=h*b+p*e;return a};a.rotateZ=function(a,c,e){var b=Math.sin(e);e=Math.cos(e);var d=c[0],f=c[1],g=c[2],h=c[3],k=c[4],l=c[5],m=c[6],p=c[7];c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=d*e+k*b;a[1]=f*e+l*b;a[2]=g*e+m*b;a[3]=h*e+p*b;a[4]=k*e-d*b;a[5]=l*e-f*b;a[6]=m*e-g*b;a[7]=p*e-h*b;return a};
a.fromTranslation=function(a,c){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};a.fromScaling=function(a,c){a[0]=c[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=c[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotation=function(a,c,e){var b=e[0],d=e[1];e=e[2];var f=Math.sqrt(b*b+d*d+e*e),h=void 0,k=void 0,l=void 0;if(f<g.EPSILON)return null;f=1/f;b*=f;d*=f;e*=f;h=Math.sin(c);
k=Math.cos(c);l=1-k;a[0]=b*b*l+k;a[1]=d*b*l+e*h;a[2]=e*b*l-d*h;a[3]=0;a[4]=b*d*l-e*h;a[5]=d*d*l+k;a[6]=e*d*l+b*h;a[7]=0;a[8]=b*e*l+d*h;a[9]=d*e*l-b*h;a[10]=e*e*l+k;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromXRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=b;a[7]=0;a[8]=0;a[9]=-b;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromYRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=0;a[2]=-b;a[3]=0;a[4]=
0;a[5]=1;a[6]=0;a[7]=0;a[8]=b;a[9]=0;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromZRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=b;a[2]=0;a[3]=0;a[4]=-b;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotationTranslation=f;a.fromQuat2=function(a,c){var b=p,d=-c[0],e=-c[1],g=-c[2],h=c[3],k=c[4],l=c[5],v=c[6],z=c[7],A=d*d+e*e+g*g+h*h;0<A?(b[0]=2*(k*h+z*d+l*g-v*e)/A,b[1]=2*(l*h+z*e+v*d-k*g)/A,b[2]=2*(v*h+z*g+k*
e-l*d)/A):(b[0]=2*(k*h+z*d+l*g-v*e),b[1]=2*(l*h+z*e+v*d-k*g),b[2]=2*(v*h+z*g+k*e-l*d));f(a,c,b);return a};var p=l.create();a.getTranslation=function(a,c){a[0]=c[12];a[1]=c[13];a[2]=c[14];return a};a.getScaling=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[4],g=c[5],h=c[6],k=c[8],l=c[9];c=c[10];a[0]=Math.sqrt(b*b+d*d+e*e);a[1]=Math.sqrt(f*f+g*g+h*h);a[2]=Math.sqrt(k*k+l*l+c*c);return a};a.getRotation=function(a,c){var b=c[0]+c[5]+c[10],d=0;0<b?(d=2*Math.sqrt(b+1),a[3]=.25*d,a[0]=(c[6]-c[9])/d,a[1]=(c[8]-
c[2])/d,a[2]=(c[1]-c[4])/d):c[0]>c[5]&&c[0]>c[10]?(d=2*Math.sqrt(1+c[0]-c[5]-c[10]),a[3]=(c[6]-c[9])/d,a[0]=.25*d,a[1]=(c[1]+c[4])/d,a[2]=(c[8]+c[2])/d):c[5]>c[10]?(d=2*Math.sqrt(1+c[5]-c[0]-c[10]),a[3]=(c[8]-c[2])/d,a[0]=(c[1]+c[4])/d,a[1]=.25*d,a[2]=(c[6]+c[9])/d):(d=2*Math.sqrt(1+c[10]-c[0]-c[5]),a[3]=(c[1]-c[4])/d,a[0]=(c[8]+c[2])/d,a[1]=(c[6]+c[9])/d,a[2]=.25*d);return a};a.fromRotationTranslationScale=function(a,c,e,f){var b=c[0],d=c[1],g=c[2],h=c[3],k=b+b,l=d+d,m=g+g;c=b*k;var p=b*l,b=b*m,
r=d*l,d=d*m,g=g*m,k=h*k,l=h*l,h=h*m,m=f[0],D=f[1];f=f[2];a[0]=(1-(r+g))*m;a[1]=(p+h)*m;a[2]=(b-l)*m;a[3]=0;a[4]=(p-h)*D;a[5]=(1-(c+g))*D;a[6]=(d+k)*D;a[7]=0;a[8]=(b+l)*f;a[9]=(d-k)*f;a[10]=(1-(c+r))*f;a[11]=0;a[12]=e[0];a[13]=e[1];a[14]=e[2];a[15]=1;return a};a.fromRotationTranslationScaleOrigin=function(a,c,e,f,g){var b=c[0],d=c[1],h=c[2],k=c[3],l=b+b,m=d+d,n=h+h;c=b*l;var p=b*m,r=b*n,b=d*m,d=d*n,B=h*n,h=k*l,m=k*m,E=k*n,F=f[0],H=f[1],n=f[2];f=g[0];k=g[1];g=g[2];var l=(1-(b+B))*F,J=(p+E)*F,F=(r-m)*
F,p=(p-E)*H,B=(1-(c+B))*H,H=(d+h)*H,r=(r+m)*n,d=(d-h)*n;c=(1-(c+b))*n;a[0]=l;a[1]=J;a[2]=F;a[3]=0;a[4]=p;a[5]=B;a[6]=H;a[7]=0;a[8]=r;a[9]=d;a[10]=c;a[11]=0;a[12]=e[0]+f-(l*f+p*k+r*g);a[13]=e[1]+k-(J*f+B*k+d*g);a[14]=e[2]+g-(F*f+H*k+c*g);a[15]=1;return a};a.fromQuat=function(a,c){var b=c[0],d=c[1],e=c[2];c=c[3];var f=b+b,g=d+d,h=e+e,b=b*f,k=d*f,d=d*g,l=e*f,p=e*g,e=e*h,f=c*f,g=c*g;c*=h;a[0]=1-d-e;a[1]=k+c;a[2]=l-g;a[3]=0;a[4]=k-c;a[5]=1-b-e;a[6]=p+f;a[7]=0;a[8]=l+g;a[9]=p-f;a[10]=1-b-d;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a};a.frustum=function(a,c,e,f,g,h,k){var b=1/(e-c),d=1/(g-f),l=1/(h-k);a[0]=2*h*b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*h*d;a[6]=0;a[7]=0;a[8]=(e+c)*b;a[9]=(g+f)*d;a[10]=(k+h)*l;a[11]=-1;a[12]=0;a[13]=0;a[14]=k*h*2*l;a[15]=0;return a};a.perspective=function(a,c,e,f,g){c=1/Math.tan(c/2);var b=void 0;a[0]=c/e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;null!=g&&Infinity!==g?(b=1/(f-g),a[10]=(g+f)*b,a[14]=2*g*f*b):(a[10]=
-1,a[14]=-2*f);return a};a.perspectiveFromFieldOfView=function(a,c,e,f){var b=Math.tan(c.upDegrees*Math.PI/180),d=Math.tan(c.downDegrees*Math.PI/180),g=Math.tan(c.leftDegrees*Math.PI/180);c=Math.tan(c.rightDegrees*Math.PI/180);var h=2/(g+c),k=2/(b+d);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=k;a[6]=0;a[7]=0;a[8]=-((g-c)*h*.5);a[9]=(b-d)*k*.5;a[10]=f/(e-f);a[11]=-1;a[12]=0;a[13]=0;a[14]=f*e/(e-f);a[15]=0;return a};a.ortho=function(a,c,e,f,g,h,k){var b=1/(c-e),d=1/(f-g),l=1/(h-k);a[0]=-2*b;a[1]=0;a[2]=
0;a[3]=0;a[4]=0;a[5]=-2*d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(c+e)*b;a[13]=(g+f)*d;a[14]=(k+h)*l;a[15]=1;return a};a.lookAt=function(a,c,e,f){var b=void 0,d=void 0,h=void 0,l=void 0,m=void 0,p=void 0,r=void 0,A=void 0,C=void 0,D=void 0,B=c[0],E=c[1];c=c[2];h=f[0];l=f[1];f=f[2];r=e[0];A=e[1];e=e[2];if(Math.abs(B-r)<g.EPSILON&&Math.abs(E-A)<g.EPSILON&&Math.abs(c-e)<g.EPSILON)return k(a);r=B-r;A=E-A;C=c-e;D=1/Math.sqrt(r*r+A*A+C*C);r*=D;A*=D;C*=D;b=l*C-f*A;d=f*r-h*C;h=h*A-l*r;(D=Math.sqrt(b*
b+d*d+h*h))?(D=1/D,b*=D,d*=D,h*=D):h=d=b=0;l=A*h-C*d;m=C*b-r*h;p=r*d-A*b;(D=Math.sqrt(l*l+m*m+p*p))?(D=1/D,l*=D,m*=D,p*=D):p=m=l=0;a[0]=b;a[1]=l;a[2]=r;a[3]=0;a[4]=d;a[5]=m;a[6]=A;a[7]=0;a[8]=h;a[9]=p;a[10]=C;a[11]=0;a[12]=-(b*B+d*E+h*c);a[13]=-(l*B+m*E+p*c);a[14]=-(r*B+A*E+C*c);a[15]=1;return a};a.targetTo=function(a,c,e,f){var b=c[0],d=c[1];c=c[2];var g=f[0],h=f[1],k=f[2];f=b-e[0];var l=d-e[1];e=c-e[2];var m=f*f+l*l+e*e;0<m&&(m=1/Math.sqrt(m),f*=m,l*=m,e*=m);var p=h*e-k*l,k=k*f-g*e,g=g*l-h*f,m=
p*p+k*k+g*g;0<m&&(m=1/Math.sqrt(m),p*=m,k*=m,g*=m);a[0]=p;a[1]=k;a[2]=g;a[3]=0;a[4]=l*g-e*k;a[5]=e*p-f*g;a[6]=f*k-l*p;a[7]=0;a[8]=f;a[9]=l;a[10]=e;a[11]=0;a[12]=b;a[13]=d;a[14]=c;a[15]=1;return a};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],
2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};a.add=function(a,c,e){a[0]=c[0]+e[0];a[1]=c[1]+e[1];a[2]=c[2]+e[2];a[3]=c[3]+e[3];a[4]=c[4]+e[4];a[5]=c[5]+e[5];a[6]=c[6]+e[6];a[7]=c[7]+e[7];a[8]=c[8]+e[8];a[9]=c[9]+e[9];a[10]=c[10]+e[10];a[11]=c[11]+e[11];a[12]=c[12]+e[12];a[13]=c[13]+e[13];a[14]=c[14]+e[14];a[15]=c[15]+e[15];return a};a.subtract=e;
a.multiplyScalar=function(a,c,e){a[0]=c[0]*e;a[1]=c[1]*e;a[2]=c[2]*e;a[3]=c[3]*e;a[4]=c[4]*e;a[5]=c[5]*e;a[6]=c[6]*e;a[7]=c[7]*e;a[8]=c[8]*e;a[9]=c[9]*e;a[10]=c[10]*e;a[11]=c[11]*e;a[12]=c[12]*e;a[13]=c[13]*e;a[14]=c[14]*e;a[15]=c[15]*e;return a};a.multiplyScalarAndAdd=function(a,c,e,f){a[0]=c[0]+e[0]*f;a[1]=c[1]+e[1]*f;a[2]=c[2]+e[2]*f;a[3]=c[3]+e[3]*f;a[4]=c[4]+e[4]*f;a[5]=c[5]+e[5]*f;a[6]=c[6]+e[6]*f;a[7]=c[7]+e[7]*f;a[8]=c[8]+e[8]*f;a[9]=c[9]+e[9]*f;a[10]=c[10]+e[10]*f;a[11]=c[11]+e[11]*f;a[12]=
c[12]+e[12]*f;a[13]=c[13]+e[13]*f;a[14]=c[14]+e[14]*f;a[15]=c[15]+e[15]*f;return a};a.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]};a.equals=function(a,c){var b=a[0],d=a[1],e=a[2],f=a[3],h=a[4],k=a[5],l=a[6],p=a[7],z=a[8],A=a[9],C=a[10],D=a[11],B=a[12],E=a[13],F=a[14];a=a[15];var H=c[0],J=c[1],
K=c[2],G=c[3],I=c[4],L=c[5],R=c[6],M=c[7],Q=c[8],N=c[9],U=c[10],V=c[11],S=c[12],X=c[13],W=c[14];c=c[15];return Math.abs(b-H)<=g.EPSILON*Math.max(1,Math.abs(b),Math.abs(H))&&Math.abs(d-J)<=g.EPSILON*Math.max(1,Math.abs(d),Math.abs(J))&&Math.abs(e-K)<=g.EPSILON*Math.max(1,Math.abs(e),Math.abs(K))&&Math.abs(f-G)<=g.EPSILON*Math.max(1,Math.abs(f),Math.abs(G))&&Math.abs(h-I)<=g.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(k-L)<=g.EPSILON*Math.max(1,Math.abs(k),Math.abs(L))&&Math.abs(l-R)<=g.EPSILON*
Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(p-M)<=g.EPSILON*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(z-Q)<=g.EPSILON*Math.max(1,Math.abs(z),Math.abs(Q))&&Math.abs(A-N)<=g.EPSILON*Math.max(1,Math.abs(A),Math.abs(N))&&Math.abs(C-U)<=g.EPSILON*Math.max(1,Math.abs(C),Math.abs(U))&&Math.abs(D-V)<=g.EPSILON*Math.max(1,Math.abs(D),Math.abs(V))&&Math.abs(B-S)<=g.EPSILON*Math.max(1,Math.abs(B),Math.abs(S))&&Math.abs(E-X)<=g.EPSILON*Math.max(1,Math.abs(E),Math.abs(X))&&Math.abs(F-W)<=g.EPSILON*Math.max(1,
Math.abs(F),Math.abs(W))&&Math.abs(a-c)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};a.mul=h;a.sub=e})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f64=l})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(c,a){function l(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=l;a.clone=
function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]};a.fromValues=function(a,c,h,f,e,l,b,d,m,r,n,u,y,w,t,v){return[a,c,h,f,e,l,b,d,m,r,n,u,y,w,t,v]};a.createView=function(a,c){return new Float64Array(a,c,16)};a.IDENTITY=l()})},"esri/views/3d/support/debugFlags":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h){return new (function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;c.SCENEVIEW_LOCKING_LOG=!1;c.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;c.HIGHLIGHTS_VISUALIZE_BLOCKS=!1;c.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;c.DECONFLICTOR_SHOW_OUTLINES=!1;c.DECONFLICTOR_SHOW_OUTLINES_INVISIBLE=!1;c.DECONFLICTOR_SHOW_GRID=!1;c.LABELS_SHOW_BORDER=!1;c.OVERLAY_DRAW_TEST_TEXTURE=!1;c.OVERLAY_SHOW_CENTER=!1;c.TESTS_DISABLE_UPDATE_THRESHOLDS=
!1;c.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1;c.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1;c.DRAW_MESH_GEOMETRY_NORMALS=!1;c.FEATURE_TILE_FETCH_SHOW_TILES=!1;c.FEATURE_TILE_TREE_SHOW_TILES=!1;c.TERRAIN_TILE_TREE_SHOW_TILES=!1;c.I3S_TREE_SHOW_TILES=!1;c.ENABLE_PROFILE_DEPTH_RANGE=!1;c.DISABLE_FAST_UPDATES=!1;c.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;c.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;c.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return c}l(c,a);g([h.property()],c.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",
void 0);g([h.property()],c.prototype,"SCENEVIEW_LOCKING_LOG",void 0);g([h.property()],c.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);g([h.property()],c.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0);g([h.property()],c.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);g([h.property()],c.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0);g([h.property()],c.prototype,"DECONFLICTOR_SHOW_OUTLINES_INVISIBLE",void 0);g([h.property()],c.prototype,"DECONFLICTOR_SHOW_GRID",void 0);g([h.property()],
c.prototype,"LABELS_SHOW_BORDER",void 0);g([h.property()],c.prototype,"OVERLAY_DRAW_TEST_TEXTURE",void 0);g([h.property()],c.prototype,"OVERLAY_SHOW_CENTER",void 0);g([h.property()],c.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);g([h.property()],c.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);g([h.property()],c.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);g([h.property()],c.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0);g([h.property()],c.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",
void 0);g([h.property()],c.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);g([h.property()],c.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0);g([h.property()],c.prototype,"I3S_TREE_SHOW_TILES",void 0);g([h.property()],c.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);g([h.property()],c.prototype,"DISABLE_FAST_UPDATES",void 0);g([h.property()],c.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0);g([h.property()],c.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);g([h.property()],
c.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return c=g([h.subclass("esri.views.3d.support.DebugFlags")],c)}(h.declared(k)))})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/spatialReferenceUtils ../../../../../geometry/support/webMercatorUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/FeatureStore ../../../../../layers/graphics/data/projectionSupport ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/graphics/data/utils ../../../engine/webgl/definitions".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A){Object.defineProperty(a,"__esModule",{value:!0});var C=function(a){return p.andThen(a,function(a){return"cluster"!==a.type?null:g({},a,{clusterRadius:b.pt2px(a.clusterRadius/2)})})},D=function(a){function b(b,c,d,e,f){var g=this;c=new y.default([],[c,d]);g=a.call(this,c,e,null,b)||this;g.invalid=!1;g.canDelete=!1;g.geohashBoundsInfo=f;return g}l(b,a);Object.defineProperty(b.prototype,"count",{get:function(){return this.attributes.cluster_count},
enumerable:!0,configurable:!0});b.create=function(a,c,d,e,f,g,h){c=new b(c,d,e,g,h);c.localId=a.createLocalId(c.objectId,!0);c.tileLevel=f;return c};b.prototype.update=function(a,b,c,d,e){this.geometry.coords[0]=a;this.geometry.coords[1]=b;this.tileLevel=c;this.attributes=d;this.geohashBoundsInfo=e;this.referenceId=null;this.invalid=!1;return this};b.prototype.toJSON=function(){return{objectId:this.objectId,referenceId:this.referenceId,attributes:g({},this.attributes,{clusterId:this.objectId}),geometry:{x:this.geometry.coords[0],
y:this.geometry.coords[1]}}};return b}(u.default);c=function(a){function b(b,c,d,e){b=a.call(this,b)||this;b._deferredDeletionQueue=[];b._invalidated=!1;b._aggregateFieldsHash=null;b._geohashLevel=0;b._aggregateValueRanges={};b._aggregateValueRangesChanged=!1;b._clusters=new Map;b._tiles=new Map;b._spatialReference=c;b._attributeStore=d;b._featureReduction=C(e);b._projectionSupportCheck=t.checkProjectionSupport(c,f.SpatialReference.WGS84);return b}l(b,a);b.prototype.update=function(a,b){return h(this,
void 0,void 0,function(){var c,e,f,g,h,l,m=this;return k(this,function(k){switch(k.label){case 0:return c=this._featureReduction,e=p.andThen(b.featureReduction,C),f=b.aggregateFields.reduce(function(a,b){return a+JSON.stringify(b)},""),g=null===c&&b.featureReduction,h=f!==this._aggregateFieldsHash,l=g||h,[4,this._projectionSupportCheck];case 1:k.sent();this._featureReduction=e;this._aggregateFieldsHash=f;this._aggregateValueRanges={};this._invalidated=!0;if(p.isNone(e))return this._tree=null,[2];
p.isSome(c)&&c.clusterRadius!==e.clusterRadius&&this._clusters.forEach(function(a){return a.canDelete=!0});l&&(this._tree=new d.GeohashTree(b.aggregateFields),this._unindexFeatures());(l||a)&&this._reindexFeatures();this._handleClusterUpdates();this._tiles.forEach(function(a){return m._getClustersForTile(a,0,e.clusterRadius,null,!1)});return[2]}})})};b.prototype._unindexFeatures=function(){this._featuresById.forEach(function(a){a.geohashIndexed=!1})};b.prototype._reindexFeatures=function(){var a=
this;this._featuresById.forEach(function(b){b.geohashX||b.geohashY||a._setGeohash(b);a._attributeStore.isVisible(b)?a._insertIntoIndex(b):a._removeFromIndex(b)})};b.prototype.onTileUpdate=function(a){var b=this,c=a.added;a=a.removed;if(c.length){var d=Math.max.apply(Math,c.map(function(a){return a.level}));this._setGeohashLevel(d);c.forEach(function(a){return b._tiles.set(a.key.id,a)})}if(!p.isNone(this._featureReduction)){var e=this._featureReduction.clusterRadius;a.forEach(function(a){b._tiles.delete(a.key.id);
b._markTileClustersForDeletion(a,e)})}};b.prototype.sweepClusters=function(){var a=this;this._clusters.forEach(function(b,c){b.canDelete&&(a._attributeStore.freeLocalId(b.objectId),a._clusters.delete(c))});for(var b=0,c=this._deferredDeletionQueue;b<c.length;b++)this._attributeStore.addLocalId(c[b]);this._deferredDeletionQueue=[]};b.prototype.executeTileQuery=function(b,c,d){return h(this,void 0,void 0,function(){var e,f,g;return k(this,function(h){switch(h.label){case 0:return p.isNone(this._featureReduction)?
[2,a.prototype.executeTileQuery.call(this,b,c,d)]:[4,this._projectionSupportCheck];case 1:return h.sent(),this._handleClusterUpdates(),e=this._featureReduction.clusterRadius,f=this._getTransforms(b,c),g=this._getClustersForTile(b,d.pixelBuffer,e,f),this._aggregateValueRangesChanged&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1),[2,g]}})})};b.prototype.getAggregate=function(a){var b=null;this._clusters.forEach(function(c){c.localId===
a&&(b=c.toJSON())});return b};b.prototype.getAggregateValueRanges=function(){return this._aggregateValueRanges};b.prototype._getClustersForTile=function(a,b,c,d,e){var h=this;void 0===e&&(e=!0);b=Math.max(b,50);var k=2*c,l=new Set,m=this._getGeohashLevel(a.key.level),r=Math.pow(2,a.key.level)*Math.ceil(A.TILE_SIZE/k),u=Math.ceil(b/k)+2;c=Math.ceil(A.TILE_SIZE/k)+2*u;var w=a.key;b=Math.floor(w.col*A.TILE_SIZE/k)-u;k=Math.floor(w.row*A.TILE_SIZE/k)-u;u=b+c;c=k+c;for(var y=[],B=a.tileInfoView.getLODInfoAt(a.key.level),
C=b;C<=u;C++){b=function(b){var c,k,u=C;B.wrap&&(u=0>C?C+r:C%r);var w=B.wrap&&0>C,A=B.wrap&&C%r!==C;b=D._lookupCluster(B,a.key.level,u,b,m);if(p.isSome(b)){u=p.andThen(d,function(a){return w?a.left:A?a.right:a.tile});if(e&&p.isNone(u)||!b.count)return"continue";if(e&&1===b.count){var F=b.geohashBoundsInfo,E=F.xLL;k=F.yLL;c=F.xTR;var H=F.yTR,F=F.level,E=p.expect(D._tree).findSingleOccupancyNode(E,k,c,H,F),E=p.unwrap(E).getLngLatBounds(),F={x:E[0],y:E[1]};k={x:E[2],y:E[3]};var J=H=c=E=0;if(D._spatialReference.isWebMercator)c=
n.lngLatToXY(F.x,F.y),E=c[0],c=c[1],k=n.lngLatToXY(k.x,k.y),H=k[0],J=k[1];else{c=t.project(F,f.SpatialReference.WGS84,D._spatialReference);k=t.project(k,f.SpatialReference.WGS84,D._spatialReference);if(!c||!k)return"continue";E=c.x;c=c.y;H=k.x;J=k.y}var G=null;D.forEachInBounds([E,c,H,J],function(a){h._attributeStore.isVisible(a)&&(G=a)});if(!G)return"continue";u=z.getGeometry(D.geometryInfo,G.geometry,0,p.expect(u));E=g({},G.attributes,b.attributes);b.referenceId=G.localId;l.add(b.objectId);y.push(new v.Feature(E,
b.localId,u))}else e&&(l.add(b.objectId),u=z.getGeometry(D.geometryInfo,b.geometry,0,p.expect(u)),y.push(new v.Feature(b.attributes,b.localId,u)))}};for(var D=this,w=k;w<=c;w++)b(w)}return{features:y,objectIds:l}};b.prototype._getGeohashLevel=function(a){return Math.min(Math.ceil(a/2+2),12)};b.prototype._setGeohashLevel=function(a){var b=this,c=this._geohashLevel;a=this._getGeohashLevel(a);a=2*(Math.floor(a/2)+1)-1;var d=this._tree;this._geohashLevel=a;p.isNone(d)||(a>c?this._featuresById.forEach(function(a){a.geohashIndexed&&
(d.insert(a,b._geohashLevel,c+1),a.geohashIndexed=!0)}):a<c&&d.dropLevels(this._geohashLevel))};b.prototype._insertIntoIndex=function(a){a.geohashIndexed||(this._invalidated=!0,a.geohashIndexed=!0,p.expect(this._tree).insert(a,this._geohashLevel))};b.prototype._removeFromIndex=function(a){a.geohashIndexed&&(this._invalidated=!0,p.expect(this._tree).remove(a,this._geohashLevel),a.geohashIndexed=!1)};b.prototype._handleClusterUpdates=function(){var a=this;this._invalidated&&this._clusters.size&&this._clusters.forEach(function(b){p.isSome(b)&&
(b.invalid=b.invalid||a._invalidated)});this._invalidated=!1};b.prototype._getTransforms=function(a,b){var c={originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]};b=r.getInfo(b);if(!b)return{tile:c,left:null,right:null};var d=b.valid;b=d[0];var e=d[1],d=g({},c,{translate:[e,a.bounds[3]]});a=g({},c,{translate:[b-e+a.bounds[0],a.bounds[3]]});return{tile:c,left:d,right:a}};b.prototype._getClusterId=function(a,b,c){return(a&15)<<28|(b&16383)<<14|c&16383};b.prototype._markForDeletion=
function(a,b,c){a=this._getClusterId(a,b,c);this._clusters.has(a)&&(b=this._clusters.get(a),p.isSome(b)?b.canDelete=!0:this._clusters.delete(a))};b.prototype._getClusterBounds=function(a,b,c){if(p.isNone(this._featureReduction))return null;var d=this._featureReduction.clusterRadius,e=2*d;b=c%2?b*e:b*e+d;var f=c*e,d=f/A.TILE_SIZE;c=(b+e)/A.TILE_SIZE;e=(f-e)/A.TILE_SIZE;b=a.getXForColumn(b/A.TILE_SIZE);d=a.getYForRow(d);c=a.getXForColumn(c);a=a.getYForRow(e);return[b,d,c,a]};b.prototype._lookupCluster=
function(a,b,c,d,e){var h,k;if(p.isNone(this._featureReduction)||p.isNone(this._tree))return null;var l=this._getClusterId(b,c,d),r=this._clusters.get(l);if(r&&p.isSome(r)&&!r.invalid&&!r.canDelete)return r;var u=this._getClusterBounds(a,c,d);a=u[0];c=u[1];d=u[2];var u=u[3],v={x:a,y:c};k={x:d,y:u};var w=0,y=h=0,z=0;if(this._spatialReference.isWebMercator)h=n.xyToLngLat(v.x,v.y),w=h[0],h=h[1],k=n.xyToLngLat(k.x,k.y),y=k[0],z=k[1];else{h=t.project(v,this._spatialReference,f.SpatialReference.WGS84);
k=t.project(k,this._spatialReference,f.SpatialReference.WGS84);if(!h||!k)return null;w=h.x;h=h.y;y=k.x;z=k.y}v={geohashX:0,geohashY:0};k={geohashX:0,geohashY:0};m.setGeohashXY(v,h,w,e);m.setGeohashXY(k,z,y,e);h=v.geohashX;y=v.geohashY;z=k.geohashX;k=k.geohashY;w={xLL:h,yLL:y,xTR:z,yTR:k,level:e};y=this._tree.getRegionStatistics(h,y,z,k,e);e=y.count;h=y.xTotal;k=y.yTotal;h=e?h/e:0;k=e?k/e:0;p.isSome(r)&&r.canDelete&&(z=this._attributeStore.removeLocalId(r.objectId),this._deferredDeletionQueue.push(z));
z=p.isSome(r)&&!r.canDelete&&r.invalid;y=g({cluster_count:e},y.attributes);v=this._attributeStore;b=z?r.update(h,k,b,y,w):D.create(v,l,h,k,b,y,w);0===e&&(b.geometry.coords[0]=(a+d)/2,b.geometry.coords[1]=(c+u)/2);this._attributeStore.setAttributeData(b.localId,b,this.geometryInfo,null);this._clusters.set(l,b);this._updateAggregateValueRangeForCluster(b,b.tileLevel);return b};b.prototype._updateAggregateValueRangeForCluster=function(a,b){var c=this._aggregateValueRanges[b]||{minValue:Infinity,maxValue:0},
d=c.minValue,e=c.maxValue;c.minValue=Math.min(d,a.count);c.maxValue=Math.max(e,a.count);this._aggregateValueRanges[b]=c;if(d!==c.minValue||e!==c.maxValue)this._aggregateValueRangesChanged=!0};b.prototype._markTileClustersForDeletion=function(a,b){var c=2*b;b=Math.ceil(A.TILE_SIZE/c);for(var d=a.key,e=Math.floor(d.col*A.TILE_SIZE/c),c=Math.floor(d.row*A.TILE_SIZE/c),d=e;d<e+b;d++)for(var f=c;f<c+b;f++)this._markForDeletion(a.key.level,d,f)};b.prototype._setGeohash=function(a){var b=a.geometry;b&&b.coords.length&&
(b=t.project({x:b.coords[0],y:b.coords[1]},this._spatialReference,f.SpatialReference.WGS84))&&m.setGeohashXY(a,b.y,b.x,12)};b.prototype._add=function(b){var c=this._featuresById.get(b.objectId);a.prototype._add.call(this,b);p.isSome(this._featureReduction)&&p.isSome(this._tree)&&(c?(b.geohashIndexed=c.geohashIndexed,b.geohashX=c.geohashX,b.geohashY=c.geohashY):this._setGeohash(b),!b.geohashIndexed&&this._attributeStore.isVisible(b)&&this._insertIntoIndex(b))};b.prototype._remove=function(b){p.isSome(this._featureReduction)&&
p.isSome(this._tree)&&this._removeFromIndex(b);return a.prototype._remove.call(this,b)};return b}(w.default);a.ClusterStore=c})},"esri/geohash/GeohashTree":function(){define(["require","exports","../core/CircularArray","../core/maybe","./geohashUtils"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(a){this._pool=new l.default(8024);this._nodes=0;this._root=new h(0,0,0);this._fields=a}a.prototype._acquire=function(a,c,b){var d=this._pool.dequeue();this._nodes++;
return g.isSome(d)?d.realloc(a,c,b):new h(a,c,b)};a.prototype._release=function(a){this._nodes--;this._pool.enqueue(a)};Object.defineProperty(a.prototype,"count",{get:function(){return this._root.count},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._nodes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"poolSize",{get:function(){return this._pool.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depth",
{get:function(){var a=0;this._forEachNode(function(c){return a=Math.max(a,c.depth)});return a},enumerable:!0,configurable:!0});a.prototype.dropLevels=function(a){var c=this;this._forEachNode(function(b){if(b.depth>=a)for(var d=0;d<b.children.length;d++){var e=b.children[d];b.children[d]=null;e&&c._release(e)}})};a.prototype.insert=function(a,c,b){void 0===b&&(b=0);for(var d=this._root,e=0,f=0,g=0;null!==d;){d.depth>=b&&(d.count+=1,d.xTotal+=a.geometry.coords[0],d.yTotal+=a.geometry.coords[1],d.xGeohashTotal+=
a.geohashX,d.yGeohashTotal+=a.geohashY,this._updateStatistics(a,d,1));if(e>=c)break;var h=Math.ceil((e+1)/2),k=Math.floor((e+1)/2),l=1-e%2,p=30-(3*h+2*k),h=30-(2*h+3*k),p=(a.geohashX&7*l+3*(1-l)<<p)>>p,h=(a.geohashY&3*l+7*(1-l)<<h)>>h,k=p+h*(8*l+4*(1-l)),v=2*l+3*(1-l),f=f<<3*l+2*(1-l)|p,g=g<<v|h;null==d.children[k]&&(d.children[k]=this._acquire(f,g,e+1));e+=1;d=d.children[k]}};a.prototype.remove=function(a,c){for(var b=this._root,d=0;null!==b;){--b.count;b.xTotal-=a.geometry.coords[0];b.yTotal-=a.geometry.coords[1];
b.xGeohashTotal-=a.geohashX;b.yGeohashTotal-=a.geohashY;this._updateStatistics(a,b,-1);if(d>=c)break;var e=Math.ceil((d+1)/2),f=Math.floor((d+1)/2),g=1-d%2,h=30-(3*e+2*f),e=30-(2*e+3*f),g=((a.geohashX&7*g+3*(1-g)<<h)>>h)+((a.geohashY&3*g+7*(1-g)<<e)>>e)*(8*g+4*(1-g)),h=b.children[g];1===h.count&&(this._release(h),b.children[g]=null);d+=1;b=h}};a.prototype.find=function(a,c,b){return this._root.find(a,c,b,0,0,0)};a.prototype.findSingleOccupancyNode=function(a,c,b,d,f){for(var e=this._root;null!==e;){var g=
e.depth,h=e.xNode,k=e.yNode,l=1-g%2,m=e.xGeohashTotal/e.count,p=e.yGeohashTotal/e.count;if(1===e.count&&a<m&&m<=b&&c<p&&p<=d)return e;if(g>=f)e=e.next;else{for(var m=Math.ceil((g+1)/2),g=Math.floor((g+1)/2),z=30-(3*m+2*g),m=30-(2*m+3*g),A=~((1<<z)-1),p=~((1<<m)-1),h=h<<3*l+2*(1-l),k=k<<2*l+3*(1-l),g=Math.max(h,(a&A)>>z),z=Math.min(h+8*l+4*(1-l),(b&A)>>z),A=Math.min(k+4*l+8*(1-l),(d&p)>>m),C=null,D=null,m=Math.max(k,(c&p)>>m);m<=A;m++)for(p=g;p<=z;p++){var B=e.children[p-h+(m-k)*(8*l+4*(1-l))];B&&
(C||(C=B,C.next=e.next),D&&(D.next=B),D=B,B.next=e.next)}e=C||e.next}}return null};a.prototype.getRegionStatistics=function(a,c,b,d,f){for(var e=this._root,g=0,h=0,k=0,l={};null!==e;){var m=e.depth,p=e.xNode,z=e.yNode;if(m>=f){var A=e.xGeohashTotal/e.count,C=e.yGeohashTotal/e.count;a<A&&A<=b&&c<C&&C<=d&&(g+=e.count,h+=e.xTotal,k+=e.yTotal,this._aggregateStatistics(l,e.statistics));e=e.next}else{for(var D=Math.ceil((m+1)/2),B=Math.floor((m+1)/2),m=1-m%2,E=30-(3*D+2*B),A=30-(2*D+3*B),F=~((1<<E)-1),
C=~((1<<A)-1),p=p<<3*m+2*(1-m),z=z<<2*m+3*(1-m),D=Math.max(p,(a&F)>>E),B=Math.max(z,(c&C)>>A),E=Math.min(p+8*m+4*(1-m),(b&F)>>E),F=Math.min(z+4*m+8*(1-m),(d&C)>>A),H=null,J=null,K=B;K<=F;K++)for(var G=D;G<=E;G++){var I=e.children[G-p+(K-z)*(8*m+4*(1-m))];I&&(K!==B&&K!==F&&G!==D&&G!==E?(A=I.xGeohashTotal/I.count,C=I.yGeohashTotal/I.count,a<A&&A<=b&&c<C&&C<=d&&(g+=I.count,h+=I.xTotal,k+=I.yTotal,this._aggregateStatistics(l,I.statistics))):(H||(H=I,H.next=e.next),J&&(J.next=I),J=I,I.next=e.next))}e=
H||e.next}}a=this._normalizeStatistics(l,g);return{count:g,attributes:a,xTotal:h,yTotal:k}};a.prototype._forEachNode=function(a){for(var c=this._root;null!==c;){var b=this._linkChildren(c)||c.next;a(c);c=b}};a.prototype._linkChildren=function(a){for(var c=null,b=null,d=0;d<=a.children.length;d++){var e=a.children[d];e&&(c||(c=e,c.next=a.next),b&&(b.next=e),b=e,e.next=a.next)}return c};a.prototype._updateStatistics=function(a,c,b){for(var d=0,e=this._fields;d<e.length;d++){var f=e[d],g=f.name,h=a.attributes[f.outStatistic.onStatisticField];
switch(f.outStatistic.statisticType){case "norm":c.statistics[g]||(c.statistics[g]={});var f=a.attributes[f.outStatistic.onStatisticNormalizationField],k=c.statistics[g].onStatisticField||0,l=c.statistics[g].onStatisticNormalizationField||0;null==h||isNaN(h)||null==f||0===f||isNaN(f)||(c.statistics[g].onStatisticField=k+b*h,c.statistics[g].onStatisticNormalizationField=l+b*f);break;case "avg":c.statistics[g]||(c.statistics[g]={value:0,nanCount:0});k=c.statistics[g].value;f=c.statistics[g].nanCount;
null==h||isNaN(h)?c.statistics[g].nanCount=f+b:c.statistics[g].value=k+b*h;break;case "avg_angle":c.statistics[g]||(c.statistics[g]={x:0,y:0,nanCount:0});var k=c.statistics[g].x,l=c.statistics[g].y,f=c.statistics[g].nanCount,p=Math.PI/180;null==h||isNaN(h)?c.statistics[g].nanCount=f+b:(c.statistics[g].x=k+b*Math.cos(h*p),c.statistics[g].y=l+b*Math.sin(h*p));break;case "mode":c.statistics[g]||(c.statistics[g]={}),k=c.statistics[g][h]||0,c.statistics[g][h]=k+b}}};a.prototype._aggregateStatistics=function(a,
c){for(var b=0,d=this._fields;b<d.length;b++){var e=d[b],f=e.name;switch(e.outStatistic.statisticType){case "avg":case "avg_angle":case "mode":case "norm":a[f]||(a[f]={});for(var g in c[f])a[f][g]=(a[f][g]||0)+c[f][g]}}};a.prototype._normalizeStatistics=function(a,c){for(var b={},d=0,e=this._fields;d<e.length;d++){var f=e[d],g=f.name;switch(f.outStatistic.statisticType){case "norm":f=a[g];if(c&&null==f.onStatisticNormalizationField)break;if(c&&f.onStatisticNormalizationField){b[g]=f.onStatisticField/
f.onStatisticNormalizationField;break}b[g]=0;break;case "avg":if(!c)break;var h=a[g],f=h.nanCount;if(!(c-f))break;b[g]=h.value/(c-f);break;case "avg_angle":if(!c)break;var f=a[g],h=f.x,k=f.y,f=f.nanCount;if(!(c-f))break;b[g]=180/Math.PI*Math.atan2(k/(c-f),h/(c-f));break;case "mode":var f=a[g],h=0,k=null,l;for(l in f){var p=f[l];p>h&&(h=p,k=l)}b[g]="null"===k?null:k}}return b};return a}();a.GeohashTree=c;var h=function(){function a(a,c,b){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.next=
null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this.children=Array(32);for(var d=0;d<this.children.length;d++)this.children[d]=null;this.xNode=a;this.yNode=c;this.depth=b}a.prototype.realloc=function(a,c,b){for(var d=0;d<this.children.length;d++)this.children[d]=null;this.xNode=a;this.yNode=c;this.depth=b;this.next=null;this.count=this.yTotal=this.xTotal=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};return this};a.prototype.getLngLatBounds=function(){var a=
this.depth,c=Math.ceil(a/2),a=Math.floor(a/2);return k.decodeGeohashXY({geohashX:this.xNode<<30-(3*c+2*a),geohashY:this.yNode<<30-(2*c+3*a)},this.depth)};a.prototype.find=function(a,c,b,d,f,g){if(d>=b)return this;var e=1-d%2,h=3*e+2*(1-e),k=2*e+3*(1-e),l=30-f-h,m=30-g-k,e=this.children[((a&7*e+3*(1-e)<<l)>>l)+((c&3*e+7*(1-e)<<m)>>m)*(8*e+4*(1-e))];return null==e?null:e.find(a,c,b,d+1,f+h,g+k)};return a}()})},"esri/geohash/geohashUtils":function(){define(["require","exports"],function(c,a){function l(a){return 57>=
a?a-48:104>=a?a-88:107>=a?a-89:110>=a?a-90:a-91}function g(a,b,c){a[0]=b;a[1]=c;return a}function k(a,b){var c=(a[0]+a[1])/2,d=!b;a[0]=d*a[0]+b*c;a[1]=d*c+b*a[1]}function h(a,b){b=b>(a[0]+a[1])/2;k(a,b);return b}function f(a,b){for(var c=g(n,-90,90),d=g(u,-180,180),e=0;e<b.length;e++){var f=b.charCodeAt(e),f=l(f);0===e%2?(k(d,!!(16&f)),k(d,!!(4&f)),k(d,!!(1&f)),k(c,!!(8&f)),k(c,!!(2&f))):(k(c,!!(16&f)),k(c,!!(4&f)),k(c,!!(1&f)),k(d,!!(8&f)),k(d,!!(2&f)))}a[0]=(c[0]+c[1])/2;a[1]=(d[0]+d[1])/2;return a}
function e(a,b,c){for(var d="",e=g(n,-90,90),f=g(u,-180,180),k=0;k<c;k++){var l=0;k%2?(l|=h(e,a)<<4,l|=h(f,b)<<3,l|=h(e,a)<<2,l|=h(f,b)<<1,l|=h(e,a)<<0):(l|=h(f,b)<<4,l|=h(e,a)<<3,l|=h(f,b)<<2,l|=h(e,a)<<1,l|=h(f,b)<<0);d+="0123456789bcdefghjkmnpqrstuvwxyz"[l]}return d}function p(a){return 180/Math.pow(2,Math.floor(5*a/2))}function b(a){return 360/Math.pow(2,Math.ceil(5*a/2))}function d(a,b){return b?1&a|(4&a)>>1|(16&a)>>2:(2&a)>>1|(8&a)>>2}function m(a,b){return b?(2&a)>>1|(8&a)>>2:1&a|(4&a)>>1|
(16&a)>>2}function r(a,b,c){var d=!((a.length-1)%2),e=a.substring(0,a.length-1),f=l(a.charCodeAt(a.length-1)),g=0,h=0,k=0,m=0;d?(g=8,h=4,k=1&f|(4&f)>>1|(16&f)>>2,m=(2&f)>>1|(8&f)>>2):(g=4,h=8,m=1&f|(4&f)>>1|(16&f)>>2,k=(2&f)>>1|(8&f)>>2);b=k+b;f=m+c;c=Math.floor(b/g);m=Math.floor(f/h);g=b-c*g;h=f-m*h;d="0123456789bcdefghjkmnpqrstuvwxyz"[d?g&1|(h&1)<<1|(g&2)<<1|(h&2)<<2|(g&4)<<2:h&1|(g&1)<<1|(h&2)<<1|(g&2)<<2|(h&4)<<2];return 1<a.length&&(c||m)?r(e,c,m)+d:e+d}Object.defineProperty(a,"__esModule",{value:!0});
var n=new Float64Array(2),u=new Float64Array(2);a.decodeBase32Char=l;a.encodeBase32Char=function(a){return"0123456789bcdefghjkmnpqrstuvwxyz"[a]};a.decodeGeohash=f;a.convertGeohash32ToXY=function(a,b){for(var c=a=0,e=30,f=30,g=0;g<b.length;g++){var h=b.charCodeAt(g),k=l(h),h=0===g%2,p=d(k,h),k=m(k,h),e=e-(h?3:2),f=f-(h?2:3);a|=p<<e;c|=k<<f}return{geohashX:a,geohashY:c}};a.decodeGeohashXY=function(a,b){for(var c=-90,d=90,e=-180,f=180,g=0;g<b;g++){for(var h=Math.ceil((g+1)/2),k=Math.floor((g+1)/2),l=
1-g%2,m=30-(3*h+2*k),p=30-(2*h+3*k),h=2*l+3*(1-l),k=(7*l+3*(1-l)<<m&a.geohashX)>>m,m=(3*l+7*(1-l)<<p&a.geohashY)>>p,l=3*l+2*(1-l)-1;0<=l;l--)var p=(e+f)/2,n=k&1<<l?1:0,e=(1-n)*e+n*p,f=(1-n)*p+n*f;for(l=h-1;0<=l;l--)h=(c+d)/2,k=m&1<<l?1:0,c=(1-k)*c+k*h,d=(1-k)*h+k*d}return[e,c,f,d]};a.setGeohashXY=function(a,b,c,d){d%2&&(d+=1);for(var e=0,f=0,g=-90,h=90,k=-180,l=180,m=0;m<d/2;m++){for(var p=0;5>p;p++)var n=(k+l)/2,r=c>n?1:0,e=e|r<<29-(p+5*m),k=(1-r)*k+r*n,l=(1-r)*n+r*l;for(p=0;5>p;p++)n=(g+h)/2,r=
b>n?1:0,f|=r<<29-(p+5*m),g=(1-r)*g+r*n,h=(1-r)*n+r*h}a.geohashX=e;a.geohashY=f};a.encodeGeohash=e;a.latDistPerGeohash=p;a.lonDistPerGeohash=b;a.unpackXBits=d;a.unpackYBits=m;a.getRelativeGeohash=r;a.getIntersectingGeohashes=function(a,c,d,f,g){d=Math.abs(d-a);f=Math.abs(f-c);var h=p(g),k=b(g);f=Math.ceil(f/k);d=Math.ceil(d/h);a=e(a,c,g);c=[];for(g=0;g<f;g++)for(h=0;h<d;h++)c.push(r(a,g,h));return c};a.forEachIntersectingGeohash=function(a,c,d,g,h,k){var l=Math.abs(d-a),m=Math.abs(g-c),n=p(h),t=b(h),
m=Math.ceil(m/t),l=Math.ceil(l/n);h=e(a,c,h);for(var u=0;u<m;u++)for(var v=0;v<l;v++){var w=r(h,u,v),y=f([0,0],w),z=y[0],y=y[1];k(w,Math.abs((Math.min(d,z+n/2)-Math.max(a,z-n/2))*(Math.min(g,y+t/2)-Math.max(c,y-t/2)))/(n*t))}}})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){Object.defineProperty(a,"__esModule",{value:!0});var t=p.getLogger("esri.layers.graphics.data.FeatureStore");c=function(){function a(a){this.geometryInfo=a;this._boundsStore=new u.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new e;this.featureAdapter=w.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var b=m.create(m.NEGATIVE_INFINITY);this._featuresById.forEach(function(c){if(c=
a._boundsStore.get(c.objectId))b[0]=Math.min(c[0],b[0]),b[1]=Math.min(c[1],b[1]),b[2]=Math.max(c[2],b[2]),b[3]=Math.max(c[3],b[3])});return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(b){b.geometry&&b.geometry.coords&&(a+=b.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var b=0;b<a.length;b++){var c=this._featuresById.get(a[b]);
c&&this._remove(c)}this._emitChanged()};a.prototype.forEachBounds=function(a,b,c){for(var e=0;e<a.length;e++){var f=this._boundsStore.get(a[e].objectId);f&&b(d.fromRect(c,f))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var c=this;this._boundsStore.forEachInBounds(a,function(a){b(c._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,b=!1;this._featuresById.forEach(function(c,d){a._markedIds.has(d)||(b=!0,a._remove(c))});this._markedIds.clear();b&&this._emitChanged()};a.prototype.executeTileQuery=function(a,b,c){return g(this,void 0,void 0,function(){var d,e,f,g,h,k,p,n,t,u,v,w,z,A;return l(this,function(l){d=c.returnGeometry;e=c.returnCentroid;f=c.returnOutline;g=c.pixelBuffer;h=
new Set;k=[];p=g*a.resolution;n=m.pad(a.bounds,p,m.create());y.createTileFeatures(k,h,this.geometryInfo,this,n,d,e,f,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||e)if(t=r.getInfo(b))u=t.valid,v=u[0],w=u[1],n[0]<v&&(z=m.fromValues(w-p,n[1],w,n[3]),y.createTileFeatures(k,h,this.geometryInfo,this,z,d,e,f,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[w,a.bounds[3]]})),n[2]>w&&
(A=m.fromValues(v,n[1],v+p,n[3]),y.createTileFeatures(k,h,this.geometryInfo,this,A,d,e,f,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[v-w+a.bounds[0],a.bounds[3]]}));k.sort(function(a,b){return a.localId-b.localId});return[2,{features:k,objectIds:h}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var c=a.objectId;if(null==c)t.error(new f("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var d=this._featuresById.get(c),e;this._markedIds.add(c);if(d)a.localId=d.localId,e=this._boundsStore.get(c),this._boundsStore.delete(c);else if(b.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(e=n.getBoundsOptimizedGeometry(e||m.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(c,e)):this._boundsStore.set(c,null);this._featuresById.set(c,a)}}};a.prototype._remove=function(a){if(b.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=c})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(c,a,l,g){Object.defineProperty(a,"__esModule",{value:!0});var k={minX:0,minY:0,maxX:0,maxY:0};c=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=g(9,l("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var c=Array(a._idByBounds.size),f=0;a._idByBounds.forEach(function(a,d){c[f++]=d});a._indexInvalid=!1;a._index.clear();a._index.load(c)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var c=this._boundsById.get(a);this._boundsById.delete(a);c&&(this._idByBounds.delete(c),this._indexInvalid||this._index.remove(c))};a.prototype.forEachInBounds=function(a,c){this._loadIndex();var e=0,b=this._index;k.minX=a[0];k.minY=a[1];k.maxX=a[2];k.maxY=a[3];for(a=b.search(k);e<a.length;e++)c(this._idByBounds.get(a[e]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,c){if(!this._indexInvalid){var e=this._boundsById.get(a);e&&(this._index.remove(e),this._idByBounds.delete(e))}this._boundsById.set(a,c);c&&(this._idByBounds.set(c,a),this._indexInvalid||this._boundsToLoad.push(c))};return a}();a.BoundsStore=c})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(c,a,l,g,k,h,f,e,p,b){function d(a,b,c,d,e,g){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var h=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=f.quantizeX(g,h[0]),a.coords[1]=f.quantizeY(g,h[1]),a.coords.length=c,a;for(var k,l,m,p,n=0,r,t=0,u=0;u<b.length;u++){var v=b[u];if(!(v<d)){r=t;m=k=f.quantizeX(g,h[n]);p=l=f.quantizeY(g,h[n+1]);a.coords[r]=m;a.coords[r+1]=p;n+=c;m=f.quantizeX(g,h[n]);p=f.quantizeY(g,h[n+1]);var w=
m-k,y=p-l,z=y/w;r+=2;a.coords[r]=w;a.coords[r+1]=y;k=m;l=p;for(var n=n+c,M=2;M<v;M++){m=f.quantizeX(g,h[n]);p=f.quantizeY(g,h[n+1]);if(m!==k||p!==l){k=m-k;l=p-l;var Q=l/k;z!==Q&&(isFinite(z)||isFinite(Q))||!(e||(isFinite(Q)?0<=z&&0<=Q||0>=z&&0>=Q:0<=y&&0<=l||0>=y&&0>=l))?(w=k,y=l,r+=2):(w+=k,y+=l);a.coords[r]=w;a.coords[r+1]=y;z=Q;k=m;l=p}n+=c}m=(r+2-t)/2;m>=d&&(a.lengths.push(m),t=r+2)}}a.coords.length>t&&(a.coords.length=t);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});
var m=new e.default,r={esriGeometryPoint:f.convertToPoint,esriGeometryPolyline:f.convertToPolyline,esriGeometryPolygon:f.convertToPolygon,esriGeometryMultipoint:f.convertToMultipoint};a.executeTileQueryForIds=function(a,b,c){b=h.pad(b.bounds,c.pixelBuffer*b.resolution,h.create());var d=[];a.featureStore.forEachInBounds(b,function(b){return d.push(a.featureAdapter.getObjectId(b))});return d};a.createTileFeatures=function(a,c,e,f,g,h,k,l,D){var t=r[e.geometryType],u=n[e.geometryType],v="esriGeometryPolygon"===
e.geometryType&&!l,w=e.hasZ?e.hasM?4:3:e.hasM?3:2;k&&!h?f.forEachInBounds(g,function(d){if(!c.has(d.objectId)){var f=b.getCentroid(e,d,D),g=d.attributes;f&&(c.add(d.objectId),a.push(new p.Feature(g,d.localId,null,f)))}}):h&&!k?f.forEachInBounds(g,function(b){if(!c.has(b.objectId)){var e=b.attributes,f=t(d(m,b.geometry,w,u,v,D),!1,!1);f&&(c.add(b.objectId),a.push(new p.Feature(e,b.localId,f,null)))}}):f.forEachInBounds(g,function(f){if(!c.has(f.objectId)){var g=b.getCentroid(e,f,D),h=f.attributes,
k=t(d(m,f.geometry,w,u,v,D),!1,!1);k&&g&&(c.add(f.objectId),a.push(new p.Feature(h,f.localId,k,g)))}})};var n={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0}})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},
getAttributes:function(a){return a.attributes},getAttribute:function(a,c){return a.attributes[c]},cloneWithGeometry:function(a,c){return new g.default(c,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,c){a.centroid||(a.centroid=l.getCentroidOptimizedGeometry(new k.default,a.geometry,c.hasZ,c.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../engine ../../graphics/graphicsUtils".split(" "),
function(c,a,l,g,k,h,f,e){function p(a){if(!("visualVariables"in a&&a.hasVisualVariables("size")))return 0;a=a.getVisualVariablesForType("size");if(!a[0])return 0;a=a[0];if("stops"===a.transformationType)return a.stops.map(function(a){return a.size}).reduce(n,0);if("clamped-linear"===a.transformationType)return"number"===typeof a.maxSize?a.maxSize:a.maxSize.stops.map(function(a){return a.size}).reduce(n,0);if("real-world-size"===a.transformationType)return 30}function b(a,b){return null==a?b:a}function d(a,
c){return g(this,void 0,void 0,function(){var g,h,k,m,n,p,u,v,z,G,I;return l(this,function(l){switch(l.label){case 0:if("simple-marker"===a.type)return g=Math.max(b(a.size,12),c),[2,r(a)+.707*g];if("picture-marker"===a.type)return h=Math.max(b(a.height,12),c),k=b(a.width,12)*(h/b(a.height,12)),m=k/2,n=h/2,[2,r(a)+Math.sqrt(m*m+n*n)];if("text"===a.type)return e.getTextSymbolEstimatedSize(y,a,f.definitions.AVERAGE_GLYPH_MOSAIC_ITEM),p=y[2]*(b(a.horizontalAlignment,"top")in w?1:.5),u=y[3]*(b(a.horizontalAlignment,
"center")in t?1:.5),v=null==a.font?9:b(a.font.size,9),z=Math.max(v,c)/v,[2,r(a)+Math.sqrt(p*p+u*u)*z];if("simple-line"===a.type)return[2,Math.max(b(a.width,.75),c)/2];if("simple-fill"===a.type||"picture-fill"===a.type)return[2,Math.max(null==a.outline?0:b(a.outline.width,0),c)/2];if("cim"===a.type)return(G=f.CIMSymbolHelper.getEnvelope(a.data))?[2,Math.sqrt(G.width*G.width+G.height*G.height)]:[2,0];if("web-style"!==a.type)return[3,2];I=d;return[4,a.fetchCIMSymbol()];case 1:return[2,I.apply(void 0,
[l.sent(),c])];case 2:return[2,0]}})})}function m(a,b){return g(this,void 0,void 0,function(){var c,e;return l(this,function(f){switch(f.label){case 0:if(!(a.type in u))return[2,0];e=(c=Math).min;return[4,d(a,b)];case 1:return[2,e.apply(c,[f.sent(),75])]}})})}function r(a){var c=b(a.xoffset,0);a=b(a.yoffset,0);return Math.sqrt(c*c+a*a)}function n(a,b){return Math.max(a,b)}Object.defineProperty(a,"__esModule",{value:!0});var u={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,
"picture-fill":1,cim:1,"web-style":1};a.computePxBuffer=function(a,b){return g(this,void 0,void 0,function(){var c,d,e,f,g,r,t;return l(this,function(l){switch(l.label){case 0:if("heatmap"===a.type)return[2,Math.round(3*a.blurRadius)];if("dot-density"===a.type)return[2,0];if("dictionary"===a.type)return"esriGeometryPoint"===b||"esriGeometryMultipoint"===b?[2,100]:[2,50];c=a.getSymbols();d=p(a);e=[];f=0;for(g=c;f<g.length;f++)r=g[f],e.push(m(r,d));return[4,k.all(e)];case 1:return t=l.sent(),[2,h.pt2px(t.reduce(n,
0))]}})})};var y=[0,0,0,0],w={left:1,right:1},t={top:1,bottom:1,baseline:1}})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("require exports ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/intersects ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/spatialReferenceUtils ../../engine".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w){function t(a,b,c,d,e){var h,l,m=g.pt2px(c.xoffset),n=g.pt2px(c.yoffset),p=G*c.angle;e*=G;switch(c.type){case "simple-marker":h=l=g.pt2px(c.size);break;case "picture-marker":h=g.pt2px(c.width),l=g.pt2px(c.height)}c=k.mat2d.identity(M);k.mat2d.translate(c,c,f.vec2.set(Q,a,b));k.mat2d.rotate(c,c,e-p);k.mat2d.scale(c,c,f.vec2.set(Q,d,-d));k.mat2d.translate(c,c,f.vec2.set(Q,m,-n));a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(Q,-.5*h,-.5*l),c);b=[0,0];f.vec2.transformMat2d(b,
f.vec2.set(Q,-.5*h,.5*l),c);d=[0,0];f.vec2.transformMat2d(d,f.vec2.set(Q,.5*h,-.5*l),c);m=[0,0];f.vec2.transformMat2d(m,f.vec2.set(Q,.5*h,.5*l),c);return{rings:[[a,d,m,b,a]]}}function v(a,b,c,d,e){var h=w.CIMSymbolHelper.getEnvelope(c.data);if(!h)return null;c=g.pt2px(h.width);var l=g.pt2px(h.height),m=g.pt2px(h.x),h=g.pt2px(h.y),n=0*G,p=G*e;e=k.mat2d.identity(M);k.mat2d.translate(e,e,f.vec2.set(Q,a,b));k.mat2d.rotate(e,e,p-n);k.mat2d.scale(e,e,f.vec2.set(Q,d,d));a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(Q,
m,h+l),e);b=[0,0];f.vec2.transformMat2d(b,f.vec2.set(Q,m,h),e);d=[0,0];f.vec2.transformMat2d(d,f.vec2.set(Q,m+c,h+l),e);l=[0,0];f.vec2.transformMat2d(l,f.vec2.set(Q,m+c,h),e);return{rings:[[a,d,l,b,a]]}}function z(a,b,c,d,e,h){var l=w.alignmentUtils.getYAnchorDirection(c.verticalAlignment||"baseline"),m="baseline"===(c.verticalAlignment||"baseline"),n=g.pt2px(c.xoffset),p=g.pt2px(c.yoffset),r=g.pt2px(c.font.size)/24,t=4*r,l=m?25*r:d[1]+(1+l)*d[3]*.5;c=G*c.angle;m=G*h;h=k.mat2d.identity(M);k.mat2d.translate(h,
h,f.vec2.set(Q,a,b));k.mat2d.rotate(h,h,m-c);k.mat2d.scale(h,h,f.vec2.set(Q,e,-e));k.mat2d.translate(h,h,f.vec2.set(Q,n,-p));k.mat2d.translate(h,h,f.vec2.set(Q,-t,-t-l));a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(Q,d[0],d[1]),h);b=[0,0];f.vec2.transformMat2d(b,f.vec2.set(Q,d[0],d[1]+d[3]),h);e=[0,0];f.vec2.transformMat2d(e,f.vec2.set(Q,d[0]+d[2],d[1]),h);n=[0,0];f.vec2.transformMat2d(n,f.vec2.set(Q,d[0]+d[2],d[1]+d[3]),h);return{rings:[[a,e,n,b,a]]}}function A(a,b,c){if(!c||0===c.glyphMosaicItems.length)return a;
var d=w.bidiText(b.text),e=d[0],d=d[1],f=w.alignmentUtils.getJustification(b.horizontalAlignment||"center"),h=w.alignmentUtils.getXAnchorDirection(b.horizontalAlignment||"center");c=(new w.TextShapingNew([c.glyphMosaicItems],w.definitions.TEXT_MAX_WIDTH,w.definitions.TEXT_LINE_HEIGHT,w.definitions.TEXT_SPACING,[0,.5*-L],.5*(1-h),0,f)).getShaping(e,d);e=w.fontUtils.getFontDecorationTop(b.font.decoration);isNaN(e)||w.TextShapingNew.addDecoration(c,e);c=w.TextShapingNew.getBox(c);b=g.pt2px(b.font.size)/
ja;a[0]=b*c.x;a[1]=b*c.y;a[2]=b*c.width;a[3]=b*c.height;return a}function C(a,b){return Math.ceil((a-b)/(2*b))}function D(a,b){var c;c=r.isPolygon(a)?a.rings:a.paths;for(var d=0;d<c.length;d++)for(var e=0,f=c[d];e<f.length;e++)f[e][0]+=b;return a}function B(a,b){if(!b)return a;var c=E(a,b).map(function(a){return a.extent});return 2>c.length?c[0]||a:2<c.length?(a.xmin=b.valid[0],a.xmax=b.valid[1],a):{rings:c.map(function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,
a.ymin]]})}}function E(a,b){var c=[],d=a.ymin,e=a.ymax,f=a.xmax-a.xmin,g=a.xmin,h=a.xmax,k,l=b.valid,m=l[0],n=l[1];k=F(a.xmin,b);var p=k.x,l=k.frameId;k=F(a.xmax,b);b=k.x;a=k.frameId;k=p===b&&0<f;if(f>2*n){f={xmin:g<h?p:b,ymin:d,xmax:n,ymax:e};g={xmin:m,ymin:d,xmax:g<h?b:p,ymax:e};h={xmin:0,ymin:d,xmax:n,ymax:e};d={xmin:m,ymin:d,xmax:0,ymax:e};e=[];m=[];H(f,h)&&e.push(l);H(f,d)&&m.push(l);H(g,h)&&e.push(a);H(g,d)&&m.push(a);for(n=l+1;n<a;n++)e.push(n),m.push(n);c.push({extent:f,frameIds:[l]},{extent:g,
frameIds:[a]},{extent:h,frameIds:e},{extent:d,frameIds:m})}else p>b||k?c.push({extent:{xmin:p,ymin:d,xmax:n,ymax:e},frameIds:[l]},{extent:{xmin:m,ymin:d,xmax:b,ymax:e},frameIds:[a]}):c.push({extent:{xmin:p,ymin:d,xmax:b,ymax:e},frameIds:[l]});return c}function F(a,b){var c=b.valid;b=c[0];var d=c[1],c=2*d,e=0;a>d?(b=Math.ceil(Math.abs(a-d)/c),a-=b*c,e=b):a<b&&(b=Math.ceil(Math.abs(a-b)/c),a+=b*c,e=-b);return{x:a,frameId:e}}function H(a,b){var c=b.xmin,d=b.ymin,e=b.xmax;b=b.ymax;return J(a,c,d)&&J(a,
c,b)&&J(a,e,b)&&J(a,e,d)}function J(a,b,c){return b>=a.xmin&&b<=a.xmax&&c>=a.ymin&&c<=a.ymax?!0:!1}function K(a,b,c){if(Array.isArray(a)){var d=a[0];if(d>b){var e=C(d,b);a[0]=d+-2*e*b}else d<c&&(e=C(d,c),a[0]=d+-2*e*c)}else d=a.x,d>b?(e=C(d,b),a.x+=-2*e*b):d<c&&(e=C(d,c),a.x+=-2*e*c);return a}Object.defineProperty(a,"__esModule",{value:!0});var G=Math.PI/180,I=w.definitions.TEXT_MAX_WIDTH,L=w.definitions.TEXT_LINE_HEIGHT,R=w.definitions.TEXT_SPACING,M=h.mat2df32.create(),Q=e.vec2f32.create(),N=b.create();
a.getBounds=function(a,b,c,e,f,g,h){if(!e||!c)return a[0]=a[1]=a[2]=a[3]=0,b[0]=b[1]=b[2]=b[3]=0,a;if(r.isPoint(e)){var k=e.x;e=e.y;"text"===c.type&&0===b[2]&&0===b[3]&&A(b,c,f);var l;switch(c.type){case "simple-marker":case "picture-marker":l=t(k,e,c,g,0);break;case "text":l=z(k,e,c,b,g,0);break;case "cim":l=v(k,e,c,g,0)}for(g=b=0;g<l.rings[0].length-1;g++)c=l.rings[0][g],c=(k-c[0])*(k-c[0])+(e-c[1])*(e-c[1]),b=Math.max(b,c);b=Math.sqrt(b);g=n.normalizeMapX(k-b,h);k=n.normalizeMapX(k+b,h);g>k&&(h=
y.getInfo(h))&&(g=h.valid,h=g[1],g=g[0],k=h);a[0]=g;a[1]=e-b;a[2]=k;a[3]=e+b}else{d.getBoundsXY(a,e);e=b[0];if(0===e){a:switch(e=0,c.type){case "simple-fill":case "picture-fill":e=c.outline;if(!e){e=0;break a}e=e.width;break;case "simple-line":e=c.width;break;case "simple-marker":e=c.size;break;case "picture-marker":e=Math.max(c.width,c.height);break;case "text":e=[0,0,0,0];A(e,c,f);e=Math.max(e[0],e[1]);break;case "cim":e=w.CIMSymbolHelper.getEnvelope(c.data),e=Math.sqrt(e.width*e.width+e.height*
e.height)}b[0]=e}e=g*e/2;a[0]-=e;a[1]-=e;a[2]+=e;a[3]+=e}return a};a.isMarkerSymbol=function(a){return"simple-marker"===a||"picture-marker"===a||"text"===a};a.graphicGeometryToNumber=function(a){switch(l.expect(a.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};var U=e.vec2f32.create(),V=e.vec2f32.create(),S=e.vec2f32.create(),X=e.vec2f32.create(),W=e.vec2f32.create(),Y=e.vec2f32.create(),T=e.vec2f32.create();a.isPointOnPolyline=function(a,b,c,d){f.vec2.set(S,
b,c);a=a.paths;for(var e,g,h,k,l,m,n,p,r=Infinity,t=0;t<a.length;t++){var u=a[t];if(!(2>u.length))for(var v=1;v<u.length;v++)e=u[v-1][0],h=u[v-1][1],g=u[v][0],k=u[v][1],l=Math.min(e,g)-d,m=Math.min(h,k)-d,n=Math.max(e,g)+d,p=Math.max(h,k)+d,b<l||b>n||c<m||c>p||(f.vec2.set(U,e,h),f.vec2.set(V,g,k),f.vec2.subtract(X,V,U),f.vec2.subtract(W,U,S),f.vec2.scale(Y,X,f.vec2.dot(X,W)/f.vec2.dot(X,X)),f.vec2.subtract(T,W,Y),e=f.vec2.dot(T,T),r>e&&(r=e))}return Math.sqrt(r)<=d};a.getMarkerSymbolBounds=t;a.getCIMMarkerBounds=
v;a.getTextSymbolBounds=z;a.normalizeCentralMeridian=function(a){var b,c,e,f,g,h=null;if(!a)return null;b=a.spatialReference;c=u.getInfo(b);g=b.isWebMercator?102100:4326;e=aa[g].maxX;f=aa[g].minX;b=aa[g].plus180Line;g=aa[g].minus180Line;var k,l=a.toJSON();if(!c)return l;"mesh"===a.type?k=l:r.isPoint(l)?k=K(l,e,f):r.isMultipoint(l)?(l.points=l.points.map(function(a){return K(a,e,f)}),k=l):r.isExtent(l)?k=B(l,c):r.isPolygon(l)||r.isPolyline(l)?(d.getBoundsXY(N,l),a={xmin:N[0],ymin:N[1],xmax:N[2],ymax:N[3]},
c=2*C(a.xmin,f)*e,l=0===c?l:D(l,c),a.xmin+=c,a.xmax+=c,m.extentIntersectsPolyline(a,b)&&a.xmax!==e?h=l:m.extentIntersectsPolyline(a,g)&&a.xmin!==f?h=l:k=l):k=a.clone();return null!==h?(new ba).cut(h,e):k};var ja=24;a.getTextSymbolSize=A;a.getTextSymbolEstimatedSize=function(a,b,c){var d=w.bidiText(b.text),e=d[0],d=d[1],f=w.alignmentUtils.getJustification(b.horizontalAlignment||"center"),h=w.alignmentUtils.getXAnchorDirection(b.horizontalAlignment||"center");c=(new w.TextShapingNew([],I,L,R,[0,.5*
-L],.5*(1-h),0,f)).getEstimatedShaping(e,d,c);c=w.TextShapingNew.getBox(c);b=g.pt2px(b.font.size)/ja;a[0]=b*c.x;a[1]=b*c.y;a[2]=b*c.width;a[3]=b*c.height;return a};var aa={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:{paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:p.WebMercator},minus180Line:{paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:p.WebMercator}},
4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:p.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:p.WGS84}}},ba=function(){function a(){}a.prototype.cut=function(a,b){var c;if(a.rings)this.closed=!0,c=a.rings,this.minPts=4;else if(a.paths)this.closed=!1,c=a.paths,this.minPts=2;else return null;var d=c.length;b*=-2;for(var e=0;e<d;e++){var f=c[e];if(f&&f.length>=this.minPts){for(var g=[],h=0;h<f.length;h++){var k=f[h];g.push([k[0]+b,k[1]])}c.push(g)}}this.closed?
a.rings=c:a.paths=c;return a};return a}()})},"esri/views/2d/layers/features/controllers/EditsQueue":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/Accessor ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators @dojo/framework/shim/Promise".split(" "),function(c,a,l,g,k,h,f,e,p){Object.defineProperty(a,
"__esModule",{value:!0});c=function(a){function b(b){b=a.call(this,b)||this;b._queue=[];b._onGoingRequest=null;b._abortController=e.createAbortController();return b}h(b,a);b.prototype.destroy=function(){this.clear()};Object.defineProperty(b.prototype,"updating",{get:function(){return!this.destroyed&&(0<this._queue.length||null!=this._onGoingRequest)},enumerable:!0,configurable:!0});b.prototype.clear=function(){if(this.destroyed)throw Error("instance is already destroyed");for(var a=this._queue.pop();a;)a.resolver.reject(e.createAbortError()),
a=this._queue.pop();this._queue.length=0;this._abortController.abort();this._abortController=e.createAbortController()};b.prototype.push=function(a){return k(this,void 0,void 0,function(){var b,c=this;return g(this,function(d){if(this.destroyed)throw Error("instance is already destroyed");b=e.createResolver();this._queue.push({event:a,resolver:b});this.notifyChange("updating");Promise.resolve().then(function(){c._processNext()});return[2,b.promise]})})};b.prototype._processNext=function(){return k(this,
void 0,void 0,function(){var a,b,c,d,e,f,h,k,l,p,C,D,B,E,F,H,J,K,G,I,L,R,M,Q=this;return g(this,function(g){switch(g.label){case 0:if(this._onGoingRequest)return[2];a=[];b=new Set;c=new Set;d=new Set;for(e=this._queue.shift();e;){f=e.event;h=f.addedFeatures;k=f.deletedFeatures;l=f.updatedFeatures;p=e.resolver;a.push(p);C=0;for(D=h;C<D.length;C++)B=D[C],E=B.objectId,F=B.error,F||(b.add(E),c.add(E),d.delete(E));H=0;for(J=l;H<J.length;H++)K=J[H],E=K.objectId,F=K.error,F||(c.add(E),d.delete(E));G=0;for(I=
k;G<I.length;G++)L=I[G],E=L.objectId,F=L.error,F||(b.has(E)?b.delete(E):d.add(E),c.delete(E));e=this._queue.shift()}if(!c.size&&!d.size)return this.notifyChange("updating"),a.forEach(function(a){return a()}),[2];R=[];M=[];c.size&&c.forEach(function(a){R.push(a)});d.size&&d.forEach(function(a){M.push(a)});this._onGoingRequest=Promise.resolve().then(function(){return Q.processEdits(R,M,{signal:Q._abortController.signal})}).catch(function(){});this.notifyChange("updating");return[4,this._onGoingRequest];
case 1:return g.sent(),this._onGoingRequest=null,this.notifyChange("updating"),a.forEach(function(a){return a()}),0<this._queue.length&&this._processNext(),[2]}})})};l([p.property({constructOnly:!0})],b.prototype,"processEdits",void 0);l([p.property({readOnly:!0})],b.prototype,"updating",null);return b=l([p.subclass("esri.views.2d.layers.features.controllers.EditsQueue")],b)}(p.declared(f));a.EditsQueue=c})},"esri/views/2d/layers/features/support/DataTile":function(){define(["require","exports"],
function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this.tile=this.displayTile=null;this.done=!1;this.queryInfoHash=null;this.returnExceeded=!1}Object.defineProperty(a.prototype,"key",{get:function(){return this.tile.key},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.tile.id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bounds",{get:function(){return this.tile.bounds},enumerable:!0,configurable:!0});
return a}();a.default=c})},"esri/views/2d/layers/features/support/DataTileFeaturesIndex":function(){define(["require","exports","../../../../../core/SetPool","../../../../../layers/graphics/data/FeatureStore","./Tile"],function(c,a,l,g,k){Object.defineProperty(a,"__esModule",{value:!0});var h=[],f=new Set;c=function(){function a(){this._tileById=new Map;this._tilesToFeatures=new Map;this._featureToTiles=new Map}a.prototype.destroy=function(){this.clear()};a.prototype.add=function(a){var b=this;this.has(a.id)||
(this._tileById.set(a.id,a),this._tilesToFeatures.set(a,l.default.acquire()),this._tilesToFeatures.forEach(function(c,e){a!==e&&(k.isParentOf(a,e)?c.forEach(function(c){b._link(a,c)}):k.isChildOf(a,e)&&b.featureStore.forEachInBounds(a.bounds,function(d){c.has(d.objectId)&&b._link(a,d.objectId)}))}))};a.prototype.clear=function(){this._tilesToFeatures.forEach(function(a){return l.default.release(a)});this._tilesToFeatures.clear();this._featureToTiles.forEach(function(a){return l.default.release(a)});
this._featureToTiles.clear();this._tileById.clear()};a.prototype.delete=function(a){var b=this,c=this.get(a.id);h.length=0;this._tilesToFeatures.get(c).forEach(function(a){var d=b._featureToTiles.get(a);d.has(c)&&1===d.size?h.push(a):b._unlink(c,a)});for(a=0;a<h.length;a++)this._unlink(c,h[a]);this.featureStore.removeManyById(h);this._tilesToFeatures.delete(c);this._tileById.delete(c.id);h.length=0};a.prototype.forEach=function(a,b){return this._tileById.forEach(a,b)};a.prototype.get=function(a){return this._tileById.get(a)};
a.prototype.has=function(a){return this._tileById.has(a)};a.prototype.setTileFeatures=function(a,b){var c=this,e=this.get(a.id);this._tilesToFeatures.has(e)||(this._tileById.set(e.id,e),this._tilesToFeatures.set(e,l.default.acquire()));for(a=0;a<b.length;a++)f.add(b[a].objectId);h.length=0;this._tilesToFeatures.get(e).forEach(function(a){if(!f.has(a)){var b=c._featureToTiles.get(a);b.has(e)&&1===b.size?h.push(a):c._unlink(e,a)}});for(a=0;a<h.length;a++)this._unlink(e,h[a]);this.featureStore.removeManyById(h);
this.featureStore.addMany(b);f.forEach(function(a){c._link(e,a)});f.clear();h.length=0};a.prototype.addOrUpdateFeatures=function(a){for(var b=this,c=new Set,e=new g.default({geometryType:this.featureStore.geometryType,hasM:this.featureStore.hasM,hasZ:this.featureStore.hasZ}),f=0,h=this.deleteFeaturesById(a.map(function(a){return a.objectId}));f<h.length;f++)c.add(h[f]);e.addMany(a);this._tileById.forEach(function(a){e.forEachInBounds(a.bounds,function(d){b._link(a,d.objectId);c.add(a)})});this.featureStore.addMany(a);
var k=[];c.forEach(function(a){return k.push(a)});return k};a.prototype.deleteFeaturesById=function(a){for(var b=this,c=new Set,e=function(a){var d=f._featureToTiles.get(a);d&&(d.forEach(function(d){c.add(d);b._tilesToFeatures.get(d).delete(a)}),l.default.release(d),f._featureToTiles.delete(a))},f=this,g=0;g<a.length;g++)e(a[g]);this.featureStore.removeManyById(a);var h=[];c.forEach(function(a){return h.push(a)});return h};a.prototype._link=function(a,b){this._featureToTiles.get(b)||this._featureToTiles.set(b,
l.default.acquire());this._featureToTiles.get(b).add(a);this._tilesToFeatures.get(a).add(b)};a.prototype._unlink=function(a,b){this._featureToTiles.get(b).delete(a);this._tilesToFeatures.get(a).delete(b);0===this._featureToTiles.get(b).size&&(l.default.release(this._featureToTiles.get(b)),this._featureToTiles.delete(b))};return a}();a.default=c})},"esri/core/SetPool":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});c=function(){function a(){this._pool=
[];this._set=new Set}a.prototype.acquire=function(){if(0===this._pool.length)return new Set;var a=this._pool.pop();this._set.delete(a);return a};a.prototype.release=function(a){a&&!this._set.has(a)&&(a.clear(),5E4>this._pool.length&&(this._pool.push(a),this._set.add(a)))};a.acquire=function(){return l.acquire()};a.release=function(a){return l.release(a)};return a}();a.default=c;var l=new c})},"esri/views/2d/layers/features/support/TileUpdateQueue":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Accessor ../../../../../core/promiseUtils ../../../../../core/scheduling ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec2 ../../../tiling".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m){Object.defineProperty(a,"__esModule",{value:!0});var r=[0,0];c=function(a){function c(b){b=a.call(this,b)||this;b._queue=new Map;b._isPaused=!1;b._scheduledNextHandle=null;b._timestamp=Date.now();b.tileInfoView=null;b._next=b._next.bind(b);b._finalize=b._finalize.bind(b);return b}l(c,a);Object.defineProperty(c.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"updating",{get:function(){return 0<
this._queue.size||null!=this._onGoingTile},enumerable:!0,configurable:!0});c.prototype.abort=function(a){this._onGoingTile&&this._onGoingTile.tileId===a&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null);this._queue.delete(a);this._scheduleNext();this.notifyChange("updating")};c.prototype.clear=function(){this._queue.clear();this._onGoingTile&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null);this._cancelNext();this.notifyChange("updating")};c.prototype.has=function(a){return this._queue.has(a)};
c.prototype.isOngoing=function(a){return this._onGoingTile&&this._onGoingTile.tileId===a};c.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};c.prototype.push=function(a,b){if(!this._queue.has(a)){var c=e.createAbortController();this._queue.set(a,{tileId:a,key:m.TileKey.pool.acquire(a),timestamp:b||this._timestamp,abortController:c});this._scheduleNext();this.notifyChange("updating")}};c.prototype.refresh=function(){this._timestamp=Date.now();this.reset()};c.prototype.reset=
function(){var a=this._onGoingTile;a&&this.push(a.tileId,this._timestamp);this.notifyChange("updating")};c.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext());this.notifyChange("updating")};c.prototype._finalize=function(){this._onGoingTile=null;this.notifyChange("updating");this._scheduleNext()};c.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)};c.prototype._scheduleNext=function(){this._isPaused||
this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingTile||(this._scheduledNextHandle=p.schedule(this._next))};c.prototype._next=function(){return h(this,void 0,void 0,function(){var a,b,c,d,e;return k(this,function(f){switch(f.label){case 0:if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingTile)return this._scheduledNextHandle=null,[2];this._scheduledNextHandle=null;a=this._peek();b=a.abortController.signal;c=a.tileId;d=a.key;m.TileKey.pool.release(d);this._queue.delete(c);
this._onGoingTile=a;e=this.process(c,this._timestamp,{signal:b});this.notifyChange("updating");if(!e||"function"!==typeof e.then)return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,e];case 2:return f.sent(),[3,4];case 3:return f.sent(),[3,4];case 4:return this._finalize(),[2]}})})};c.prototype._peek=function(){var a=this;if(!this.state)throw Error("state not set");var b=this.tileInfoView,c=this.state.center,e=Number.NEGATIVE_INFINITY,f=Number.POSITIVE_INFINITY,g=null;this._queue.forEach(function(h){b.getTileCoords(r,
h.key);var k=a._timestamp-h.timestamp;isNaN(k)?(k=d.vec2.distance(r,c),k<f&&(f=k,g=h)):k===e?(k=d.vec2.distance(r,c),k<f&&(f=k,g=h)):k>e&&(e=k,f=Number.POSITIVE_INFINITY,g=h)});return g};g([b.property({readOnly:!0})],c.prototype,"length",null);g([b.property({constructOnly:!0})],c.prototype,"process",void 0);g([b.property()],c.prototype,"state",void 0);g([b.property({constructOnly:!0})],c.prototype,"tileInfoView",void 0);g([b.property({readOnly:!0})],c.prototype,"updating",null);return c=g([b.subclass("esri.views.2d.layers.features.support.TileUpdateQueue")],
c)}(b.declared(f));a.default=c})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/MapPool ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../geometry/SpatialReference ../../../../../layers/support/LabelClass ../../../../../layers/support/labelFormatUtils ../../../../../renderers/support/jsonUtils ../../../engine ../../../arcade/utils ../../../engine/webgl/util/symbolUtils ../../../engine/webgl/util/vvFlagUtils ./BaseProcessor".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v,z,A,C,D){Object.defineProperty(a,"__esModule",{value:!0});var B=b.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._symbolToMosaicItemMap=new Map;b._visualSetPromises=new Map;b.type="symbol";return b}l(b,a);b.prototype.initialize=function(){this._factory=this._createFactory()};b.prototype.destroy=function(){this._visualSetPromises.clear();this._symbolToMosaicItemMap.clear();
this.notifyChange("updating")};Object.defineProperty(b.prototype,"supportsTileUpdates",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"labelingInfo",{get:function(){return!this.config||m.isNone(this.config.labelingInfo)?null:this.config.labelingInfo.map(function(a){return y.fromJSON(a)})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"labelClassInfos",{get:function(){var a=this;return this.labelingInfo?r.all(this.labelingInfo.map(function(b,
c){return f(a,void 0,void 0,function(){var a;return h(this,function(d){switch(d.label){case 0:return a={index:c,minScale:b.minScale,maxScale:b.maxScale},[4,w.createLabelFunction(b,this.service.fields,this.spatialReference)];case 1:return[2,(a.builder=d.sent(),a.symbol=b.symbol,a)]}})})})):r.resolve()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hydrate",{get:function(){return z.createHydrateFactory(this.service.geometryType)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"renderer",{get:function(){return this.config?t.fromJSON(this.config.renderer):null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"updating",{get:function(){return 0<this._visualSetPromises.size},enumerable:!0,configurable:!0});b.prototype.update=function(a){return f(this,void 0,void 0,function(){var b;return h(this,function(c){b=this._getMeshHash();this._set("config",a);b!==this._getMeshHash()?this._factory=this._createFactory():this._factory.update(this.labelingInfo,this.renderer,
this.tileStore.tileScheme.tileInfo);return[2]})})};b.prototype.onTileData=function(a,b,c){var d=this,e=b.addOrUpdate,f=b.remove,g=b.clear;b=e&&e.length?this._processFeatures(a,e,b.transformParams):r.resolve();var h=c.signal;b=b.then(function(b){return d.remoteClient.invoke("tileRenderer.onTileData",{tileKey:a.id,data:{addOrUpdate:b&&b.message||null,remove:f,clear:g}},{transferList:b&&b.transferList||null,signal:h})}).catch(function(b){return d._handleError(a,b,c)});this._visualSetPromises.set(a,b);
r.always(b,function(){return d._cleanPromise(a)});this.notifyChange("updating");return b};b.prototype.onTileError=function(a,b,c){var d=this;b=this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:b},{signal:c.signal});this._visualSetPromises.set(a,b);r.always(b,function(){return d._cleanPromise(a)});this.notifyChange("updating");return b};b.prototype._getMeshHash=function(){var a=C.getVVFlags("visualVariables"in this.renderer&&this.renderer.visualVariables||[]);return this.renderer.getMeshHash()+
"."+a};b.prototype._createFactory=function(){var a=this,b=this.service,c=b.geometryType,d=b.objectIdField,b=b.fields,e=u.fromJSON(this.spatialReference),b={geometryType:c,fields:b,spatialReference:e},e=new v.WGLTemplateStore(function(b,c){return a.remoteClient.invoke("tileRenderer.getMaterialItems",b,c)},!1),f=this.tileStore.tileScheme.tileInfo;this._matcher=v.createMatcher(this.renderer,e,b);return new v.WGLMeshFactory(c,d,this.renderer,e,this.labelingInfo,f)};b.prototype._cleanPromise=function(a){this._visualSetPromises.delete(a);
this.notifyChange("updating")};b.prototype._processFeatures=function(a,b,c){var d=this;if(!b||!b.length)return r.resolve(null);var e=this._factory,f={viewingMode:"",scale:a.scale};return this._matcher.then(function(a){return e.analyze(b,!1,a,c,f)}).then(function(b){return d._getLabelMosaicItems(a,b,c).then(function(f){return d._writeFeatures(a,b,c,f,e)})})};b.prototype._writeFeatures=function(a,b,c,d,e){for(var f=e.createMeshData(b.length),g={viewingMode:"",scale:a.scale},h=this._symbolToMosaicItemMap,
k=0;k<b.length;k++){var l=b[k];try{e.write(f,l,c,g,a.level,d,h)}catch(U){}}return this._encodeDisplayData(f)};b.prototype._encodeDisplayData=function(a){var b={},c=[];a.encode(b,c);return{message:b,transferList:c}};b.prototype._handleError=function(a,b,c){c=c.signal;if(!r.isAbortError(b))return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:b.message},{signal:c})};b.prototype._getLabelMosaicItems=function(a,b,c){return f(this,void 0,void 0,function(){var e,f,g,k,l,m;return h(this,
function(h){switch(h.label){case 0:return e=d.acquire(),[4,this._createLabelFeatures(a.scale,b,e,c)];case 1:f=h.sent();g=this._symbolToMosaicItemMap;k=d.acquire();l=[];m=0;e.forEach(function(a,b){if(g.has(b.id)){var c=g.get(b.id).glyphMosaicItems,d=[];a.forEach(function(a){if(c&&c.length<a||!c[a])d[a]=a});0<d.length&&(k.set(m,b),l.push({symbol:b.toJSON(),id:m,glyphIds:d}),m++)}else{k.set(m,b);var e=[];a.forEach(function(a){return e.push(a)});l.push({symbol:b.toJSON(),id:m,glyphIds:e});m++}});if(0<
l.length)return[2,this.remoteClient.invoke("tileRenderer.getMaterialItems",l).then(function(a){for(var b=0;b<a.length;b++){var c=a[b],e=k.get(c.id);if(e)if(A.isTextSymbol(e))if(g.has(e.id)){if(e=g.get(e.id).glyphMosaicItems,c=c.mosaicItem.glyphMosaicItems)for(var h=0;h<c.length;h++)null!=c[h]&&(e[h]=c[h])}else g.set(e.id,c.mosaicItem);else g.set(e.id,c.mosaicItem)}d.release(k);return f})];d.release(e);return[2,r.resolve(f)]}})})};b.prototype._getLabelClassInfosForScale=function(a){return f(this,void 0,
void 0,function(){var b;return h(this,function(c){switch(c.label){case 0:return[4,this.labelClassInfos];case 1:return b=c.sent(),[2,b.filter(function(b){var c=b.minScale;b=b.maxScale;return(!c||c>=a||0===c)&&(!b||b<=a||0===b)})]}})})};b.prototype._createLabelFeatures=function(a,b,c,e){return f(this,void 0,void 0,function(){var f,g,l,n,p,r,t,w,y,z,A,C,D,E,F,G,H,J,K,ta,qa,ma,oa,Ba,ua,Da,xa,Ca,za;return h(this,function(h){switch(h.label){case 0:return this.labelingInfo&&b&&0!==b.length?[4,this._getLabelClassInfosForScale(a)]:
[2,null];case 1:f=h.sent();if(0===f.length)return[2,null];g=d.acquire();l=new v.CollisionGrid(v.definitions.COLLISION_EARLY_REJECT_BUCKET_SIZE);n=0;for(p=b;n<p.length;n++){r=p[n];t=this.service.geometryType;y=w=0;if("esriGeometryPoint"===t||"esriGeometryPolygon"===t)if("esriGeometryPoint"===t?(z=r.geometry,w=z.x,y=z.y):(w=r.centroid.x,y=r.centroid.y),A=l.checkOverlap(w,y))continue;C=r.localId;D=[];for(E=0;E<f.length;E++){F=f[E];G=F.index;H=F.builder;J=F.symbol;K=r;if(!e)return B.error("mapview-labeling",
"Tried to evaluate geometry expression but no transformation found"),[2,void 0];ta=e.transform;qa=e.hasZ;ma=e.hasM;oa=this.hydrate(r.geometry,ta,qa,ma);Ba=k({},r,{geometry:oa});oa.spatialReference=u.fromJSON(this.spatialReference);K=Ba;ua=H.evaluate(K);if(!m.isNone(ua)&&""!==ua){v.definitions.DEBUG_LABELS&&(Da="-"+C,ua=ua.substring(0,ua.length-Da.length)+Da);xa=v.bidiText(ua);Ca=xa[0];za=xa[1];var I=J;h=Ca;var L=c;L.has(I)||L.set(I,new Set);for(var I=L.get(I),L=h.length,M=0;M<L;M++){var N=h.charCodeAt(M);
I.add(N)}D.push({text:Ca,rtl:za,id:G})}}g.set(C,D)}return[2,g]}})})};g([n.property({readOnly:!0})],b.prototype,"supportsTileUpdates",null);g([n.property()],b.prototype,"config",void 0);g([n.property({dependsOn:["config"]})],b.prototype,"labelingInfo",null);g([n.property({dependsOn:["labelingInfo","service","spatialReference"]})],b.prototype,"labelClassInfos",null);g([n.property({dependsOn:["service"]})],b.prototype,"hydrate",null);g([n.property({dependsOn:["config"],readOnly:!0})],b.prototype,"renderer",
null);g([n.property({readOnly:!0})],b.prototype,"updating",null);return b=g([n.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],b)}(n.declared(D.default));a.default=c})},"esri/core/MapPool":function(){define(["require","exports","./ObjectPool"],function(c,a,l){c=function(){function a(a,c){void 0===a&&(a=50);void 0===c&&(c=50);this._pool=new l(Map,!1,function(a){return a.clear()},c,a)}a.prototype.acquire=function(){return this._pool.acquire()};a.prototype.release=function(a){this._pool.release(a)};
a.acquire=function(){return g.acquire()};a.release=function(a){return g.release(a)};return a}();var g=new c(100);return c})},"esri/layers/support/LabelClass":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../symbols ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./LabelExpressionInfo ./labelUtils ./types ../../symbols/support/defaults ../../symbols/support/jsonUtils".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n,u,y){function w(a){return a?"service"===a.origin?!1:!a.layer||!n.isOfType(a.layer,"map-image"):!0}function t(a){return a?(a=A.exec(a))&&(a[1]||a[3])||null:null}var v=new e.default({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",
esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",
esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0}),z=/^\s*\{([^}]+)\}\s*$/i,A=
/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]))\s*$/i;return function(a){function c(b){b=a.call(this,b)||this;b.name=null;b.labelExpression=null;b.labelExpressionInfo=null;b.labelPlacement=null;b.maxScale=0;b.minScale=0;b.symbol=u.defaultTextSymbol2D;b.useCodedValues=void 0;b.where=null;return b}g(c,a);e=c;c.evaluateWhere=function(a,b){var c=function(a,b,c){switch(b){case "\x3d":return a==c?!0:!1;case "\x3c\x3e":return a!=c?!0:!1;case "\x3e":return a>c?!0:!1;case "\x3e\x3d":return a>=
c?!0:!1;case "\x3c":return a<c?!0:!1;case "\x3c\x3d":return a<=c?!0:!1}return!1};try{if(null==a)return!0;var d=a.split(" ");if(3===d.length)return c(b[d[0]],d[1],d[2]);if(7===d.length){var e=c(b[d[0]],d[1],d[2]),f=d[3],g=c(b[d[4]],d[5],d[6]);switch(f){case "AND":return e&&g;case "OR":return e||g}}return!1}catch(L){console.log("Error.: can't parse \x3d "+a)}};c.prototype.readLabelExpression=function(a,b){b=b.labelExpressionInfo;if(!b||!b.value&&!b.expression)return a};c.prototype.writeLabelExpression=
function(a,b,c,d){this.labelExpressionInfo&&w(d)&&(null!=this.labelExpressionInfo.value?a=this.labelExpressionInfo.value.replace(/\{/g,"[").replace(/\}/g,"]"):null!=this.labelExpressionInfo.expression&&(d=t(this.labelExpressionInfo.expression))&&(a="["+d+"]"));null!=a&&(b[c]=a)};c.prototype.writeLabelExpressionInfo=function(a,b,c,d){if(null==a&&null!=this.labelExpression&&w(d))a=new m({expression:this.getLabelExpressionArcade()});else if(!a)return;a=a.toJSON(d);a.expression&&(b[c]=a)};c.prototype.writeMaxScale=
function(a,b){if(a||this.minScale)b.maxScale=a};c.prototype.writeMinScale=function(a,b){if(a||this.maxScale)b.minScale=a};c.prototype.getLabelExpression=function(){var a={expression:"",type:"none"};this.labelExpressionInfo?this.labelExpressionInfo.value?(a.expression=this.labelExpressionInfo.value,a.type="conventional"):this.labelExpressionInfo.expression&&(a.expression=this.labelExpressionInfo.expression,a.type="arcade"):null!=this.labelExpression&&(a.expression=this.labelExpression.replace(/\[/g,
"{").replace(/\]/g,"}"),a.type="conventional");return a};c.prototype.getLabelExpressionArcade=function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return r.convertTemplatedStringToArcade(a.expression);case "arcade":return a.expression}return null};c.prototype.getLabelExpressionSingleField=function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return(a=a.expression.match(z))&&a[1].trim()||null;case "arcade":return t(a.expression)}return null};
c.prototype.clone=function(){return new e({labelExpression:this.labelExpression,labelExpressionInfo:b.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:b.clone(this.symbol),where:this.where,useCodedValues:this.useCodedValues})};var e;l([d.property({type:String,json:{write:!0}})],c.prototype,"name",void 0);l([d.property({type:String,json:{write:{allowNull:!0}}})],c.prototype,"labelExpression",void 0);l([d.reader("labelExpression")],
c.prototype,"readLabelExpression",null);l([d.writer("labelExpression")],c.prototype,"writeLabelExpression",null);l([d.property({type:m,json:{write:{overridePolicy:function(a,b,c){return w(c)?{allowNull:!0}:{enabled:!1}}}}})],c.prototype,"labelExpressionInfo",void 0);l([d.writer("labelExpressionInfo")],c.prototype,"writeLabelExpressionInfo",null);l([d.property({type:v.apiValues,json:{type:v.jsonValues,read:v.read,write:v.write}})],c.prototype,"labelPlacement",void 0);l([d.property({type:Number})],
c.prototype,"maxScale",void 0);l([d.writer("maxScale")],c.prototype,"writeMaxScale",null);l([d.property({type:Number})],c.prototype,"minScale",void 0);l([d.writer("minScale")],c.prototype,"writeMinScale",null);l([d.property({types:f.symbolTypesLabel,json:{origins:{"web-scene":{types:f.symbolTypesLabel3D,read:y.read,write:y.writeTarget,default:null}},read:y.read,write:y.writeTarget,default:null}})],c.prototype,"symbol",void 0);l([d.property({type:Boolean,json:{write:!0}})],c.prototype,"useCodedValues",
void 0);l([d.property({type:String,json:{write:!0}})],c.prototype,"where",void 0);return c=e=l([d.subclass("esri.layers.support.LabelClass")],c)}(d.declared(p.JSONSupport))})},"esri/layers/support/LabelExpressionInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ./labelUtils".split(" "),function(c,a,l,g,k,h,f){return function(a){function c(){var b=null!==a&&a.apply(this,
arguments)||this;b.value=null;b.expression=null;return b}l(c,a);b=c;c.prototype.readExpression=function(a,b){return b.value?f.convertTemplatedStringToArcade(b.value):a};c.prototype.writeExpression=function(a,b,c){null!=this.value&&(a=f.convertTemplatedStringToArcade(this.value));b[c]=a};c.prototype.clone=function(){return new b({value:this.value,expression:this.expression})};var b;g([h.property({json:{read:!1,write:!1}})],c.prototype,"value",void 0);g([h.property({type:String,json:{write:{allowNull:!0}}})],
c.prototype,"expression",void 0);g([h.reader("expression",["expression","value"])],c.prototype,"readExpression",null);g([h.writer("expression")],c.prototype,"writeExpression",null);return c=b=g([h.subclass("esri.layers.support.LabelExpressionInfo")],c)}(h.declared(k.JSONSupport))})},"esri/layers/support/labelUtils":function(){define(["require","exports","../../core/string"],function(c,a,l){Object.defineProperty(a,"__esModule",{value:!0});var g=/__begin__/ig,k=/__end__/ig,h=/^__begin__/i,f=/__end__$/i;
a.convertTemplatedStringToArcade=function(a){a?(a=l.replace(a,function(a){return'__begin__$feature["'+a+'"]__end__'}),a=h.test(a)?a.replace(h,""):'"'+a,a=f.test(a)?a.replace(f,""):a+'"',a=a.replace(g,'" + ').replace(k,' + "')):a='""';return a}})},"esri/layers/support/types":function(){define(["require","exports"],function(c,a){Object.defineProperty(a,"__esModule",{value:!0});a.isOfType=function(a,c){a=a.constructor._meta;if(!a||!a.bases)return!1;a=a.bases;var g=Array.isArray(c);return a.some(function(a){a=
a.__accessorMetadata__;if(!a)return!1;a=a.properties;if(!a||!a.type||!a.type.value)return!1;a=a.type.value;return g?-1!==c.indexOf(a):a===c})}})},"esri/layers/support/labelFormatUtils":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/Error ../../core/Logger ../../core/promiseUtils ../../intl/date ../../intl/number ./FieldsIndex ./fieldUtils ../../support/arcadeOnDemand".split(" "),
function(c,a,l,g,k,h,f,e,p,b,d,m,r,n){function u(){return h(this,void 0,void 0,function(){return k(this,function(a){return[2,p.create(function(a){c(["../../core/sql/WhereClause"],a)})]})})}function y(a,c,e,f){a=r.getField(f,a);if(!a)return c;if(null==e[a.name])return"";if(c=a.domain)if("codedValue"===c.type||"coded-value"===c.type){f=e[a.name];var g=0;for(c=c.codedValues;g<c.length;g++){var h=c[g];if(h.code===f)return h.name}}else if("range"===c.type&&(f=+e[a.name],g="range"in c?c.range[1]:c.maxValue,
("range"in c?c.range[0]:c.minValue)<=f&&f<=g))return c.name;e=e[a.name];"date"===a.type||"esriFieldTypeDate"===a.type?e=b.formatDate(e,b.convertDateFormatToIntlOptions("short-date")):r.isNumericField(a)&&(e=d.formatNumber(+e));return e?e:""}Object.defineProperty(a,"__esModule",{value:!0});var w=e.getLogger("esri.layers.support.labelFormatUtils"),t={type:"simple",evaluate:function(){return null}};a.createLabelFunction=function(a,b,c){return h(this,void 0,void 0,function(){var d,e,g,h,l,p,r,v;return k(this,
function(k){switch(k.label){case 0:if(!a||!a.symbol)return[2,t];d=a.where;e=a.getLabelExpression();return d?[4,u()]:[3,2];case 1:return h=k.sent(),[3,3];case 2:h=null,k.label=3;case 3:return g=h,"arcade"!==e.type?[3,5]:[4,n.createLabelExpression(e.expression,c,b)];case 4:return p=k.sent(),l={type:"arcade",evaluate:function(a){try{var b=p.evaluate({$feature:p.repurposeFeature(a)});if(null!=b)return b.toString()}catch(R){w.error(new f("bad-arcade-expression","Encountered an error when evaluating label expression for feature",
{feature:a,expression:e}))}return null}},[3,6];case 5:l={type:"simple",evaluate:function(a){var c=a&&a.attributes;return c?e.expression.replace(/{[^}]*}/g,function(a){return y(a.slice(1,-1),a,c,b)}):null}},k.label=6;case 6:if(d){try{r=g.WhereClause.create(d,new m(b))}catch(I){return[2,t]}v=l.evaluate;l.evaluate=function(a){return r.testFeature(a)?v(a):null}}return[2,l]}})})};a.formatField=y})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators".split(" "),
function(c,a,l,g,k,h,f,e){Object.defineProperty(a,"__esModule",{value:!0});c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.initialize=function(){};b.prototype.destroy=function(){};Object.defineProperty(b.prototype,"supportsTileUpdates",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"spatialReference",{get:function(){var a=this.get("tileStore.tileScheme.spatialReference");return a&&a.toJSON()||null},enumerable:!0,
configurable:!0});g([e.property({readOnly:!0})],b.prototype,"supportsTileUpdates",null);g([e.property({constructOnly:!0})],b.prototype,"remoteClient",void 0);g([e.property({constructOnly:!0})],b.prototype,"service",void 0);g([e.property({dependsOn:["tileStore.tileScheme.spatialReference"]})],b.prototype,"spatialReference",null);g([e.property({constructOnly:!0})],b.prototype,"tileInfo",void 0);g([e.property({constructOnly:!0})],b.prototype,"tileStore",void 0);return b=g([e.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],
b)}(e.declared(f.HandleOwner));a.default=c})},"*noref":1}});
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/Accessor ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../../../layers/support/TileInfo ../../ViewState ./controllers ./processors ./support/TileStore ../../tiling/TileInfoView".split(" "),function(c,
a,l,g,k,h,f,e,p,b,d,m,r,n,u,y,w,t,v){Object.defineProperty(a,"__esModule",{value:!0});var z=d.getLogger("esri.views.2d.layers.features.Pipeline"),A=new Set;a.getInstances=function(){return A};c=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.controller=null;b.processor=null;b.remoteClient=null;b.tileStore=null;b.service=null;b.viewState=null;return b}l(c,a);c.prototype.initialize=function(){var a=this;this.watch("updating",function(b){a.remoteClient.invoke("setUpdating",b)});
b("esri-performance-tests")&&!b("esri-workers")&&A.add(this)};c.prototype.destroy=function(){b("esri-performance-tests")&&!b("esri-workers")&&A.delete(this);this.controller&&this.controller.destroy();this.processor&&this.processor.destroy()};Object.defineProperty(c.prototype,"updating",{get:function(){var a=this.controller,b=this.processor;return!a||!b||a.updating||b.updating||!1},enumerable:!0,configurable:!0});c.prototype.startup=function(a){var b=a.service,c=a.config,d=a.tileInfo,e=a.options;return k(this,
void 0,void 0,function(){var a;return h(this,function(f){this.service=b;this.tileStore||(a=new v(n.fromJSON(d)),this.tileStore=new t.default(a));return[2,this._configure(c,e)]})})};c.prototype.update=function(a){var b=a.config,c=a.options;return k(this,void 0,void 0,function(){return h(this,function(a){switch(a.label){case 0:return this.processor&&this.controller?c.layerFilterChanged||c.invalidateFeatureData||c.invalidateMesh?[4,this.controller.update(b,c.layerFilterChanged)]:[3,2]:(z.error(new p("mapview-pipeline",
"Tried to update an unconfigured pipeline.")),[2]);case 1:a.sent(),a.label=2;case 2:return c.invalidateMesh?[4,this.processor.update(b)]:[3,4];case 3:a.sent(),this.controller.invalidate(),a.label=4;case 4:return[4,this.remoteClient.invoke("setUpdating",this.updating)];case 5:return a.sent(),[2]}})})};c.prototype.setViewState=function(a){a=u.fromJSON(a);this._set("viewState",a);this.tileStore&&this.tileStore.setViewState(a);this.controller&&this.controller.setViewState(a)};c.prototype._configure=function(a,
b){return k(this,void 0,void 0,function(){return h(this,function(c){switch(c.label){case 0:return[4,m.all([this._handleControllerConfig(a),this._handleProcessorConfig(a)])];case 1:return c.sent(),this.controller.processor=this.processor,this.viewState&&this.controller.setViewState(this.viewState),[4,this.update({config:a,options:b})];case 2:return c.sent(),[2]}})})};c.prototype._handleControllerConfig=function(a){return k(this,void 0,void 0,function(){var b;return h(this,function(c){switch(c.label){case 0:return[4,
this._createController(this.service,a)];case 1:return b=c.sent(),[4,b.startup()];case 2:return c.sent(),[2,b]}})})};c.prototype._handleProcessorConfig=function(a){return k(this,void 0,void 0,function(){return h(this,function(b){return[2,this._createProcessor(this.service,a)]})})};c.prototype._createController=function(a,b){return k(this,void 0,void 0,function(){var c,d,e,f,g;return h(this,function(h){switch(h.label){case 0:return this.controller?[2,this.controller]:[4,y.loadControllerModule(a.type)];
case 1:return c=h.sent().default,d=this,e=d.tileStore,f=d.remoteClient,this.controller=g=new c({service:a,config:b,tileStore:e,remoteClient:f}),[2,g]}})})};c.prototype._createProcessor=function(a,b){return k(this,void 0,void 0,function(){var c,d,e,f,g;return h(this,function(h){switch(h.label){case 0:return[4,w.loadProcessorModule(b.renderer.type)];case 1:return c=h.sent().default,d=this,e=d.remoteClient,f=d.tileStore,g=new c({service:a,config:b,tileStore:f,remoteClient:e}),this.processor&&this.processor.destroy(),
this.processor=g,[2,g]}})})};g([r.property()],c.prototype,"controller",void 0);g([r.property()],c.prototype,"processor",void 0);g([r.property({dependsOn:["controller.updating","processor.updating"]})],c.prototype,"updating",null);g([r.property()],c.prototype,"viewState",void 0);return c=g([r.subclass("esri.views.2d.layers.features.Pipeline")],c)}(r.declared(e));a.default=c});