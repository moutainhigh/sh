// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../core/compilerUtils","./Util"],function(f,m,g,h){var k=function(){function a(b){this.refCnt=0;this.glMaterial=b}a.prototype.incRefCnt=function(){++this.refCnt};a.prototype.decRefCnt=function(){--this.refCnt;h.assert(0<=this.refCnt)};a.prototype.getRefCnt=function(){return this.refCnt};a.prototype.getGLMaterial=function(){return this.glMaterial};return a}();f=function(){function a(b,d,c){this._textureRep=b;this._programRep=d;this._techniqueRep=c;this._id2glMaterialRef=
new Map}a.prototype.acquire=function(b,d){var c=b.id+"_"+d,a=this._id2glMaterialRef.get(c);null==a?(b=(a=b.getGLMaterials()[d])?new a({material:b,programRep:this._programRep,techniqueRep:this._techniqueRep,textureRep:this._textureRep}):void 0,a=new k(b),this._id2glMaterialRef.set(c,a)):b=a.getGLMaterial();a.incRefCnt();b&&this.increaseProgramReferences(b);return b};a.prototype.release=function(b,a){b=b+"_"+a;a=this._id2glMaterialRef.get(b);a.decRefCnt();if(0===a.getRefCnt()){if(a=a.getGLMaterial())this.decreaseProgramReferences(a),
a.dispose();this._id2glMaterialRef.delete(b)}};a.prototype.updateMaterialParameters=function(b){for(var a=0,c=l;a<c.length;a++){var e=this._id2glMaterialRef.get(b+"_"+c[a]);e&&e.getGLMaterial()&&this.updateParamsForMat(e.getGLMaterial())}};a.prototype.updateParamsForMat=function(b){b.updateParameters&&(this.decreaseProgramReferences(b),b.updateParameters(),this.increaseProgramReferences(b))};a.prototype.increaseProgramReferences=function(b){if(b=b.getPrograms())for(var a=this._programRep,c=0;c<b.length;c++)a.increaseRefCount(b[c])};
a.prototype.decreaseProgramReferences=function(a){if(a=a.getPrograms())for(var b=this._programRep,c=0;c<a.length;c++)b.decreaseRefCount(a[c])};return a}();var l=g.tuple("color","depth","depthShadowMap","normal","highlight");return f});