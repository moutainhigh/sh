// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../core/maybe","../../../webgl"],function(h,g,e,m){Object.defineProperty(g,"__esModule",{value:!0});h=function(){function a(){this.cache=new Map}a.prototype.dispose=function(){this.cache.forEach(function(b){e.isSome(b.texture)&&(b.texture.dispose(),b.texture=null)});this.cache.clear()};a.prototype.acquire=function(b){if(e.isNone(b))return null;var f=this.patternId(b),a=this.cache.get(f);if(a)return a.refCount++,a.bind;var c=this.patternToTextureData(b,2),k=c.length/
2,d={refCount:1,texture:null,bind:function(b,a){e.isNone(d.texture)&&(d.texture=new m.Texture(b,{width:c.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},c));b.bindTexture(d.texture,a);return k}};this.cache.set(f,d);return d.bind};a.prototype.release=function(b){if(!e.isNone(b)){b=this.patternId(b);var a=this.cache.get(b);a&&(a.refCount--,0===a.refCount&&(e.isSome(a.texture)&&a.texture.dispose(),this.cache.delete(b)))}};a.prototype.swap=function(b,a){a=this.acquire(a);
this.release(b);return a};a.prototype.bind=function(a,f,l,c,k){a=e.isSome(c)?c(a,k)*f.pixelRatio:1;l.setUniform1i("stipplePatternTexture",k);l.setUniform1f("stipplePatternPixelSizeInv",1/a)};a.prototype.patternId=function(a){return a.join(",")};a.prototype.patternToTextureData=function(a,f){for(var b=a.reduce(function(a,b){return a+b})*f,b=new Uint8Array(b),c=!0,e=0,d=0;d<a.length;d++){for(var g=a[d],h=0;h<g*f;h++)b[e++]=c?255:0;c=!c}return b};return a}();g.StippleTextureRepository=h;g.createStipplePattern=
function(a){return a.slice()};g.createStipplePatternSimple=function(a){return[a,a]}});