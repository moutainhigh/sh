// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ./NativeLine.glsl ../../../webgl/Program ../../../webgl/renderState".split(" "),
function(m,h,k,c,g,l,n,p,q,r,t,b,u,v,w,e){Object.defineProperty(h,"__esModule",{value:!0});g=function(b){function a(d,a){a=b.call(this,d,a)||this;a.stipplePattern=null;a.stippleTextureBind=null;a.stippleTextureRepository=d.stippleTextureRepository;return a}k(a,b);a.prototype.initializeProgram=function(d){var b=a.shader.get(),f=this.configuration,b=b.build({output:f.output,attributeColor:f.vertexColors,slicePlaneEnabled:f.slicePlaneEnabled,sliceHighlightDisabled:f.sliceHighlightDisabled,stippleEnabled:f.stippleEnabled,
stippleOffColorEnabled:f.stippleOffColorEnabled,stippleUVMaxEnabled:!1,stippleIntegerRepeatsEnabled:f.stippleIntegerRepeatsEnabled});return new w(d.rctx,b.generateSource("vertex"),b.generateSource("fragment"),u.Default3D)};a.prototype.dispose=function(){b.prototype.dispose.call(this);this.stippleTextureRepository.release(this.stipplePattern);this.stippleTextureBind=this.stipplePattern=null};a.prototype.bindPass=function(d,a,b){if(this.stipplePattern!==a.stipplePattern){var c=a.stipplePattern;this.stippleTextureBind=
this.stippleTextureRepository.swap(this.stipplePattern,c);this.stipplePattern=c}this.configuration.stippleEnabled&&(c=l.isSome(this.stippleTextureBind)?this.stippleTextureBind(d,0)*b.pixelRatio:1,this.program.setUniform1i("stipplePatternTexture",0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/c),this.program.setUniform2f("ndcToPixel",b.viewport[2]/2,b.viewport[3]/2));0===this.configuration.output?(this.program.setUniform4fv("constantColor",a.color),this.program.setUniform1f("alphaCoverage",
Math.min(1,a.width*b.pixelRatio)),this.configuration.stippleOffColorEnabled&&(d=l.expect(a.stippleOffColor),this.program.setUniform4f("stippleOffColor",d[0],d[1],d[2],3<d.length?d[3]:1))):q.OutputHighlight.bindOutputHighlight(d,this.program,b)};a.prototype.bindDraw=function(a){p.Transform.bindUniforms(this.program,a);n.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};a.prototype.initializePipeline=function(){var a=this.configuration;return 0===a.output?e.makePipelineState({blending:a.transparent||
a.stippleEnabled?e.separateBlendingParams(770,1,771,771):null,depthTest:{func:513},depthWrite:e.defaultDepthWriteParams,colorWrite:e.defaultColorWriteParams}):e.makePipelineState({depthTest:{func:513},colorWrite:e.defaultColorWriteParams})};a.prototype.bindPipelineState=function(a){a.setPipelineState(this.pipeline)};a.shader=new r.ReloadableShaderModule(v,"./NativeLine.glsl",m);return a}(t.ShaderTechnique);h.NativeLineTechnique=g;g=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||
this;a.output=0;a.slicePlaneEnabled=!1;a.sliceHighlightDisabled=!1;a.vertexColors=!1;a.transparent=!1;a.stippleEnabled=!1;a.stippleOffColorEnabled=!1;a.stippleIntegerRepeatsEnabled=!1;return a}k(a,e);c([b.parameter({count:6})],a.prototype,"output",void 0);c([b.parameter()],a.prototype,"slicePlaneEnabled",void 0);c([b.parameter()],a.prototype,"sliceHighlightDisabled",void 0);c([b.parameter()],a.prototype,"vertexColors",void 0);c([b.parameter()],a.prototype,"transparent",void 0);c([b.parameter()],a.prototype,
"stippleEnabled",void 0);c([b.parameter()],a.prototype,"stippleOffColorEnabled",void 0);c([b.parameter()],a.prototype,"stippleIntegerRepeatsEnabled",void 0);return a}(b.ShaderTechniqueConfiguration);h.NativeLineTechniqueConfiguration=g});