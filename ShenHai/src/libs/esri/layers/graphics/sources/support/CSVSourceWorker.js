// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
require({cache:{"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(B,a,v,h,b){var d={};B.setObject("dojo.number",d);d.format=function(f,b){b=B.mixin({},b||{});var c=a.normalizeLocale(b.locale),c=a.getLocalization("dojo.cldr","number",c);b.customs=c;c=b.pattern||c[(b.type||"decimal")+"Format"];return isNaN(f)||Infinity==Math.abs(f)?null:d._applyPattern(f,c,b)};d._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;d._applyPattern=function(a,b,c){c=
c||{};var f=c.customs.group,l=c.customs.decimal;b=b.split(";");var q=b[0];b=b[0>a?1:0]||"-"+q;if(-1!=b.indexOf("%"))a*=100;else if(-1!=b.indexOf("\u2030"))a*=1E3;else if(-1!=b.indexOf("\u00a4"))f=c.customs.currencyGroup||f,l=c.customs.currencyDecimal||l,b=b.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,b,d,f){return(a=c[["symbol","currency","displayName"][d.length-1]]||c.currency||"")?b+a+f:""});else if(-1!=b.indexOf("E"))throw Error("exponential notation not supported");var n=d._numberPatternRE,
q=q.match(n);if(!q)throw Error("unable to find a number expression in pattern: "+b);!1===c.fractional&&(c.places=0);return b.replace(n,d._formatAbsolute(a,q[0],{decimal:l,group:f,places:c.places,round:c.round}))};d.round=function(a,b,d){d=10/(d||10);return(d*+a).toFixed(b)/d};if(0==(.9).toFixed()){var c=d.round;d.round=function(a,b,d){var f=Math.pow(10,-b||0),l=Math.abs(a);if(!a||l>=f)f=0;else if(l/=f,.5>l||.95<=l)f=0;return c(a,b,d)+(0<a?f:-f)}}d._formatAbsolute=function(a,b,c){c=c||{};!0===c.places&&
(c.places=0);Infinity===c.places&&(c.places=6);b=b.split(".");var f="string"==typeof c.places&&c.places.indexOf(","),l=c.places;f?l=c.places.substring(f+1):0<=l||(l=(b[1]||[]).length);0>c.round||(a=d.round(a,l,c.round));a=String(Math.abs(a)).split(".");var q=a[1]||"";b[1]||c.places?(f&&(c.places=c.places.substring(0,f)),f=void 0!==c.places?c.places:b[1]&&b[1].lastIndexOf("0")+1,f>q.length&&(a[1]=h.pad(q,f,"0",!0)),l<q.length&&(a[1]=q.substr(0,l))):a[1]&&a.pop();l=b[0].replace(",","");f=l.indexOf("0");
-1!=f&&(f=l.length-f,f>a[0].length&&(a[0]=h.pad(a[0],f)),-1==l.indexOf("#")&&(a[0]=a[0].substr(a[0].length-f)));var l=b[0].lastIndexOf(","),n,w;-1!=l&&(n=b[0].length-l-1,b=b[0].substr(0,l),l=b.lastIndexOf(","),-1!=l&&(w=b.length-l-1));b=[];for(l=a[0];l;)f=l.length-n,b.push(0<f?l.substr(f):l),l=0<f?l.slice(0,f):"",w&&(n=w,w=void 0);a[0]=b.reverse().join(c.group||",");return a.join(c.decimal||".")};d.regexp=function(a){return d._parseInfo(a).regexp};d._parseInfo=function(f){f=f||{};var c=a.normalizeLocale(f.locale),
c=a.getLocalization("dojo.cldr","number",c),h=f.pattern||c[(f.type||"decimal")+"Format"],y=c.group,p=c.decimal,D=1;if(-1!=h.indexOf("%"))D/=100;else if(-1!=h.indexOf("\u2030"))D/=1E3;else{var n=-1!=h.indexOf("\u00a4");n&&(y=c.currencyGroup||y,p=c.currencyDecimal||p)}c=h.split(";");1==c.length&&c.push("-"+c[0]);c=b.buildGroupRE(c,function(a){a="(?:"+b.escapeString(a,".")+")";return a.replace(d._numberPatternRE,function(a){var b={signed:!1,separator:f.strict?y:[y,""],fractional:f.fractional,decimal:p,
exponent:!1};a=a.split(".");var c=f.places;1==a.length&&1!=D&&(a[1]="###");1==a.length||0===c?b.fractional=!1:(void 0===c&&(c=f.pattern?a[1].lastIndexOf("0")+1:Infinity),c&&void 0==f.fractional&&(b.fractional=!0),!f.places&&c<a[1].length&&(c+=","+a[1].length),b.places=c);a=a[0].split(",");1<a.length&&(b.groupSize=a.pop().length,1<a.length&&(b.groupSize2=a.pop().length));return"("+d._realNumberRegexp(b)+")"})},!0);n&&(c=c.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(a,d,c,k){a=b.escapeString(f[["symbol",
"currency","displayName"][c.length-1]]||f.currency||"");if(!a)return"";d=d?"[\\s\\xa0]":"";k=k?"[\\s\\xa0]":"";return f.strict?d+a+k:(d&&(d+="*"),k&&(k+="*"),"(?:"+d+a+k+")?")}));return{regexp:c.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:y,decimal:p,factor:D}};d.parse=function(a,b){b=d._parseInfo(b);a=(new RegExp("^"+b.regexp+"$")).exec(a);if(!a)return NaN;var f=a[1];if(!a[1]){if(!a[2])return NaN;f=a[2];b.factor*=-1}f=f.replace(new RegExp("["+b.group+"\\s\\xa0]","g"),"").replace(b.decimal,".");return f*
b.factor};d._realNumberRegexp=function(a){a=a||{};"places"in a||(a.places=Infinity);"string"!=typeof a.decimal&&(a.decimal=".");"fractional"in a&&!/^0/.test(a.places)||(a.fractional=[!0,!1]);"exponent"in a||(a.exponent=[!0,!1]);"eSigned"in a||(a.eSigned=[!0,!1]);var c=d._integerRegexp(a),f=b.buildGroupRE(a.fractional,function(b){var d="";b&&0!==a.places&&(d="\\"+a.decimal,d=Infinity==a.places?"(?:"+d+"\\d+)?":d+("\\d{"+a.places+"}"));return d},!0),h=b.buildGroupRE(a.exponent,function(b){return b?
"([eE]"+d._integerRegexp({signed:a.eSigned})+")":""}),c=c+f;f&&(c="(?:(?:"+c+")|(?:"+f+"))");return c+h};d._integerRegexp=function(a){a=a||{};"signed"in a||(a.signed=[!0,!1]);"separator"in a?"groupSize"in a||(a.groupSize=3):a.separator="";var d=b.buildGroupRE(a.signed,function(a){return a?"[-+]":""},!0),c=b.buildGroupRE(a.separator,function(d){if(!d)return"(?:\\d+)";d=b.escapeString(d);" "==d?d="\\s":"\u00a0"==d&&(d="\\s\\xa0");var c=a.groupSize,f=a.groupSize2;return f?(d="(?:0|[1-9]\\d{0,"+(f-1)+
"}(?:["+d+"]\\d{"+f+"})*["+d+"]\\d{"+c+"})",0<c-f?"(?:"+d+"|(?:0|[1-9]\\d{0,"+(c-1)+"}))":d):"(?:0|[1-9]\\d{0,"+(c-1)+"}(?:["+d+"]\\d{"+c+"})*)"},!0);return d+c};return d})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(B,a){var v=/[&<>'"\/]/g,h={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},b={};a.setObject("dojo.string",b);b.escape=function(a){return a?a.replace(v,function(a){return h[a]}):""};b.rep=function(a,b){if(0>=
b||!a)return"";for(var d=[];;){b&1&&d.push(a);if(!(b>>=1))break;a+=a}return d.join("")};b.pad=function(a,c,f,l){f||(f="0");a=String(a);c=b.rep(f,Math.ceil((c-a.length)/f.length));return l?a+c:c+a};b.substitute=function(b,c,f,l){l=l||B.global;f=f?a.hitch(l,f):function(a){return a};return b.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(b,d,h){if(""==d)return"$";b=a.getObject(d,!1,c);h&&(b=a.getObject(h,!1,l).call(l,b,d));h=f(b,d);if("undefined"===typeof h)throw Error('string.substitute could not find key "'+
d+'" in template');return h.toString()})};b.trim=String.prototype.trim?a.trim:function(a){a=a.replace(/^\s+/,"");for(var b=a.length-1;0<=b;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a};return b})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(B,a){var v={};a.setObject("dojo.regexp",v);v.escapeString=function(a,b){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return b&&-1!=b.indexOf(a)?a:"\\"+a})};v.buildGroupRE=function(a,b,d){if(!(a instanceof
Array))return b(a);for(var c=[],f=0;f<a.length;f++)c.push(b(a[f]));return v.group(c.join("|"),d)};v.group=function(a,b){return"("+(b?"?:":"")+a+")"};return v})},"dstore/Csv":function(){define(["dojo/_base/lang","dojo/_base/declare"],function(B,a){function v(a,b){var d={},c=a.length,f;for(f=0;f<c;f++)d[a[f]]=b[f];return d}var h=/^\s*"([\S\s]*)"\s*$/,b=/""/g,d=/"/g;return a(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(a){var d=[];a=a.split(this.newline);var c=this.fieldNames,
q=0,y=[],p="",D="",n,w,E,I,k,t,z;k=0;E=a.length;a:for(;k<E;k++)if(B.trim(a[k])){n=a[k].split(this.delimiter);t=0;for(I=n.length;t<I;t++){w=n[t];z=-1;p+=D+w;for(D="";0<=(z=w.indexOf('"',z+1));)q++;if(0===q%2){if(0<q)if(q=h.exec(p))y.push(q[1].replace(b,'"'));else{console.warn("Csv: discarding row with invalid value: "+p);y=[];p="";q=0;continue a}else y.push(this.trim||!c?B.trim(p):p);p="";q=0}else D=this.delimiter}0===q?(c?d.push(v(c,y)):c=this.fieldNames=y,y=[]):D=this.newline}return d},toCsv:function(a){return this.stringify(this.data,
a)},stringify:function(a,b){b=b||{};var c=b.alwaysQuote,f=this.fieldNames,h=this.delimiter,p=this.newline,D="",n,w,E,I;for(n=-1;n<a.length;n++)for(-1<n&&(D+=p),w=0;w<f.length;w++){E=0>n?f[w]:a[n][f[w]];if(null===E||void 0===E)E="";"string"!==typeof E&&(E=E.toString());I=c||0<=E.indexOf('"')||0<=E.indexOf(h);D+=(0<w?h:"")+(I?'"'+E.replace(d,'""')+'"':E)}b.trailingNewline&&(D+=p);return D}})})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),
function(B,a,v,h,b,d){function c(a,c,n,h,q){void 0===h&&(h=null);void 0===q&&(q=!1);if(null===h){var I=d.cacheKey(c,n);void 0!==y[I]?h=y[I]:(h=f(c,n,null),null===h&&(h=new d),y[I]=h)}return l._project(a,c,n instanceof b||!1===q?n:new b(n),h,q)}function f(a,b,c){void 0===c&&(c=null);a=l._getTransformation(a,b,c);return null!==a?d.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var l=null;a.isLoaded=function(){return!!l&&h.isLoaded()};a.isSupported=function(){return h.isSupported()};
var q=null;a.load=function(){return q?q:q=v.create(function(a,b){var d=h.load();B(["./geometryEngine"],function(c){l=c;d.then(function(){l._enableProjection(h);a()},function(a){b(a)})})})};a.project=function(a,b,d){void 0===d&&(d=null);return a instanceof Array?0===a.length?[]:c(a,a[0].spatialReference,b,d):c([a],a.spatialReference,b,d)[0]};var y={};a.projectMany=c;a.getTransformation=f;a.getTransformations=function(a,b,c){void 0===c&&(c=null);a=l._getTransformationBySuitability(a,b,c);if(null!==
a){b=[];for(c=0;c<a.length;c++)b.push(d.fromGE(a[c]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(B,a,v,h,b){function d(b){function d(a,b,d){a[b]=d(a[b])}a._pe=b;p.init();D.init();n.init();w.init();E.init();a.PeGCSExtent=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}v(d,b);d.prototype.destroy=function(){a._pe.destroy(this)};return d}(a._pe.PeGCSExtent);for(var c=
0,f=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];c<f.length;c++)b=f[c],d(b.prototype,"getName",function(a){return function(){return a.call(this,Array(p.PE_NAME_MAX))}});c=0;for(f=[a._pe.PeGeogtran,a._pe.PeProjcs];c<f.length;c++)b=f[c],d(b.prototype,"getParameters",function(b){return function(){for(var d=Array(p.PE_PARM_MAX),c=b.call(this),f=0;f<d.length;f++){var k=a._pe.getValue(c,"*");d[f]=k?a._pe.wrapPointer(k,
a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return d}});d(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var d=[],c=a.call(this);q(d,b,c);return d}});d(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var d=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var c=null,f=b.call(this);if(!a._pe.compare(f,a._pe.NULL)){var c=[f],k=this.getSteps();if(1<k)for(var f=a._pe.getPointer(f),z=1;z<k;z++)c.push(a._pe.wrapPointer(f+
d*z,a._pe.PeGTlistExtendedGTs))}return c}});var F=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var d=this._cache;d||(this._cache=d=new Map);if(d.has(b))return d.get(b);var c=null,f=b.call(this);if(!a._pe.compare(f,a._pe.NULL)){var c=[f],k=f.getNump();if(1<k)for(var f=a._pe.getPointer(f),z=1;z<k;z++)c.push(a._pe.wrapPointer(f+F*z,a._pe.PeHorizon))}d.set(b,c);return c}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=
function(b){void 0===b&&(b=p.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var d=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(p.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(d,b,c))}}function c(b){if(b){var d=a._pe.getClass(b);d&&(d=a._pe.getCache(d))&&(b=a._pe.getPointer(b))&&delete d[b]}}function f(b,d){var c=[];d=Array(d);for(var f=0;f<b;f++)c.push(a._pe.ensureInt8(d));return c}function l(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):
b=a;return b}function q(b,d,c,f){void 0===f&&(f=!1);if(f)for(f=0;f<2*d;f++)b[f]=a._pe.getValue(c+f*Float64Array.BYTES_PER_ELEMENT,"double");else{var k=0===b.length;for(f=0;f<d;f++)k&&(b[f]=Array(2)),b[f][0]=a._pe.getValue(c,"double"),b[f][1]=a._pe.getValue(c+Float64Array.BYTES_PER_ELEMENT,"double"),c+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var y;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!h("esri-wasm")};a.load=function(){return y?
y:y=b.create(function(a,b){B(["./support/pe-wasm"],function(c){c({locateFile:function(a){return B.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){d(b);a()})})})};(function(b){function d(b,d,c){a._pe.ensureCache.prepare();var f=l(c),k=c===f,f=a._pe.ensureFloat64(f);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),d,f))&&q(c,d,f,k);return b}function c(a,b,d){return f(a,b,d,0)}function f(b,d,c,f){a._pe.ensureCache.prepare();var k=l(c),z=c===k,k=a._pe.ensureFloat64(k);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),
d,k,f))&&q(c,d,k,z);return b}b.geogToProj=d;b.projGeog=function(a,b,f,k){switch(k){case p.PE_TRANSFORM_P_TO_G:return c(a,b,f);case p.PE_TRANSFORM_G_TO_P:return d(a,b,f)}return 0};b.projToGeog=c;b.projToGeogCenter=f})(a.PeCSTransformations||(a.PeCSTransformations={}));var p;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(p=a.PeDefs||(a.PeDefs={}));(function(b){function d(b,d){var k=null,z=f[b];z||(z={},f[b]=z);z.hasOwnProperty(String(d))?k=z[d]:(b=a._pe.PeFactory.prototype.factoryByType(b,
d),a._pe.compare(b,a._pe.NULL)||(k=b,z[d]=k));return k=c(k)}function c(b){if(b){var d=b.getType();switch(d){case p.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case p.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case p.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:d&p.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var f={},F={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return d(p.PE_TYPE_COORDSYS,
a)};b.factoryByType=d;b.fromString=function(b,d){var f=null,k=F[b];k||(k={},F[b]=k);k.hasOwnProperty(d)?f=k[d]:(b=a._pe.PeFactory.prototype.fromString(b,d),a._pe.compare(b,a._pe.NULL)||(f=b,k[d]=f));return f=c(f)};b.geogcs=function(a){return d(p.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return d(p.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return d(p.PE_TYPE_PROJCS,a)};b.unit=function(a){return d(p.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var D;(function(b){var d;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;d=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,c,f,k,l,h){var z=null,F=new a._pe.PeInteger(h);try{var t=a._pe.PeGTlistExtended.prototype.getGTlist(b,c,f,k,l,F);if(h=F.val)if(z=[t],1<h){var n=a._pe.getPointer(t);for(b=1;b<h;b++)z.push(a._pe.wrapPointer(n+d*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(F)}return z}})(D=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var d=0;d<b.length;d++){var f=b[d];c(f);f.getEntries().forEach(function(a){c(a);a=a.getGeogtran();c(a);a.getParameters().forEach(c);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){c(a);var b=a.getDatum();c(b);c(b.getSpheroid());c(a.getPrimem());c(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,d,c,f,
h){a._pe.ensureCache.prepare();var k=l(c),z=c===k,k=a._pe.ensureFloat64(k),t=0;f&&(t=a._pe.ensureFloat64(f));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),d,k,t,h))&&q(c,d,k,z);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function d(b,d,c,k,t,h){a._pe.ensureCache.prepare();var z,F;switch(b){case "dd":z=a._pe._pe_geog_to_dd;F=p.PE_DD_MAX;break;case "ddm":z=a._pe._pe_geog_to_ddm;F=p.PE_DDM_MAX;break;case "dms":z=a._pe._pe_geog_to_dms,F=p.PE_DMS_MAX}b=0;d&&(b=a._pe.getPointer(d));
d=l(k);d=a._pe.ensureFloat64(d);F=f(c,F);k=a._pe.ensureInt32(F);if(t=z(b,c,d,t,k))for(z=0;z<c;z++)h[z]=a._pe.UTF8ToString(F[z]);return t}function c(b,d,c,f,k){a._pe.ensureCache.prepare();var z;switch(b){case "dd":z=a._pe._pe_dd_to_geog;break;case "ddm":z=a._pe._pe_ddm_to_geog;break;case "dms":z=a._pe._pe_dms_to_geog}b=0;d&&(b=a._pe.getPointer(d));d=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(d);d=a._pe.ensureFloat64(Array(2*c));(z=z(b,c,f,d))&&q(k,c,d);return z}b.geog_to_dms=
function(a,b,c,f,k){return d("dms",a,b,c,f,k)};b.dms_to_geog=function(a,b,d,f){return c("dms",a,b,d,f)};b.geog_to_ddm=function(a,b,c,f,k){return d("ddm",a,b,c,f,k)};b.ddm_to_geog=function(a,b,d,f){return c("ddm",a,b,d,f)};b.geog_to_dd=function(a,b,c,f,k){return d("dd",a,b,c,f,k)};b.dd_to_geog=function(a,b,d,f){return c("dd",a,b,d,f)}})(a.PeNotationDms||(a.PeNotationDms={}));var n;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,d,c,F,h,n,w){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=l(c);c=a._pe.ensureFloat64(b);b=f(d,p.PE_MGRS_MAX);var z=a._pe.ensureInt32(b);if(F=a._pe._pe_geog_to_mgrs_extended(k,
d,c,F,h,n,z))for(h=0;h<d;h++)w[h]=a._pe.UTF8ToString(b[h]);return F};b.mgrs_to_geog_extended=function(b,d,c,f,l){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(f=a._pe._pe_mgrs_to_geog_extended(k,d,c,f,b))&&q(l,d,b);return f}})(n=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,d,c,h,n,w,q){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));
b=l(c);c=a._pe.ensureFloat64(b);b=f(d,p.PE_MGRS_MAX);var z=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_usng(k,d,c,h,n,w,z))for(n=0;n<d;n++)q[n]=a._pe.UTF8ToString(b[n]);return h};b.usng_to_geog=function(b,d,c,f){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(k=a._pe._pe_usng_to_geog(k,d,c,b))&&q(f,d,b);return k}})(a.PeNotationUsng||(a.PeNotationUsng={}));var w;(function(b){b.init=
function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,d,c,h,n){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=l(c);c=a._pe.ensureFloat64(b);b=f(d,p.PE_UTM_MAX);var z=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_utm(k,d,c,h,z))for(k=0;k<d;k++)n[k]=a._pe.UTF8ToString(b[k]);return h};b.utm_to_geog=
function(b,d,c,f,l){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(f=a._pe._pe_utm_to_geog(k,d,c,f,b))&&q(l,d,b);return f}})(w=a.PeNotationUtm||(a.PeNotationUtm={}));var E;(function(b){var d=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(c,f){void 0===f&&(f=b.PE_PCSINFO_OPTION_DOMAIN);var k,l;d.has(c)&&(l=d.get(c),l[f]&&(k=l[f]));k||(k=a._pe.PePCSInfo.prototype.generate(c,f),l||(l=[],d.set(c,l)),l[f]=k);return k}})(E=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=d})},"esri/geometry/support/GeographicTransformation":function(){define(["require",
"exports","./GeographicTransformationStep"],function(B,a,v){return function(){function a(b){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(b&&b.steps){var a=0;for(b=b.steps;a<b.length;a++){var c=b[a];c instanceof v?this.steps.push(c):this.steps.push(new v({wkid:c.wkid,wkt:c.wkt,isInverse:c.isInverse}))}}}a.cacheKey=function(b,a){return[void 0!==b.wkid&&null!==b.wkid?b.wkid.toString():"-1",void 0!==b.wkt&&null!==b.wkt?b.wkt.toString():"",void 0!==a.wkid&&null!==a.wkid?
a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():""].join()};a.fromGE=function(b){var d=new a,c="",f=0;for(b=b.steps;f<b.length;f++){var l=v.fromGE(b[f]);d.steps.push(l);c+=l.uid.toString()+","}d._cached_projection={};d._gtlistentry=null;d._chain=c;return d};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var d=this.steps.length-1;0<=d;d--)b.steps.push(this.steps[d].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",d=0,c=this.steps;d<c.length;d++)a+=
c[d].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,d,c){this._cached_projection[a.cacheKey(b,d)]=c};a.prototype.getCachedGeTransformation=function(b,d){for(var c="",f=0,l=this.steps;f<l.length;f++)c+=l[f].uid.toString()+",";c!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=c);b=this._cached_projection[a.cacheKey(b,d)];return void 0===b?null:b};return a}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(B,a){var v=0;return function(){function a(a){void 0===a&&(a=null);this.uid=v++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var d=new a;d._wkt=b.wkt;d._wkid=b.wkid;d._isInverse=b.isInverse;return d};Object.defineProperty(a.prototype,"wkt",
{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=v++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=v++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=v++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;
b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(B,a,v,h,b,d,c,f,l,q,y,p,D,n,w,E,I){Object.defineProperty(a,"__esModule",{value:!0});var k=l.getLogger("esri.layers.graphics.data.FeatureStore");B=function(){function a(a){this.geometryInfo=a;this._boundsStore=new w.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new f;this.featureAdapter=I.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var b=p.create(p.NEGATIVE_INFINITY);this._featuresById.forEach(function(d){if(d=
a._boundsStore.get(d.objectId))b[0]=Math.min(d[0],b[0]),b[1]=Math.min(d[1],b[1]),b[2]=Math.max(d[2],b[2]),b[3]=Math.max(d[3],b[3])});return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(b){b.geometry&&b.geometry.coords&&(a+=b.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var b=0;b<a.length;b++){var d=this._featuresById.get(a[b]);
d&&this._remove(d)}this._emitChanged()};a.prototype.forEachBounds=function(a,b,d){for(var c=0;c<a.length;c++){var f=this._boundsStore.get(a[c].objectId);f&&b(y.fromRect(d,f))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var d=this;this._boundsStore.forEachInBounds(a,function(a){b(d._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,b=!1;this._featuresById.forEach(function(d,c){a._markedIds.has(c)||(b=!0,a._remove(d))});this._markedIds.clear();b&&this._emitChanged()};a.prototype.executeTileQuery=function(a,b,d){return h(this,void 0,void 0,function(){var c,f,k,l,h,n,t,m,u,r,G,H,z,w;return v(this,function(J){c=d.returnGeometry;f=d.returnCentroid;k=d.returnOutline;l=d.pixelBuffer;h=
new Set;n=[];t=l*a.resolution;m=p.pad(a.bounds,t,p.create());E.createTileFeatures(n,h,this.geometryInfo,this,m,c,f,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||f)if(u=D.getInfo(b))r=u.valid,G=r[0],H=r[1],m[0]<G&&(z=p.fromValues(H-t,m[1],H,m[3]),E.createTileFeatures(n,h,this.geometryInfo,this,z,c,f,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[H,a.bounds[3]]})),m[2]>H&&
(w=p.fromValues(G,m[1],G+t,m[3]),E.createTileFeatures(n,h,this.geometryInfo,this,w,c,f,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[G-H+a.bounds[0],a.bounds[3]]}));n.sort(function(a,b){return a.localId-b.localId});return[2,{features:n,objectIds:h}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var b=a.objectId;if(null==b)k.error(new c("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var d=this._featuresById.get(b),f;this._markedIds.add(b);if(d)a.localId=d.localId,f=this._boundsStore.get(b),this._boundsStore.delete(b);else if(q.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(f=n.getBoundsOptimizedGeometry(f||p.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(b,f)):this._boundsStore.set(b,null);this._featuresById.set(b,a)}}};a.prototype._remove=function(a){if(q.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=B})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(B,a,v,h,b,d,c,f){function l(a,b){return a?b?4:3:b?3:2}function q(a,b,d,c){if(a){if(d)return b&&c?da:Ca;if(b&&c)return ca}else if(b&&
c)return Ca;return Wa}function y(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function p(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function D(a,b){return b*a.scale[0]+a.translate[0]}function n(a,b){return a.translate[1]-b*a.scale[1]}function w(a){a=a.coords;return{x:a[0],y:a[1]}}function E(a,b){a.coords[0]=b.x;a.coords[1]=b.y;return a}function I(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function k(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;return a}function t(a){a=
a.coords;return{x:a[0],y:a[1],m:a[2]}}function z(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.m;return a}function F(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function S(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;a.coords[3]=b.m;return a}function N(a,b){return a&&b?S:a?k:b?z:E}function C(a,b,d){if(!a)return null;for(var c=l(b,d),f=[],m=0;m<a.coords.length;m+=c){for(var k=[],u=0;u<c;u++)k.push(a.coords[m+u]);f.push(k)}return b?d?{points:f,hasZ:b,hasM:d}:{points:f,hasZ:b}:d?{points:f,
hasM:d}:{points:f}}function V(a,b,d){void 0===d&&(d=l(b.hasZ,b.hasM));a.lengths[0]=b.points.length;var c=a.coords,f=0,m=0;for(b=b.points;m<b.length;m++)for(var k=b[m],u=0;u<d;u++)c[f++]=k[u];return a}function W(a,b,d){if(!a)return null;var c=l(b,d),f=a.coords,m=[],k=0,u=0;for(a=a.lengths;u<a.length;u++){for(var r=a[u],O=[],h=0;h<r;h++){for(var n=[],H=0;H<c;H++)n.push(f[k++]);O.push(n)}m.push(O)}return b?d?{paths:m,hasZ:b,hasM:d}:{paths:m,hasZ:b}:d?{paths:m,hasM:d}:{paths:m}}function ha(a,b,d){void 0===
d&&(d=l(b.hasZ,b.hasM));var c=a.lengths,f=a.coords,m=0,k=0;for(b=b.paths;k<b.length;k++){for(var u=b[k],r=0,O=u;r<O.length;r++)for(var h=O[r],n=0;n<d;n++)f[m++]=h[n];c.push(u.length)}return a}function X(a,b,d){if(!a)return null;var c=l(b,d),f=a.coords,m=[],k=0,u=0;for(a=a.lengths;u<a.length;u++){for(var r=a[u],h=[],O=0;O<r;O++){for(var n=[],H=0;H<c;H++)n.push(f[k++]);h.push(n)}m.push(h)}return b?d?{rings:m,hasZ:b,hasM:d}:{rings:m,hasZ:b}:d?{rings:m,hasM:d}:{rings:m}}function L(a,b,d,c){void 0===d&&
(d=b.hasZ);void 0===c&&(c=b.hasM);m(a,b.rings,d,c);return a}function m(a,b,d,c){d=l(d,c);c=a.lengths;for(var f=a.coords,m=0,k=c.length=f.length=0;k<b.length;k++){for(var u=b[k],r=0,h=u;r<h.length;r++)for(var n=h[r],O=0;O<d;O++)f[m++]=n[O];c.push(u.length)}return a}function u(a,b,c,m,k,u){a.length=0;if(!c){for(m=0;m<b.length;m++)k=b[m],a.push(new d.default(null,k.attributes,null,k.attributes[u]));return a}switch(c){case "esriGeometryPoint":m=N(m,k);for(k=0;k<b.length;k++){var r=b[k];c=r.geometry;var r=
r.attributes,h=void 0;c&&(h=m(new f.default,c));a.push(new d.default(h,r,null,r[u]))}break;case "esriGeometryMultipoint":m=l(m,k);for(k=0;k<b.length;k++)r=b[k],c=r.geometry,r=r.attributes,h=void 0,c&&(h=V(new f.default,c,m)),a.push(new d.default(h,r,null,r[u]));break;case "esriGeometryPolyline":m=l(m,k);for(k=0;k<b.length;k++)r=b[k],c=r.geometry,r=r.attributes,h=void 0,c&&(h=ha(new f.default,c,m)),a.push(new d.default(h,r,null,r[u]));break;case "esriGeometryPolygon":for(c=0;c<b.length;c++){var n=
b[c],r=n.geometry,h=n.centroid,n=n.attributes,H=void 0;r&&(H=L(new f.default,r,m,k));h?a.push(new d.default(H,n,E(new f.default,h),n[u])):a.push(new d.default(H,n,null,n[u]))}break;default:pa.error("convertToFeatureSet:unknown-geometry",new v("Unable to parse unknown geometry type '"+c+"'")),a.length=0}return a}function r(a,b,d,c,f){a.length=0;switch(d){case "esriGeometryPoint":d=w;c&&f?d=F:c?d=I:f&&(d=t);for(c=0;c<b.length;c++){var m=b[c];f=m.geometry;m=m.attributes;f=f?d(f):null;a.push({attributes:m,
geometry:f})}break;case "esriGeometryMultipoint":for(d=0;d<b.length;d++){var k=b[d],m=k.geometry,k=k.attributes,u=void 0;m&&(u=C(m,c,f));a.push({attributes:k,geometry:u})}break;case "esriGeometryPolyline":for(d=0;d<b.length;d++)k=b[d],m=k.geometry,k=k.attributes,u=void 0,m&&(u=W(m,c,f)),a.push({attributes:k,geometry:u});break;case "esriGeometryPolygon":for(d=0;d<b.length;d++){var u=b[d],k=u.geometry,m=u.attributes,r=u.centroid,u=void 0;k&&(u=X(k,c,f));r?(k=w(r),a.push({attributes:m,centroid:k,geometry:u})):
a.push({attributes:m,geometry:u})}break;default:pa.error("convertToFeatureSet:unknown-geometry",new v("Unable to parse unknown geometry type '"+d+"'"))}return a}function G(a,b,d,c,f,m,k,u){void 0===k&&(k=d);void 0===u&&(u=c);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;f=va[f];var r=b.coords;b=b.lengths;var h=l(d,c),n=l(d&&k,c&&u);d=q(d,c,k,u);if(!b.length)return d(a.coords,r,0,0,y(m,r[0]),p(m,r[1])),a.lengths.length&&(a.lengths.length=
0),a.coords.length=h,a;for(var H,G=0,t,O=0,J=0;J<b.length;J++){var w=b[J];if(!(w<f)){var z=0;t=O;u=c=y(m,r[G]);H=k=p(m,r[G+1]);d(a.coords,r,t,G,u,H);z++;G+=h;t+=n;for(var F=1;F<w;F++,G+=h)if(u=y(m,r[G]),H=p(m,r[G+1]),u!==c||H!==k)d(a.coords,r,t,G,u-c,H-k),t+=n,z++,c=u,k=H;z>=f&&(a.lengths.push(z),O=t)}}a.coords.length=O;return a.coords.length?a:null}function H(a,b,d,c,f,m,k){for(var u=c,r=0,l,h=m+d;h<k;h+=d){l=b[h];var n=b[h+1],G=b[k],t=b[k+1],J=b[m],w=b[m+1],O=G-J,z=t-w;if(0!==O||0!==z){var F=((l-
J)*O+(n-w)*z)/(O*O+z*z);1<F?(J=G,w=t):0<F&&(J+=O*F,w+=z*F)}O=l-J;z=n-w;l=O*O+z*z;l>u&&(r=h,u=l)}u>c&&(r-m>d&&H(a,b,d,c,f,m,r),f(a,b,a.length,r,b[r],b[r+1]),k-r>d&&H(a,b,d,c,f,r,k))}function J(a,b,d,c,f){var m=b.coords,k=b.lengths,u=d?c?da:Ca:c?Ca:Wa;d=l(d,c);if(!m.length)return a!==b&&(a.lengths.length=0,a.coords.length=0),a;if(!k.length)return u(a.coords,m,0,0,D(f,m[0]),n(f,m[1])),a!==b&&(a.lengths.length=0,a.coords.length=d),a;var r=f.scale;c=r[0];for(var r=r[1],h=0,H=0;H<k.length;H++){var G=k[H];
a.lengths[H]=G;var t=D(f,m[h]),J=n(f,m[h+1]);u(a.coords,m,h,h,t,J);for(var h=h+d,w=1;w<G;w++,h+=d)t+=m[h]*c,J-=m[h+1]*r,u(a.coords,m,h,h,t,J)}a!==b&&(a.lengths.length=k.length,a.coords.length=m.length);return a}Object.defineProperty(a,"__esModule",{value:!0});var pa=h.getLogger("esri.tasks.support.optimizedFeatureSet"),va={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},Wa=function(a,b,d,c,f,m){a[d]=f;a[d+1]=m},Ca=function(a,b,d,c,f,m){a[d]=f;a[d+1]=m;a[d+
2]=b[c+2]},ca=function(a,b,d,c,f,m){a[d]=f;a[d+1]=m;a[d+2]=b[c+3]},da=function(a,b,d,c,f,m){a[d]=f;a[d+1]=m;a[d+2]=b[c+2];a[d+3]=b[c+3]};a.quantizeX=y;a.quantizeY=p;a.hydrateX=D;a.hydrateY=n;a.convertToPoint=function(a,b,d){return a?b?d?F(a):I(a):d?t(a):w(a):null};a.convertFromPoint=function(a,b,d){void 0===d&&(d=N(null!=b.z,null!=b.m));return d(a,b)};a.convertToMultipoint=C;a.convertFromMultipoint=V;a.convertToPolyline=W;a.convertFromPolyline=ha;a.convertToPolygon=X;a.convertFromPolygon=L;a.convertFromNestedArray=
m;var Y=[],Z=[];a.convertFromFeature=function(a,b,d,c,f){Y[0]=a;a=u(Z,Y,b,d,c,f)[0];Y.length=Z.length=0;return a};a.convertFromFeatures=u;a.convertToFeature=function(a,b,d,c){Z[0]=a;r(Y,Z,b,d,c);a=Y[0];Y.length=Z.length=0;return a};a.convertFromGeometry=function(a,d,c){if(!a)return null;var m=new f.default;"hasZ"in a&&null==d&&(d=a.hasZ);"hasM"in a&&null==c&&(c=a.hasM);if(b.isPoint(a))return N(null!=d?d:null!=a.z,null!=c?c:null!=a.m)(m,a);if(b.isPolygon(a))return L(m,a,d,c);if(b.isPolyline(a))return ha(m,
a,l(d,c));if(b.isMultipoint(a))return V(m,a,l(d,c));pa.error("convertFromGeometry:unknown-geometry",new v("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=function(a,b,d,c){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(b){case "esriGeometryPoint":return b=w,d&&c?b=F:d?b=I:c&&(b=t),b(a);case "esriGeometryMultipoint":return C(a,d,c);case "esriGeometryPolyline":return W(a,d,c);case "esriGeometryPolygon":return X(a,d,c);default:pa.error("convertToGeometry:unknown-geometry",
new v("Unable to parse unknown geometry type '"+b+"'"))}};a.convertToFeatures=r;a.convertToFeatureSet=function(a){var b=a.objectIdFieldName,d=a.spatialReference,c=a.transform,f=a.fields,m=a.hasM,k=a.hasZ,u=a.geometryType,h=a.exceededTransferLimit;a={features:r([],a.features,u,k,m),fields:f,geometryType:u,objectIdFieldName:b,spatialReference:d};c&&(a.transform=c);h&&(a.exceededTransferLimit=h);m&&(a.hasM=m);k&&(a.hasZ=k);return a};a.convertFromFeatureSet=function(a,b){var d=new c.default,f=a.hasM,
m=a.hasZ,k=a.features,r=a.objectIdFieldName,h=a.spatialReference,l=a.geometryType,n=a.exceededTransferLimit,H=a.transform;d.fields=a.fields;d.geometryType=l;d.objectIdFieldName=r||b;d.spatialReference=h;if(!d.objectIdFieldName)return pa.error(new v("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),d;k&&u(d.features,k,l,m,f,d.objectIdFieldName);n&&(d.exceededTransferLimit=n);f&&(d.hasM=f);m&&(d.hasZ=m);H&&(d.transform=H);return d};a.hydrateOptimizedFeatureSet=function(a){var b=
a.transform,d=a.hasM,c=a.hasZ;if(!b)return a;for(var f=0,m=a.features;f<m.length;f++){var k=m[f];k.geometry&&J(k.geometry,k.geometry,d,c,b);k.centroid&&J(k.centroid,k.centroid,d,c,b)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,b){var c=b.geometryType,m=b.features,k=b.hasM,u=b.hasZ;if(!a)return b;for(var r=0;r<m.length;r++){var h=m[r],l=new d.default(new f.default,h.attributes);G(l.geometry,h.geometry,k,u,c,a);h.centroid&&(l.centroid=new f.default,G(l.centroid,h.centroid,k,
u,"esriGeometryPoint",a));m[r]=l}b.transform=a;return b};a.quantizeOptimizedGeometry=G;a.generalizeOptimizedGeometry=function(a,b,d,c,f,m,k,u){void 0===k&&(k=d);void 0===u&&(u=c);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;f=va[f];var r=b.coords;b=b.lengths;var h=l(d,c),n=l(d&&k,c&&u);d=q(d,c,k,u);if(!b.length)return d(a.coords,r,0,0,r[0],r[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=h,a;c=0;m*=m;for(k=0;k<b.length;k++){u=
b[k];if(!(u<f)){var G=a.coords.length/n,t=c,J=c+(u-1)*h;d(a.coords,r,a.coords.length,t,r[t],r[t+1]);H(a.coords,r,h,m,d,t,J);d(a.coords,r,a.coords.length,J,r[J],r[J+1]);t=a.coords.length/n-G;t>=f?a.lengths.push(t):a.coords.length=G*n}c+=u*h}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,b,d,c){d=l(d,c);var f=c=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,k=Number.NEGATIVE_INFINITY;if(b&&b.coords){b=b.coords;for(var u=0;u<b.length;u+=d){var r=b[u],h=b[u+1];c=Math.min(c,
r);m=Math.max(m,r);f=Math.min(f,h);k=Math.max(k,h)}}a[0]=c;a[1]=f;a[2]=m;a[3]=k;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,b,d,c){d=l(d,c);c=b.coords;var f=Number.POSITIVE_INFINITY,m=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,r=0,h=0;for(b=b.lengths;h<b.length;h++)for(var n=b[h],H=c[r],G=c[r+1],f=Math.min(H,f),m=Math.min(G,m),k=Math.max(H,k),u=Math.max(G,u),r=r+d,t=1;t<n;t++,r+=d){var J=c[r],w=c[r+1],H=H+J,G=G+w;0>J&&(f=Math.min(f,H));0<J&&(k=Math.max(k,
H));0>w?m=Math.min(m,G):0<w&&(u=Math.max(u,G))}a[0]=f;a[1]=m;a[2]=k;a[3]=u;return a};a.hydrateOptimizedGeometry=J;a.removeZMValues=function(a,b,d,c,f,m){var k,u=l(d,c);d=q(d,c,f,m);c=b.coords;a.coords.length=0;a.lengths.length=0;(k=a.lengths).push.apply(k,b.lengths);for(b=0;b<c.length;b+=u)d(a.coords,c,a.coords.length,b,c[b],c[b+1]);return a};a.removeCollinearVectices=function(a,b,d,c,f){if(!b||!b.coords||!b.coords.length)return null;d=va[d];var m=b.coords;b=b.lengths;var k=q(c,f,c,f);c=l(c,f);for(var u=
f=0,r=0,h=0,n=0;n<b.length;n++){var H=b[n],u=h;k(a.coords,m,u,f,m[f],m[f+1]);f+=c;var G=m[f],t=m[f+1],J=G,w=t,z=t/G,u=u+c;k(a.coords,m,u,f,J,w);f+=c;for(var F=2;F<H;F++){var G=m[f],t=m[f+1],L=t/G,pa=z===L||!isFinite(z)&&!isFinite(L),z=pa&&isFinite(L)?0<=z&&0<=L||0>=z&&0>=L:0<=w&&0<=t||0>=w&&0>=t;pa&&z?(J+=G,w+=t):(J=G,w=t,u+=c);k(a.coords,m,u,f,J,w);f+=c;z=L}u+=c;H=(u-h)/c;H>=d&&(a.lengths[r]=H,h=u,r++)}a.coords.length>u&&(a.coords.length=u);a.lengths.length>r&&(a.lengths.length=r);return a.coords.length?
a:null}})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(B,a,v,h){Object.defineProperty(a,"__esModule",{value:!0});var b={minX:0,minY:0,maxX:0,maxY:0};B=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=h(9,v("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:
["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),d=0;a._idByBounds.forEach(function(a,c){b[d++]=c});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=
function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,d){this._loadIndex();var c=0,f=this._index;b.minX=a[0];b.minY=a[1];b.maxX=a[2];b.maxY=a[3];for(a=f.search(b);c<a.length;c++)d(this._idByBounds.get(a[c]))};a.prototype.get=function(a){return this._boundsById.get(a)};a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||
(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var d=this._boundsById.get(a);d&&(this._index.remove(d),this._idByBounds.delete(d))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||this._boundsToLoad.push(b))};return a}();a.BoundsStore=B})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(B){function a(b,d){if(!(this instanceof a))return new a(b,d);this._maxEntries=Math.max(4,
b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));d&&("function"===typeof d?this.toBBox=d:this._initFormat(d));this.clear()}function v(a,b){h(a,0,a.children.length,b,a)}function h(a,d,c,f,k){k||(k=p(null));k.minX=Infinity;k.minY=Infinity;k.maxX=-Infinity;k.maxY=-Infinity;for(var h;d<c;d++)h=a.children[d],b(k,a.leaf?f(h):h);return k}function b(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function d(a,
b){return a.minX-b.minX}function c(a,b){return a.minY-b.minY}function f(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function l(a){return a.maxX-a.minX+(a.maxY-a.minY)}function q(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function y(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function p(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function D(a,b,d,c,f){for(var k=[b,d],h;k.length;)d=k.pop(),
b=k.pop(),d-b<=c||(h=b+Math.ceil((d-b)/c/2)*c,B(a,h,b,d,f),k.push(b,h,h,d))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,d=[],c=this.toBBox;if(!y(a,b))return d;for(var f=[],h,l,n,p;b;){h=0;for(l=b.children.length;h<l;h++)n=b.children[h],p=b.leaf?c(n):n,y(a,p)&&(b.leaf?d.push(n):q(a,p)?this._all(n,d):f.push(n));b=f.pop()}return d},collides:function(a){var b=this.data,d=this.toBBox;if(!y(a,b))return!1;for(var c=[],f,h,l,n;b;){f=0;for(h=b.children.length;f<
h;f++)if(l=b.children[f],n=b.leaf?d(l):l,y(a,n)){if(b.leaf||q(a,n))return!0;c.push(l)}b=c.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,d=a.length;b<d;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&
this._insert(a,this.data.height-1);return this},clear:function(){this.data=p([]);return this},remove:function(a,b){if(!a)return this;for(var d=this.data,c=this.toBBox(a),f=[],h=[],l,n,w,p;d||f.length;){d||(d=f.pop(),n=f[f.length-1],l=h.pop(),p=!0);if(d.leaf){a:{w=a;var C=d.children,y=b;if(y){for(var v=0;v<C.length;v++)if(y(w,C[v])){w=v;break a}w=-1}else w=C.indexOf(w)}if(-1!==w){d.children.splice(w,1);f.push(d);this._condense(f);break}}p||d.leaf||!q(d,c)?n?(l++,d=n.children[l],p=!1):d=null:(f.push(d),
h.push(l),l=0,n=d,d=d.children[0])}return this},toBBox:function(a){return a},compareMinX:d,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var d=[];a;)a.leaf?b.push.apply(b,a.children):d.push.apply(d,a.children),a=d.pop();return b},_build:function(a,b,d,c){var f=d-b+1,h=this._maxEntries,l;if(f<=h)return l=p(a.slice(b,d+1)),v(l,this.toBBox),l;c||(c=Math.ceil(Math.log(f)/Math.log(h)),h=Math.ceil(f/Math.pow(h,c-1)));l=p([]);l.leaf=
!1;l.height=c;var f=Math.ceil(f/h),h=f*Math.ceil(Math.sqrt(h)),n,q,w;for(D(a,b,d,h,this.compareMinX);b<=d;b+=h)for(q=Math.min(b+h-1,d),D(a,b,q,f,this.compareMinY),n=b;n<=q;n+=f)w=Math.min(n+f-1,q),l.children.push(this._build(a,n,w,c-1));v(l,this.toBBox);return l},_chooseSubtree:function(a,b,d,c){for(var k,h,l,n,q,w,p,E;;){c.push(b);if(b.leaf||c.length-1===d)break;p=E=Infinity;k=0;for(h=b.children.length;k<h;k++)l=b.children[k],q=f(l),w=(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,
a.maxY)-Math.min(l.minY,a.minY))-q,w<E?(E=w,p=q<p?q:p,n=l):w===E&&q<p&&(p=q,n=l);b=n||b.children[0]}return b},_insert:function(a,d,c){var f=this.toBBox;c=c?a:f(a);var f=[],k=this._chooseSubtree(c,this.data,d,f);k.children.push(a);for(b(k,c);0<=d;)if(f[d].children.length>this._maxEntries)this._split(f,d),d--;else break;this._adjustParentBBoxes(c,f,d)},_split:function(a,b){var d=a[b],c=d.children.length,f=this._minEntries;this._chooseSplitAxis(d,f,c);c=this._chooseSplitIndex(d,f,c);c=p(d.children.splice(c,
d.children.length-c));c.height=d.height;c.leaf=d.leaf;v(d,this.toBBox);v(c,this.toBBox);b?a[b-1].children.push(c):this._splitRoot(d,c)},_splitRoot:function(a,b){this.data=p([a,b]);this.data.height=a.height+1;this.data.leaf=!1;v(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,d){var c,k,l,q,n,p,w;n=p=Infinity;for(c=b;c<=d-b;c++)k=h(a,0,c,this.toBBox),l=h(a,c,d,this.toBBox),q=Math.max(0,Math.min(k.maxX,l.maxX)-Math.max(k.minX,l.minX))*Math.max(0,Math.min(k.maxY,l.maxY)-Math.max(k.minY,l.minY)),
k=f(k)+f(l),q<n?(n=q,w=c,p=k<p?k:p):q===n&&k<p&&(p=k,w=c);return w},_chooseSplitAxis:function(a,b,f){var h=a.leaf?this.compareMinX:d,k=a.leaf?this.compareMinY:c,l=this._allDistMargin(a,b,f,h);b=this._allDistMargin(a,b,f,k);l<b&&a.children.sort(h)},_allDistMargin:function(a,d,c,f){a.children.sort(f);f=this.toBBox;var k=h(a,0,d,f),t=h(a,c-d,c,f),q=l(k)+l(t),n,p;for(n=d;n<c-d;n++)p=a.children[n],b(k,a.leaf?f(p):p),q+=l(k);for(n=c-d-1;n>=d;n--)p=a.children[n],b(t,a.leaf?f(p):p),q+=l(t);return q},_adjustParentBBoxes:function(a,
d,c){for(;0<=c;c--)b(d[c],a)},_condense:function(a){for(var b=a.length-1,d;0<=b;b--)0===a[b].children.length?0<b?(d=a[b-1].children,d.splice(d.indexOf(a[b]),1)):this.clear():v(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],
function(){function B(h,b,d,c,f){for(;c>d;){if(600<c-d){var l=c-d+1,q=b-d+1,y=Math.log(l),p=.5*Math.exp(2*y/3),y=.5*Math.sqrt(y*p*(l-p)/l)*(0>q-l/2?-1:1);B(h,b,Math.max(d,Math.floor(b-q*p/l+y)),Math.min(c,Math.floor(b+(l-q)*p/l+y)),f)}l=h[b];q=d;p=c;a(h,d,b);for(0<f(h[c],l)&&a(h,d,c);q<p;){a(h,q,p);q++;for(p--;0>f(h[q],l);)q++;for(;0<f(h[p],l);)p--}0===f(h[d],l)?a(h,d,p):(p++,a(h,p,c));p<=b&&(d=p+1);b<=p&&(c=p-1)}}function a(a,b,d){var c=a[b];a[b]=a[d];a[d]=c}function v(a,b){return a<b?-1:a>b?1:0}
return function(a,b,d,c,f){B(a,b,d||0,c||a.length-1,f||v)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),function(B,a,v,h,b,d,c,f,l,q){function y(a,b,d,f,h,l){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=
0);if(!b||!b.coords.length)return null;var k=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=c.quantizeX(l,k[0]),a.coords[1]=c.quantizeY(l,k[1]),a.coords.length=d,a;for(var t,q,n,p,z=0,w,y=0,L=0;L<b.length;L++){var m=b[L];if(!(m<f)){w=y;n=t=c.quantizeX(l,k[z]);p=q=c.quantizeY(l,k[z+1]);a.coords[w]=n;a.coords[w+1]=p;z+=d;n=c.quantizeX(l,k[z]);p=c.quantizeY(l,k[z+1]);var u=n-t,r=p-q,G=r/u;w+=2;a.coords[w]=u;a.coords[w+1]=r;t=n;q=p;for(var z=z+d,H=2;H<m;H++){n=c.quantizeX(l,k[z]);p=c.quantizeY(l,
k[z+1]);if(n!==t||p!==q){t=n-t;q=p-q;var J=q/t;G!==J&&(isFinite(G)||isFinite(J))||!(h||(isFinite(J)?0<=G&&0<=J||0>=G&&0>=J:0<=r&&0<=q||0>=r&&0>=q))?(u=t,r=q,w+=2):(u+=t,r+=q);a.coords[w]=u;a.coords[w+1]=r;G=J;t=n;q=p}z+=d}n=(w+2-y)/2;n>=f&&(a.lengths.push(n),y=w+2)}}a.coords.length>y&&(a.coords.length=y);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});var p=new f.default,D={esriGeometryPoint:c.convertToPoint,esriGeometryPolyline:c.convertToPolyline,esriGeometryPolygon:c.convertToPolygon,
esriGeometryMultipoint:c.convertToMultipoint};a.executeTileQueryForIds=function(a,b,c){b=d.pad(b.bounds,c.pixelBuffer*b.resolution,d.create());var f=[];a.featureStore.forEachInBounds(b,function(b){return f.push(a.featureAdapter.getObjectId(b))});return f};a.createTileFeatures=function(a,b,d,c,f,h,F,v,N){var k=D[d.geometryType],t=n[d.geometryType],z="esriGeometryPolygon"===d.geometryType&&!v,w=d.hasZ?d.hasM?4:3:d.hasM?3:2;F&&!h?c.forEachInBounds(f,function(c){if(!b.has(c.objectId)){var f=q.getCentroid(d,
c,N),m=c.attributes;f&&(b.add(c.objectId),a.push(new l.Feature(m,c.localId,null,f)))}}):h&&!F?c.forEachInBounds(f,function(d){if(!b.has(d.objectId)){var c=d.attributes,f=k(y(p,d.geometry,w,t,z,N),!1,!1);f&&(b.add(d.objectId),a.push(new l.Feature(c,d.localId,f,null)))}}):c.forEachInBounds(f,function(c){if(!b.has(c.objectId)){var f=q.getCentroid(d,c,N),m=c.attributes,u=k(y(p,c.geometry,w,t,z,N),!1,!1);u&&f&&(b.add(c.objectId),a.push(new l.Feature(m,c.localId,u,f)))}})};var n={esriGeometryPoint:0,esriGeometryPolyline:2,
esriGeometryPolygon:3,esriGeometryMultipoint:0}})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/iteratorUtils ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(B,a,v,h,b,d,c,f,l,q,y,p,D,n,w,E,I,k,t,z,F,S,N,C,V,W){Object.defineProperty(a,"__esModule",{value:!0});var ha=l.getLogger("esri.layers.graphics.data.QueryEngine");B=function(){return function(a,b,d,c,f){void 0===b&&(b=null);this.attributes=a;this.geometry=d;this.centroid=c;this.filterFlags=f;this.groupId=-1;this.localId=b}}();a.Feature=B;var X=new Set,L=new q.MemCacheStorage(2E6),m=0;B=function(){function a(a){var b=this;this.capabilities={query:z.queryCapabilities};this.geometryType=a.geometryType;
this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new q.MemCache(m++ +"$$",L));this.fieldsIndex=new V(a.fields);a.scheduler&&a.task&&(this._frameQueue=
new W.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,
"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:C.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=N.getTimeExtent(this.timeInfo,
this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,c;return h(this,function(m){switch(m.label){case 0:b=f.clone(a),m.label=1;case 1:return m.trys.push([1,14,,15]),[4,this._schedule()];case 2:return m.sent(),[4,C.normalizeQuery(b,this.definitionExpression,this.spatialReference)];
case 3:return b=m.sent(),[4,this._reschedule()];case 4:return m.sent(),[4,this._checkQuerySupport(b)];case 5:return b=m.sent(),[4,this._reschedule()];case 6:return m.sent(),[4,this._executeGeometryQuery(b)];case 7:return d=m.sent(),[4,this._reschedule()];case 8:return m.sent(),[4,d.executeObjectIdsQuery(b)];case 9:return d=m.sent(),[4,this._reschedule()];case 10:return m.sent(),[4,d.executeTimeQuery(b)];case 11:return d=m.sent(),[4,this._reschedule()];case 12:return m.sent(),[4,d.executeAttributesQuery(b)];
case 13:return d=m.sent(),[3,15];case 14:c=m.sent();if(c!==C.QUERY_ENGINE_EMPTY_RESULT)throw c;d=new F.default([],null,this);return[3,15];case 15:return[2,d.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,c;return h(this,function(m){switch(m.label){case 0:b=f.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,m.label=1;case 1:return m.trys.push([1,14,,15]),[4,this._schedule()];case 2:return m.sent(),
[4,C.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=m.sent(),[4,this._reschedule()];case 4:return m.sent(),[4,this._checkQuerySupport(b)];case 5:return b=m.sent(),[4,this._reschedule()];case 6:return m.sent(),[4,this._executeGeometryQuery(b)];case 7:return d=m.sent(),[4,this._reschedule()];case 8:return m.sent(),[4,d.executeObjectIdsQuery(b)];case 9:return d=m.sent(),[4,this._reschedule()];case 10:return m.sent(),[4,d.executeTimeQuery(b)];case 11:return d=m.sent(),
[4,this._reschedule()];case 12:return m.sent(),[4,d.executeAttributesQuery(b)];case 13:return d=m.sent(),[2,d.size];case 14:c=m.sent();if(c!==C.QUERY_ENGINE_EMPTY_RESULT)throw c;return[2,0];case 15:return[2]}})})};a.prototype.executeQueryForExtent=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,c,m,k,l,G,H;return h(this,function(h){switch(h.label){case 0:b=f.clone(a),c=b.outSR,h.label=1;case 1:return h.trys.push([1,14,,15]),[4,this._schedule()];case 2:return h.sent(),
[4,C.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=h.sent(),[4,this._reschedule()];case 4:return h.sent(),[4,this._checkQuerySupport(b)];case 5:return b=h.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule()];case 6:return h.sent(),[4,this._executeGeometryQuery(b)];case 7:return d=h.sent(),[4,this._reschedule()];case 8:return h.sent(),[4,d.executeObjectIdsQuery(b)];case 9:return d=h.sent(),[4,this._reschedule()];case 10:return h.sent(),
[4,d.executeTimeQuery(b)];case 11:return d=h.sent(),[4,this._reschedule()];case 12:return h.sent(),[4,d.executeAttributesQuery(b)];case 13:d=h.sent();m=d.size;if(!m)return[2,{count:m,extent:null}];D.set(r,D.NEGATIVE_INFINITY);this.featureStore.forEachBounds(d.items,function(a){return D.expand(r,a)},u);k={xmin:r[0],ymin:r[1],xmax:r[3],ymax:r[4],spatialReference:C.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(r[2])&&isFinite(r[5])&&(k.zmin=r[2],k.zmax=r[5]);l=t.project(k,d.spatialReference,
c);l.spatialReference=C.cleanFromGeometryEngine(c||this.spatialReference);0===l.xmax-l.xmin&&(G=p.getMetersPerUnitForSR(l.spatialReference),l.xmin-=G,l.xmax+=G);0===l.ymax-l.ymin&&(G=p.getMetersPerUnitForSR(l.spatialReference),l.ymin-=G,l.ymax+=G);this.hasZ&&null!=l.zmin&&null!=l.zmax&&0===l.zmax-l.zmin&&(G=p.getMetersPerUnitForSR(l.spatialReference),l.zmin-=G,l.zmax+=G);return[2,{count:m,extent:l}];case 14:H=h.sent();if(H===C.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw H;case 15:return[2]}})})};
a.prototype.executeQueryForIds=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){return h(this,function(b){return[2,this.executeQueryForIdSet(a,d).then(function(a){return c.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,c,m,k,u,r,l;return h(this,function(h){switch(h.label){case 0:b=f.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,h.label=1;case 1:return h.trys.push([1,13,,
14]),[4,this._schedule()];case 2:return h.sent(),[4,C.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=h.sent(),[4,this._reschedule()];case 4:return h.sent(),[4,this._executeGeometryQuery(b)];case 5:return d=h.sent(),[4,this._reschedule()];case 6:return h.sent(),[4,d.executeObjectIdsQuery(b)];case 7:return d=h.sent(),[4,this._reschedule()];case 8:return h.sent(),[4,d.executeTimeQuery(b)];case 9:return d=h.sent(),[4,this._reschedule()];case 10:return h.sent(),[4,d.executeAttributesQuery(b)];
case 11:return d=h.sent(),[4,this._reschedule()];case 12:h.sent();c=d.items;m=new Set;k=0;for(u=c;k<u.length;k++)r=u[k],m.add(d.featureAdapter.getObjectId(r));return[2,m];case 13:l=h.sent();if(l===C.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw l;case 14:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){var c=this;if(this.timeInfo)return this.executeQuery(a,b).then(function(a){return c._filterLatest(a,c.timeInfo)});ha.error(new d("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};
a.prototype._schedule=function(a){return b(this,void 0,void 0,function(){return h(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a).then(function(a){return a})]:[2,a]})})};a.prototype._reschedule=function(a){return b(this,void 0,void 0,function(){return h(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a).then(function(a){return a})]:[2,a]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();
this._budget=null};a.prototype._filterLatest=function(a,b){var d=b.trackIdField,c=b.startTimeField;b=b.endTimeField||c;for(var c=new Map,f=[],m=0,k=a.features;m<k.length;m++){var u=k[m],h=u.attributes[d],r=u.attributes[b];(!c.has(h)||c.get(h).attributes[b]<r)&&c.set(h,u)}c.forEach(function(a){return f.push(a)});return v({},a,{features:f})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new F.default(a,null,this)}return this._allItems};
a.prototype._executeGeometryQuery=function(a){return b(this,void 0,void 0,function(){var d,c,f,m,k,u,r,l,G,t,q,H,n,p,L,z,w,y,C,v,D,N,X,E,B=this;return h(this,function(J){switch(J.label){case 0:d=a.geometry;c=a.outSR;f=a.spatialRel;m=I.isValid(c)&&!I.equals(this.spatialReference,c);if(k=this.cacheSpatialQueries?m?JSON.stringify({geometry:d,spatialRelationship:f,outSpatialReference:c}):JSON.stringify({geometry:d,spatialRelationship:f}):null)if(u=this._geometryQueryCache.get(k),void 0!==u)return[2,u];
r=function(d){return b(B,void 0,void 0,function(){var b;return h(this,function(f){switch(f.label){case 0:return m&&(a.returnGeometry||a.returnCentroid)?[4,d.project(c)]:[3,2];case 1:return b=f.sent(),k&&this._geometryQueryCache.put(k,b,b.size||1),[2,b];case 2:return k&&this._geometryQueryCache.put(k,d,d.size||1),[2,d]}})})};if(!d)return[2,r(this._getAll())];l=this.featureAdapter;if("esriSpatialRelDisjoint"!==f)return[3,5];G=this._searchFeatures(this._getQueryBBoxes(d));if(!G.length)return[2,r(this._getAll())];
H=new Set;n=0;for(p=G;n<p.length;n++)L=p[n],H.add(l.getObjectId(L));return[4,this._reschedule(H)];case 1:return H=J.sent(),z=0,t=Array(H.size),this.featureStore.forEach(function(a){return t[z++]=a}),q=H,[4,this._reschedule()];case 2:return J.sent(),[4,S.getSpatialQueryOperator(f,d,this)];case 3:return w=J.sent(),y=function(a){return!q.has(l.getObjectId(a))||w(l.getGeometry(a))},v=F.default.bind,[4,this._runSpatialFilter(t,y)];case 4:return C=new (v.apply(F.default,[void 0,J.sent(),d,this])),[2,r(C)];
case 5:return D=this._searchFeatures(this._getQueryBBoxes(d)),D.length?(N=this._canExecuteSoloPass(d,a))?[2,r(new F.default(D,d,this))]:[4,S.getSpatialQueryOperator(f,d,this)]:(C=new F.default([],d,this),k&&this._geometryQueryCache.put(k,C,C.size||1),[2,C]);case 6:return X=J.sent(),[4,this._runSpatialFilter(D,function(a){return X(l.getGeometry(a))})];case 7:return E=J.sent(),[2,r(new F.default(E,d,this))]}})})};a.prototype._runSpatialFilter=function(a,d){return b(this,void 0,void 0,function(){var c,
f,m,k=this;return h(this,function(u){if(!d)return[2,a];if(!this._budget)return[2,a.filter(function(a){return d(a)})];c=0;f=[];m=function(){return b(k,void 0,void 0,function(){var b;return h(this,function(k){switch(k.label){case 0:if(!(c<a.length))return[3,3];b=a[c];d(b)&&f.push(b);return this._budget.done?[4,this._reschedule()]:[3,2];case 1:return k.sent(),[2,m()];case 2:return++c,[3,0];case 3:return[2]}})})};return[2,this._reschedule().then(function(){return m()}).then(function(){return f})]})})};
a.prototype._canExecuteSoloPass=function(a,b){var d=this.geometryType;b=b.spatialRel;return S.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===d&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(S.canQueryWithRBush(a)){if(E.isExtent(a))return[n.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(E.isPolygon(a))return a.rings.map(function(a){return n.fromValues(Math.min(a[0][0],a[2][0]),
Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[w.getBoundsXY(n.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){X.add(a)});var d=Array(X.size),c=0;X.forEach(function(a){return d[c++]=a});X.clear();return d};a.prototype._checkQuerySupport=function(a){return b(this,void 0,void 0,function(){return h(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||
a.pixelSize||a.relationParam||a.text)throw new d("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,y.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),S.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),t.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,f=a.returnDistinctValues;c&&0<c.length&&
(c=c.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),k.validateFields(this.fieldsIndex,c,"orderByFields contains missing fields"));if(b&&0<b.length)k.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(f)throw new d("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});k.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return b(this,
void 0,void 0,function(){var b,c,f,m,u,r,l,G,t,q,n,p;return h(this,function(h){b=a.outStatistics;c=a.groupByFieldsForStatistics;f=a.having;m=c&&c.length;u=b&&b.length;if(f){if(!m||!u)throw new d("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});k.validateHaving(this.fieldsIndex,f,b)}if(u){if(r=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];l=b.map(function(a){return a.onStatisticField});k.validateFields(this.fieldsIndex,
l,"onStatisticFields contains missing fields");m&&k.validateFields(this.fieldsIndex,c,"groupByFieldsForStatistics contains missing fields");G=0;for(t=b;G<t.length;G++)if(q=t[G],n=q.onStatisticField,p=q.statisticType,(!m||"count"!==p)&&n&&k.hasInvalidFieldType(n,this.fieldsIndex))throw new d("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:q,query:a});}return[2]})})};return a}();a.default=B;var u=D.create(),r=D.create()})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/iteratorUtils ../../../core/sql/WhereClauseCache".split(" "),
function(B,a,v,h,b,d){function c(a,b){return a?q.get(a,b):null}function f(a,b,d,q){void 0===q&&(q=!0);for(var n=[],p=0;p<b.length;p++){var k=b[p];if("*"!==k&&!a.has(k))if(q){var t=l(k);try{var z=c(t,a);if(!z)throw new h("feature-store:unsupported-query","invalid SQL expression",{where:t});if(!z.isStandardized)throw new h("feature-store:unsupported-query","expression is not standard",{clause:z});f(a,z.fieldNames,"expression contains missing fields")}catch(F){if((t=F&&F.details)&&(t.clause||t.where))throw F;
t&&t.missingFields?n.push.apply(n,t.missingFields):n.push(k)}}else n.push(k)}if(n.length)throw new h("feature-store:unsupported-query",d,{missingFields:n});}function l(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var q=new d.WhereClauseCache(50,500),y=b.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;
var d=q.get(b,a);if(!d)throw new h("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!d.isStandardized)throw new h("feature-store:unsupported-query","where clause is not standard",{where:b});f(a,d.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,d){if(!b)return!0;var c=q.get(b,a);if(!c)throw new h("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!c.isAggregate)throw new h("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});f(a,c.fieldNames,"having contains missing fields");if(!c.getExpressions().every(function(b){var c=b.aggregateType;b=b.field;var f=a.has(b)&&a.get(b).name;return d.some(function(b){var d=b.onStatisticField;b=b.statisticType;return(a.has(d)&&a.get(d).name)===f&&b.toLowerCase().trim()===c})}))throw new h("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=c;a.validateFields=f;a.getExpressionFromFieldName=l;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!y.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(B,a,v,h){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b){this._cache=new v(a);this._invalidCache=new v(b)}a.prototype.get=function(a,b){var d=b.uid+":"+a,c=this._cache.get(d);if(c)return c;if(void 0!==this._invalidCache.get(d))return null;try{var q=
h.WhereClause.create(a,b);this._cache.put(d,q);return q}catch(y){return this._invalidCache.put(d,null),null}};return a}();a.WhereClauseCache=B})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(B,a,v){return function(){function a(a,d){this._storage=new v.MemCacheStorage;this._storage.maxSize=a;d&&this._storage.registerRemoveFunc("",d)}a.prototype.put=function(a,d){this._storage.put(a,d,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../iteratorUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(B,a,v,h,b,d,c){function f(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function l(a,b,d,c,k,h,l,q,t){void 0===d&&(d="0");void 0===c&&(c="0");void 0===
k&&(k="0");void 0===h&&(h="0");void 0===l&&(l="");void 0===q&&(q="0");void 0===t&&(t="0");return"+"===l||"-"===l?(a=f(parseInt(a,10),4)+"-"+f(parseInt(b,10),2)+"-"+f(parseInt(d,10),2),b="",10>parseFloat(h)&&(b="0"),c=f(parseInt(c,10),2)+":"+f(parseInt(k,10),2)+":"+(b+parseFloat(h).toString()),l=""+l+f(parseInt(q,10),2)+":"+f(parseInt(t,10),2),new Date(a+"T"+c+l)):new Date(parseInt(a,10),parseInt(b,10),parseInt(d,10),parseInt(c,10),parseInt(k,10),parseFloat(h))}function q(a){var b=C.exec(a);if(null!==
b){a=b[1];var d=b[2],c=b[3],f=b[4],k=b[5],h=b[6];return l(a,d,c,f,k,h)}b=V.exec(a);if(null!==b){a=b[1];var d=b[2],c=b[3],f=b[4],k=b[5],h=b[6],q=b[7],t=b[8],b=b[9];return l(a,d,c,f,k,h,q,t,b)}b=W.exec(a);if(null!==b)return a=b[1],d=b[2],c=b[3],f=b[4],k=b[5],q=b[6],t=b[7],b=b[8],l(a,d,c,f,k,"0",q,t,b);b=ha.exec(a);if(null!==b)return a=b[1],d=b[2],c=b[3],f=b[4],k=b[5],l(a,d,c,f,k);b=N.exec(a);if(null!==b)return a=b[1],d=b[2],c=b[3],l(a,d,c);throw Error("SQL Invalid Timestamp");}function y(a){a=N.exec(a);
if(null===a)throw Error("SQL Invalid Date");var b=a[2],d=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(d,10))}function p(a){return Array.isArray(a)?a:[a]}function D(a){return null!==a?!0!==a:null}function n(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function w(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function E(a,b){if(null==a)return null;for(var d=!1,c=0;c<b.length;c++){var f=b[c];if(null==f)d=null;else if(a===f){d=!0;break}}return d}
function I(a,b,d){if(null==a)return null;for(var c="",f=0,m=0;m<b.length;m++){var k=b.charAt(m);switch(f){case 0:k===d?f=1:c=0<="-[]/{}()*+?.\\^$|".indexOf(k)?c+("\\"+k):"%"===k?c+".*":"_"===k?c+".":c+k;break;case 1:c=0<="-[]/{}()*+?.\\^$|".indexOf(k)?c+("\\"+k):c+k,f=0}}return(new RegExp("^"+c+"$")).test(a)}function k(a){return a instanceof Date?a.valueOf():a}function t(a,b,d){if(null==b||null==d)return null;b=k(b);d=k(d);switch(a){case "\x3c\x3e":return b!==d;case "\x3d":return b===d;case "\x3e":return b>
d;case "\x3c":return b<d;case "\x3e\x3d":return b>=d;case "\x3c\x3d":return b<=d}}function z(a){for(var b=[],d={},c=0;c<a.length;c++){var f=a[c],k=f.toLowerCase();void 0===d[k]&&(b.push(f),d[k]=1)}return b}function F(a,b,c){if(b instanceof d.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+c.getTime());case "-":return b.valueInMilliseconds()-c.getTime();case "*":return b.valueInMilliseconds()*c.getTime();case "/":return b.valueInMilliseconds()/c.getTime()}else if(c instanceof
d.SqlInterval)switch(a){case "+":return d.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+c.valueInMilliseconds());case "-":return d.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-c.valueInMilliseconds());case "*":return b.valueInMilliseconds()*c.valueInMilliseconds();case "/":return b.valueInMilliseconds()/c.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(c instanceof d.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-c.valueInMilliseconds());case "*":return b.getTime()*c.valueInMilliseconds();case "/":return b.getTime()/c.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof c)switch(c*=864E5,b=b.getTime(),a){case "+":return new Date(b+c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}else if(c instanceof Date&&"number"===typeof b)switch(b*=864E5,c=c.getTime(),a){case "+":return new Date(b+
c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}switch(a){case "+":return b+c;case "-":return b-c;case "*":return b*c;case "/":return b/c}}function S(a,b,d,c){a=c.getAttribute(a,b);return null!=a&&1===d[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var N=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,C=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,V=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
W=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,ha=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,X=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,d,c){return S(a,b,d,c)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,d){return I(a,b,d)};a.ensureArray=function(a){return p(a)};a.applyIn=function(a,b){return E(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,c){return d.SqlInterval.createFromValueAndQualifer(a,b,c)};a.convertInterval=function(a){return a instanceof d.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,d){return t(a,b,d)};a.calculate=function(a,b,d){return F(a,b,d)};a.makeComparable=function(a){return k(a)};a.evaluateFunction=function(a,b){return d.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return D(a)};a.ternaryAnd=function(a,b){return n(a,b)};a.ternaryOr=function(a,b){return w(a,b)};return a}();B=function(){function f(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=c.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var d=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=d}f.create=function(a,b){return new f(a,b)};Object.defineProperty(f.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});f.prototype.testSet=function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);for(var c={},f=function(a){c[a]=b.map(function(b){return d.getAttribute(b,a)})},k=0,m=this.fieldNames;k<m.length;k++)f(m[k]);return!!this.evaluateNode(this.parseTree,{attributes:c},a.defaultAttributeAdapter)};f.prototype.calculateValue=
function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,c);return b instanceof d.SqlInterval?b.valueInMilliseconds()/864E5:b};f.prototype.calculateValueCompiled=function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,d,this.datefields);if(v("csp-restrictions"))return this.calculateValue(b,d);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,
d,this.datefields)};f.prototype.testFeature=function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,d)};f.prototype.testFeatureCompiled=function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);if(void 0===this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,d,this.datefields);if(v("csp-restrictions"))return this.testFeature(b,d);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,d,this.datefields)};
f.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return z(a)};f.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var d=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var c=d+"-"+b;a.has(c)||a.set(c,{aggregateType:d,field:b})}}});return h.valuesOfMap(a)};f.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return z(a)};f.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(X)};f.prototype.extractExpressionInfo=function(a){var c=this,f=[],k=!0,m=!0;this.visitAll(this.parseTree,function(h){switch(h.type){case "column_ref":var l=h.column.toUpperCase();if("CURRENT_DATE"!==
l&&"CURRENT_TIMESTAMP"!==l){var r=(l=a.get(h.column))&&l.name;!l||"date"!==l.type&&"esriFieldTypeDate"!==l.type||(c.datefields[l.name]=1);void 0!==r?(f.push(r),h.column=r):f.push(h.column)}break;case "function":l=h.name,h=h.args.value.length,k&&(k=d.isStandardized(l,h)),m&&(m=b.isAggregate(l,h))}});return{referencedFieldNames:z(f),isStandardized:k,isAggregate:m}};f.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);
break;case "case_expression":for(var d=0,c=a.clauses;d<c.length;d++){var f=c[d];this.visitAll(f,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":d=0;for(a=a.value;d<a.length;d++)f=a[d],this.visitAll(f,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};f.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+
this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var d="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",c=0;c<a.clauses.length;c++)b+=" ("+d+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";else for(b="( ",c=0;c<a.clauses.length;c++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+
")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";d=0;for(a=a.value;d<a.length;d++)c=a[d],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(c);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+y(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+q(a.value).getTime().toString()+"))";case "column_ref":return"CURRENT_DATE"===
a.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===a.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};f.prototype.evaluateNode=function(a,c,f){switch(a.type){case "interval":return c=this.evaluateNode(a.value,c,f),d.SqlInterval.createFromValueAndQualifer(c,
a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var h=k(this.evaluateNode(a.operand,c,f)),l=0;l<a.clauses.length;l++){if(h===k(this.evaluateNode(a.clauses[l].operand,c,f)))return this.evaluateNode(a.clauses[l].value,c,f)}else for(l=0;l<a.clauses.length;l++)if(!0===this.evaluateNode(a.clauses[l].operand,c,f))return this.evaluateNode(a.clauses[l].value,c,f);return null!==a.else?this.evaluateNode(a.else,c,f):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":h=
[];l=0;for(a=a.value;l<a.length;l++){var r=a[l];h.push(this.evaluateNode(r,c,f))}return h;case "unary_expr":return D(this.evaluateNode(a.expr,c,f));case "binary_expr":switch(a.operator){case "AND":return n(this.evaluateNode(a.left,c,f),this.evaluateNode(a.right,c,f));case "OR":return w(this.evaluateNode(a.left,c,f),this.evaluateNode(a.right,c,f));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,c,f);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,c,f);case "IN":return h=p(this.evaluateNode(a.right,c,f)),E(this.evaluateNode(a.left,c,f),h);case "NOT IN":return h=p(this.evaluateNode(a.right,c,f)),D(E(this.evaluateNode(a.left,c,f),h));case "BETWEEN":return h=this.evaluateNode(a.left,c,f),a=this.evaluateNode(a.right,c,f),null==h||null==a[0]||null==a[1]?null:h>=k(a[0])&&h<=k(a[1]);case "NOTBETWEEN":return h=this.evaluateNode(a.left,c,f),a=this.evaluateNode(a.right,c,f),null==h||null==a[0]||null==a[1]?null:
h<k(a[0])||h>k(a[1]);case "LIKE":return I(this.evaluateNode(a.left,c,f),this.evaluateNode(a.right,c,f),a.escape);case "NOT LIKE":return D(I(this.evaluateNode(a.left,c,f),this.evaluateNode(a.right,c,f),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return t(a.operator,this.evaluateNode(a.left,c,f),this.evaluateNode(a.right,c,f));case "-":case "+":case "*":case "/":return F(a.operator,this.evaluateNode(a.left,c,f),this.evaluateNode(a.right,c,f))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return y(a.value);case "timestamp":return q(a.value);case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(r=new Date,r.setHours(0,0,0,0),r):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:S(c,a.column,this.datefields,f);case "function":return c=this.evaluateNode(a.args,c,f),this.isAggregate?b.aggregateFunction(a.name,c):d.evaluateFunction(a.name,c)}throw Error("Unsupported sql syntax "+a.type);
};return f}();a.WhereClause=B;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(B,a){function v(a){for(var b=0,d=0;d<a.length;d++)b+=a[d];return b/a.length}function h(a){for(var b=v(a),d=a.length,h=0,q=0;q<a.length;q++)h+=Math.pow(a[q]-b,2);return 1<d?h/(d-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,c){var d=
b[a.toLowerCase()];if(null==d)throw Error("Function Not Recognised");if(c.length<d.minParams||c.length>d.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return d.evaluate(c)};a.isAggregate=function(a,c){a=b[a.toLowerCase()];return null!=a&&c>=a.minParams&&c<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,
a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:v(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,d=0;d<a.length;d++)b+=a[d];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(h(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:h(a[0])}}}})},
"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(B,a,v){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var d=new a;d.second=b/1E3;return d};a.createFromValueAndQualifer=
function(b,c,f){var d=null,h=new a;h.op="-"===f?"-":"+";if("interval-period"===c.type){a.fixDefaults(c);if("year"===c.period||"month"===c.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))h[c.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(c.start);a.fixDefaults(c.end);if("year"===c.start.period||"month"===c.start.period)throw Error("Year-Month Intervals not supported");if("year"===c.end.period||"month"===c.end.period)throw Error("Year-Month Intervals not supported");
switch(c.start.period){case "day":switch(c.end.period){case "hour":d=/^[0-9]{1,} [0-9]{1,}$/;if(d.test(b))h[c.start.period]=parseFloat(b.split(" ")[0]),h[c.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":d=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(d.test(b))h[c.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),h.hour=parseFloat(b[0]),h.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":d=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(d.test(b))h[c.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),h.hour=parseFloat(b[0]),h.minute=parseFloat(b[1]),h.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(c.end.period){case "minute":d=/^[0-9]{1,}:[0-9]{1,}$/;if(d.test(b))h.hour=parseFloat(b.split(":")[0]),h.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":d=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(d.test(b))b=b.split(":"),h.hour=parseFloat(b[0]),h.minute=parseFloat(b[1]),h.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(c.end.period){case "second":d=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(d.test(b))b=b.split(":"),h.minute=parseFloat(b[0]),h.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return h};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=B;a.evaluateFunction=function(a,d){var b=h[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(d.length<b.minParams||d.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(d)};a.isStandardized=function(a,d){a=h[a.toLowerCase()];return null!=a&&d>=a.minParams&&
d<=a.maxParams};var h={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],c=a[1];return null==b||null==c?null:b.toString().substring(c-1)}if(3===a.length)return b=a[0],c=a[1],a=a[2],null==b||null==c||null==a?null:0>=a?"":b.toString().substring(c-1,c+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,c=b?a[1]:" ",b=b?a[2]:a[1];if(null==c||null==b)return null;c="("+v.escapeRegExpString(c)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
c+"*|"+c+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+c+"*","g"),"");case "TRAILING":return b.replace(new RegExp(c+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",c=0;c<
a.length;c++){if(null==a[c])return null;b+=a[c].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(B,a,v){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){}a.parse=function(a){return v.parse(a)};
return a}();a.WhereGrammar=B})},"esri/core/sql/sql92grammar":function(){define([],function(){function B(a,v,h,b){this.message=a;this.expected=v;this.found=h;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,B)}(function(a,v){function h(){this.constructor=a}h.prototype=v.prototype;a.prototype=new h})(B,Error);B.buildMessage=function(a,v){function h(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+h(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+h(a)})}function d(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+h(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+h(a)})}var c={literal:function(a){return'"'+b(a.text)+'"'},"class":function(a){var b="",c;for(c=0;c<a.parts.length;c++)b+=a.parts[c]instanceof Array?d(a.parts[c][0])+"-"+d(a.parts[c][1]):d(a.parts[c]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),d;for(d=0;d<a.length;d++){var f=d,h;h=a[d];h=c[h.type](h);b[f]=h}b.sort();
if(0<b.length){for(a=d=1;d<b.length;d++)b[d-1]!==b[d]&&(b[a]=b[d],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(v?'"'+b(v)+'"':"end of input")+" found."};return{SyntaxError:B,parse:function(a,v){function h(a,b){return{type:"literal",text:a,ignoreCase:b}}function b(a,b,e){return{type:"class",parts:a,inverted:b,ignoreCase:e}}function d(b){var e=Ea[b],d;if(!e){for(d=b-1;!Ea[d];)d--;e=Ea[d];
for(e={line:e.line,column:e.column};d<b;)10===a.charCodeAt(d)?(e.line++,e.column=1):e.column++,d++;Ea[b]=e}return e}function c(a,b){var e=d(a),c=d(b);return{start:{offset:a,line:e.line,column:e.column},end:{offset:b,line:c.line,column:c.column}}}function f(a){g<aa||(g>aa&&(aa=g,Ma=[]),Ma.push(a))}function l(){var a,b,d;a=g;b=A();b!==e?(b=y(),b!==e?(d=A(),d!==e?a=b:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function q(){var a,b,d,c,f,k,h,l;a=g;b=y();if(b!==e){d=[];c=g;f=A();f!==e?(k=xa(),k!==e?(h=A(),
h!==e?(l=y(),l!==e?c=f=[f,k,h,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);for(;c!==e;)d.push(c),c=g,f=A(),f!==e?(k=xa(),k!==e?(h=A(),h!==e?(l=y(),l!==e?c=f=[f,k,h,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);if(d!==e){a={type:"expr_list"};b=[b];for(c=0;c<d.length;c++)b.push(d[c][3]);a.value=b}else g=a,a=e}else g=a,a=e;return a}function y(){var a,b,d,c,f,k,h,l;a=g;b=p();if(b!==e){d=[];c=g;f=A();f!==e?(k=wa(),k!==e?(h=A(),h!==e?(l=p(),l!==e?c=f=[f,k,h,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);
for(;c!==e;)d.push(c),c=g,f=A(),f!==e?(k=wa(),k!==e?(h=A(),h!==e?(l=p(),l!==e?c=f=[f,k,h,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);d!==e?a=b=ya(b,d):(g=a,a=e)}else g=a,a=e;return a}function p(){var a,b,d,c,f,k,h,l;a=g;b=D();if(b!==e){d=[];c=g;f=A();f!==e?(k=ja(),k!==e?(h=A(),h!==e?(l=D(),l!==e?c=f=[f,k,h,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);for(;c!==e;)d.push(c),c=g,f=A(),f!==e?(k=ja(),k!==e?(h=A(),h!==e?(l=D(),l!==e?c=f=[f,k,h,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);d!==e?a=b=
ya(b,d):(g=a,a=e)}else g=a,a=e;return a}function D(){var b,d,c,k,h;b=g;d=ia();d===e&&(d=g,33===a.charCodeAt(g)?(c=$c,g++):(c=e,0===x&&f(ad)),c!==e?(k=g,x++,61===a.charCodeAt(g)?(h=$a,g++):(h=e,0===x&&f(ab)),x--,h===e?k=void 0:(g=k,k=e),k!==e?d=c=[c,k]:(g=d,d=e)):(g=d,d=e));d!==e?(c=A(),c!==e?(k=D(),k!==e?b=d={type:"unary_expr",operator:"NOT",expr:k}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e);if(b===e)if(b=g,d=I(),d!==e)if(c=A(),c!==e){var l,m,t;c=[];k=g;h=A();h!==e?(l=n(),l!==e?(m=A(),m!==e?(t=I(),t!==e?k=h=
[h,l,m,t]:(g=k,k=e)):(g=k,k=e)):(g=k,k=e)):(g=k,k=e);if(k!==e)for(;k!==e;)c.push(k),k=g,h=A(),h!==e?(l=n(),l!==e?(m=A(),m!==e?(t=I(),t!==e?k=h=[h,l,m,t]:(g=k,k=e)):(g=k,k=e)):(g=k,k=e)):(g=k,k=e);else c=e;c!==e&&(c={type:"arithmetic",tail:c});c===e&&(c=g,k=E(),k!==e?(h=A(),h!==e?(h=ea(),h!==e?(h=A(),h!==e?(h=q(),h!==e?(l=A(),l!==e?(l=fa(),l!==e?c=k={op:k,right:h}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,k=E(),k!==e?(h=A(),h!==e?(h=ea(),h!==e?(h=A(),h!==
e?(h=fa(),h!==e?c=k={op:k,right:{type:"expr_list",value:[]}}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,k=E(),k!==e?(h=A(),h!==e?(h=W(),h!==e?c=k={op:k,right:h}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e))),c===e&&(c=g,h=ia(),h!==e?(k=A(),k!==e?(k=Xa(),k!==e?(l=A(),l!==e?(l=I(),l!==e?(m=A(),m!==e?(m=ja(),m!==e?(h=A(),h!==e?(h=I(),h!==e?c=h={op:"NOT"+k,right:{type:"expr_list",value:[l,h]}}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),
c===e&&(c=g,h=Xa(),h!==e?(k=A(),k!==e?(k=I(),k!==e?(l=A(),l!==e?(l=ja(),l!==e?(m=A(),m!==e?(m=I(),m!==e?c=h={op:h,right:{type:"expr_list",value:[k,m]}}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)),c===e&&(c=g,k=Z(),k!==e?(h=A(),h!==e?(h=ia(),h!==e?(h=A(),h!==e?(h=I(),h!==e?c=k={op:k+"NOT",right:h}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,k=Z(),k!==e?(h=A(),h!==e?(h=I(),h!==e?c=k={op:k,right:h}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)),c===e&&(c=g,k=
w(),k!==e?(h=A(),h!==e?(h=r(),h!==e?(l=A(),l!==e?(l=g,a.substr(g,6).toLowerCase()===bd?(m=a.substr(g,6),g+=6):(m=e,0===x&&f(cd)),m!==e?(m=g,x++,t=C(),x--,t===e?m=void 0:(g=m,m=e),m!==e?l="ESCAPE":(g=l,l=e)):(g=l,l=e),l!==e?(l=A(),l!==e?(l=G(),l!==e?c=k={op:k,right:h,escape:l.value}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,k=w(),k!==e?(h=A(),h!==e?(h=r(),h!==e?c=k={op:k,right:h,escape:""}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e))))));c===e&&(c=null);c!==e?(b=d,
d=c,""==d||void 0==d||null==d?d=b:(c=null,d=c="arithmetic"==d.type?ya(b,d.tail):bb(d.op,b,d.right,d.escape)),b=d):(g=b,b=e)}else g=b,b=e;else g=b,b=e;return b}function n(){var b;a.substr(g,2)===cb?(b=cb,g+=2):(b=e,0===x&&f(dd));b===e&&(62===a.charCodeAt(g)?(b=ed,g++):(b=e,0===x&&f(fd)),b===e&&(a.substr(g,2)===db?(b=db,g+=2):(b=e,0===x&&f(gd)),b===e&&(a.substr(g,2)===eb?(b=eb,g+=2):(b=e,0===x&&f(hd)),b===e&&(60===a.charCodeAt(g)?(b=id,g++):(b=e,0===x&&f(jd)),b===e&&(61===a.charCodeAt(g)?(b=$a,g++):
(b=e,0===x&&f(ab)),b===e&&(a.substr(g,2)===fb?(b=fb,g+=2):(b=e,0===x&&f(kd))))))));return b}function w(){var a,b,c,d;a=a=g;b=ia();b!==e?(c=A(),c!==e?(d=O(),d!==e?a=b=[b,c,d]:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=O());return a}function E(){var a,b,c,d;a=a=g;b=ia();b!==e?(c=A(),c!==e?(d=Y(),d!==e?a=b=[b,c,d]:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=Y());return a}function I(){var a,b,c,d,f,h,l,r;a=g;b=t();if(b!==e){c=[];d=g;f=A();f!==e?(h=k(),h!==
e?(l=A(),l!==e?(r=t(),r!==e?d=f=[f,h,l,r]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);for(;d!==e;)c.push(d),d=g,f=A(),f!==e?(h=k(),h!==e?(l=A(),l!==e?(r=t(),r!==e?d=f=[f,h,l,r]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);c!==e?a=b=ya(b,c):(g=a,a=e)}else g=a,a=e;return a}function k(){var b;43===a.charCodeAt(g)?(b=ac,g++):(b=e,0===x&&f(bc));b===e&&(45===a.charCodeAt(g)?(b=cc,g++):(b=e,0===x&&f(dc)));return b}function t(){var a,b,c,d,f,k,h,l;a=g;b=F();if(b!==e){c=[];d=g;f=A();f!==e?(k=z(),k!==e?(h=A(),
h!==e?(l=F(),l!==e?d=f=[f,k,h,l]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);for(;d!==e;)c.push(d),d=g,f=A(),f!==e?(k=z(),k!==e?(h=A(),h!==e?(l=F(),l!==e?d=f=[f,k,h,l]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);c!==e?a=b=ya(b,c):(g=a,a=e)}else g=a,a=e;return a}function z(){var b;42===a.charCodeAt(g)?(b=ld,g++):(b=e,0===x&&f(md));b===e&&(47===a.charCodeAt(g)?(b=nd,g++):(b=e,0===x&&f(od)));return b}function F(){var b,c,d,k,h,l,m;m=G();if(m===e){var t,u,n,z;t=g;var p,F,w,v;p=g;F=va();F!==e?(w=Wa(),w!==
e?(v=Ca(),v!==e?p=F=parseFloat(F+w+v):(g=p,p=e)):(g=p,p=e)):(g=p,p=e);p===e&&(p=g,F=va(),F!==e?(w=Wa(),w!==e?p=F=parseFloat(F+w):(g=p,p=e)):(g=p,p=e),p===e&&(p=g,F=va(),F!==e?(w=Ca(),w!==e?p=F=parseFloat(F+w):(g=p,p=e)):(g=p,p=e),p===e&&(p=g,F=va(),F!==e&&(F=parseFloat(F)),p=F)));u=p;u!==e?(n=g,x++,z=N(),x--,z===e?n=void 0:(g=n,n=e),n!==e?t=u={type:"number",value:u}:(g=t,t=e)):(g=t,t=e);m=t;if(m===e){var D,L;D=g;var B,E,I,O;B=g;a.substr(g,4).toLowerCase()===pd?(E=a.substr(g,4),g+=4):(E=e,0===x&&f(qd));
E!==e?(I=g,x++,O=C(),x--,O===e?I=void 0:(g=I,I=e),I!==e?B=E=[E,I]:(g=B,B=e)):(g=B,B=e);L=B;L!==e&&(L={type:"bool",value:!0});D=L;if(D===e){D=g;var ca,da,ia,Xa;ca=g;a.substr(g,5).toLowerCase()===rd?(da=a.substr(g,5),g+=5):(da=e,0===x&&f(sd));da!==e?(ia=g,x++,Xa=C(),x--,Xa===e?ia=void 0:(g=ia,ia=e),ia!==e?ca=da=[da,ia]:(g=ca,ca=e)):(g=ca,ca=e);L=ca;L!==e&&(L={type:"bool",value:!1});D=L}m=D;if(m===e){var Z,ja,wa,aa,ya;ja=g;a.substr(g,4).toLowerCase()===td?(wa=a.substr(g,4),g+=4):(wa=e,0===x&&f(ud));
wa!==e?(aa=g,x++,ya=C(),x--,ya===e?aa=void 0:(g=aa,aa=e),aa!==e?ja=wa=[wa,aa]:(g=ja,ja=e)):(g=ja,ja=e);Z=ja;Z!==e&&(Z={type:"null",value:null});m=Z;if(m===e){var sa,xa,Ea,Ba;sa=g;var Fa,ua,gb,Ma;Fa=g;a.substr(g,4).toLowerCase()===vd?(ua=a.substr(g,4),g+=4):(ua=e,0===x&&f(wd));ua!==e?(gb=g,x++,Ma=C(),x--,Ma===e?gb=void 0:(g=gb,gb=e),gb!==e?Fa=ua="DATE":(g=Fa,Fa=e)):(g=Fa,Fa=e);xa=Fa;xa!==e?(Ea=A(),Ea!==e?(Ba=r(),Ba!==e?sa=xa={type:"date",value:Ba.value}:(g=sa,sa=e)):(g=sa,sa=e)):(g=sa,sa=e);m=sa;if(m===
e){var ta,ec,Ya,fc;ta=g;var Ga,Eb,hb,Za;Ga=g;a.substr(g,9).toLowerCase()===xd?(Eb=a.substr(g,9),g+=9):(Eb=e,0===x&&f(yd));Eb!==e?(hb=g,x++,Za=C(),x--,Za===e?hb=void 0:(g=hb,hb=e),hb!==e?Ga=Eb="TIMESTAMP":(g=Ga,Ga=e)):(g=Ga,Ga=e);ec=Ga;ec!==e?(Ya=A(),Ya!==e?(fc=r(),fc!==e?ta=ec={type:"timestamp",value:fc.value}:(g=ta,ta=e)):(g=ta,ta=e)):(g=ta,ta=e);m=ta;if(m===e){var P,Na,Fb,qa,Gb,Oa,$a,gc;P=g;Na=uc();Na!==e?(Fb=A(),Fb!==e?(45===a.charCodeAt(g)?(qa=cc,g++):(qa=e,0===x&&f(dc)),qa===e&&(43===a.charCodeAt(g)?
(qa=ac,g++):(qa=e,0===x&&f(bc))),qa!==e?(Gb=A(),Gb!==e?(Oa=r(),Oa!==e?($a=A(),$a!==e?(gc=X(),gc!==e?P=Na={type:"interval",value:Oa,qualifier:gc,op:qa}:(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e);P===e&&(P=g,Na=uc(),Na!==e?(Fb=A(),Fb!==e?(qa=r(),qa!==e?(Gb=A(),Gb!==e?(Oa=X(),Oa!==e?P=Na={type:"interval",value:qa,qualifier:Oa,op:""}:(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e));m=P}}}}}}b=m;if(b===e){var T,hc,ab,bb,cb,ic,db,eb,fb,jc,rb,sb;T=g;var Ha,Hb,ib,tb;
Ha=g;a.substr(g,7).toLowerCase()===zd?(Hb=a.substr(g,7),g+=7):(Hb=e,0===x&&f(Ad));Hb!==e?(ib=g,x++,tb=C(),x--,tb===e?ib=void 0:(g=ib,ib=e),ib!==e?Ha=Hb="EXTRACT":(g=Ha,Ha=e)):(g=Ha,Ha=e);hc=Ha;if(hc!==e)if(ab=A(),ab!==e)if(bb=ea(),bb!==e)if(cb=A(),cb!==e){var ka;ka=vc();ka===e&&(ka=wc(),ka===e&&(ka=xc(),ka===e&&(ka=yc(),ka===e&&(ka=zc(),ka===e&&(ka=Da())))));ic=ka;ic!==e?(db=A(),db!==e?(eb=$b(),eb!==e?(fb=A(),fb!==e?(jc=y(),jc!==e?(rb=A(),rb!==e?(sb=fa(),sb!==e?T=hc={type:"function",name:"extract",
args:{type:"expr_list",value:[{type:"string",value:ic},jc]}}:(g=T,T=e)):(g=T,T=e)):(g=T,T=e)):(g=T,T=e)):(g=T,T=e)):(g=T,T=e)):(g=T,T=e)}else g=T,T=e;else g=T,T=e;else g=T,T=e;else g=T,T=e;b=T;if(b===e){var R,kc,ub,vb,wb,Ib,xb,yb,zb,Jb,Ab,ga,Pa,lc,mc,nc;R=g;var Ia,Kb,jb,Bb;Ia=g;a.substr(g,9).toLowerCase()===Bd?(Kb=a.substr(g,9),g+=9):(Kb=e,0===x&&f(Cd));Kb!==e?(jb=g,x++,Bb=C(),x--,Bb===e?jb=void 0:(g=jb,jb=e),jb!==e?Ia=Kb="SUBSTRING":(g=Ia,Ia=e)):(g=Ia,Ia=e);kc=Ia;if(kc!==e)if(ub=A(),ub!==e)if(vb=
ea(),vb!==e)if(wb=A(),wb!==e)if(Ib=y(),Ib!==e)if(xb=A(),xb!==e)if(yb=$b(),yb!==e)if(zb=A(),zb!==e)if(Jb=y(),Jb!==e)if(Ab=A(),Ab!==e){ga=g;var Ja,Lb,kb,Ac;Ja=g;a.substr(g,3).toLowerCase()===Dd?(Lb=a.substr(g,3),g+=3):(Lb=e,0===x&&f(Ed));Lb!==e?(kb=g,x++,Ac=C(),x--,Ac===e?kb=void 0:(g=kb,kb=e),kb!==e?Ja=Lb="FOR":(g=Ja,Ja=e)):(g=Ja,Ja=e);Pa=Ja;Pa!==e?(lc=A(),lc!==e?(mc=y(),mc!==e?(nc=A(),nc!==e?ga=Pa=[Pa,lc,mc,nc]:(g=ga,ga=e)):(g=ga,ga=e)):(g=ga,ga=e)):(g=ga,ga=e);ga===e&&(ga=null);ga!==e?(Pa=fa(),Pa!==
e?R=kc={type:"function",name:"substring",args:{type:"expr_list",value:ga?[Ib,Jb,ga[2]]:[Ib,Jb]}}:(g=R,R=e)):(g=R,R=e)}else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;b=R;if(b===e){var K,Qa,Mb,Nb,Ob,la,Pb,Ra,Qb,Rb,Bc,oc,Cc,Dc;K=g;Qa=tc();Qa!==e?(Mb=A(),Mb!==e?(Nb=ea(),Nb!==e?(Ob=A(),Ob!==e?(la=ha(),la===e&&(la=null),la!==e?(Pb=A(),Pb!==e?(Ra=y(),Ra!==e?(Qb=A(),Qb!==e?(Rb=$b(),Rb!==e?(Bc=A(),Bc!==e?(oc=y(),oc!==e?(Cc=
A(),Cc!==e?(Dc=fa(),Dc!==e?K=Qa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==la?"BOTH":la},Ra,oc]}}:(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e);K===e&&(K=g,Qa=tc(),Qa!==e?(Mb=A(),Mb!==e?(Nb=ea(),Nb!==e?(Ob=A(),Ob!==e?(la=ha(),la===e&&(la=null),la!==e?(Pb=A(),Pb!==e?(Ra=y(),Ra!==e?(Qb=A(),Qb!==e?(Rb=fa(),Rb!==e?K=Qa={type:"function",name:"trim",args:{type:"expr_list",
value:[{type:"string",value:null==la?"BOTH":la},Ra]}}:(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e)):(g=K,K=e));b=K;if(b===e){var U,pc,Ec,Fc,Gc,qc,Hc,Ic,Jc,rc,Kc,Lc;U=g;var Ka,Sb,lb,Mc;Ka=g;a.substr(g,8).toLowerCase()===Fd?(Sb=a.substr(g,8),g+=8):(Sb=e,0===x&&f(Gd));Sb!==e?(lb=g,x++,Mc=C(),x--,Mc===e?lb=void 0:(g=lb,lb=e),lb!==e?Ka=Sb="POSITION":(g=Ka,Ka=e)):(g=Ka,Ka=e);pc=Ka;pc!==e?(Ec=A(),Ec!==e?(Fc=ea(),Fc!==e?(Gc=A(),Gc!==e?(qc=y(),qc!==e?(Hc=A(),Hc!==
e?(Ic=Y(),Ic!==e?(Jc=A(),Jc!==e?(rc=y(),rc!==e?(Kc=A(),Kc!==e?(Lc=fa(),Lc!==e?U=pc={type:"function",name:"position",args:{type:"expr_list",value:[qc,rc]}}:(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e);b=U;if(b===e){var ba,Tb,Nc,Oc,Pc,Sa,Qc,Rc;ba=g;var ma,mb,nb,ra;ma=g;ma=mb=S();if(ma===e)if(ma=g,96===a.charCodeAt(g)?(mb=Sc,g++):(mb=e,0===x&&f(Tc)),mb!==e){nb=[];Uc.test(a.charAt(g))?(ra=a.charAt(g),g++):(ra=e,0===x&&f(Vc));if(ra!==
e)for(;ra!==e;)nb.push(ra),Uc.test(a.charAt(g))?(ra=a.charAt(g),g++):(ra=e,0===x&&f(Vc));else nb=e;nb!==e?(96===a.charCodeAt(g)?(ra=Sc,g++):(ra=e,0===x&&f(Tc)),ra!==e?ma=mb=nb.join(""):(g=ma,ma=e)):(g=ma,ma=e)}else g=ma,ma=e;Tb=ma;Tb!==e?(Nc=A(),Nc!==e?(Oc=ea(),Oc!==e?(Pc=A(),Pc!==e?(Sa=q(),Sa===e&&(Sa=null),Sa!==e?(Qc=A(),Qc!==e?(Rc=fa(),Rc!==e?ba=Tb={type:"function",name:Tb,args:Sa?Sa:{type:"expr_list",value:[]}}:(g=ba,ba=e)):(g=ba,ba=e)):(g=ba,ba=e)):(g=ba,ba=e)):(g=ba,ba=e)):(g=ba,ba=e)):(g=ba,
ba=e);b=ba;if(b===e){var Ub,M,Ta,Vb,Ua,Wb,za,na,ob,Wc,Xc;M=g;Ta=Cb();if(Ta!==e)if(Vb=A(),Vb!==e)if(Ua=y(),Ua!==e)if(Wb=A(),Wb!==e){za=[];for(na=J();na!==e;)za.push(na),na=J();za!==e?(na=A(),na!==e?(ob=Db(),ob!==e?M=Ta={type:"case_expression",format:"simple",operand:Ua,clauses:za,else:null}:(g=M,M=e)):(g=M,M=e)):(g=M,M=e)}else g=M,M=e;else g=M,M=e;else g=M,M=e;else g=M,M=e;if(M===e)if(M=g,Ta=Cb(),Ta!==e)if(Vb=A(),Vb!==e)if(Ua=y(),Ua!==e)if(Wb=A(),Wb!==e){za=[];for(na=J();na!==e;)za.push(na),na=J();
za!==e?(na=A(),na!==e?(ob=pa(),ob!==e?(Wc=A(),Wc!==e?(Xc=Db(),Xc!==e?M=Ta={type:"case_expression",format:"simple",operand:Ua,clauses:za,else:ob.value}:(g=M,M=e)):(g=M,M=e)):(g=M,M=e)):(g=M,M=e)):(g=M,M=e)}else g=M,M=e;else g=M,M=e;else g=M,M=e;else g=M,M=e;Ub=M;if(Ub===e){var Q,Va,Xb,Aa,oa,pb,Yc,Zc;Q=g;Va=Cb();if(Va!==e)if(Xb=A(),Xb!==e){Aa=[];for(oa=H();oa!==e;)Aa.push(oa),oa=H();Aa!==e?(oa=A(),oa!==e?(pb=Db(),pb!==e?Q=Va={type:"case_expression",format:"searched",clauses:Aa,else:null}:(g=Q,Q=e)):
(g=Q,Q=e)):(g=Q,Q=e)}else g=Q,Q=e;else g=Q,Q=e;if(Q===e)if(Q=g,Va=Cb(),Va!==e)if(Xb=A(),Xb!==e){Aa=[];for(oa=H();oa!==e;)Aa.push(oa),oa=H();Aa!==e?(oa=A(),oa!==e?(pb=pa(),pb!==e?(Yc=A(),Yc!==e?(Zc=Db(),Zc!==e?Q=Va={type:"case_expression",format:"searched",clauses:Aa,else:pb.value}:(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)}else g=Q,Q=e;else g=Q,Q=e;Ub=Q}b=Ub;if(b===e){var qb,La,sc,Yb,Zb;La=g;sc=N();if(sc!==e){Yb=[];for(Zb=V();Zb!==e;)Yb.push(Zb),Zb=V();Yb!==e?La=sc+=Yb.join(""):(g=La,La=
e)}else g=La,La=e;qb=La;qb!==e&&(qb={type:"column_ref",table:"",column:qb});b=qb;b===e&&(b=W(),b===e&&(b=g,c=ea(),c!==e?(d=A(),d!==e?(k=y(),k!==e?(h=A(),h!==e?(l=fa(),l!==e?(k.paren=!0,b=c=k):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)))}}}}}}}return b}function S(){var a,b,c,d;a=g;b=N();if(b!==e){c=[];for(d=C();d!==e;)c.push(d),d=C();c!==e?a=b+=c.join(""):(g=a,a=e)}else g=a,a=e;return a}function N(){var b;Hd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(Id));return b}function C(){var b;
Jd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(Kd));return b}function V(){var b;Ld.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(Md));return b}function W(){var b,c,d;b=g;64===a.charCodeAt(g)?(c=Nd,g++):(c=e,0===x&&f(Od));c!==e?(d=S(),d!==e?b=c=[c,d]:(g=b,b=e)):(g=b,b=e);b!==e&&(b={type:"param",value:b[1]});return b}function ha(){var b,c,d;b=g;a.substr(g,7).toLowerCase()===Pd?(c=a.substr(g,7),g+=7):(c=e,0===x&&f(Qd));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="LEADING":
(g=b,b=e)):(g=b,b=e);b===e&&(b=g,a.substr(g,8).toLowerCase()===Rd?(c=a.substr(g,8),g+=8):(c=e,0===x&&f(Sd)),c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="TRAILING":(g=b,b=e)):(g=b,b=e),b===e&&(b=g,a.substr(g,4).toLowerCase()===Td?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ud)),c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="BOTH":(g=b,b=e)):(g=b,b=e)));return b}function X(){var b,c,d;b=g;var k,h;c=g;d=L();d!==e?(k=A(),k!==e?(k=ea(),k!==e?(k=A(),k!==e?(k=u(),k!==e?(h=A(),h!==e?(h=
fa(),h!==e?c=d={type:"interval-period",period:d.value,precision:k,secondary:null}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);c===e&&(c=g,d=L(),d!==e&&(d=rb(d)),c=d);if(c!==e)if(d=A(),d!==e)if(d=g,a.substr(g,2).toLowerCase()===Vd?(k=a.substr(g,2),g+=2):(k=e,0===x&&f(Wd)),k!==e?(k=g,x++,h=C(),x--,h===e?k=void 0:(g=k,k=e),k!==e?d="TO":(g=d,d=e)):(g=d,d=e),d!==e)if(d=A(),d!==e){var l;d=g;k=L();k!==e&&(k={type:"interval-period",period:k.value,precision:null,secondary:null});
d=k;d===e&&(d=g,k=Da(),k!==e?(k=A(),k!==e?(k=ea(),k!==e?(k=A(),k!==e?(k=u(),k!==e?(h=A(),h!==e?(h=xa(),h!==e?(h=A(),h!==e?(h=m(),h!==e?(l=A(),l!==e?(l=fa(),l!==e?d=k=sb(k,h):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,k=Da(),k!==e?(k=A(),k!==e?(k=ea(),k!==e?(k=A(),k!==e?(k=u(),k!==e?(h=A(),h!==e?(h=fa(),h!==e?d=k={type:"interval-period",period:"second",precision:k,secondary:null}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):
(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,k=Da(),k!==e&&(k={type:"interval-period",period:"second",precision:null,secondary:null}),d=k)));d!==e?b=c={type:"interval-qualifier",start:c,end:d}:(g=b,b=e)}else g=b,b=e;else g=b,b=e;else g=b,b=e;else g=b,b=e;b===e&&(b=g,d=L(),d!==e?(c=A(),c!==e?(c=ea(),c!==e?(c=A(),c!==e?(c=m(),c!==e?(k=A(),k!==e?(k=fa(),k!==e?b=d={type:"interval-period",period:d.value,precision:c,secondary:null}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=
e)):(g=b,b=e),b===e&&(b=g,d=L(),d!==e&&(d=rb(d)),b=d,b===e&&(b=g,d=Da(),d!==e?(c=A(),c!==e?(c=ea(),c!==e?(c=A(),c!==e?(c=u(),c!==e?(k=A(),k!==e?(k=xa(),k!==e?(d=A(),d!==e?(d=m(),d!==e?(k=A(),k!==e?(k=fa(),k!==e?b=d=sb(c,d):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e),b===e&&(b=g,d=Da(),d!==e?(c=A(),c!==e?(c=ea(),c!==e?(c=A(),c!==e?(c=m(),c!==e?(k=A(),k!==e?(k=fa(),k!==e?b=d={type:"interval-period",period:"second",precision:c,
secondary:null}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e),b===e&&(b=g,d=Da(),d!==e&&(d={type:"interval-period",period:"second",precision:null,secondary:null}),b=d)))));return b}function L(){var a;a=g;a=xc();a!==e&&(a={type:"string",value:"day"});a===e&&(a=g,a=yc(),a!==e&&(a={type:"string",value:"hour"}),a===e&&(a=g,a=zc(),a!==e&&(a={type:"string",value:"minute"}),a===e&&(a=g,a=wc(),a!==e&&(a={type:"string",value:"month"}),a===e&&(a=g,a=vc(),a!==e&&(a={type:"string",
value:"year"})))));return a}function m(){var a;a=ca();a!==e&&(a=parseFloat(a));return a}function u(){var a;a=ca();a!==e&&(a=parseFloat(a));return a}function r(){var a;a=G();a===e&&(a=W());return a}function G(){var b,c,d;b=g;39===a.charCodeAt(g)?(c=tb,g++):(c=e,0===x&&f(ub));c===e&&(a.substr(g,2)===vb?(c=vb,g+=2):(c=e,0===x&&f(Xd)));if(c!==e){c=[];d=g;a.substr(g,2)===Ba?(d=Ba,g+=2):(d=e,0===x&&f(wb));d!==e&&(d="'");d===e&&(xb.test(a.charAt(g))?(d=a.charAt(g),g++):(d=e,0===x&&f(yb)));for(;d!==e;)c.push(d),
d=g,a.substr(g,2)===Ba?(d=Ba,g+=2):(d=e,0===x&&f(wb)),d!==e&&(d="'"),d===e&&(xb.test(a.charAt(g))?(d=a.charAt(g),g++):(d=e,0===x&&f(yb)));c!==e?(39===a.charCodeAt(g)?(d=tb,g++):(d=e,0===x&&f(ub)),d!==e?b=c={type:"string",value:c.join("")}:(g=b,b=e)):(g=b,b=e)}else g=b,b=e;return b}function H(){var a,b,c;a=g;b=Ya();b!==e?(b=A(),b!==e?(b=y(),b!==e?(c=A(),c!==e?(c=Za(),c!==e?(c=A(),c!==e?(c=y(),c!==e?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=
a,a=e)):(g=a,a=e);return a}function J(){var a,b,c;a=g;b=Ya();b!==e?(b=A(),b!==e?(b=y(),b!==e?(c=A(),c!==e?(c=Za(),c!==e?(c=A(),c!==e?(c=y(),c!==e?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function pa(){var b,c;b=g;var d,k;c=g;a.substr(g,4).toLowerCase()===Yd?(d=a.substr(g,4),g+=4):(d=e,0===x&&f(Zd));d!==e?(d=g,x++,k=C(),x--,k===e?d=void 0:(g=d,d=e),d!==e?c="ELSE":(g=c,c=e)):(g=c,c=e);c!==e?(c=A(),c!==e?(c=y(),c!==
e?b={type:"else_clause",value:c}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e);return b}function va(){var b,c,d;b=ca();b===e&&(b=g,45===a.charCodeAt(g)?(c=cc,g++):(c=e,0===x&&f(dc)),c===e&&(43===a.charCodeAt(g)?(c=ac,g++):(c=e,0===x&&f(bc))),c!==e?(d=ca(),d!==e?b=c=c[0]+d:(g=b,b=e)):(g=b,b=e));return b}function Wa(){var b,c;b=g;46===a.charCodeAt(g)?(c=$d,g++):(c=e,0===x&&f(ae));c!==e?(c=ca(),c===e&&(c=null),c!==e?b="."+(null!=c?c:""):(g=b,b=e)):(g=b,b=e);return b}function Ca(){var b,c,d;c=b=g;be.test(a.charAt(g))?
(d=a.charAt(g),g++):(d=e,0===x&&f(ce));d!==e?(de.test(a.charAt(g))?(d=a.charAt(g),g++):(d=e,0===x&&f(ee)),d===e&&(d=null),d!==e?c="e"+(null===d?"":d):(g=c,c=e)):(g=c,c=e);c!==e?(d=ca(),d!==e?b=c+d:(g=b,b=e)):(g=b,b=e);return b}function ca(){var a,b;a=[];b=da();if(b!==e)for(;b!==e;)a.push(b),b=da();else a=e;a!==e&&(a=a.join(""));return a}function da(){var b;fe.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(ge));return b}function Y(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===he?(c=a.substr(g,
2),g+=2):(c=e,0===x&&f(ie));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="IN":(g=b,b=e)):(g=b,b=e);return b}function Z(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===je?(c=a.substr(g,2),g+=2):(c=e,0===x&&f(ke));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="IS":(g=b,b=e)):(g=b,b=e);return b}function O(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===le?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(me));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="LIKE":(g=b,b=e)):(g=b,b=
e);return b}function ia(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===ne?(c=a.substr(g,3),g+=3):(c=e,0===x&&f(oe));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="NOT":(g=b,b=e)):(g=b,b=e);return b}function ja(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===pe?(c=a.substr(g,3),g+=3):(c=e,0===x&&f(qe));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="AND":(g=b,b=e)):(g=b,b=e);return b}function wa(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===re?(c=a.substr(g,2),g+=2):(c=e,0===x&&
f(se));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="OR":(g=b,b=e)):(g=b,b=e);return b}function Xa(){var b,c,d;b=g;a.substr(g,7).toLowerCase()===te?(c=a.substr(g,7),g+=7):(c=e,0===x&&f(ue));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="BETWEEN":(g=b,b=e)):(g=b,b=e);return b}function $b(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===ve?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(we));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="FROM":(g=b,b=e)):(g=b,b=e);return b}function tc(){var b,
c,d;b=g;a.substr(g,4).toLowerCase()===xe?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(ye));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="TRIM":(g=b,b=e)):(g=b,b=e);return b}function uc(){var b,c,d;b=g;a.substr(g,8).toLowerCase()===ze?(c=a.substr(g,8),g+=8):(c=e,0===x&&f(Ae));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="INTERVAL":(g=b,b=e)):(g=b,b=e);return b}function vc(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Be?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ce));c!==e?(c=g,x++,d=C(),
x--,d===e?c=void 0:(g=c,c=e),c!==e?b="YEAR":(g=b,b=e)):(g=b,b=e);return b}function wc(){var b,c,d;b=g;a.substr(g,5).toLowerCase()===De?(c=a.substr(g,5),g+=5):(c=e,0===x&&f(Ee));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="MONTH":(g=b,b=e)):(g=b,b=e);return b}function xc(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===Fe?(c=a.substr(g,3),g+=3):(c=e,0===x&&f(Ge));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="DAY":(g=b,b=e)):(g=b,b=e);return b}function yc(){var b,c,d;b=g;a.substr(g,
4).toLowerCase()===He?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ie));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="HOUR":(g=b,b=e)):(g=b,b=e);return b}function zc(){var b,c,d;b=g;a.substr(g,6).toLowerCase()===Je?(c=a.substr(g,6),g+=6):(c=e,0===x&&f(Ke));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="MINUTE":(g=b,b=e)):(g=b,b=e);return b}function Da(){var b,c,d;b=g;a.substr(g,6).toLowerCase()===Le?(c=a.substr(g,6),g+=6):(c=e,0===x&&f(Me));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:
(g=c,c=e),c!==e?b="SECOND":(g=b,b=e)):(g=b,b=e);return b}function Cb(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Ne?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Oe));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="CASE":(g=b,b=e)):(g=b,b=e);return b}function Db(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===Pe?(c=a.substr(g,3),g+=3):(c=e,0===x&&f(Qe));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="END":(g=b,b=e)):(g=b,b=e);return b}function Ya(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===
Re?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Se));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="WHEN":(g=b,b=e)):(g=b,b=e);return b}function Za(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Te?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ue));c!==e?(c=g,x++,d=C(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="THEN":(g=b,b=e)):(g=b,b=e);return b}function xa(){var b;44===a.charCodeAt(g)?(b=Ve,g++):(b=e,0===x&&f(We));return b}function ea(){var b;40===a.charCodeAt(g)?(b=Xe,g++):(b=e,0===x&&f(Ye));return b}function fa(){var b;
41===a.charCodeAt(g)?(b=Ze,g++):(b=e,0===x&&f($e));return b}function A(){var a,b;a=[];for(b=zb();b!==e;)a.push(b),b=zb();return a}function zb(){var b;af.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(bf));return b}function bb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function ya(a,b){for(var c=0;c<b.length;c++)a=bb(b[c][1],a,b[c][3]);return a}v=void 0!==v?v:{};var e={},Ab={start:l},Bb=l,$c="!",ad=h("!",!1),$a="\x3d",ab=h("\x3d",!1),cb="\x3e\x3d",
dd=h("\x3e\x3d",!1),ed="\x3e",fd=h("\x3e",!1),db="\x3c\x3d",gd=h("\x3c\x3d",!1),eb="\x3c\x3e",hd=h("\x3c\x3e",!1),id="\x3c",jd=h("\x3c",!1),fb="!\x3d",kd=h("!\x3d",!1),ac="+",bc=h("+",!1),cc="-",dc=h("-",!1),ld="*",md=h("*",!1),nd="/",od=h("/",!1),Hd=/^[A-Za-z_\x80-\uFFFF]/,Id=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Jd=/^[A-Za-z0-9_]/,Kd=b([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ld=/^[A-Za-z0-9_.\x80-\uFFFF]/,Md=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),
Nd="@",Od=h("@",!1),rb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},sb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},tb="'",ub=h("'",!1),vb="N'",Xd=h("N'",!1),Ba="''",wb=h("''",!1),xb=/^[^']/,yb=b(["'"],!0,!1),$d=".",ae=h(".",!1),fe=/^[0-9]/,ge=b([["0","9"]],!1,!1),be=/^[eE]/,ce=b(["e","E"],!1,!1),de=/^[+\-]/,ee=b(["+","-"],!1,!1),td="null",ud=h("NULL",!0),pd="true",qd=h("TRUE",!0),rd="false",sd=h("FALSE",!0),he="in",
ie=h("IN",!0),je="is",ke=h("IS",!0),le="like",me=h("LIKE",!0),bd="escape",cd=h("ESCAPE",!0),ne="not",oe=h("NOT",!0),pe="and",qe=h("AND",!0),re="or",se=h("OR",!0),te="between",ue=h("BETWEEN",!0),ve="from",we=h("FROM",!0),Dd="for",Ed=h("FOR",!0),Bd="substring",Cd=h("SUBSTRING",!0),zd="extract",Ad=h("EXTRACT",!0),xe="trim",ye=h("TRIM",!0),Fd="position",Gd=h("POSITION",!0),xd="timestamp",yd=h("TIMESTAMP",!0),vd="date",wd=h("DATE",!0),Pd="leading",Qd=h("LEADING",!0),Rd="trailing",Sd=h("TRAILING",!0),Td=
"both",Ud=h("BOTH",!0),Vd="to",Wd=h("TO",!0),ze="interval",Ae=h("INTERVAL",!0),Be="year",Ce=h("YEAR",!0),De="month",Ee=h("MONTH",!0),Fe="day",Ge=h("DAY",!0),He="hour",Ie=h("HOUR",!0),Je="minute",Ke=h("MINUTE",!0),Le="second",Me=h("SECOND",!0),Ne="case",Oe=h("CASE",!0),Pe="end",Qe=h("END",!0),Re="when",Se=h("WHEN",!0),Te="then",Ue=h("THEN",!0),Yd="else",Zd=h("ELSE",!0),Ve=",",We=h(",",!1),Xe="(",Ye=h("(",!1),Ze=")",$e=h(")",!1),af=/^[ \t\n\r]/,bf=b([" ","\t","\n","\r"],!1,!1),Sc="`",Tc=h("`",!1),Uc=
/^[^`]/,Vc=b(["`"],!0,!1),g=0,Ea=[{line:1,column:1}],aa=0,Ma=[],x=0,ua;if("startRule"in v){if(!(v.startRule in Ab))throw Error("Can't start parsing from rule \""+v.startRule+'".');Bb=Ab[v.startRule]}ua=Bb();if(ua!==e&&g===a.length)return ua;ua!==e&&g<a.length&&f({type:"end"});throw function(a,b,c){return new B(B.buildMessage(a,b),a,b,c)}(Ma,aa<a.length?a.charAt(aa):null,aa<a.length?c(aa,aa+1):c(aa,aa));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(B,a,v,h,b,d,c,f,l){function q(a,b){var c;if(!b)return null;if("x"in b){var d={x:0,y:0};a=a(b.x,b.y,n);d.x=a[0];d.y=a[1];null!=b.z&&(d.z=b.z);null!=b.m&&(d.m=b.m);return d}if("xmin"in b)return d={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,n),d.xmin=c[0],d.ymin=c[1],a=a(b.xmax,b.ymax,n),d.xmax=a[0],d.ymax=a[1],b.hasZ&&(d.zmin=b.zmin,d.zmax=b.zmax,d.hasZ=!0),b.hasM&&(d.mmin=b.mmin,d.mmax=b.mmax,d.hasM=!0),d;if("rings"in b)return{rings:y(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:y(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:p(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function y(a,b){for(var c=[],d=0;d<a.length;d++)c.push(p(a[d],b));return c}function p(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],k=b(f[0],f[1],[0,0]);c.push(k);2<f.length&&k.push(f[2]);3<f.length&&k.push(f[3])}return c}function D(a,b){return!f.isValid(a)||!f.isValid(b)||f.equals(a,b)||l.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var n=[0,0];a.doesBrowserSupportProjection=
function(a,b){return D(a,b)?c.isSupported():!0};a.checkProjectionSupport=function(a,d){return h(this,void 0,void 0,function(){var f,k,h;return v(this,function(l){if(!d)return[2];if(Array.isArray(a)){f=0;for(k=a;f<k.length;f++)if(h=k[f],D(h.geometry&&h.geometry.spatialReference,d)){if(c.isSupported())return[2,c.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:d});}return[2]}if(!D(a,d))return[2];if(c.isSupported())return[2,c.load()];
throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:d});})})};var w=q.bind(null,l.lngLatToXY),E=q.bind(null,l.xyToLngLat);a.project=function(a,b,d){if(!a)return a;d||(d=b,b=a.spatialReference);return f.isValid(b)&&f.isValid(d)&&!f.equals(b,d)?l.canProject(b,d)?f.isWebMercator(d)?w(a):E(a):c.projectMany([a],b,d,null,!0)[0]:a};var I=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,b,c){return h(this,void 0,void 0,function(){var k,h=this;return v(this,function(l){a&&a.length&&b&&c&&!f.equals(b,c)||d.resolve(a);k={geometries:a,inSpatialReference:b,outSpatialReference:c,resolve:null};this._jobs.push(k);return[2,d.create(function(a){k.resolve=a;null===h._timer&&(h._timer=setTimeout(h._process,10))},function(){var a=h._jobs.indexOf(k);-1<a&&h._jobs.splice(a,1)})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,d=
a.inSpatialReference,k=a.outSpatialReference,a=a.resolve;l.canProject(d,k)?f.isWebMercator(k)?a(b.map(w)):a(b.map(E)):a(c.projectMany(b,d,k,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return h(this,void 0,void 0,function(){return v(this,function(d){return[2,I.push(a,b,c)]})})}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(B,a){Object.defineProperty(a,"__esModule",{value:!0});
a.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,
supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/iteratorUtils ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(B,a,v,h,b,d,c,f,l,q,y,p,D,n,w,E){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(q.isValid(a.outSR)&&!q.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=E.cleanFromGeometryEngine(v({spatialReference:a.outSR},n.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=E.cleanFromGeometryEngine(v({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=D.getWhereClause(b.where,this.fieldsIndex);if(!c)return f.resolve(this);if(c.isStandardized){for(var d=0,k=[],h=0,l=this.items;h<l.length;h++){var n=l[h];c.testFeature(n,this.featureAdapter)&&(k[d++]=n)}c=new a(k,this.queryGeometry,this);c.definitionExpression=b.where;return f.resolve(c)}return f.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return f.resolve(this);var c=d.createSetFromValues(b.objectIds),k=this.featureAdapter.getObjectId;return f.resolve(new a(this.items.filter(function(a){return c.has(k(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=w.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!c.isSome(b))return f.resolve(this);b=this.items.filter(b);return f.resolve(new a(b,this.queryGeometry,this))};
a.prototype.project=function(c){return b(this,void 0,void 0,function(){var b,d,f,k=this;return h(this,function(h){switch(h.label){case 0:if(!c||q.equals(this.spatialReference,c))return[2,this];b=this.featureAdapter;return[4,n.projectMany(this.items.map(function(a){return E.getGeometry(k,b.getGeometry(a))}),this.spatialReference,c)];case 1:return d=h.sent(),f=d.map(function(a,c){return b.cloneWithGeometry(k.items[c],y.convertFromGeometry(a,k.hasZ,k.hasM))}),[2,new a(f,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,d=this.geometryType,f=this.hasM,k=this.hasZ,h=this.objectIdField,n=this.spatialReference,q=a.outFields,p=a.outSR,w=a.quantizationParameters,y=a.resultRecordCount,m=a.resultOffset,u=a.returnZ,r=a.returnM,G=!1;null!=y&&
null!=m&&(y=m+y,G=c.length>y,c=c.slice(m,Math.min(c.length,y)));return{exceededTransferLimit:G,features:this._createFeatures(a,c),fields:q&&q.map(function(a){return b.fieldsIndex.get(a)}),geometryType:d,hasM:f&&r,hasZ:k&&u,objectIdFieldName:h,spatialReference:E.cleanFromGeometryEngine(p?p:n),transform:w&&l.toQuantizationTransform(w)||null}};a.prototype._createFeatures=function(a,b){var c=new p.default(a,this.featureAdapter,this.fieldsIndex),d=a.orderByFields,f=a.quantizationParameters,k=a.returnGeometry,
h=a.returnCentroid,n=a.maxAllowableOffset,q=a.returnZ;a=a.returnM;var t=this.hasZ&&(void 0===q?!1:q),w=this.hasM&&(void 0===a?!1:a),q=[];a=0;if(b.length&&d&&d.length){var d=d[0].split(" "),y=d[0],m=this.fieldsIndex.get(y),u="DESC"===d[1];b.sort(function(a,b){a=c.getFieldValue(a,y,m);b=c.getFieldValue(b,y,m);if("number"===typeof a&&"number"===typeof b)return u?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(u?a>b:a<b)?-1:(u?a<b:a>b)?1:0})}if(k||h)if(f=
l.toQuantizationTransform(f),k&&!h)for(h=0;h<b.length;h++)k=b[h],q[a++]={attributes:c.getAttributes(k),geometry:E.getGeometry(this,this.featureAdapter.getGeometry(k),n,f,t,w)};else if(!k&&h)for(n=0;n<b.length;n++)k=b[n],q[a++]={attributes:c.getAttributes(k),centroid:E.transformCentroid(this,this.featureAdapter.getCentroid(k,this),f)};else for(h=0;h<b.length;h++)k=b[h],q[a++]={attributes:c.getAttributes(k),centroid:E.transformCentroid(this,this.featureAdapter.getCentroid(k,this),f),geometry:E.getGeometry(this,
this.featureAdapter.getGeometry(k),n,f,t,w)};else for(n=0;n<b.length;n++)k=b[n],(t=c.getAttributes(k))&&(q[a++]={attributes:t});return q};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,f=0;for(a=a.outStatistics;f<a.length;f++){var k=a[f];if("exceedslimit"===k.statisticType){c=null!=k.maxPointCount?k.maxPointCount:Number.POSITIVE_INFINITY;d=null!=k.maxRecordCount?k.maxRecordCount:Number.POSITIVE_INFINITY;
b=null!=k.maxVertexCount?k.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,h=this.featureAdapter,b=this.items.reduce(function(a,b){b=h.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};
a.prototype._createStatisticsQueryResponse=function(a){var b=new p.default(a,this.featureAdapter,this.fieldsIndex),c=a.outStatistics,d=[],f=[],k=a.groupByFieldsForStatistics;a=a.having;for(var h=k&&k.length,k=h&&k[0],l=this.fieldsIndex.get(k),n=!l,q={},w={},y={},m={attributes:{}},u=0;u<c.length;u++){var r=c[u],G=r.outStatisticFieldName,H=r.statisticType,r="exceedslimit"!==H?r.onStatisticField:void 0,J=this.fieldsIndex.get(r),v=h&&(r===k||n)&&"count"===H;if(h){q[r]||(q[r]=this._calculateUniqueValues(b,
k,l));var D=q[r],B;for(B in D){var E=D[B],I=E.count,da=E.data,Y=E.items;if(!a||b.validateItems(Y,a)){var E=w[da]||{attributes:{}},Z=null;v?Z=I:(I=this._calculateStatistics(Y,b,r,J),Y="var"===H?"variance":H,Z=I[Y]);E.attributes[G]=Z;E.attributes[n?"EXPR_1":k]=da;w[da]=E}}}else y[r]||(y[r]=this._calculateStatistics(this.items,b,r,J)),I=y[r],Y="var"===H?"variance":H,m.attributes[G]=I[Y];f.push({name:G,alias:G,type:"esriFieldTypeDouble"})}if(h)for(var O in w)d.push(w[O]);else d.push(m);return{fields:f,
features:d}};a.prototype._calculateStatistics=function(a,b,c,d){for(var f=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=null,l=null,n=null,q=null,p=[],t=0,m=0;m<a.length;m++){var u=b.getFieldValue(a[m],c,d);"string"===typeof u?t++:null==u||isNaN(u)||(k+=u,f=Math.min(f,u),h=Math.max(h,u),p.push(u),t++)}if(t){l=k/t;for(b=a=0;b<p.length;b++)u=p[b],a+=Math.pow(u-l,2);q=1<t?a/(t-1):0;n=Math.sqrt(q)}else h=f=null;return{avg:l,count:t,max:h,min:f,stddev:n,sum:k,variance:q}};a.prototype._calculateUniqueValues=
function(a,b,c){for(var d={},f=0,h=this.items;f<h.length;f++){var k=h[f],l=a.getFieldValue(k,b,c);if(null==l||"string"===typeof l&&""===l.trim())l=null;null==d[l]?d[l]={count:1,data:l,items:[k]}:(d[l].count++,d[l].items.push(k))}return d};return a}();a.default=B})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(B,a,v,h){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b,f){this._fieldDataCache=
new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=f;this.featureAdapter=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=b=0;c<a.length;c++){var d=a[c],y=h.getExpressionFromFieldName(d),p=this.fieldsIndex.get(y),y=p?null:h.getWhereClause(y,f),p=p?p.name:h.getAliasFromFieldName(d)||"FIELD_EXP_"+b++;this._fieldDataCache.set(d,{alias:p,clause:y})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);
return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,b,f){var c=f?f.name:b,d=null;this._fieldDataCache.has(c)?d=this._fieldDataCache.get(c).clause:f||(d=h.getWhereClause(b,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:d}));return f?this.featureAdapter.getAttribute(a,c):d.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:h.getWhereClause(b,this.fieldsIndex)});
return this._fieldDataCache.get(b).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:h.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var d={},h=0;h<b.length;h++){var q=this._fieldDataCache.get(b[h]),
y=q.alias,q=q.clause;d[y]=q?q.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,y)}return d};a.prototype._processAttributesForDistinctValues=function(a){if(v.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,d=[];if(b)for(var h=0;h<b.length;h++){var q=this._fieldDataCache.get(b[h]).alias;d.push(a[q])}else for(q in a)d.push(a[q]);b=(b||["*"]).join(",")+"\x3d"+d.join(",");d=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++d);return 1<d?null:
a};return a}();a.default=B})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(B,a){function v(a,d,c,f,h){if(null!=f&&null!=h&&f===h)return function(b){return f>=a.getAttribute(b,d)&&f<=a.getAttribute(b,c)};if(null!=f&&null!=h)return function(b){var l=a.getAttribute(b,d);b=a.getAttribute(b,c);return!(l>h||b<f)};if(null!=f)return function(b){return!(a.getAttribute(b,c)<f)};if(null!=h)return function(b){return!(a.getAttribute(b,d)>h)}}function h(a,d,c,f){if(null!=
c&&null!=f&&c===f)return function(b){return a.getAttribute(b,d)===c};if(null!=c&&null!=f)return function(b){return a.getAttribute(b,d)>=c&&a.getAttribute(b,d)<=f};if(null!=c)return function(b){return a.getAttribute(b,d)>=c};if(null!=f)return function(b){return a.getAttribute(b,d)<=f}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,d){if(!a)return null;var b=d.featureAdapter,f=a.startTimeField,h=a.endTimeField,q=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY;if(f&&
h)d.forEach(function(a){var c=b.getAttribute(a,f);a=b.getAttribute(a,h);null==c||isNaN(c)||(q=Math.min(q,c));null==a||isNaN(a)||(y=Math.max(y,a))});else{var p=f||h;d.forEach(function(a){a=b.getAttribute(a,p);null==a||isNaN(a)||(q=Math.min(q,a),y=Math.max(y,a))})}return{start:q,end:y}};a.getTimeOperator=function(a,d,c){if(!d||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var l=d.start;d=d.end;return null==l&&null==d?null:b&&a?v(c,b,a,l,d):h(c,b||a,l,d)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(B,a,v,h,b,d,c,f,l,q,y,p,D,n,w,E,I){function k(a,b,c,d,f){void 0===d&&(d=a.hasZ);void 0===f&&(f=a.hasM);var h=a.hasZ&&d,k=a.hasM&&f;return c?(a=n.quantizeOptimizedGeometry(C,b,a.hasZ,a.hasM,"esriGeometryPoint",c,d,f),n.convertToPoint(a,h,k)):n.convertToPoint(b,h,k)}function t(b,c,f){return h(this,void 0,void 0,function(){var h,k,m,n,p,t;return v(this,function(r){switch(r.label){case 0:if(!b)return[2,null];h=b.where;b.where=h=h&&h.trim();if(!h||/^1 *= *1$/.test(h)||c&&c===h)b.where=null;return b.geometry?
[4,z(b)]:[2,b];case 1:return k=r.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(m=b.geometry.spatialReference,k=l.getGeometryExtent(k),k.spatialReference=m),b.geometry=k,[4,E.checkProjectionSupport(k.spatialReference,f)];case 2:return r.sent(),[4,y.normalizeCentralMeridian(q.fromJSON(k))];case 3:n=r.sent()[0];if(d.isNone(n))throw a.QUERY_ENGINE_EMPTY_RESULT;p=n.toJSON();return[4,E.project(p,p.spatialReference,f)];case 4:t=r.sent();if(!t)throw a.QUERY_ENGINE_EMPTY_RESULT;
t.spatialReference=f;b.geometry=t;return[2,b]}})})}function z(a){return h(this,void 0,void 0,function(){var b,d,h,k,l,n,q,t,w,y;return v(this,function(m){switch(m.label){case 0:b=a.geometry;d=a.distance;h=a.units;if(null==d)return[2,c.resolve(b)];k=b.spatialReference;l=h&&F.fromJSON(h)||f.getUnitString(k);n=k&&(p.isGeographic(k)||p.isWebMercator(k));if(!n)return[3,1];t=b;return[3,3];case 1:return[4,E.checkProjectionSupport(k,p.WGS84).then(function(){return E.project(b,p.WGS84)})];case 2:t=m.sent(),
m.label=3;case 3:return q=t,[4,I.getGeodesicBufferOperator()];case 4:return w=m.sent(),y=w(q,d,l),[2,y?y.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var F=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var S=new w.default,N=new w.default,C=new w.default,V={esriGeometryPoint:n.convertToPoint,
esriGeometryPolyline:n.convertToPolyline,esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};a.transformCentroid=k;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=D.getCentroidOptimizedGeometry(new w.default,b.geometry,a.hasZ,a.hasM));return k(a,b.centroid,c)};a.getGeometry=function(a,b,c,d,f,h){void 0===f&&(f=a.hasZ);void 0===h&&(h=a.hasM);var k=a.hasZ&&f,l=a.hasM&&h;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(c)return c=n.generalizeOptimizedGeometry(N,b,a.hasZ,a.hasM,a.geometryType,c,f,h),d&&(c=n.quantizeOptimizedGeometry(C,c,k,l,a.geometryType,d)),V[a.geometryType](c,k,l);if(d)return c=n.quantizeOptimizedGeometry(C,b,a.hasZ,a.hasM,a.geometryType,d,f,h),V[a.geometryType](c,k,l);n.removeZMValues(S,b,a.hasZ,a.hasM,f,h);return V[a.geometryType](S,k,l)};a.normalizeQuery=function(a,b,c){return h(this,void 0,void 0,function(){var d,f,h,k,l;return v(this,function(m){d=
a.outFields;f=a.orderByFields;h=a.groupByFieldsForStatistics;k=a.outStatistics;if(d)for(l=0;l<d.length;l++)d[l]=d[l].trim();if(f)for(l=0;l<f.length;l++)f[l]=f[l].trim();if(h)for(l=0;l<h.length;l++)h[l]=h[l].trim();if(k)for(l=0;l<k.length;l++)k[l].onStatisticField&&(k[l].onStatisticField=k[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,t(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return h(this,void 0,void 0,function(){return v(this,function(d){return[2,
t(a,b,c)]})})};a.normalizeQueryLike=t;a.cleanFromGeometryEngine=function(a){return a&&W in a?JSON.parse(JSON.stringify(a,ha)):a};var W="_geVersion",ha=function(a,b){return a!==W?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(B,a){function v(a,d,c,f,h,q){q=h?q?4:3:q?3:2;var b=c,l=c+q,v=0,n=0,w=c=0,E=0,B=0;for(--f;B<f;B++,b+=q,l+=q){var k=d[b],t=d[b+1],z=d[b+2],F=d[l],S=d[l+1],N=d[l+2],C=k*S-F*t,w=w+C,v=v+(k+F)*C,n=n+(t+S)*C;h&&(C=k*N-F*z,c+=(z+N)*C,E+=
C);k<a[0]&&(a[0]=k);k>a[1]&&(a[1]=k);t<a[2]&&(a[2]=t);t>a[3]&&(a[3]=t);h&&(z<a[4]&&(a[4]=z),z>a[5]&&(a[5]=z))}0<w&&(w*=-1);0<E&&(E*=-1);if(!w)return null;a=[v,n,.5*w];h&&(a[3]=c,a[4]=.5*E);return a}function h(a,d,c,f,h){h=f?h?4:3:h?3:2;for(var b=d,l=d+h,p=0,v=0,n=0,w=0,B=0,I=c-1;B<I;B++,b+=h,l+=h){var k=a[b],t=a[b+1],z=a[b+2],F=a[l],S=a[l+1],N=a[l+2],C;if(f){C=F-k;var V=S-t,W=N-z;C=Math.sqrt(C*C+V*V+W*W)}else C=F-k,V=S-t,C=Math.sqrt(C*C+V*V);C&&(p+=C,f?(k=[k+.5*(F-k),t+.5*(S-t),z+.5*(N-z)],v+=C*k[0],
n+=C*k[1],w+=C*k[2]):(k=[k+.5*(F-k),t+.5*(S-t)],v+=C*k[0],n+=C*k[1]))}return 0<p?f?[v/p,n/p,w/p]:[v/p,n/p]:0<c?f?[a[d],a[d+1],a[d+2]]:[a[d],a[d+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,d,c,f){if(!d||!d.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var b=a.coords,q=[],y=c?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],p=d.lengths,B=d.coords,n=c?f?4:3:f?3:2,w=0,E=0;E<p.length;E++){var I=p[E],k=v(y,B,w,I,c,f);k&&q.push(k);w+=I*n}q.sort(function(a,b){var d=a[2]-b[2];0===d&&c&&(d=a[4]-b[4]);return d});q.length&&(n=6*q[0][2],b[0]=q[0][0]/n,b[1]=q[0][1]/n,c&&(n=6*q[0][4],b[2]=0!==n?q[0][3]/n:0),b[0]<y[0]||b[0]>y[1]||b[1]<y[2]||b[1]>y[3]||c&&(b[2]<y[4]||b[2]>y[5]))&&(b.length=0);if(!b.length)if(d=
d.lengths[0]?h(B,0,p[0],c,f):null)b[0]=d[0],b[1]=d[1],c&&2<d.length&&(b[2]=d[2]);else return null;return a};a.lineCentroid=h})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(B,a,v,h,b,d,c,f,l,q,y,p,D,n,w){function E(){return d.create(function(a){return B(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var I={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},k={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},t={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},z={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=E;a.getGeodesicBufferOperator=function(){return E().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,h){if(l.isPolygon(b)&&"esriGeometryPoint"===h.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var k=p.convertFromPolygon(new D.default,b,!1,!1);return d.resolve(function(a){return y.polygonContainsPoint(k,!1,!1,a)})}if(l.isPolygon(b)&&"esriGeometryMultipoint"===h.geometryType){var n=
p.convertFromPolygon(new D.default,b,!1,!1);if("esriSpatialRelContains"===a)return d.resolve(function(a){return y.polygonContainsMultipoint(n,!1,!1,a,h.hasZ,h.hasM)})}if(l.isExtent(b)&&"esriGeometryPoint"===h.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return d.resolve(function(a){return c.extentContainsPoint(b,w.getGeometry(h,a))});if(l.isExtent(b)&&"esriGeometryMultipoint"===h.geometryType&&"esriSpatialRelContains"===a)return d.resolve(function(a){return c.extentContainsMultipoint(b,
w.getGeometry(h,a))});if(l.isExtent(b)&&"esriSpatialRelIntersects"===a){var q=f.getExtentIntersector(h.geometryType);return d.resolve(function(a){return q(b,w.getGeometry(h,a))})}return E().then(function(c){var d=c[I[a]].bind(null,b);return function(a){return d(w.getGeometry(h,a))}})};a.checkSpatialQuerySupport=function(a,c,d){return h(this,void 0,void 0,function(){var f,h;return v(this,function(p){f=a.spatialRel;h=a.geometry;if(!h)return[2];if(!0!==k[f])throw new b("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!q.isValid(h.spatialReference)||!q.isValid(d))return[2];if(!0!==t[l.getJsonType(h)])throw new b("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==z[c])throw new b("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,n.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(l.isExtent(a))return!0;if(l.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(B,a){function v(a,b,d,c,f){if(!a)return!1;b=b?d?4:3:d?3:2;d=a.coords;var h=!1,q=0,y=0;for(a=a.lengths;y<a.length;y++){for(var p=a[y],v=q,n=q,w=q+p*b;n<w;n+=b){v=n+b;v===w&&(v=q);var B=d[n],I=d[n+1],k=d[v],v=d[v+1];(I<
f&&v>=f||v<f&&I>=f)&&B+(f-I)/(v-I)*(k-B)<c&&(h=!h)}q+=p*b}return h}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,b,d,c){return v(a,b,d,c.coords[0],c.coords[1])};a.polygonContainsMultipoint=function(a,b,d,c,f,l){f=f?l?4:3:l?3:2;l=c.coords;c=c.lengths;if(!c)return!1;for(var h=0,y=0;h<c.length;h++,y+=f)if(!v(a,b,d,l[y],l[y+1]))return!1;return!0};a.polygonContainsCoords=v})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(B,a,v){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){this._deferreds=[];this._values=[]}a.prototype.push=function(a){var b=this;return v.create(function(c,d){b._deferreds.push({resolve:c,reject:d});b._values.push(a)})};a.prototype.unshift=function(a){var b=this;return v.create(function(c,d){b._deferreds.unshift({resolve:c,reject:d});b._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,
configurable:!0});a.prototype.process=function(){if(0===this.length)return!1;this._deferreds.shift().resolve(this._values.shift());return!0};a.prototype.cancelAll=function(){for(var a=v.createAbortError(),d=0,c=this._deferreds;d<c.length;d++)c[d].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=B})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(B,
a,v,h,b){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,b){return new h.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,c){a.centroid||(a.centroid=v.getCentroidOptimizedGeometry(new b.default,a.geometry,c.hasZ,c.hasM));return a.centroid}};
a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(B,a,v,h,b,d){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?d.defaultPointSymbolJSON:"esriGeometryPolyline"===
a?d.defaultPolylineSymbolJSON:d.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(h("csp-restrictions"))return function(){var c;return v((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",d;for(d in a)c+="this."+d+" \x3d "+JSON.stringify(a[d])+";";var f=new Function(c);return function(){return new f}}catch(p){return function(){var c;return v((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",
prototype:{attributes:b.clone(a)}}]}})},"*now":function(B){B(['dojo/i18n!*preload*esri/layers/graphics/sources/support/nls/CSVSourceWorker*["ar","bs","ca","cs","da","de","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper dojo/number dstore/Csv ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../geometry/projection ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/webMercatorUtils ../../OptimizedFeature ../../OptimizedGeometry ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ../../../support/FieldsIndex".split(" "),function(B,
a,v,h,b,d,c,f,l,q,y,p,D,n,w,E,I,k,t,z,F,S,N){Object.defineProperty(a,"__esModule",{value:!0});var C=S.createDrawingInfo("esriGeometryPoint"),V=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"];a.csvLatitudeFieldNames="lat latitude y ycenter latitude83 latdecdeg point-y".split(" ");a.csvLongitudeFieldNames="lon lng long longitude x xcenter longitude83 longdecdeg point-x".split(" ");a.csvDetectedDelimiters=[","," ",";","|","\t"];var W=
/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,ha=[0,0],X=function(){return function(a,b){this.x=a;this.y=b}}(),L=function(){var a=b._parseInfo(),c=new RegExp("^"+a.regexp+"$"),d=new RegExp("["+a.group+"\\s\\xa0]","g"),f=a.factor;return function(b){b=c.exec(b);a.factor=f;if(!b)return NaN;var h=b[1];if(!b[1]){if(!b[2])return NaN;h=b[2];a.factor*=-1}h=h.replace(d,"").replace(a.decimal,
".");return+h*a.factor}}(),m=function(){return"isInteger"in Number?Number.isInteger:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}}();B=function(){function b(){this._queryEngine=this._fieldsIndex=null}b.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._fieldsIndex=this._queryEngine=null};b.prototype.load=function(a,b){void 0===b&&(b={});return h(this,void 0,void 0,function(){var c,d,f,h,k;return v(this,function(l){switch(l.label){case 0:return[4,
p.all([this._fetch(a.url,b),this._checkProjection(b&&a.parsing&&a.parsing.spatialReference)])];case 1:return c=l.sent()[0],d=this._parse(c,a.parsing),this._queryEngine=this._createQueryEngine(c,d),d.layerDefinition.extent=this._queryEngine.fullExtent,d.layerDefinition.timeInfo&&(f=this._queryEngine.timeExtent,h=f.start,k=f.end,d.layerDefinition.timeInfo.timeExtent=[h,k]),[2,d]}})})};b.prototype.applyEdits=function(){return h(this,void 0,void 0,function(){return v(this,function(a){throw new l("csv-source:editing-not-supported",
"applyEdits() is not supported on CSVLayer");})})};b.prototype.queryFeatures=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return h(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQuery(a,b.signal)]})})};b.prototype.queryFeatureCount=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return h(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};b.prototype.queryObjectIds=function(a,
b){void 0===a&&(a={});void 0===b&&(b={});return h(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};b.prototype.queryExtent=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return h(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};b.prototype._fetch=function(a,b){return h(this,void 0,void 0,function(){var c,d;return v(this,function(h){switch(h.label){case 0:if(!a)throw new l("csv-source:invalid-source",
"url not defined");c=D.urlToObject(a);return[4,f(c.path,{query:c.query,responseType:"text",signal:b.signal})];case 1:return d=h.sent(),[2,d.data]}})})};b.prototype._parse=function(a,b){void 0===b&&(b={});for(var c={columnDelimiter:b.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:b.latitudeField,longitudeFieldName:b.longitudeField}};a&&"\n"===a[0];)a=a.slice(1);"\n"!==a[a.length-1]&&(a+="\n");var d=this._readFirstLine(a);if(!d)throw new l("csv","CSV is empty",{csv:a});if(!b.columnDelimiter){var f=
this._inferDelimiter(d);if(!f)throw new l("csv-source:invalid-delimiter","Unable to detect the delimiter from CSV");c.columnDelimiter=f}var d=d.split(c.columnDelimiter),h=c.layerDefinition={name:"csv",drawingInfo:C,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:b.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:b.spatialReference||{wkid:102100}}};if(!b.latitudeField||!b.longitudeField){f=
this._inferLocationInfo(d);if(!b.longitudeField&&!f.longitudeFieldName||!b.latitudeField&&!f.latitudeFieldName)throw new l("csv","Unable to identify latitudeField and/or longitudeField from CSV");c.locationInfo={longitudeFieldName:b.longitudeField||f.longitudeFieldName,latitudeFieldName:b.latitudeField||f.latitudeFieldName}}a=this._inferFields(a,c.columnDelimiter,d,c.locationInfo);if(b.fields&&b.fields.length){for(var d=new Map,f=0,k=b.fields;f<k.length;f++)b=k[f],d.set(b.name.toLowerCase(),b);for(f=
0;f<a.length;f++)if(b=a[f],k=d.get(b.name.toLowerCase())){var m=b.name;y.mixin(b,k);b.name=m}}h.fields=a;h.fields.some(function(a){return"esriFieldTypeOID"===a.type?(h.objectIdField=a.name,!0):!1})||(b={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1},h.objectIdField=b.name,h.fields.unshift(b));this._fieldsIndex=new N(h.fields);h.timeInfo&&(b=h.timeInfo,b.startTimeField&&((a=this._fieldsIndex.get(b.startTimeField))?(b.startTimeField=a.name,a.type="esriFieldTypeDate"):
b.startTimeField=null),b.endTimeField&&((a=this._fieldsIndex.get(b.endTimeField))?(b.endTimeField=a.name,a.type="esriFieldTypeDate"):b.endTimeField=null),b.trackIdField&&(a=this._fieldsIndex.get(b.trackIdField),b.trackIdField=a?a.name:null),b.startTimeField||b.endTimeField||(h.timeInfo=null));return c};b.prototype._inferLocationInfo=function(b){var c=null,d=null;b.forEach(function(b){var f=b.toLowerCase(),h;h=a.csvLatitudeFieldNames.indexOf(f);-1===h||d||(d=b);h=a.csvLongitudeFieldNames.indexOf(f);
-1===h||c||(c=b)});return{longitudeFieldName:c,latitudeFieldName:d}};b.prototype._inferFields=function(a,b,c,d){var f=[],h=this._sampleLines(a).map(function(a){return a.split(b).map(function(a){return a.trim()})});a=function(a){var b=c[a];if(b===d.longitudeFieldName||b===d.latitudeFieldName)f.push({name:b,type:"esriFieldTypeDouble",alias:b});else{var l=h.map(function(b){return b[a]}),l=k._inferFieldType(l),b={name:b,type:null,alias:b};switch(l){case "integer":b.type="esriFieldTypeInteger";break;case "double":b.type=
"esriFieldTypeDouble";break;case "date":b.type="esriFieldTypeDate";b.length=36;break;default:b.type="esriFieldTypeString",b.length=255}f.push(b)}};for(var k=this,l=0;l<c.length;l++)a(l);return f};b.prototype._inferFieldType=function(a){var b=this;if(!a.length)return"string";var c=/[^+-.,0-9]/;return a.map(function(a){var d=!1;if(""===a||c.test(a))d=!0;else{d=L(a);if(!isNaN(d))return/[.,]/.test(a)||!m(d)||214783647<d||-214783648>d?"double":"integer";if(-1===a.indexOf("E"))d=!0;else if(d=Number(a),
isNaN(d))if(-1===a.indexOf(","))d=!0;else if(a=a.replace(",","."),d=Number(a),isNaN(d))d=!0;else return"double";else return"double"}return d&&!/^[-]?\d*[.,]?\d*$/.test(a)&&b._isValidDate(new Date(a),a)?"date":"string"}).reduce(function(a,b){if(a===b)return b;if("string"===a||"string"===b)return"string";if("double"===a||"double"===b)return"double"})};b.prototype._isValidDate=function(a,b){if(!a||"[object Date]"!==Object.prototype.toString.call(a)||isNaN(a.getTime()))return!1;a=!0;if(q("chrome")&&/\d+\W*$/.test(b)&&
(b=b.match(/[a-zA-Z]{2,}/))){a=!1;for(var c=0;!a&&c<=b.length;)a=!W.test(b[c]),c++;a=!a}return a};b.prototype._readFirstLine=function(a){return a.substring(0,a.indexOf("\n")).trim()};b.prototype._sampleLines=function(a,b){void 0===b&&(b=10);for(var c=!1,d=[],f=a.indexOf("\n")+1;!c&&d.length<b;){var h=a.indexOf("\n",f);if(-1===h)c=!0;else{var k=void 0;(k=-1===h&&f<a.length-1?a.substring(f).trim():a.substring(f,h).trim())&&d.push(k);f=h+1}}return d};b.prototype._inferDelimiter=function(b){var c=0,d=
"";a.csvDetectedDelimiters.forEach(function(a){var f=b.split(a).length;f>c&&(c=f,d=a)});return""===d?null:d};b.prototype._createQueryEngine=function(a,b){var f,h=b.locationInfo;f=h.latitudeFieldName;for(var l=h.longitudeFieldName,m=b.layerDefinition,h=m.objectIdField,p=m.fields,q=m.extent,r=m.timeInfo,m=[],u=[],v=new Set,y=new Set,z=[],B=0;B<p.length;B++){var C=p[B],G=C.name,C=C.type;"esriFieldTypeDate"===C?v.add(G):-1<V.indexOf(C)&&y.add(G);G!==h&&z.push(G)}p=new d;p.delimiter=b.columnDelimiter;
p.fieldNames=z;p.newline="\n";a=p.parse(a);p=0;a.shift();for(z=0;z<a.length;z++)if(B=a[z],G=this._parseCoordinateValue(B[f]),C=this._parseCoordinateValue(B[l]),null!=C&&null!=G&&!isNaN(G)&&!isNaN(C)){B[f]=G;B[l]=C;for(var D in B)if(D!==f&&D!==l)if(v.has(D)){var N=new Date(B[D]);B[D]=this._isValidDate(N,B[D])?N.getTime():null}else y.has(D)&&(N=L(B[D]),isNaN(N)?B[D]=null:B[D]=N);B[h]=p;p++;m.push(new X(C,G));u.push(B)}if(!w.equals({wkid:4326},q.spatialReference))if(w.isWebMercator(q.spatialReference))for(D=
0,l=m;D<l.length;D++)v=l[D],f=E.lngLatToXY(v.x,v.y,ha),v.x=f[0],v.y=f[1];else m=n.projectMany(m,c.SpatialReference.WGS84,q.spatialReference,null,!0);f=new t.default({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});b=new F.default({fields:b.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:r,objectIdField:h,spatialReference:q.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:f});q=[];for(r=0;r<m.length;r++)l=m[r],D=l.x,l=l.y,v=u[r],v[h]=r+1,q.push(new I.default(new k.default([],
[D,l]),v,null,v[h]));f.addMany(q);return b};b.prototype._parseCoordinateValue=function(a){if(null==a||""===a)return null;var b=L(a);if(isNaN(b)||181<Math.abs(b))b=parseFloat(a);return b};b.prototype._checkProjection=function(a){return h(this,void 0,void 0,function(){return v(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,z.checkProjectionSupport(w.WGS84,a)];case 1:return b.sent(),[3,3];case 2:throw b.sent(),new l("csv-layer","Projection not supported");case 3:return[2]}})})};
return b}();a.default=B});