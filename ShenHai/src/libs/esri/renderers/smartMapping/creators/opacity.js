// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ./support/utils ../statistics/summaryStatistics ../support/utils ../../support/AuthoringInfo ../../support/AuthoringInfoVisualVariable ../../visualVariables/OpacityVariable".split(" "),function(z,n,r,p,q,k,t,l,u,m,v,w,x){function y(d){return q(this,void 0,void 0,function(){var a,g,c,b,e;return p(this,function(f){switch(f.label){case 0:if(!(d&&
d.layer&&(d.field||d.valueExpression||d.sqlExpression)))throw new k("opacity-visual-variable:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(d.valueExpression&&!d.view)throw new k("opacity-visual-variable:missing-parameters","View is required when 'valueExpression' is specified");a=r({},d);g=[0,2,1,3];c=m.createLayerAdapter(a.layer,g);a.layer=c;if(!c)throw new k("opacity-visual-variable:invalid-parameters","'layer' must be one of these types: "+
m.getLayerTypeLabels(g).join(", "));return[4,c.load()];case 1:return f.sent(),[4,m.getFieldsList({field:a.field,normalizationField:a.normalizationField,valueExpression:a.valueExpression})];case 2:b=f.sent();if(e=l.verifyBasicFieldValidity(c,b,"opacity-visual-variable:invalid-parameters"))throw e;return[2,a]}})})}Object.defineProperty(n,"__esModule",{value:!0});n.createVisualVariable=function(d){return q(this,void 0,void 0,function(){var a,g;return p(this,function(c){switch(c.label){case 0:return[4,
y(d)];case 1:a=c.sent();g=null;if(!a.statistics)return[3,2];g=a.statistics;return[3,4];case 2:return[4,u({layer:a.layer,field:a.field,valueExpression:a.valueExpression,sqlExpression:a.sqlExpression,sqlWhere:a.sqlWhere,normalizationType:a.normalizationField?"field":void 0,normalizationField:a.normalizationField,minValue:a.minValue,maxValue:a.maxValue,view:a.view})];case 3:g=c.sent(),c.label=4;case 4:c=g;var b=a,e=b.layer,f=b.field,e=(e=f&&"function"!==typeof f?e.getField(f):null)&&"date"===e.type,
h=l.createStopValues(c),h=(e=l.getDefaultDataRange(c,e,!0))||[h[0],h[4]],f=new x({field:f,valueExpression:b.valueExpression,valueExpressionTitle:b.valueExpressionTitle,normalizationField:b.normalizationField,stops:[{value:h[0],opacity:.3},{value:h[1],opacity:1}],legendOptions:b.legendOptions}),b=new w({type:"opacity",minSliderValue:null!=b.minValue?b.minValue:c.min,maxSliderValue:null!=b.maxValue?b.maxValue:c.max}),b=new v({visualVariables:[b]});return[2,t.resolve({visualVariable:f,statistics:c,defaultValuesUsed:!!e,
authoringInfo:b})]}})})}});